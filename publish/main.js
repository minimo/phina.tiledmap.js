/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/tiledmap/Tiledmap.js":
/*!**********************************!*\
  !*** ./src/tiledmap/Tiledmap.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TiledMap": () => (/* binding */ TiledMap)
/* harmony export */ });
/* harmony import */ var _XMLLoader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./XMLLoader */ "./src/tiledmap/XMLLoader.js");
/* harmony import */ var phina_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! phina.js */ "./node_modules/phina.js/build/phina.esm.js");



class TiledMap extends _XMLLoader__WEBPACK_IMPORTED_MODULE_0__.XMLLoader{
    constructor() {
      super();
      this.image = null;
      this.tilesets = null;
      this.layers = null;
      this.path = "";
    }

    /**
     * マップイメージ取得
     * @param layerName {String}
     * @returns {Texture|null}
     */
    getImage(layerName) {
      if (layerName === undefined) {
        return this.image;
      } else {
        return this._generateImage(layerName);
      }
    }

    /**
     * 指定マップレイヤーを配列として取得
     * @param layerName {String}
     * @returns {null|*}
     */
    getMapData(layerName) {
      //レイヤー検索
      for(let i = 0; i < this.layers.length; i++) {
        if (this.layers[i].name === layerName) {
          //コピーを返す
          return this.layers[i].data.concat();
        }
      }
      return null;
    }

    /**
     * オブジェクトグループを取得（指定が無い場合、全レイヤーを配列にして返す）
     * @param groupName {String}
     * @returns {*[]|any}
     */
    getObjectGroup(groupName) {
      groupName = groupName || null;
      const ls = [];
      const len = this.layers.length;
      for (let i = 0; i < len; i++) {
        if (this.layers[i].type === "objectgroup") {
          if (groupName == null || groupName === this.layers[i].name) {
            //レイヤー情報をクローンする
            const obj = this._cloneObjectLayer(this.layers[i]);
            if (groupName !== null) return obj;
            ls.push(obj);
          }
        }
      }
      return ls;
    }

    /**
     * オブジェクトレイヤーをクローンして返す
     * @param srcLayer {String}
     * @returns {any}
     * @private
     */
    _cloneObjectLayer(srcLayer) {
      const result = phina_js__WEBPACK_IMPORTED_MODULE_1__.$safe.call({}, srcLayer);
      result.objects = [];
      //レイヤー内オブジェクトのコピー
      srcLayer.objects.forEach(obj => {
        const resObj = {
          properties: phina_js__WEBPACK_IMPORTED_MODULE_1__.$safe.call({}, obj.properties),
        }
        phina_js__WEBPACK_IMPORTED_MODULE_1__.$extend.call(resObj, obj);
        if (obj.ellipse) resObj.ellipse = obj.ellipse;
        if (obj.gid) resObj.gid = obj.gid;
        if (obj.polygon) resObj.polygon = obj.polygon.clone();
        if (obj.polyline) resObj.polyline = obj.polyline.clone();
        result.objects.push(resObj);
      });
      return result;
    }

    /**
     * データのパースを行う
     * @param data {XMLDocument}
     * @returns {Promise<unknown>}
     * @private
     */
    _parse(data) {
      return new Promise(resolve => {
        //タイル属性情報取得
        const map = data.getElementsByTagName('map')[0];
        const attr = this._attrToJSON(map);
        phina_js__WEBPACK_IMPORTED_MODULE_1__.$extend.call(this, attr);
        this.properties = this._propertiesToJSON(map);

        //タイルセット取得
        this.tilesets = this._parseTilesets(data);
        this.tilesets.sort((a, b) => a.firstgid - b.firstgid);

        //レイヤー取得
        this.layers = this._parseLayers(data);

        //イメージデータ読み込み
        this._checkImage()
          .then(() => {
            //マップイメージ生成
            this.image = this._generateImage();
            resolve();
          });
      })
    }

    /**
     * タイルセットのパース
     * @param xml {XMLDocument}
     * @returns {*[]}
     * @private
     */
    _parseTilesets(xml) {
      const each = Array.prototype.forEach;
      const data = [];
      const tilesets = xml.getElementsByTagName('tileset');
      each.call(tilesets, async tileset => {
        const t = {};
        const attr = this._attrToJSON(tileset);
        if (attr.source) {
          t.isOldFormat = false;
          t.source = this.path + attr.source;
        } else {
          //旧データ形式（未対応）
          t.isOldFormat = true;
          t.data = tileset;
        }
        t.firstgid = attr.firstgid;
        data.push(t);
      });
      return data;
    }

    /**
     * レイヤー情報のパース
     * @param xml {XMLDocument}
     * @returns {*[]}
     * @private
     */
    _parseLayers(xml) {
      const each = Array.prototype.forEach;
      const data = [];

      const map = xml.getElementsByTagName("map")[0];
      const layers = [];
      each.call(map.childNodes, elm => {
        if (elm.tagName === "layer" || elm.tagName === "objectgroup" || elm.tagName === "imagelayer") {
          layers.push(elm);
        }
      });

      layers.forEach(layer => {
        switch (layer.tagName) {
          case "layer":
            {
              //通常レイヤー
              const d = layer.getElementsByTagName('data')[0];
              const encoding = d.getAttribute("encoding");
              const l = {
                  type: "layer",
                  name: layer.getAttribute("name"),
              };

              if (encoding === "csv") {
                  l.data = this._parseCSV(d.textContent);
              } else if (encoding === "base64") {
                  l.data = this._parseBase64(d.textContent);
              }

              const attr = this._attrToJSON(layer);
              phina_js__WEBPACK_IMPORTED_MODULE_1__.$extend.call(l, attr);
              l.properties = this._propertiesToJSON(layer);

              data.push(l);
            }
            break;

          //オブジェクトレイヤー
          case "objectgroup":
            {
              const l = {
                type: "objectgroup",
                objects: [],
                name: layer.getAttribute("name"),
                x: parseFloat(layer.getAttribute("offsetx")) || 0,
                y: parseFloat(layer.getAttribute("offsety")) || 0,
                alpha: layer.getAttribute("opacity") || 1,
                color: layer.getAttribute("color") || null,
                draworder: layer.getAttribute("draworder") || null,
              };
              each.call(layer.childNodes, elm => {
                if (elm.nodeType === 3) return;
                const d = this._attrToJSON(elm);
                d.properties = this._propertiesToJSON(elm);
                //子要素の解析
                if (elm.childNodes.length) {
                  elm.childNodes.forEach(e => {
                    if (e.nodeType === 3) return;
                    //楕円
                    if (e.nodeName === 'ellipse') {
                      d.ellipse = true;
                    }
                    //多角形
                    if (e.nodeName === 'polygon') {
                      d.polygon = [];
                      const attr = this._attrToJSON_str(e);
                      const pl = attr.points.split(" ");
                      pl.forEach(function(str) {
                        const pts = str.split(",");
                        d.polygon.push({x: parseFloat(pts[0]), y: parseFloat(pts[1])});
                      });
                    }
                    //線分
                    if (e.nodeName === 'polyline') {
                      d.polyline = [];
                      const attr = this._attrToJSON_str(e);
                      const pl = attr.points.split(" ");
                      pl.forEach(str => {
                        const pts = str.split(",");
                        d.polyline.push({x: parseFloat(pts[0]), y: parseFloat(pts[1])});
                      });
                    }
                  });
                }
                l.objects.push(d);
              });
              l.properties = this._propertiesToJSON(layer);

              data.push(l);
            }
            break;

          //イメージレイヤー
          case "imagelayer":
            {
              const l = {
                type: "imagelayer",
                name: layer.getAttribute("name"),
                x: parseFloat(layer.getAttribute("offsetx")) || 0,
                y: parseFloat(layer.getAttribute("offsety")) || 0,
                alpha: layer.getAttribute("opacity") || 1,
                visible: (layer.getAttribute("visible") === undefined || layer.getAttribute("visible") !== 0),
              };
              const imageElm = layer.getElementsByTagName("image")[0];
              l.image = {source: imageElm.getAttribute("source")};

              data.push(l);
            }
            break;
          //グループ
          case "group":
            break;
        }
      });
      return data;
    }

    /**
     * アセットに無いイメージデータを読み込み
     * @returns {Promise<unknown>|Promise<void>}
     * @private
     */
    _checkImage() {
      const imageSource = [];
      const loadImage = [];

      //一覧作成
      this.tilesets.forEach(tileset => {
        const obj = {
          isTileset: true,
          image: tileset.source,
        };
        imageSource.push(obj);
      });
      this.layers.forEach(layer => {
        if (layer.image) {
          const obj = {
            isTileset: false,
            image: layer.image.source,
          };
          imageSource.push(obj);
        }
      });

      //アセットにあるか確認
      imageSource.forEach(e => {
        if (e.isTileset) {
          const tsx = phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetManager.get('tsx', e.image);
          if (!tsx) {
            //アセットになかったのでロードリストに追加
            loadImage.push(e);
          }
        } else {
          const image = phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetManager.get('image', e.image);
          if (!image) {
            //アセットになかったのでロードリストに追加
            loadImage.push(e);
          }
        }
      });

      //一括ロード
      //ロードリスト作成
      if (loadImage.length) {
        const assets = { image: [], tsx: [] };
        loadImage.forEach(e => {
          if (e.isTileset) {
            assets.tsx[e.image] = e.image;
          } else {
            //アセットのパスをマップと同じにする
            assets.image[e.image] = this.path + e.image;
          }
        });
        return new Promise(resolve => {
          const loader = new phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetLoader();
          loader.load(assets);
          loader.on('load', () => {
            this.tilesets.forEach(e => {
              e.tsx = phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetManager.get('tsx', e.source);
            });
            resolve();
          });
        });
      } else {
        return Promise.resolve();
      }
    }

    /**
     * マップイメージ作成
     * @param layerName {String}
     * @returns {Texture|null}
     * @private
     */
    _generateImage(layerName) {
      let numLayer = 0;
      for (let i = 0; i < this.layers.length; i++) {
        if (this.layers[i].type === "layer" || this.layers[i].type === "imagelayer") numLayer++;
      }
      if (numLayer === 0) return null;

      const width = this.width * this.tilewidth;
      const height = this.height * this.tileheight;
      const canvas = new phina_js__WEBPACK_IMPORTED_MODULE_1__.Canvas().setSize(width, height);

      for (let i = 0; i < this.layers.length; i++) {
        //マップレイヤー
        if (this.layers[i].type === "layer" && this.layers[i].visible !== "0") {
          if (layerName === undefined || layerName === this.layers[i].name) {
            const layer = this.layers[i];
            const mapdata = layer.data;
            const width = layer.width;
            const height = layer.height;
            const opacity = layer.opacity || 1.0;
            let count = 0;
            for (let y = 0; y < height; y++) {
              for (let x = 0; x < width; x++) {
                const index = mapdata[count];
                if (index !== 0) {
                  //マップチップを配置
                  this._setMapChip(canvas, index, x * this.tilewidth, y * this.tileheight, opacity);
                }
                count++;
              }
            }
          }
        }
        //オブジェクトグループ
        if (this.layers[i].type === "objectgroup" && this.layers[i].visible !== "0") {
          if (layerName === undefined || layerName === this.layers[i].name) {
            const layer = this.layers[i];
            const opacity = layer.opacity || 1.0;
            layer.objects.forEach(function(e) {
              if (e.gid) {
                this._setMapChip(canvas, e.gid, e.x, e.y, opacity);
              }
            }.bind(this));
          }
        }
        //イメージレイヤー
        if (this.layers[i].type === "imagelayer" && this.layers[i].visible !== "0") {
          if (layerName === undefined || layerName === this.layers[i].name) {
            const image = phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetManager.get('image', this.layers[i].image.source);
            canvas.context.drawImage(image.domElement, this.layers[i].x, this.layers[i].y);
          }
        }
      }

      const texture = new phina_js__WEBPACK_IMPORTED_MODULE_1__.Texture();
      texture.domElement = canvas.domElement;
      return texture;
    }

    /**
     * キャンバスの指定した座標にマップチップのイメージをコピーする
     * @param canvas {HTMLCanvasElement}
     * @param index {Number}
     * @param x {Number}
     * @param y {Number}
     * @private
     */
    _setMapChip(canvas, index, x, y) {
      //対象タイルセットの判別
      let tileset;
      for (let i = 0; i < this.tilesets.length; i++) {
        const tsx1 = this.tilesets[i];
        const tsx2 = this.tilesets[i + 1];
        if (!tsx2) {
          tileset = tsx1;
          i = this.tilesets.length;
        } else if (tsx1.firstgid <= index && index < tsx2.firstgid) {
          tileset = tsx1;
          i = this.tilesets.length;
        }
      }
      //タイルセットからマップチップを取得
      const tsx = tileset.tsx;
      const chip = tsx.chips[index - tileset.firstgid];
      const image = phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetManager.get('image', chip.image);
      canvas.context.drawImage(
        image.domElement,
        chip.x + tsx.margin, chip.y + tsx.margin,
        tsx.tilewidth, tsx.tileheight,
        x, y,
        tsx.tilewidth, tsx.tileheight);
    }
}

/**
 * tmxファイル読み込み
 * @param key {String}
 * @param path {String}
 * @returns {Flow}
 */
phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetLoader.assetLoadFunctions.tmx = (key, path) => {
    const tmx = new TiledMap();
    return tmx.load(path);
}


/***/ }),

/***/ "./src/tiledmap/Tileset.js":
/*!*********************************!*\
  !*** ./src/tiledmap/Tileset.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TileSet": () => (/* binding */ TileSet)
/* harmony export */ });
/* harmony import */ var _XMLLoader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./XMLLoader */ "./src/tiledmap/XMLLoader.js");
/* harmony import */ var phina_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! phina.js */ "./node_modules/phina.js/build/phina.esm.js");



class TileSet extends _XMLLoader__WEBPACK_IMPORTED_MODULE_0__.XMLLoader{
    constructor(xml) {
        super();
        this.image = null;
        this.tilewidth = 0;
        this.tileheight = 0;
        this.tilecount = 0;
        this.columns = 0;
        this.path = "";
        if (xml) {
            this.loadFromXML(xml);
        }
    }

    /**
     * XMLファイル読み込み
     * @param xml {XMLDocument}
     * @returns {Promise<unknown>}
     */
    loadFromXML(xml) {
      return this._parse(xml);
    }

    /**
     *
     * @param data {XMLDocument}
     * @returns {Promise<unknown>}
     * @private
     */
    _parse(data) {
      return new Promise(resolve => {
        //タイルセット取得
        const tileset = data.getElementsByTagName('tileset')[0];
        // const props = this._propertiesToJSON(tileset);

        //タイルセット属性情報取得
        const attr = this._attrToJSON(tileset);
        phina_js__WEBPACK_IMPORTED_MODULE_1__.$safe.call(attr,{
          tilewidth: 32,
          tileheight: 32,
          spacing: 0,
          margin: 0,
        });
        phina_js__WEBPACK_IMPORTED_MODULE_1__.$extend.call(this, attr);
        this.chips = [];

        //ソース画像設定取得
        this.imageName = tileset.getElementsByTagName('image')[0].getAttribute('source');
  
        //透過色設定取得
        const trans = tileset.getElementsByTagName('image')[0].getAttribute('trans');
        if (trans) {
          this.transR = parseInt(trans.substring(0, 2), 16);
          this.transG = parseInt(trans.substring(2, 4), 16);
          this.transB = parseInt(trans.substring(4, 6), 16);
        }
  
        //マップチップリスト作成
        for (let r = 0; r < this.tilecount; r++) {
          this.chips[r] = {
              image: this.imageName,
              x: (r  % this.columns) * (this.tilewidth + this.spacing) + this.margin,
              y: Math.floor(r / this.columns) * (this.tileheight + this.spacing) + this.margin,
          };
        }

        //イメージデータ読み込み
        this._loadImage()
          .then(() => resolve());
      });
    }

    /**
     * アセットに無いイメージデータを読み込み
     * @returns {Promise<unknown>}
     * @private
     */
    _loadImage() {
      return new Promise(resolve => {
        const imageSource = {
          imageName: this.imageName,
          imageUrl: this.path + this.imageName,
          transR: this.transR,
          transG: this.transG,
          transB: this.transB,
        };
        
        let loadImage = null;
        const image = phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetManager.get('image', imageSource.image);
        if (image) {
          this.image = image;
        } else {
          loadImage = imageSource;
        }

        //ロードリスト作成
        const assets = { image: [] };
        assets.image[imageSource.imageName] = imageSource.imageUrl;

        if (loadImage) {
          const loader = new phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetLoader();
          loader.load(assets);
          loader.on('load', () => {
            //透過色設定反映
            this.image = phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetManager.get('image', imageSource.imageUrl);
            if (imageSource.transR !== undefined) {
              const r = imageSource.transR;
              const g = imageSource.transG;
              const b = imageSource.transB;
              this.image.filter((pixel, index, x, y, bitmap) => {
                const data = bitmap.data;
                if (pixel[0] === r && pixel[1] === g && pixel[2] === b) {
                    data[index+3] = 0;
                }
              });
            }
            resolve();
          });
        } else {
          resolve();
        }
      });
    }
}

/**
 * tsxファイル読み込み
 * @param key
 * @param path
 * @returns {Flow}
 */
phina_js__WEBPACK_IMPORTED_MODULE_1__.AssetLoader.assetLoadFunctions.tsx = function(key, path) {
    const tsx = new TileSet();
    return tsx.load(path);
};



/***/ }),

/***/ "./src/tiledmap/XMLLoader.js":
/*!***********************************!*\
  !*** ./src/tiledmap/XMLLoader.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "XMLLoader": () => (/* binding */ XMLLoader)
/* harmony export */ });
/* harmony import */ var phina_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! phina.js */ "./node_modules/phina.js/build/phina.esm.js");


class XMLLoader extends phina_js__WEBPACK_IMPORTED_MODULE_0__.Asset{
    constructor() {
        super();
        this.path = "";
    }

    loadDummy() { }

    /**
     * XMLファイルのロード
     * @param resolve {function}
     * @protected
     */
    _load(resolve) {
        //パス抜き出し
        this.path = "";
        const last = this.src.lastIndexOf("/");
        if (last > 0) {
            this.path = this.src.substring(0, last + 1);
        }

        //終了関数保存
        this._resolve = resolve;

        // load
        const xml = new XMLHttpRequest();
        xml.open('GET', this.src);
        xml.onreadystatechange = () => {
            if (xml.readyState === 4) {
                if ([200, 201, 0].indexOf(xml.status) !== -1) {
                    const data = (new DOMParser()).parseFromString(xml.responseText, "text/xml");
                    this.dataType = "xml";
                    this.data = data;
                    this._parse(data)
                        .then(() => this._resolve(this));
                }
            }
        };
        xml.send(null);
    }

    /**
     * XMLプロパティをJSONに変換
     * @param elm {XMLDocument}
     * @returns {{}}
     * @protected
     */
    _propertiesToJSON(elm) {
        const properties = elm.getElementsByTagName("properties")[0];
        const obj = {};
        if (properties === undefined) return obj;

        for (let k = 0; k < properties.childNodes.length; k++) {
            const p = properties.childNodes[k];
            if (p.tagName === "property") {
                let value = p.getAttribute('value');
                if (!value) value = p.textContent;
                //propertyにtype指定があったら変換
                const type = p.getAttribute('type');
                if (type === "int") {
                    obj[p.getAttribute('name')] = parseInt(value, 10);
                } else if (type === "float") {
                    obj[p.getAttribute('name')] = parseFloat(value);
                } else if (type === "bool" ) {
                    obj[p.getAttribute('name')] = value === "true";
                } else {
                    obj[p.getAttribute('name')] = value;
                }
            }
        }
        return obj;
    }

    /**
     * XML属性をJSONに変換
     * @param source
     * @returns {{}}
     * @protected
     */
    _attrToJSON(source) {
        const obj = {};
        for (let i = 0; i < source.attributes.length; i++) {
            let val = source.attributes[i].value;
            val = isNaN(parseFloat(val))? val: parseFloat(val);
            obj[source.attributes[i].name] = val;
        }
        return obj;
    }

    /**
     * XML属性をJSONに変換（Stringで返す）
     * @param source
     * @returns {{}}
     * @protected
     */
    _attrToJSON_str(source) {
        const obj = {};
        for (let i = 0; i < source.attributes.length; i++) {
            obj[source.attributes[i].name] = source.attributes[i].value;
        }
        return obj;
    }

    /**
     * CSVパース
     * @param data {string}
     * @returns {*[]}
     * @protected
     */
    _parseCSV(data) {
        const layer = [];
        const dataList = data.split(',');
        dataList.forEach(elm => {
            const num = parseInt(elm, 10);
            layer.push(num);
        });
        return layer;
    }

    /**
     * BASE64パース
     * http://thekannon-server.appspot.com/herpity-derpity.appspot.com/pastebin.com/75Kks0WH
     * @param data {string}
     * @returns {*[]}
     * @protected
     */
    _parseBase64(data) {
        const rst = [];
        const dataList = atob(data.trim()).split('').map(e => e.charCodeAt(0));
        for (let i = 0, len = dataList.length / 4; i < len; ++i) {
            const n = dataList[i * 4].toString();
            rst[i] = parseInt(n, 10);
        }
        return rst;
    }
}

/***/ }),

/***/ "./node_modules/phina.js/build/phina.esm.js":
/*!**************************************************!*\
  !*** ./node_modules/phina.js/build/phina.esm.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Accelerometer": () => (/* binding */ Accelerometer),
/* harmony export */   "Accessory": () => (/* binding */ Accessory),
/* harmony export */   "Ajax": () => (/* binding */ Ajax),
/* harmony export */   "ArrayEx": () => (/* binding */ arrayExtensions),
/* harmony export */   "ArrayExStatic": () => (/* binding */ arrayStaticExtensions),
/* harmony export */   "Asset": () => (/* binding */ Asset),
/* harmony export */   "AssetLoader": () => (/* binding */ AssetLoader),
/* harmony export */   "AssetManager": () => (/* binding */ AssetManager),
/* harmony export */   "BaseApp": () => (/* binding */ BaseApp),
/* harmony export */   "Button": () => (/* binding */ Button),
/* harmony export */   "Canvas": () => (/* binding */ Canvas),
/* harmony export */   "CanvasApp": () => (/* binding */ CanvasApp),
/* harmony export */   "CanvasLayer": () => (/* binding */ CanvasLayer),
/* harmony export */   "CanvasRenderer": () => (/* binding */ CanvasRenderer),
/* harmony export */   "ChangeDispatcher": () => (/* binding */ ChangeDispatcher),
/* harmony export */   "Circle": () => (/* binding */ Circle),
/* harmony export */   "CircleGauge": () => (/* binding */ CircleGauge),
/* harmony export */   "CircleShape": () => (/* binding */ CircleShape),
/* harmony export */   "Collision": () => (/* binding */ Collision),
/* harmony export */   "Color": () => (/* binding */ Color),
/* harmony export */   "CountScene": () => (/* binding */ CountScene),
/* harmony export */   "DisplayElement": () => (/* binding */ DisplayElement),
/* harmony export */   "DisplayScene": () => (/* binding */ DisplayScene),
/* harmony export */   "DomApp": () => (/* binding */ DomApp),
/* harmony export */   "Draggable": () => (/* binding */ Draggable),
/* harmony export */   "Element": () => (/* binding */ Element),
/* harmony export */   "EventDispatcher": () => (/* binding */ EventDispatcher),
/* harmony export */   "File": () => (/* binding */ File),
/* harmony export */   "Flickable": () => (/* binding */ Flickable),
/* harmony export */   "Flow": () => (/* binding */ Flow),
/* harmony export */   "Font": () => (/* binding */ Font),
/* harmony export */   "FrameAnimation": () => (/* binding */ FrameAnimation),
/* harmony export */   "GameApp": () => (/* binding */ GameApp),
/* harmony export */   "Gamepad": () => (/* binding */ PhinaGamepad),
/* harmony export */   "GamepadManager": () => (/* binding */ GamepadManager),
/* harmony export */   "Gauge": () => (/* binding */ Gauge),
/* harmony export */   "Grid": () => (/* binding */ Grid),
/* harmony export */   "HeartShape": () => (/* binding */ HeartShape),
/* harmony export */   "Input": () => (/* binding */ Input),
/* harmony export */   "Interactive": () => (/* binding */ Interactive),
/* harmony export */   "Keyboard": () => (/* binding */ Keyboard),
/* harmony export */   "Label": () => (/* binding */ Label),
/* harmony export */   "LabelArea": () => (/* binding */ LabelArea),
/* harmony export */   "Layer": () => (/* binding */ Layer),
/* harmony export */   "LoadingScene": () => (/* binding */ LoadingScene),
/* harmony export */   "ManagerScene": () => (/* binding */ ManagerScene),
/* harmony export */   "MathEx": () => (/* binding */ mathExtensions),
/* harmony export */   "Matrix33": () => (/* binding */ Matrix33),
/* harmony export */   "Mouse": () => (/* binding */ Mouse),
/* harmony export */   "NumberEx": () => (/* binding */ numberExtensions),
/* harmony export */   "Object2D": () => (/* binding */ Object2D),
/* harmony export */   "ObjectEx": () => (/* binding */ objectExtensions),
/* harmony export */   "PathShape": () => (/* binding */ PathShape),
/* harmony export */   "PauseScene": () => (/* binding */ PauseScene),
/* harmony export */   "Physical": () => (/* binding */ Physical),
/* harmony export */   "PlainElement": () => (/* binding */ PlainElement),
/* harmony export */   "PolygonShape": () => (/* binding */ PolygonShape),
/* harmony export */   "QueryString": () => (/* binding */ QueryString),
/* harmony export */   "Random": () => (/* binding */ Random),
/* harmony export */   "Rect": () => (/* binding */ Rect),
/* harmony export */   "RectangleShape": () => (/* binding */ RectangleShape),
/* harmony export */   "ResultScene": () => (/* binding */ ResultScene),
/* harmony export */   "Scene": () => (/* binding */ Scene),
/* harmony export */   "Script": () => (/* binding */ Script),
/* harmony export */   "Shape": () => (/* binding */ Shape),
/* harmony export */   "Sound": () => (/* binding */ Sound),
/* harmony export */   "SoundManager": () => (/* binding */ SoundManager),
/* harmony export */   "SplashScene": () => (/* binding */ SplashScene),
/* harmony export */   "Sprite": () => (/* binding */ Sprite),
/* harmony export */   "SpriteSheet": () => (/* binding */ SpriteSheet),
/* harmony export */   "StarShape": () => (/* binding */ StarShape),
/* harmony export */   "StringEx": () => (/* binding */ stringExtensions),
/* harmony export */   "Support": () => (/* binding */ Support),
/* harmony export */   "Texture": () => (/* binding */ Texture),
/* harmony export */   "ThreeLayer": () => (/* binding */ ThreeLayer),
/* harmony export */   "Ticker": () => (/* binding */ Ticker),
/* harmony export */   "TitleScene": () => (/* binding */ TitleScene),
/* harmony export */   "Touch": () => (/* binding */ Touch$1),
/* harmony export */   "TouchList": () => (/* binding */ TouchList),
/* harmony export */   "TriangleShape": () => (/* binding */ TriangleShape),
/* harmony export */   "Tween": () => (/* binding */ Tween),
/* harmony export */   "Tweener": () => (/* binding */ Tweener),
/* harmony export */   "Twitter": () => (/* binding */ Twitter),
/* harmony export */   "Updater": () => (/* binding */ Updater),
/* harmony export */   "Vector2": () => (/* binding */ Vector2),
/* harmony export */   "Vector3": () => (/* binding */ Vector3),
/* harmony export */   "Wave": () => (/* binding */ Wave),
/* harmony export */   "dateEx": () => (/* binding */ dateExtensions),
/* harmony export */   "dateExStatic": () => (/* binding */ dateStaticExtensions),
/* harmony export */   "extendBuiltInObject": () => (/* binding */ extendBuiltInObject),
/* harmony export */   "extendEventObject": () => (/* binding */ extendEventObject),
/* harmony export */   "phina": () => (/* binding */ phina)
/* harmony export */ });
/*!
 * phina.js v0.2.3
 * Released under the MIT license
 *
 * Copyright (C) phi
 */
/**
 * @class global.String
 * # 拡張した String クラス
 */

/**
 * @method format
 * フォーマットに引数を適用した文字列を返します。
 *
 * 引数がオブジェクトの場合、"{プロパティ名}" がオブジェクトのプロパティの値に置き換わります。
 * 指定したプロパティがオブジェクトにない場合は空文字列になります。
 *
 * 第1引数がオブジェクトでなかった場合、"{整数}" が各引数に置き換わります。
 * 指定した値の引数がなかった場合は空文字列になります。
 *
 * ### Example
 *     obj = {r: 128, g: 0, b: 255};
 *     "color: rgb({r}, {g}, {b});".format(obj); // => "color: rgb(128, 0, 255);"
 *
 *     "{0} + {1} = {2}".format(5, 8, (5+8)); // => "5 + 8 = 13"
 *
 * @this String
 * @param {Object} arg パラメータとなるオブジェクト
 * @return {String} 生成した文字列
 */
function format(arg) {
// String.prototype.$method("format", function(arg) {
  // 置換ファンク
  var rep_fn = undefined;
  
  // オブジェクトの場合
  if (typeof arg == "object") {
    /** @ignore */
    rep_fn = function(m, k) {
      if (arg[k] === undefined) {
        return '';
      }
      else {
        return arg[k];
      }
    };
  }
  // 複数引数だった場合
  else {
    var args = arguments;
    /** @ignore */
    rep_fn = function(m, k) {
      var v = args[ parseInt(k) ];
      if (v !== undefined && v !== null) {
        return v;
      }
      else {
        return '';
      }
    };
  }
  
  return this.replace( /\{(\w+)\}/g, rep_fn );
}


/**
 * @method each
 * 各文字を順番に渡しながら関数を繰り返し実行します。
 *
 * ### Example
 *     str = 'abc';
 *     str.each(function(ch) {
 *       console.log(ch);
 *     });
 *     // => 'a'
 *     //    'b'
 *     //    'c'
 *
 * @this String
 * @param {Function} _callback 各要素に対して実行するコールバック関数
 * @param {Object} [_self=this] callback 内で this として参照される値
 */
function each(_callback, _self) {
// String.prototype.$method("each", function() {
  Array.prototype.forEach.apply(this, arguments);
  return this;
}

// ==========
// 以下ライブラリ内では未使用
// ==========

/**
 * @method trim
 * 文字列先頭と末尾の空白文字を全て取り除いた文字列を返します。
 *
 * ###Reference
 * - [String Functions for Javascript – trim, to camel case, to dashed, and to underscore](http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/)
 *
 * ### Example
 *     "  Hello, world!  ".trim(); // => "Hello, world!"
 * 
 * @this String
 * @return {String} トリムした結果の文字列
 */
function trim() {
// String.prototype.$method("trim", function() {
  return this.replace(/^\s+|\s+$/g, "");
}

/**
 * @method capitalize
 * キャピタライズした文字列、すなわち、すべての単語の先頭を大文字にした文字列を返します。
 *
 * 単語の先頭以外は小文字化されます。
 *
 * ###Reference
 * - [キャピタライズ(単語の先頭の大文字化)を行う - oct inaodu](http://d.hatena.ne.jp/brazil/20051212/1134369083)  
 * - [デザインとプログラムの狭間で: javascriptでキャピタライズ（一文字目を大文字にする）](http://design-program.blogspot.com/2011/02/javascript.html)
 *
 * ### Example
 *     "i aM a pen.".capitalize(); // => "I Am A Pen."
 *
 * @this String
 * @return {String} キャピタライズした文字列
 */
function capitalize() {
// String.prototype.$method("capitalize", function() {
  return this.replace(/\w+/g, function(word){
    return capitalizeFirstLetter.call(word);
    // return word.capitalizeFirstLetter();
  });
}

/**
 * @method capitalizeFirstLetter
 * 先頭の文字を大文字にして、それ以外を小文字にした文字列を返します。
 *
 * ### Example
 *     "i aM a pen.".capitalizeFirstLetter(); // "I am a pen."
 *
 * @this String
 * @return {String} 先頭の文字を大文字にして、それ以外を小文字にした文字列
 */
function capitalizeFirstLetter() {
// String.prototype.$method("capitalizeFirstLetter", function() {
  return this.charAt(0).toUpperCase() + this.substr(1).toLowerCase();
}

/**
 * @method toDash
 * 文字列内の大文字を「"-" + 小文字」に変換します。
 *
 * css2properties（element.style）の各プロパティ名を CSS のプロパティ名に変換する場合に便利です。
 *
 * ### Example
 *     "borderTopColor".toDash(); // => "border-top-color"
 *
 * @this String
 * @return {String} 変換後の文字列
 */
function toDash() {
// String.prototype.$method("toDash", function() {
  return this.replace(/([A-Z])/g, function(m){ return '-'+m.toLowerCase(); });
}


/**
 * @method toHash
 * ハッシュ値を生成して返します。
 *
 * ### Example
 *     "phina.js".toHash(); // => 2676327394
 *
 * @this String
 * @return {Number} CRC32ハッシュ値
 */
function toHash() {
// String.prototype.$method("toHash", function() {
  return toCRC32.call(this);
  // return this.toCRC32();
}


/**
 * @method padding
 * 左に文字を埋めて指定した桁にします。this の文字列は右寄せされます。
 *
 * ### Example
 *     "1234".padding(10);      // => "      1234"
 *     "1234".padding(10, '0'); // => "0000001234"
 *
 * @this String
 * @param {Number} n 桁数
 * @param {String} [ch=" "] 埋める文字
 * @return {String} 指定した桁の文字列
 */
function padding(n, ch) {
// String.prototype.$method("padding", function(n, ch) {
  var str = this.toString();
  n  = n-str.length;
  ch = (ch || ' ')[0];
  
  while(n-- > 0) { str = ch + str; }
  
  return str;
}
/**
 * @method paddingLeft
 * 左に文字を埋めて指定した桁にします。this の文字列を右寄せされます。
 *
 * @this String
 * {@link #padding} と同じです。
 * @inheritdoc #padding
 */
function paddingLeft(n, ch) {
// String.prototype.$method("paddingLeft", function(n, ch) {
  var str = this.toString();
  n  = n-str.length;
  ch = (ch || ' ')[0];
  
  while(n-- > 0) { str = ch + str; }
  
  return str;
}

/**
 * @method paddingRight
 * 右に文字を埋めて指定した桁にします。this の文字列は左寄せされます。
 *
 * ### Example
 *     "1234".paddingRight(10);      // => "1234      "
 *     "1234".paddingRight(10, '0'); // => "1234000000"
 *
 * @this String
 * @param {Number} n 桁数
 * @param {String} [ch=" "] 埋める文字
 * @return {String} 指定した桁の文字列
 */
function paddingRight(n, ch) {
// String.prototype.$method("paddingRight", function(n, ch) {
  var str = this.toString();
  n  = n-str.length;
  ch = (ch || ' ')[0];
  
  while(n-- > 0) { str = str + ch; }
  
  return str;
}
  
/**
 * @method quotemeta
 * 正規表現のメタ文字をクォートします。
 *
 * ### Example
 *     "Hello world. (can you hear me?)".quotemeta(); // => "Hello\\ world\\.\\ \\(can\\ you\\ hear\\ me\\?\\)"
 *
 * @this String
 * @return {String} クォートされた文字列
 */
function quotemeta(n) {
// String.prototype.$method("quotemeta", function(n) {
  return this.replace(/([^0-9A-Za-z_])/g, '\\$1');
}
  
/**
 * @method repeat
 * 自分自身を指定した回数だけ繰り返した文字列を返します。
 *
 * ### Example
 *     "Abc".repeat(4); // => "AbcAbcAbcAbc"
 *
 * @this String
 * @param {Number} n 繰り返し回数
 * @return {String} 文字列
 */
function repeat(n) {
// String.prototype.$method("repeat", function(n) {
  // TODO: 確認する
  var arr = Array(n);
  for (var i=0; i<n; ++i) arr[i] = this;
  return arr.join('');
}

/**
 * @method count
 * 指定した文字列が何個入っているかをカウントして返します。
 *
 * 大文字・小文字は区別されます。
 *
 * ### Example
 *     "This is a string. Isn't it?".count("is"); // => 2
 *
 * @this String
 * @param {String} str 調べる文字列
 * @return {Number} this に str が入っている個数
 */
function count(str) {
// String.prototype.$method("count", function(str) {
  var re = new RegExp(str, 'gm');
  return this.match(re).length;
}

/**
 * @method include
 * 指定した文字列が含まれているかどうかを返します。
 *
 * 大文字・小文字は区別されます。
 *
 * ### Example
 *     "This is a string.".include("is"); // => true
 *     "This is a string.".include("was"); // => false
 *
 * @this String
 * @param {String} str 調べる文字列
 * @return {Boolean} 含まれているかどうか
 */
function include(str) {
// String.prototype.$method("include", function(str) {
  return this.indexOf(str) != -1;
}

/**
 * @method toArray
 * 1文字ずつ分解した配列を返します。
 *
 * ### Example
 *     "12345".toArray(); // => ["1", "2", "3", "4", "5"]
 *     "あいうえお".toArray(); // => "あ", "い", "う", "え", "お"]
 *
 * @this String
 * @return {String[]} 配列
 */
function toArray() {
// String.prototype.$method("toArray", function() {
  var arr = [];
  for (var i=0,len=this.length; i<len; ++i) {
    arr.push(this[i]);
  }
  return arr;
}

/**
 * @method toObject
 * キーと値の組み合わせが連結された文字列からオブジェクトを生成します。
 *
 * 値は Number、Boolean、String のいずれかの型として評価されます。
 *
 * ### Example
 *     obj1 = "num=128.5&flag1=true&flag2=false&str=hoge";
 *     obj1.toObject(); // => {num: 128.5, flag1: true, flag2: false, str: "hoge" }
 *     
 *     obj2 = "num:-64.5|flag1:false|flag2:true|str:foo";
 *     obj2.toObject('|', ':'); // => {num: -64.5, flag1: false, flag2: true, str: "foo" }
 *
 * @this String
 * @param {String} [sep="&"] セパレータ文字
 * @param {String} [eq=""] キーと値の組み合わせを表す文字
 * @return {Object} オブジェクト
 */
function toObject(sep, eq) {
// String.prototype.$method("toObject", function(sep, eq) {
  sep = sep || '&';
  eq  = eq || '=';

  var obj = {};
  var params = this.split(sep);
  params.forEach(function(str, i) {
  // params.each(function(str, i) {
    var pos = str.indexOf(eq);
    if (pos > 0) {
      var key = str.substring(0, pos);
      /** @type string|number|boolean */
      var val = str.substring(pos+1);
      var num = Number(val);

      if (!isNaN(num)) {
        val = num;
      }
      else if (val === 'true') {
        val = true;
      }
      else if (val === 'false') {
        val = false;
      }

      obj[key] = val;
    }
  });

  return obj;
}


var table = "00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".split(' ');

/**
 * @method toCRC32
 * 文字列の CRC32 を計算します。
 *
 * ### Example
 *     "phina.js".toCRC32(); // => 2676327394
 *
 * @this String
 * @return {Number} CRC32 ハッシュ値
 */
function toCRC32() {
// String.prototype.$method("toCRC32", function() {
  var crc = 0, x=0, y=0;
  
  crc = crc ^ (-1);
  for (var i=0, iTop=this.length; i<iTop; ++i) {
    y = (crc ^ this.charCodeAt(i)) & 0xff;
    x = Number("0x" + table[y]);
    crc = (crc >>> 8) ^ x;
  }
  
  return (crc ^ (-1)) >>> 0;
}

var stringExtensions = /*#__PURE__*/Object.freeze({
  __proto__: null,
  format: format,
  each: each,
  trim: trim,
  capitalize: capitalize,
  capitalizeFirstLetter: capitalizeFirstLetter,
  toDash: toDash,
  toHash: toHash,
  padding: padding,
  paddingLeft: paddingLeft,
  paddingRight: paddingRight,
  quotemeta: quotemeta,
  repeat: repeat,
  count: count,
  include: include,
  toArray: toArray,
  toObject: toObject,
  toCRC32: toCRC32
});

/**
 * @class global.Object
 * Objectの拡張
 */

/**
 * 関数を追加
 * 
 * @param   {String} name name
 * @param   {Function} fn
 */
function $method(name, fn) {
  Object.defineProperty(this, name, {
    value: fn,
    enumerable: false,
    writable: true
  });
}

/**
 * @method setter
 * セッターを定義する
 * 
 * @param {string | number | symbol} name
 * @param {any} fn
 */
// Object.prototype.$method("setter", function(name, fn){
function setter(name, fn) {
  Object.defineProperty(this, name, {
    set: fn,
    enumerable: false,
    configurable: true,
  });
}

/**
 * @method getter
 * ゲッターを定義する
 * 
 * @this {Object}
 * @param {string | number | symbol} name
 * @param {any} fn
 */
// Object.prototype.$method("getter", function(name, fn){
function getter(name, fn) {
  Object.defineProperty(this, name, {
    get: fn,
    enumerable: false,
    configurable: true,
  });
}

/**
 * @method accessor
 * アクセッサ(セッター/ゲッター)を定義する
 * 
 * @this Object
 * @param {string | number | symbol} name
 * @param {import('../phina').AccessorExtendObject} param
 */
// Object.prototype.$method("accessor", function(name, param) {
function accessor(name, param) {
  Object.defineProperty(this, name, {
    set: param["set"],
    get: param["get"],
    enumerable: false,
    configurable: true,
  });
}

/**
 * @method forIn
 * オブジェクト用ループ処理
 * 
 * @param {Function} fn
 * @param {any} self
 */
function forIn(fn, self) {
  self = self || this;

  Object.keys(this).forEach(function(key, index) {
    var value = this[key];

    fn.call(self, key, value, index);
  }, this);

  return this;
}

/**
 * @method  $extend
 * 他のライブラリと競合しちゃうので extend -> $extend としました
 */
function $extend() {
// Object.prototype.$method("$extend", function() {
  Array.prototype.forEach.call(arguments, function(source) {
    for (var property in source) {
      this[property] = source[property];
    }
  }, this);
  return this;
}

/**
 * @method  $safe
 * 安全拡張
 * 上書きしない
 */
function $safe(source) {
// Object.prototype.$method("$safe", function(source) {
  Array.prototype.forEach.call(arguments, function(source) {
    for (var property in source) {
      if (this[property] === undefined) this[property] = source[property];
    }
  }, this);
  return this;
}

/**
 * @method $watch
 * 
 * @param  {string} key       [description]
 * @param  {function} callback  [description]
 * @return {void}           [description]
 */
function $watch(key, callback) {
// Object.prototype.$method('$watch', function(key, callback) {
  var target = this;
  var descriptor = null;

  while(target) {
    descriptor = Object.getOwnPropertyDescriptor(target, key);
    if (descriptor) {
      break;
    }
    target = Object.getPrototypeOf(target);
  }

  // すでにアクセッサーとして存在する場合
  if (descriptor) {
    // データディスクリプタの場合
    if (descriptor.value !== undefined) {
      var tempKey = '__' + key;
      var tempValue = this[key];

      this[tempKey] = tempValue;

      accessor.call(this, key, {
      // this.accessor(key, {
        get: function() {
          return this[tempKey];
        },
        set: function(v) {
          var old = this[tempKey];
          this[tempKey] = v;
          callback.call(this, v, old);
        },
      });
    }
    // アクセサディスクリプタの場合
    else {
      accessor.call(this, key, {
      // this.accessor(key, {
        get: function() {
          return descriptor.get.call(this);
        },
        set: function(v) {
          var old = descriptor.get.call(this);
          descriptor.set.call(this, v);
          callback.call(this, v, old);
        },
      });
    }
  }
  else {
    var accesskey = '__' + key;

    accessor.call(this, key, {
    // this.accessor(key, {
      get: function() {
        return this[accesskey];
      },
      set: function(v) {
        var old = this[accesskey];
        this[accesskey] = v;
        callback.call(this, v, old);
      },
    });
  }
}

// ==========
// 以下ライブラリ内では未使用
// ==========

/**
 * @method property
 * 変数を追加
 * 
 * @param   {String} name name
 * @param   {Object} val
 */
function property(name, val) {
  Object.defineProperty(this, name, {
    value: val,
    enumerable: true,
    writable: true
  });
}

/**
 * @method $get
 * パス指定で値を取得
 * 
 * @param {string} key
 */
function $get(key) {
// Object.prototype.$method('$get', function(key) {
  return key.split('.').reduce(function(t, v) {
    return t && t[v];
  }, this);
}

/**
 * @method $set
 * パス指定で値を設定
 * 
 * @param {string} key
 * @param {any} value
 */
function $set(key, value) {
// Object.prototype.$method('$set', function(key, value) {
  key.split('.').reduce(function(t, v, i, arr) {
    if (i === (arr.length-1)) {
      t[v] = value;
    }
    else {
      if (!t[v]) t[v] = {};
      return t[v];
    }
  }, this);
}

/**
 * @method $has
 * そのプロパティを持っているかを判定する
 * 
 * @param {any} key
 */
function $has(key) {
// Object.prototype.$method("$has", function(key) {
  return this.hasOwnProperty(key);
}

/**
 * @method  $strict
 * 厳格拡張
 * すでにあった場合は警告
 */
function $strict(source) {
// Object.prototype.$method("$strict", function(source) {
  Array.prototype.forEach.call(arguments, function(source) {
    for (var property in source) {
      console.assert(!this[property], format.call("tm error: {0} is Already", property));
      // console.assert(!this[property], "tm error: {0} is Already".format(property));
      this[property] = source[property];
    }
  }, this);
  return this;
}

/**
 * @method  $pick
 * ピック
 */
function $pick() {
// Object.prototype.$method("$pick", function() {
  var temp = {};

  Array.prototype.forEach.call(arguments, function(key) {
    if (key in this) temp[key] = this[key];
  }, this);

  return temp;
}

/**
 * @method  $omit
 * オミット
 */
function $omit() {
// Object.prototype.$method("$omit", function() {
  var temp = {};

  for (var key in this) {
    if (Array.prototype.indexOf.call(arguments, key) == -1) {
      temp[key] = this[key];
    }
  }

  return temp;
}

/**
 * @method  $toArray
 * 配列化
 */
function $toArray() {
// Object.prototype.$method("$toArray", function() {
  return Array.prototype.slice.call(this);
}

/**
 * [observe description]
 * @param  {any}   obj      [description]
 * @param  {Function} callback [description]
 * @return {void}            [description]
 */
function observe(obj, callback) {
// Object.$method('observe', function(obj, callback) {
  if (Object['observe']) return Object['observe'].call(obj, callback); // add
  var keys = Object.keys(obj);
  keys.forEach(function(key) {
    var tempKey = '__' + key;
    var tempValue = obj[key];
    obj[tempKey] = tempValue;
    
    accessor.call(obj, key, {
    // obj.accessor(key, {
      get: function() {
        return this[tempKey];
      },
      set: function(v) {
        this[tempKey] = v;
        callback();
      },
    });
  });
}

/**
 * [unobserve description]
 * @param  {any}   obj      [description]
 * @param  {Function} callback [description]
 * @return {void}            [description]
 */
function unobserve(obj, callback) {
// Object.$method('unobserve', function(obj, callback) {
  if (Object['unobserve']) return Object['unobserve'].call(obj, callback); // add
  console.assert(false);
}

var objectExtensions = /*#__PURE__*/Object.freeze({
  __proto__: null,
  $method: $method,
  setter: setter,
  getter: getter,
  accessor: accessor,
  forIn: forIn,
  $extend: $extend,
  $safe: $safe,
  $watch: $watch,
  property: property,
  $get: $get,
  $set: $set,
  $has: $has,
  $strict: $strict,
  $pick: $pick,
  $omit: $omit,
  $toArray: $toArray,
  observe: observe,
  unobserve: unobserve
});

/**
 * @class global.Math
 * # 拡張した Math クラス
 * 数学的な処理を扱う Math クラスを拡張しています。
 * 
 * 全てstaticメンバーです。
 */

/**
 * @static
 * @method clamp
 * 指定した値を指定した範囲に収めた結果を返します。
 *
 * ### Example
 *     Math.clamp(120, 0, 640); // => 120
 *     Math.clamp(980, 0, 640); // => 640
 *     Math.clamp(-80, 0, 640); // => 0
 *
 * @param {Number} value 値
 * @param {Number} min  範囲の下限
 * @param {Number} max  範囲の上限
 * @return {Number} 丸めた結果の値
 */
function clamp(value, min, max) {
  return (value < min) ? min : ( (value > max) ? max : value );
}

/**
 * @property DEG_TO_RAD
 * 度をラジアンに変換するための定数です。
 */
var DEG_TO_RAD = Math.PI/180;

/**
 * @property RAD_TO_DEG
 * ラジアンを度に変換するための定数です。
 */
var RAD_TO_DEG = 180/Math.PI;


// ==========
// 以下ライブラリ内では未使用
// ==========

/**
 * @property PHI
 * 黄金比です。
 */
var PHI = (1 + Math.sqrt(5)) / 2;

/**
 * @static
 * @method degToRad
 * 度をラジアンに変換します。
 *
 * ### Example
 *     Math.degToRad(180); // => 3.141592653589793
 *
 * @param {Number} deg 度
 * @return {Number} ラジアン
 */
function degToRad(deg) {
// Math.degToRad = function(deg) {
  return deg * DEG_TO_RAD;
}

/**
 * @static
 * @method radToDeg
 * ラジアンを度に変換します。
 *
 * ### Example
 *     Math.radToDeg(Math.PI/4); // => 45
 *
 * @param {Number} rad ラジアン
 * @return {Number} 度
 */
function radToDeg(rad) {
// Math.radToDeg = function(rad) {
  return rad * RAD_TO_DEG;
}

/**
 * @static
 * @method inside
 * 指定した値が指定した値の範囲にあるかどうかを返します。
 *
 * ### Example
 *     Math.inside(980, 0, 640); // => false
 *     Math.inside(120, 0, 640); // => true
 *
 * @param {Number} value チェックする値
 * @param {Number} min  範囲の下限
 * @param {Number} max  範囲の上限
 * @return {Boolean} 範囲内に値があるかないか
 */
function inside(value, min, max) {
// Math.$method("inside", function(value, min, max) {
  return (value >= min) && (value) <= max;
}

/**
 * @static
 * @method randint
 * 指定された範囲内でランダムな整数値を生成します。
 *
 * ### Example
 *     Math.randint(-4, 4); // => -4、0、3、4 など
 *
 * @param {Number} min  範囲の最小値
 * @param {Number} max  範囲の最大値
 * @return {Number} ランダムな整数値
 */
function randint(min, max) {
// Math.$method("randint", function(min, max) {
  return Math.floor( Math.random()*(max-min+1) ) + min;
}

/**
 * @static
 * @method randfloat
 * 指定された範囲内でランダムな数値を生成します。
 *
 * ### Example
 *     Math.randfloat(-4, 4); // => -2.7489193824000937 など
 *
 * @param {Number} min  範囲の最小値
 * @param {Number} max  範囲の最大値
 * @return {Number} ランダムな数値
 */
function randfloat(min, max) {
// Math.$method("randfloat", function(min, max) {
  return Math.random()*(max-min)+min;
}

/**
 * @static
 * @method randbool
 * ランダムに真偽値を生成します。
 * 引数で百分率を指定する事もできます。
 *
 * ### Example
 *     Math.randbool();   // => true または false
 *     Math.randbool(80); // => 80% の確率で true
 *
 * @param {Number} percent  真になる百分率
 * @return {Boolean} ランダムな真偽値
 */
function randbool(percent) {
// Math.$method("randbool", function(percent) {
  return Math.random() < (percent === undefined ? 50 : percent) / 100;
}

var mathExtensions = /*#__PURE__*/Object.freeze({
  __proto__: null,
  clamp: clamp,
  DEG_TO_RAD: DEG_TO_RAD,
  RAD_TO_DEG: RAD_TO_DEG,
  PHI: PHI,
  degToRad: degToRad,
  radToDeg: radToDeg,
  inside: inside,
  randint: randint,
  randfloat: randfloat,
  randbool: randbool
});

/*
 * array.js
 */

/**
 * @type {import('../phina').AccessorExtendObject} first
 * 最初の要素を返す、もしくはそこにセットする
 *
 * ### Example
 *     arr = [6, 5, 2, 3, 1, 4];
 *     arr.first; // => 6
 */
const first = {
// Array.prototype.accessor("first", {
  /** @this Array */
  "get": function()   { return this[0]; },
  /** @this Array */
  "set": function(v)  { this[0] = v; }
};

/**
 * @type {import('../phina').AccessorExtendObject} last
 * 最後の要素を返す、もしくはそこにセットする
 *
 * ### Example
 *     arr = [6, 5, 2, 3, 1, 4];
 *     arr.last; // => 4
 */
const last = {
// Array.prototype.accessor("last", {
  /** @this Array */
  "get": function()   { return this[this.length-1]; },
  /** @this Array */
  "set": function(v)  { this[this.length-1] = v; }
};


/**
 * @method at
 * 指定したインデックスの要素を返します（ループ・負数の指定可）。
 *
 * 添字が負数の場合は末尾からのオフセットとみなします。末尾の要素が -1 番目になります。  
 * 添字の絶対値が Array.length 以上の場合はループします。
 *
 * ### Example
 *     arr = ['a', 'b', 'c', 'd', 'e', 'f'];
 *     arr.at(0);  // => 'a'
 *     arr.at(6);  // => 'a'
 *     arr.at(13); // => 'b'
 *     arr.at(-1); // => 'f'
 *     arr.at(-8); // => 'e'
 *
 * @this Array
 * @param {Number} i 添字
 * @return {Object} 添字で指定された要素
 */
function at(i) {
// Array.prototype.$method("at", function(i) {
  i%=this.length;
  i+=this.length;
  i%=this.length;
  return this[i];
}

/**
 * @method erase
 * @chainable
 * 指定したオブジェクトと一致した最初の要素を削除します。
 *
 * ### Example
 *     arr1 = ['a', 'b', 'b', 'c'];
 *     arr2 = arr1.erase('b'); // => ['a', 'b', 'c']
 *     arr1 === arr2;          // => true
 *
 * @this Array
 * @param {Object} elm 削除したいオブジェクト
 */
function erase(elm) {
// Array.prototype.$method("erase", function(elm) {
  var index  = this.indexOf(elm);
  if (index >= 0) {
    this.splice(index, 1);
  }
  return this;
}


/**
 * @method clear
 * @chainable
 * 自身を空の配列にします。
 *
 * ### Example
 *     arr = [1, 2, [3, 4]];
 *     arr.clear(); // => []
 * 
 * @this Array
 */
function clear(deep) {
// Array.prototype.$method("clear", function() {
  this.length = 0;
  return this;
}

/**
 * @method contains
 * 指定した要素が配列に含まれているかをチェックします。
 *
 * 比較には厳密な同値（三重イコール演算子 === で使われるのと同じ方法）を用います。
 *
 * ### Example
 *     arr = [6, 5, 2, 3, 1, 4];
 *     arr.contains(3);     // => true
 *     arr.contains(3, 4);  // => false
 *     arr.contains(3, -4); // => true
 *     arr.contains("6");   // => false
 *
 * @this Array
 * @param {Object} item チェックするオブジェクト
 * @param {Number} [fromIndex=0] 検索を始める位置。負数を指定した場合は末尾からのオフセットと見なします。
 * @return {Boolean} チェックの結果
 */
function contains(item, fromIndex) {
// Array.prototype.$method("contains", function(item, fromIndex) {
  return this.indexOf(item, fromIndex) != -1;
}

/**
 * @method clone
 * 自身のコピーを生成して返します。
 *
 * ### Example
 *     arr1 = [1, 2, [3, 4]];
 *     arr2 = arr1.clone();      // => [1, 2, [3, 4]]
 *     arr1[2] === arr2[2];      // => true
 *     arr1[2][0] = 9;
 *     arr2;                     // => [1, 2, [9, 4]]
 *     arr1 = [1, 2, [3, 4]];
 *     arr2 = arr1.clone(true);  // => [1, 2, [3, 4]]
 *     arr1[2] === arr2[2];      // => false
 *     arr1[2][0] = 9;
 *     arr2;                     // => [1, 2, [3, 4]]
 *
 * @this Array
 * @param {Boolean} [deep=false] 配列のネストをたどって複製するかどうか
 * @return {Array} 新しい配列
 */
function clone(deep) {
// Array.prototype.$method("clone", function(deep) {
  if (deep === true) ;
  else {
    return Array.prototype.slice.apply(this);
  }
}

/**
 * @method range
 * @chainable
 * 自身を等差数列（一定間隔の整数値の列）とします。
 *
 * - 引数が1つの場合、0～end（end含まず）の整数の配列です。  
 * - 引数が2つの場合、start～end（end含まず）の整数の配列です。  
 * - 引数が3つの場合、start～end（end含まず）かつ start + n * step (nは整数)を満たす整数の配列です。
 *
 * ### Example
 *     arr = [];
 *     arr.range(4);        // => [0, 1, 2, 3]
 *     arr.range(2, 5);     // => [2, 3, 4]
 *     arr.range(2, 14, 5); // => [2, 7, 12]
 *     arr.range(2, -3);    // => [2, 1, 0, -1, -2]
 *
 * @this Array
 * @param {Number} start 最初の値（デフォルトは 0）
 * @param {Number} end 最後の値（省略不可）
 * @param {Number} [step] 間隔。デフォルト値は1または-1
 */
function range(start, end, step) {
// Array.prototype.$method("range", function(start, end, step) {
  clear.call(this);
  // this.clear();
  
  if (arguments.length == 1) {
    for (var i=0; i<start; ++i) this[i] = i;
  }
  else if (start < end) {
    step = step || 1;
    if (step > 0) {
      for (var i=start, index=0; i<end; i+=step, ++index) {
        this[index] = i;
      }
    }
  }
  else {
    step = step || -1;
    if (step < 0) {
      for (var i=start, index=0; i>end; i+=step, ++index) {
        this[index] = i;
      }
    }
  }
  
  return this;
}


// ==========
// 以下ライブラリ内では未使用
// ==========


/**
 * @method equals
 * 渡された配列と等しいかどうかをチェックします。
 *
 * 要素同士を === で比較します。要素に配列が含まれている場合は {@link #deepEquals} を使用してください。
 *
 * ### Example
 *     arr1 = [6, 5, 2, 3, 1, 4];
 *     arr1.equals([6, 5, 2, 3, 1, 4]);       // => true
 *     arr2 = [6, 5, 2, [3, 1], 4];
 *     arr2.equals([6, 5, 2, [3, 1], 4]);     // => false
 *     arr2.deepEquals([6, 5, 2, [3, 1], 4]); // => true
 *
 * @this Array
 * @param {Array} arr 比較する対象の配列
 * @return {Boolean} チェックの結果
 */
function equals(arr) {
// Array.prototype.$method("equals", function(arr) {
  // 長さチェック
  if (this.length !== arr.length) return false;
  
  for (var i=0,len=this.length; i<len; ++i) {
    if (this[i] !== arr[i]) {
      return false;
    }
  }

  return true;
}

/**
 * @method deepEquals
 * ネストされている配列を含め、渡された配列と等しいかどうかをチェックします。
 *
 * ※equalsDeep にするか検討. (Java では deepEquals なのでとりあえず合わせとく)
 *
 * ### Example
 *     arr = [6, 5, 2, [3, 1], 4];
 *     arr.equals([6, 5, 2, [3, 1], 4]);     // => false
 *     arr.deepEquals([6, 5, 2, [3, 1], 4]); // => true
 *
 * @this Array
 * @param {Array} arr 比較する対象の配列
 * @return {Boolean} チェックの結果
 */
function deepEquals(arr) {
// Array.prototype.$method("deepEquals", function(arr) {
  // 長さチェック
  if (this.length !== arr.length) return false;
  
  for (var i=0,len=this.length; i<len; ++i) {
    var result = (this[i].deepEquals) ? this[i].deepEquals(arr[i]) : (this[i] === arr[i]);
    if (result === false) {
      return false;
    }
  }
  return true;
}

/**
 * @method swap
 * @chainable
 * a 番目の要素 と b 番目の要素を入れ替えます。
 *
 * ### Example
 *     arr1 = ['a', 'b', 'c', 'd'];
 *     arr2 = arr1.swap(0, 3); // => ['d', 'b', 'c', 'a']
 *     arr1 === arr2;          // => true
 *
 * @this Array
 * @param {Number} a  インデックス
 * @param {Number} b  インデックス
 */
function swap(a, b) {
// Array.prototype.$method("swap", function(a, b) {
  var temp = this[a];
  this[a] = this[b];
  this[b] = temp;
  
  return this;
}

/**
 * @method eraseAll
 * @chainable
 * 指定したオブジェクトと一致したすべての要素を削除します。
 *
 * ### Example
 *     arr1 = ['a', 'b', 'b', 'c'];
 *     arr2 = arr1.eraseAll('b'); // => ['a', 'c']
 *     arr1 === arr2;             // => true
 *
 * @this Array
 * @param {Object} elm 削除したいオブジェクト
 */
function eraseAll(elm) {
// Array.prototype.$method("eraseAll", function(elm) {
  for (var i=0,len=this.length; i<len; ++i) {
    if (this[i] == elm) {
      this.splice(i--, 1);
    }
  }
  return this;
}

/**
 * @method eraseIf
 * @chainable
 * 各要素を引数にして関数を実行し、その値が真となる（＝条件にマッチする）最初の要素を削除します。
 *
 * どの要素もマッチしなければ何も起きません。
 *
 * ### Example
 *     arr = ['foo', 'bar', 'hoge', 'fuga'];
 *     arr.eraseIf( function(elm) {
 *       return elm.indexOf('o') >= 0;
 *     });
 *     // => ['bar', 'hoge', 'fuga']
 *
 * @this Array
 * @param {Function} fn 各要素に対して実行するコールバック関数
 */
function eraseIf(fn) {
// Array.prototype.$method("eraseIf", function(fn) {
  for (var i=0,len=this.length; i<len; ++i) {
    if ( fn(this[i], i, this) ) {
      this.splice(i, 1);
      break;
    }
  }
  return this;
}

/**
 * @method eraseIfAll
 * @chainable
 * 各要素を引数にして関数を実行し、その値が真となる（＝条件にマッチする）すべての要素を削除します。
 *
 * どの要素もマッチしなければ何も起きません。
 *
 * ### Example
 *     arr = ['foo', 'bar', 'hoge', 'fuga'];
 *     arr.eraseIfAll( function(elm) {
 *       return elm.indexOf('o') >= 0;
 *     });
 *     // => ['bar', 'fuga']
 *
 * @this Array
 * @param {Function} fn 各要素に対して実行するコールバック関数
 */
function eraseIfAll(fn) {
// Array.prototype.$method("eraseIfAll", function(fn) {
  for (var i=0,len=this.length; i<len; ++i) {
    if ( fn(this[i], i, this) ) {
      this.splice(i--, 1);
      len--;
    }
  }
  return this;
}

/**
 * @method random
 * 配列からランダムに1つ取り出した要素を返します。
 *
 * 取り出す範囲をインデックスで指定することもできます。  
 * {@link #pickup}、{@link #lot} と同じです。  
 *
 * ### Example
 *     arr = ['foo', 'bar', 'hoge', 'fuga'];
 *     arr.random(2, 3);  // => 'hoge' または 'fuga'
 *
 * @this Array
 * @param {Number} [min=0] インデックスの下限
 * @param {Number} [max=配列の最大インデックス] インデックスの上限
 * @return {Object} ランダムに1つ取り出した要素
 */
function random(min, max) {
// Array.prototype.$method("random", function(min, max) {
  min = min || 0;
  max = max || this.length-1;
  return this[randint(min, max) ];
}

/**
 * @method pickup
 * 配列からランダムで1つ取り出した要素を返します。
 * 
 * {@link #random}、{@link #lot} と同じです。
 * @inheritdoc #random
 * 
 * @this {Array}
 * @param {number} min
 * @param {number} max
 */
function pickup(min, max) {
// Array.prototype.$method("pickup", function(min, max) {
  min = min || 0;
  max = max || this.length-1;
  return this[randint(min, max) ];
}

/**
 * @method lot
 * 配列からランダムで1つ取り出した要素を返します。
 * 
 * {@link #random}、{@link #pickup} と同じです。
 * @inheritdoc #random
 * 
 * @this {Array}
 * @param {number} min
 * @param {number} max
 */
function lot(min, max) {
// Array.prototype.$method("lot", function(min, max) {
  min = min || 0;
  max = max || this.length-1;
  return this[randint(min, max) ];
}

/**
 * @method uniq
 * 要素の重複を取り除いた配列を生成して返します。
 *
 * 自分自身は破壊されません。
 *
 * ### Example
 *     arr = [1, 2, 3, 4, 3, 2];
 *     arr.uniq(); // => [1, 2, 3, 4]
 *
 * @this Array
 * @param {Number} [deep] 未使用
 * @return {Object} 新しい配列
 */
function uniq(deep) {
// Array.prototype.$method("uniq", function(deep) {
  return this.filter(function(value, index, self) {
    return self.indexOf(value) === index;
  });
}


/**
 * @method flatten
 * 自身を再帰的に平滑化した配列を生成して返します。
 *
 * level を指定しなければ深さの際限なく完全に平滑化します。
 *
 * ### Example
 *     arr = [1, 2, [3, [4, 5]]];
 *     arr.flatten();  // => [1, 2, 3, 4, 5]
 *     arr.flatten(1); // => [1, 2, 3, [4, 5]]
 *
 * @this Array<Array>
 * @param {Number} [level=0]  平滑化の再帰の深さ
 * @return {Object} 平滑化した配列
 */
function flatten(level) {
// Array.prototype.$method("flatten", function(level) {
  var arr = null;

  if (level) {
    arr = this;
    for (var i=0; i<level; ++i) {
      arr = Array.prototype.concat.apply([], arr);
    }
  }
  else {
    // 完全フラット
    arr = this.reduce(function (previousValue, curentValue) {
      return Array.isArray(curentValue) ?
        // previousValue.concat(curentValue.flatten()) : previousValue.concat(curentValue);
        previousValue.concat(flatten.call(curentValue)) : previousValue.concat(curentValue);
    }, []);
  }

  return arr;
}

/**
 * @method fill
 * @chainable
 * 自身の一部の要素を特定の値で埋めます。
 *
 * ### Example
 *     arr = [1, 2, 3, 4, 5];
 *     arr.fill("x");       // => ["x", "x", "x", "x", "x"]
 *     arr.fill("x", 2, 4); // => [1, 2, "x", "x", 5]
 *
 * @this Array
 * @param {Object} value 埋める値
 * @param {Number} [start=0] 値を埋める最初のインデックス
 * @param {Number} [end=自身の配列の長さ] 値を埋める最後のインデックス+1
 */
function fill(value, start, end) {
// Array.prototype.$method("fill", function(value, start, end) {
  start = start || 0;
  end   = end   || (this.length);
  
  for (var i=start; i<end; ++i) {
    this[i] = value;
  }
  
  return this;
}


/**
 * @method shuffle
 * @chainable
 * 自身の要素をランダムにシャッフルします。
 *
 * ### Example
 *     arr = [1, 2, 3, 4, 5];
 *     arr.shuffle(); // => [5, 1, 4, 2, 3] など
 * 
 * @this Array
 */
function shuffle() {
// Array.prototype.$method("shuffle", function() {
  for (var i=0,len=this.length; i<len; ++i) {
    var j = randint(0, len-1);
    
    if (i != j) {
      // this.swap(i, j);
      swap.call(this, i, j);
    }
  }
  
  return this;
}

/**
 * @method sum
 * 要素の合計値を返します。
 *
 * 要素に数値以外が含まれる場合の挙動は不定です。
 *
 * ### Example
 *     arr = [1, 2, 3, 4, 5, 6];
 *     arr.sum(); // => 21
 *
 * @this Array
 * @return {Number} 合計
 */
function sum() {
// Array.prototype.$method("sum", function() {
  var sum = 0;
  for (var i=0,len=this.length; i<len; ++i) {
    sum += this[i];
  }
  return sum;
}

/**
 * @method average
 * 要素の平均値を返します。
 *
 * 要素に数値以外が含まれる場合の挙動は不定です。
 *
 * ### Example
 *     arr = [1, 2, 3, 4, 5, 6]
 *     arr.average(); // => 3.5
 *
 * @this Array
 * @return {Number} 平均値
 */
function average() {
// Array.prototype.$method("average", function() {
  var sum = 0;
  var len = this.length;
  for (var i=0; i<len; ++i) {
    sum += this[i];
  }
  return sum/len;
}

/**
 * @method each
 * @chainable
 * 要素を順番に渡しながら関数を繰り返し実行します。
 *
 * メソッドチェーンに対応していますが、このメソッドによって自分自身は変化しません。
 *
 * ###Reference
 * - [Array.prototype.forEach() - JavaScript | MDN](https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach)
 *
 * ### Example
 *     arr = [1, 2, 3];
 *     arr.each( function(elm) {
 *       console.log(elm * elm)
 *     });
 *     // => 1
 *     //    4
 *     //    9
 *
 * @this Array
 * @param {Function} callback 各要素に対して実行するコールバック関数
 * @param {Object} [self] callback 内で this として参照される値
 */
function each$1(callback, self) {
  this.forEach.call(this, callback, self || this);
  return this;
}
// Array.prototype.$method("each", function() {
//   this.forEach.apply(this, arguments);
//   return this;
// }

// /**
//  * @method toULElement
//  * ULElement に変換します（未実装）
//  */
// Array.prototype.$method("toULElement", function(){
//     // TODO: 
// });

// /**
//  * @method toOLElement
//  * OLElement に変換します（未実装）
//  */
// Array.prototype.$method("toOLElement", function(){
//     // TODO:
// });

/**
 * @method most
 * 指定した関数の返り値が最小となる要素と最大となる要素をまとめて返します。
 *
 * 空の配列に対して実行すると {max: Infinity, min: -Infinity} を返します。
 *
 * ### Example
 *     [5,1,4,1,9,2,-10].most(); // => {max:9, min: -10}
 *
 *     points = [ {x:0, y:0}, {x:640, y:960}, {x:-80, y:100} ];
 *     points.most(function(e){return e.x;}).min; // => [x:-80, y:100]
 *     points.most(function(e){return e.y;}).max; // => [x:640, y:960]
 * 
 * @typedef {Object} ArrayMostReturnValue max と min をキーに持つオブジェクト
 * @property {number} min - 関数の返り値が最小となる要素
 * @property {number} max - 関数の返り値が最大となる要素
 *
 * @this Array<number>
 * @param {Function} [func] 各要素に対して実行するコールバック関数
 * @param {Object} [self=this] 関数内で this として参照される値。デフォルトは自分自身。
 * @return {ArrayMostReturnValue}
 */
function most(func, self) {
// Array.prototype.$method("most", function(func, self) {
  if(this.length < 1){
    return {
      max: -Infinity,
      min: Infinity,
    };
  }
  if(func){
    var maxValue = -Infinity;
    var minValue = Infinity;
    var maxIndex = 0;
    var minIndex = 0;
    
    if(typeof self === 'undefined'){self = this;}
    
    for (var i = 0, len = this.length; i < len; ++i) {
      var v = func.call(self, this[i], i, this);
      if(maxValue < v){
        maxValue = v;
        maxIndex = i;
      }
      if(minValue > v){
        minValue = v;
        minIndex = i;
      }
    }
    return {
      max: this[maxIndex],
      min: this[minIndex],
    };
  }
  else {
    var max = -Infinity;
    var min = Infinity;
    for (var i = 0, len = this.length;i < len; ++i) {
      if(max<this[i]){max=this[i];}
      if(min>this[i]){min=this[i];}
    }
    return {
      max: max,
      min: min,
    };
  }
  
}  


// ==========
// 以下はes2015以降に存在するため、保留
// ==========


// /**
//  * @method find
//  * 各要素を引数にして関数を実行し、その値が真となる（＝条件にマッチする）最初の要素を返します。
//  *
//  * どの要素もマッチしなければ undefined を返します。
//  *
//  * ### Example
//  *     arr = ['foo', 'bar', 'hoge', 'fuga'];
//  *     arr.find( function(elm) {
//  *       return elm.indexOf('a') >= 0;
//  *     });
//  *     // => 'bar'
//  *
//  * @param {Function} callback 各要素に対して実行するコールバック関数
//  * @param {Object} [self=this] callback 内で this として参照される値。デフォルトは呼び出し時の this。
//  * @return {Object} 条件にマッチした最初の要素、または undefined
//  */
// Array.prototype.$method("find", function(fn, self) {
//   var target = null;

//   this.some(function(elm, i) {
//     if (fn.call(self, elm, i, this)) {
//       target = elm;
//       return true;
//     }
//   });

//   return target;
// });

// /**
//  * @method findIndex
//  * 各要素を引数にして関数を実行し、その値が真となる（＝条件にマッチする）最初のインデックスを返します。
//  *
//  * どの要素もマッチしなければ -1 を返します。
//  *
//  * ### Example
//  *     arr = ['foo', 'bar', 'hoge', 'fuga'];
//  *     arr.findIndex( function(elm) {
//  *       return elm.indexOf('a') >= 0;
//  *     });
//  *     // => 1
//  *
//  * @param {Function} callback 各要素に対して実行するコールバック関数
//  * @param {Object} [self=this] callback 内で this として参照される値。デフォルトは呼び出し時の this。
//  * @return {Object} 条件にマッチした最初のインデックス、または -1
//  */
// Array.prototype.$method("findIndex", function(fn, self) {
//   var target = -1;

//   this.some(function(elm, i) {
//     if (fn.call(self, elm, i, this)) {
//       target = i;
//       return true;
//     }
//   });

//   return target;
// });

/**
 * @method of
 * @static
 * ES6 準拠の of 関数です。可変長引数をとって Array オブジェクトにして返します。
 *
 * ### Example
 *     Array.of();        // => []
 *     Array.of(1, 2, 3); // => [1, 2, 3]
 *
 * @param {Object} elementN 生成する配列の要素
 * @return {Array} 生成した配列
 */
// Array.$method("of", function() {
//   return Array.prototype.slice.call(arguments);
// });

/**
 * @method from
 * @static
 * ES6 準拠の from 関数です。array-like オブジェクトかiterable オブジェクトから新しい配列を生成します。
 *
 * array-like オブジェクトとは、length プロパティを持ち、数字の添字でアクセス可能なオブジェクトのことです。
 * 通常の配列のほか、String、arguments、NodeList なども array-like オブジェクトです。
 *
 * iterable オブジェクトとは、Symbol.iterator プロパティを持つオブジェクトのことです。
 * 通常の配列のほか、String、arguments、NodeList なども iterable オブジェクトです。
 *
 * ### Example
 *     Array.from([1, 2, 3], function(elm){ return elm * elm} ); // => [1, 4, 9]
 *     Array.from("foo");                                        // => ["f", "o", "o"]
 *     Array.from( document.querySelectorAll("span"))            // => [Element, Element, Element,...]
 *
 * @param {Object} arrayLike 配列に変換する array-like オブジェクト
 * @param {Function} [callback] arrayLike のすべての要素に対して実行するマップ関数
 * @param {Object} [context] callback 内で this として参照される値
 * @return {Array} 生成した配列
 */
// Array.$method("from", function(arrayLike, callback, context) {
//   if (!Object(arrayLike).length) return [];

//   var result = [];
//   if (Symbol && Symbol.iterator && arrayLike[Symbol.iterator]) {
//       var iterator = arrayLike[Symbol.iterator]();
//       while (true) {
//           var iteratorResult = iterator.next();
//           if (iteratorResult.done) break;

//           var value = typeof callback === 'function' ? callback.bind(context || this)(iteratorResult.value) : iteratorResult.value;
//           result.push(value);
//       }
//       return result;
//   }

//   for (var i = 0, len = arrayLike.length; i < len; i++) {
//       result.push(arrayLike[i]);
//   }
//   return result.map(typeof callback == 'function' ? callback : function(item) {
//     return item;
//   }, context);
// });

var arrayExtensions = /*#__PURE__*/Object.freeze({
  __proto__: null,
  first: first,
  last: last,
  at: at,
  erase: erase,
  clear: clear,
  contains: contains,
  clone: clone,
  range: range,
  equals: equals,
  deepEquals: deepEquals,
  swap: swap,
  eraseAll: eraseAll,
  eraseIf: eraseIf,
  eraseIfAll: eraseIfAll,
  random: random,
  pickup: pickup,
  lot: lot,
  uniq: uniq,
  flatten: flatten,
  fill: fill,
  shuffle: shuffle,
  sum: sum,
  average: average,
  each: each$1,
  most: most
});

/**
 * アクセサ拡張用オブジェクト
 * @typedef {{get: ()=> any, set: (v:any)=> void}} AccessorExtendObject
 */

/**
 * @typedef {{
 *   _creator: any
 *   _hierarchies: PhinaClass[]
 *   init: function
 *   superClass?: any
 *   superInit?: function
 *   superMethod?: (methodName: string, ...args:any) => any // スーパーメソッドの結果
 *   constructor?: any
 *   [k: string]: any // その他のプロパティ
 * }} PhinaClassPrototype
 */

/**
 * @typedef {{
 *   prototype: PhinaClassPrototype
 *   [k: string]: any // その他のstaticプロパティ
 * }} PhinaClass
 */

/**
 * @typedef {Object} CreateClassParam
 * @property {Function & {owner: any}} params.init クラス初期化関数
 * @property {PhinaClass} [params.superClass] スーパークラス
 * @property {{[k: string]: AccessorExtendObject}} [params._accessor] アクセサを付与
 * @property {{[k: string]: any}} [params._static] staticプロパティを付与
 * @property {Function} [params._defined] 定義時に実行したい関数
 */

var _classDefinedCallback = {};

var phina = {
  /**
   * @property {String} VERSION
   * @memberof phina
   * @static
   * phina.js のバージョンです。
   */
  VERSION: "0.2.3",

  /**
   * @method isNode
   * Node.js の module かどうかをチェックします。
   * @memberof phina
   * @static
   */
  isNode: function () {
    return "object" !== "undefined";
  },

  /**
   * @method namespace
   * 引数は関数で、その関数内での this は phina になります。
   * @memberof phina
   * @static
   *
   * @param {Function} fn 関数
   */
  namespace: function (fn) {
    fn.call(this);
  },

  /**
   * @method testUA
   * 引数の RegExp オブジェクトとユーザーエージェントを比較して返します。
   * @memberof phina
   * @static
   *
   * @param {RegExp} regExp
   * @return {Boolean}
   */
  testUA: function (regExp) {
    if (!this.global.navigator) return false;
    var ua = this.global.navigator.userAgent;
    return regExp.test(ua);
  },

  /**
   * @method isAndroid
   * Android かどうかを返します。
   * @memberof phina
   * @static
   *
   * @return {Boolean} Android かどうか
   */
  isAndroid: function () {
    return this.testUA(/Android/);
  },

  /**
   * @method isIPhone
   * iPhone かどうかを返します。
   * @memberof phina
   * @static
   *
   * @return {Boolean} iPhone かどうか
   */
  isIPhone: function () {
    return this.testUA(/iPhone/);
  },

  /**
   * @method isIPad
   * iPad かどうかを返します。
   * @memberof phina
   * @static
   *
   * @return {Boolean} iPad かどうか
   */
  isIPad: function () {
    return this.testUA(/iPad/);
  },

  /**
   * @method isIOS
   * iOS かどうかを返します。
   * @memberof phina
   * @static
   *
   * @return {Boolean} iOS かどうか
   */
  isIOS: function () {
    return this.testUA(/iPhone|iPad/);
  },

  /**
   * @method isMobile
   * モバイルかどうかを返します。具体的には Android, iPhone, iPad のいずれかだと true になります。
   * @memberof phina
   * @static
   *
   * @return {Boolean} モバイルかどうか
   */
  isMobile: function () {
    return this.testUA(/iPhone|iPad|Android/);
  },

  /**
   * @method createClass
   * クラスを作成する関数です。
   * 親クラスの指定は文字列でも可能です。
   * 何も継承しない場合 superClass の指定は不要です。また、親クラスを継承している場合、コンストラクタ内で this.superInit() を実行して親クラスを初期化することが必須です。
   * @memberof phina
   * @static
   *
   * @example
   * var Class = phina.createClass({
   *   superClass: namespace.Super,//親クラス継承
   *
   *   //メンバ変数
   *   member1: 100,
   *   member2: 'test',
   *   member3: null,
   *
   *   // コンストラクタ
   *   // Class()を呼び出したとき実行される
   *   init: function(a, b){
   *     //スーパークラス(継承したクラス)のinit
   *     this.superInit(a, b);
   *     this.a = a;
   *     this.b = b;
   *   },
   *
   *   //メソッド
   *   method1: function(){},
   *   method2: function(){},
   *
   * });
   *
   * @param {CreateClassParam} params
   * @return {PhinaClass} phinaクラス
   */
  createClass: function (params) {

    /** @type {PhinaClass} */
    var _class = function () {
      var instance = new _class.prototype._creator();
      _class.prototype.init.apply(instance, arguments);
      return instance;
    };

    if (params.superClass) {
      _class.prototype = Object.create(params.superClass.prototype);
      params.init.owner = _class;
      _class.prototype.superInit = function () {
        this.__counter = this.__counter || 0;

        var superClass = this._hierarchies[this.__counter++];
        var superInit = superClass.prototype.init;
        superInit.apply(this, arguments);

        this.__counter = 0;
      };
      _class.prototype.superMethod = function () {
        var args = Array.prototype.slice.call(arguments, 0);
        var name = args.shift();
        this.__counters = this.__counters || {};
        this.__counters[name] = this.__counters[name] || 0;

        var superClass = this._hierarchies[this.__counters[name]++];
        var superMethod = superClass.prototype[name];
        var rst = superMethod.apply(this, args);

        this.__counters[name] = 0;

        return rst;
      };
      _class.prototype.constructor = _class;
    }

    // //
    // params.forIn(function(key, value) {
    //   if (typeof value === 'function') {
    //     _class.$method(key, value);
    //   }
    //   else {
    //     _class.prototype[key] = value;
    //   }
    // });
    // 継承
    $extend.call(_class.prototype, params);
    // _class.prototype.$extend(params);

    // 継承用
    _class.prototype._hierarchies = [];
    var _super = _class.prototype.superClass;
    while (_super) {
      _class.prototype._hierarchies.push(_super);
      _super = _super.prototype.superClass;
    }

    // accessor
    if (params._accessor) {
      // params._accessor.forIn(
      forIn.call(
        params._accessor,
        /**
         * @param {string} key
         * @param {AccessorExtendObject} value
         */
        function (key, value) {
          accessor.call(_class.prototype, key, value);
          // _class.prototype.accessor(key, value);
        }
      );
      // _class.prototype = Object.create(_class.prototype, params._accessor);
    }

    _class.prototype._creator = function () {
      return this;
    };
    _class.prototype._creator.prototype = _class.prototype;

    // static property/method
    if (params._static) {
      $extend.call(_class, params._static);
      // _class.$extend(params._static);
    }

    if (params._defined) {
      params._defined.call(_class, _class);
    }

    return _class;
  },

  /**
   * @method using
   * 文字列で定義したパスを使ってオブジェクトを取り出します。パスは , . / \ :: で区切ることができます。
   * {@link #phina.register} で登録したオブジェクトを取り出すときなどに使うと便利な関数です。
   * @memberof phina
   * @static
   *
   * @example
   * hoge = {
   *   foo: {
   *     bar: {
   *       num: 100
   *     }
   *   }
   * };
   * var bar = phina.using('hoge.foo.bar');
   * console.log(bar.num); // => 100
   *
   * @param {String} path オブジェクトへのパス
   * @return {Object} 取り出したオブジェクト
   */
  using: function (path) {
    if (!path) {
      return this.global;
    }

    var pathes = path.split(/[,.\/ ]|::/);
    var current = this.global;

    pathes.forEach(function (p) {
      current = current[p] || (current[p] = {});
    });

    return current;
  },

  /**
   * @method register
   * パス指定でオブジェクトを登録する関数です。パスは , . / \ :: で区切ることができます。
   * @memberof phina
   * @static
   *
   * @example
   * phina.register('hoge.foo.bar', {
   *   num: 100,
   * });
   * console.log(hoge.foo.bar.num); // => 100
   *
   * @param {String} path 登録するオブジェクトのパス
   * @param {Object} _class 登録するオブジェクト
   * @return {Object} 登録したオブジェクト
   */
  register: function (path, _class) {
    var pathes = path.split(/[,.\/ ]|::/);
    // var className = pathes.last;
    var className = last.get.call(pathes);
    // FIXME: ここを直さないとピリオド区切り以外は無効？
    var parentPath = path.substring(0, path.lastIndexOf("."));
    var parent = this.using(parentPath);

    parent[className] = _class;

    return _class;
  },

  /**
   * @method define
   * クラスを定義する関数です。使い方は {@link #createClass} とほとんど同じです。
   * ただし、引数は2つあり、第一引数は定義するクラスのパスを文字列で渡します。第二引数のオブジェクトは {@link #createClass} の引数と同じようにします。
   * {@link #createClass} と違い、変数に代入する必要がなく、パス指定でクラスを定義できます。
   * 内部的には {@link #register}, {@link #using} を使用しているため、パスは , . / \ :: で区切ることができます。
   * @memberof phina
   * @static
   *
   * @example
   * phina.define('namespace.Class', {
   *   superClass: 'namespace.Super',//親クラス継承
   *
   *   //メンバ変数
   *   member1: 100,
   *   member2: 'test',
   *   member3: null,
   *
   *   //コンストラクタ
   *   //Class()を呼び出したとき実行される
   *   init: function(a, b){
   *     //スーパークラス(継承したクラス)のinit
   *     this.superInit(a, b);
   *     this.a = a;
   *     this.b = b;
   *   },
   *
   *   //メソッド
   *   method1: function(){},
   *   method2: function(){},
   * });
   *
   * @param {String} path パス
   * @param {Object} params
   * @param {Function & {owner: any}} params.init クラス初期化関数
   * @param {string | PhinaClass} [params.superClass] スーパークラス
   * @param {{[k: string]: AccessorExtendObject}} [params._accessor] アクセサを付与
   * @param {{[k: string]: any}} [params._static] staticプロパティを付与
   * @param {Function} [params._defined] 定義時に実行したい関数
   * @return {PhinaClass} 定義したクラス
   */
  define: function (path, params) {
    if (params.superClass) {
      if (typeof params.superClass === "string") {
        var _superClass = this.using(params.superClass);
        if (typeof _superClass != "function") {
          if (!_classDefinedCallback[params.superClass]) {
            _classDefinedCallback[params.superClass] = [];
          }
          _classDefinedCallback[params.superClass].push(function () {
            this.define(path, params);
          });

          return;
        } else {
          params.superClass = _superClass;
        }
      } else {
        params.superClass = params.superClass;
      }
    }

    var _class = this.createClass(/** @type CreateClassParam */ (params));
    // _class.prototype.accessor('className', {
    accessor.call(_class.prototype, "className", {
      get: function () {
        return path;
      },
    });

    this.register(path, _class);

    if (_classDefinedCallback[path]) {
      _classDefinedCallback[path].forEach(function (callback) {
        callback();
      });
      _classDefinedCallback[path] = null;
    }

    return _class;
  },

  /**
   * @method globalize
   * phina.js が用意している全てのクラスをグローバルに展開します。（具体的には phina が持つオブジェクトが一通りグローバルに展開されます。）
   * この関数を実行することで、いちいち global からたどっていかなくても phina.js の用意しているクラスをクラス名だけで呼び出すことができます。
   * @memberof phina
   * @static
   *
   * @example
   * var sprite1 = phina.display.Sprite("piyo"); 
   * phina.globalize();
   * var sprite2 = Sprite("piyo"); // sprite1と等価
   *
   */
  globalize: function () {
    // phina.forIn(
    forIn.call(this, function (key, value) {

      if (typeof value !== "object") return;

      // value.forIn(function(key, value) {
      forIn.call(value, function (key, value) {
        // if (phina.global[key]) {
        //   console.log(ns, key);
        //   phina.global['_' + key] = value;
        // }
        // else {
        //   phina.global[key] = value;
        // }
        this.global[key] = value;
      });
    });
  },

  /** @private */
  _mainListeners: [],
  /** @private */
  _mainLoaded: false,

  /**
   * @method main
   * phina.js でプログラミングする際、メインの処理を記述するための関数です。
   * 基本的に phina.js でのプログラミングではこの中にプログラムを書いていくことになります。
   * @memberof phina
   * @static
   *
   * @example
   * phina.main(function() {
   *   //ここにメインの処理を書く
   * });
   *
   * @param {Function} func メインの処理
   */
  main: function (func) {
    if (this._mainLoaded) {
      func();
    } else {
      this._mainListeners.push(func);
    }
  },

  /**
   * @memberof phina
   * Node.js なら global、 ブラウザなら window を返します。
   * ゲッターのみ定義されています。
   */
  get global() {
    return GLOBAL;
  },
};

var GLOBAL = phina.isNode() ? __webpack_require__.g : window;

var doc = phina.global.document;
if (phina.global.addEventListener && doc && doc.readyState !== "complete") {
  phina.global.addEventListener("load", function () {
    var run = function () {
      var listeners = clone.call(phina._mainListeners);
      // var listeners = phina._mainListeners.clone();
      clear.call(phina._mainListeners);
      // phina._mainListeners.clear();
      listeners.forEach(function (func) {
        // listeners.each(function(func) {
        func();
      });

      // main 内で main を追加している場合があるのでそのチェック
      if (phina._mainListeners.length > 0) {
        run();
        // run(0);
      } else {
        phina._mainLoaded = true;
      }
    };
    // ちょっと遅延させる(画面サイズ問題)
    setTimeout(run);
  });
} else {
  phina._mainLoaded = true;
}

/**
 * Arrayクラスのstatic拡張
 */

/**
 * @method range
 * @static
 * インスタンスメソッドの {@link #range} と同じです。
 *
 * ### Example
 *     Array.range(2, 14, 5); // => [2, 7, 12]
 */
function range$1(start, end, step) {
  return range.apply([], arguments);
}
// Array.$method("range", function(start, end, step) {
//   return Array.prototype.range.apply([], arguments);
// });

var arrayStaticExtensions = /*#__PURE__*/Object.freeze({
  __proto__: null,
  range: range$1
});

/**
 * @class global.Number
 * # 拡張した Number クラス
 * 数値を扱う Number クラスを拡張しています。
 */

/**
 * @method times
 * 0 から自分自身の数-1まで、カウンタをインクリメントしながら関数を繰り返し実行します。
 *
 * ### Example
 *     arr = [];
 *     (5).times(function(i){
 *       arr.push(i);
 *     }); // => [0, 1, 2, 3, 4]
 *
 * @this Number
 * @param {Function} fn コールバック関数
 * @param {Object} [self=this] 関数内で this として参照される値。デフォルトは自分自身。
 */
function times(fn, self) {
// Number.prototype.$method("times",  function(fn, self) {
  self = self || this;
  for (var i=0; i<this; ++i) {
    fn.call(self, i, this);
  }
  return this;
}

/**
 * @method step
 * 自分自身の値から指定した数まで、カウンタを増分させながら関数を繰り返し実行します。
 *
 * 上限値や増分値は float 型を指定することができます。
 *
 * ### Example
 *     var arr = [];
 *     (2.4).step(5.3, 0.8, function(n) {
 *       arr.push(n);
 *      }); // => [2.4, 3.2, 4.0, 4.8]
 *
 * @this Number
 * @param {Number} limit カウンタの上限値
 * @param {Number} step カウンタを増分する量
 * @param {Function} fn コールバック関数。引数にカウンタが渡される。
 * @param {Object} [self=this] 関数内で this として参照される値。デフォルトは自分自身。
 */
function step(limit, step, fn, self) {
// Number.prototype.$method("step",  function(limit, step, fn, self) {
  self = self || this;
  for (var i=+this; i<=limit; i+=step) {
    fn.call(self, i, this);
  }
  return this;
}


// ==========
// 以下ライブラリ内では未使用
// ==========

/**
 * @method round
 * 指定した小数の位を四捨五入した値を返します。
 *
 * 負の値を指定すると整数部の位を四捨五入できます。
 *
 * ### Example
 *     (13.87).round(); // => 14
 *     (-1.87).round(); // => -2
 *     (-1.27).round(); // => -1
 *     
 *     (2.345).round(); // => 2
 *     (2.345).round(1); // => 2.3
 *     (2.345).round(2); // => 2.35
 *
 *     (12345.67).round(-3); // => 12000
 *
 * @this Number
 * @param {Number} [figure=0] 四捨五入する位
 * @return {Number} 小数第 figure 位で四捨五入した値
 */
function round(figure) {
// Number.prototype.$method("round", function(figure) {
  figure = figure || 0;
  var base = Math.pow(10, figure);
  var temp = this * base;
  temp = Math.round(temp);
  return temp/base;
}

/**
 * @method ceil
 * 指定した小数の位を切り上げた値を返します。
 *
 * 負の値を指定すると整数部の位を切り上げられます。
 *
 * ### Example
 *     (-1.27).ceil(); // => -1
 *     (-1.87).ceil(); // => -1
 *     
 *     (2.345).ceil(); // => 3
 *     (2.345).ceil(1); // => 2.4
 *     (2.345).ceil(2); // => 2.35
 *
 *     (12345.67).ceil(-3); // => 13000
 *
 * @this Number
 * @param {Number} [figure=0] 切り上げる位
 * @return {Number} 小数第 figure 位で切り上げた値
 */
function ceil(figure) {
// Number.prototype.$method("ceil",  function(figure) {
  figure = figure || 0;
  var base = Math.pow(10, figure);
  var temp = this * base;
  temp = Math.ceil(temp);
  return temp/base;
}

/**
 * @method floor
 * 指定した小数の位を切り下げた値を返します。
 *
 * 負の値を指定すると整数部の位を切り下げられます。
 *
 * ### Example
 *     (-1.27).floor(); // => -2
 *     (-1.87).floor(); // => -2
 *     
 *     (2.345).floor(); // => 2
 *     (2.345).floor(1); // => 2.3
 *     (2.345).floor(2); // => 2.34
 *
 *     (12345.67).floor(-3); // => 12000
 *
 * @this Number
 * @param {Number} [figure=0] 切り下げる位
 * @return {Number} 小数第 figure 位で切り下げた値
 */
function floor(figure) {
// Number.prototype.$method("floor",  function(figure) {
  figure = figure || 0;
  var base = Math.pow(10, figure);
  var temp = this * base;
  temp = Math.floor(temp);
  
  // ~~this
  // this|0
  
  return temp/base;
}

/**
 * @method toInt
 * 数値を整数に変換します。
 *
 * ### Example
 *     (42.195).toInt(); // => 42
 *
 * @this Number
 * @return {Number} 整数値
 */
function toInt() {
// Number.prototype.$method("toInt",  function() {
  return (this | 0);
}

/**
 * @method toHex
 * 数値を16進数表記にした文字列を返します。
 *
 * ### Example
 *     (26).toHex(); // => "1a"
 *     (-26).toHex(); // => "-1a"
 *     (26.25).toHex(); // => "1a.4"
 *
 * @this Number
 * @return {String} 16進数表記の文字列
 */
function toHex() {
// Number.prototype.$method("toHex",  function() {
  return this.toString(16);
}

/**
 * @method toBin
 * 数値を2進数表記にした文字列を返します。
 *
 * ### Example
 *     (6).toBin(); // => "110"
 *     (-6).toBin(); // => "-110"
 *     (0xA3).toBin(); // => "10100011"
 *     (6.25).toHex(); // => "110.01"
 *
 * @this Number
 * @return {String} 2進数表記の文字列
 */
function toBin() {
// Number.prototype.$method("toBin",  function() {
  return this.toString(2);
}


/**
 * @method toUnsigned
 * 数値を unsigned int 型に変換します。
 *
 * 数値を符号無し整数として評価した値を返します。  
 * Javascriptのビット演算では数値を符号付きの32bit整数として扱うため、RGBA を
 * 整数値で表現して演算する場合、期待通りの結果が得られない場合があります。
 * そこで本関数で unsigned int 型に変換することで期待通りの値を得ることができます。
 *
 * ### Example
 *     rgba = 0xfeffffff & 0xff000000; // => -33554432
 *     rgba.toHex(); // => "-2000000"
 *     rgba.toUnsigned().toHex(); // => "fe000000"
 *
 * @this Number
 * @return {Number} unsigned int 型に変換した値
 */
function toUnsigned() {
// Number.prototype.$method("toUnsigned",  function() {
  return this >>> 0;
}

/**
 * @method padding
 * 指定した桁になるように文字を埋めます。
 *
 * ### Example
 *     (123).padding(5); // => "00123"
 *     (123).padding(5, "_"); // => "__123"
 *     (-12).padding(5); // => "-0012"
 *
 * @this Number
 * @param {Number} n 桁数
 * @param {String} [ch="0"] 埋める文字
 * @return {String} 桁数を揃えた文字列
 */
function padding$1(n, ch) {
// Number.prototype.$method("padding",  function(n, ch) {
  var str = this+'';
  n  = n-str.length;
  ch = (ch || '0')[0];
  
  while(n-- > 0) { str = ch + str; }
  
  if (str.indexOf("-") >= 0) {
    str = "-" + str.replace("-", "");
  }

  return str;
}

/**
 * @method upto
 * 自分自身の数から指定した数まで、カウンタをインクリメントしながら関数を繰り返し実行します。
 *
 * 指定した数が自分自身の数より小さい場合は関数は実行されません。
 *
 * ### Example
 *     arr = [];
 *     (6).upto(8, function(i){
 *       arr.push(i);
 *     });
 *     arr; // => [6, 7, 8]
 *
 *     (3).upto(0, function(i){
 *       arr.push(i);
 *     });
 *     arr; // => [6, 7, 8]
 *
 * @this Number
 * @param {Function} fn コールバック関数。引数にカウンタが渡される。
 * @param {Object} [self=this] 関数内で this として参照される値。デフォルトは自分自身。
 */
function upto(t, fn, self) {
// Number.prototype.$method("upto",  function(t, fn, self) {
  self = self || this;
  for (var i=+this; i<=t; ++i) {
    fn.call(self, i, this);
  }
  return this;
}

/**
 * @method downto
 * 自分自身の数から指定した数まで、カウンタをデクリメントしながら関数を繰り返し実行します。
 *
 * 指定した数が自分自身の数より大きい場合は関数は実行されません。
 *
 * ### Example
 *     arr = [];
 *     (7).downto(4, function(i){
 *       arr.push(i);
 *     }); // => [7, 6, 5, 4]
 *
 * @this Number
 * @param {Function} fn コールバック関数。引数にカウンタが渡される。
 * @param {Object} [self=this] 関数内で this として参照される値。デフォルトは自分自身。
 */
function downto(t, fn, self) {
// Number.prototype.$method("downto",  function(t, fn, self) {
  self = self || this;
  for (var i=+this; i>=t; --i) {
    fn.call(self, i, this);
  }
  return this;
}


/**
 * @method map
 * 0から自分自身の値-1までカウンタをインクリメントさせながらコールバック関数を繰り返し実行し、
 * その返り値を要素とする配列を生成します。
 *
 * ### Example
 *     (5).map(function(i) {
 *       return i*i;
 *     }); // => [0, 1, 4, 9, 16]
 *
 * @this Number
 * @param {Function} fn コールバック関数。引数にカウンタが渡される。
 * @param {Object} [self=this] 関数内で this として参照される値。デフォルトは自分自身。
 * @return {Array} 生成した配列
 */
function map(fn, self) {
// Number.prototype.$method("map",  function(fn, self) {
  self = self || this;

  var results = [];
  for (var i=0; i<this; ++i) {
    var r = fn.call(self, i);
    results.push(r);
  }
  return results;
}

/**
 * @method abs
 * 絶対値を返します。
 *
 * ### Example
 *     (-5).abs(); // => 5
 *     (+5).abs(); // => 5
 *
 * @this Number
 * @return {Number} 絶対値
 */
function abs() { return Math.abs(this) }
// Number.prototype.$method("abs", function() { return Math.abs(this) });

/**
 * @method acos
 * アークコサイン（ラジアン単位）を返します。
 *
 * ### Example
 *     (0).asin(); // => 0
 *     (1).asin(); // => 1.5707963267948966
 *
 * @this Number
 * @return {Number} アークコサイン
 */
function acos() { return Math.acos(this) }
// Number.prototype.$method("acos", function() { return Math.acos(this) });

/**
 * @method asin
 * アークサイン（ラジアン単位）を返します。
 *
 * ### Example
 *     (1).acos(); // => 0
 *     (-1).acos(); // => 3.141592653589793
 *
 * @this Number
 * @return {Number} アークサイン
 */
function asin() { return Math.asin(this) }
// Number.prototype.$method("asin", function() { return Math.asin(this) });

/**
 * @method atan
 * アークタンジェント（ラジアン単位）を返します。
 *
 * ### Example
 *     (0).atan(); // => 0
 *     (1).atan(); // => 0.7853981633974483
 *
 * @this Number
 * @return {Number} アークタンジェント
 */
function atan() { return Math.atan(this) }
// Number.prototype.$method("atan", function() { return Math.atan(this) });

/**
 * @method cos
 * コサイン（ラジアン単位）を返します。
 *
 * ### Example
 *     (Math.PI/3).cos(); // => 0.5
 *
 * @this Number
 * @return {Number} コサイン
 */
function cos() { return Math.cos(this) }
// Number.prototype.$method("cos", function() { return Math.cos(this) });

/**
 * @method exp
 * e<sup>this</sup> を返します。ここで e は自然対数の底であるネイピア数（オイラー数）です。
 *
 * ### Example
 *     (2).exp(); // => e<sup>2</sup>
 *     (0).exp(); // => 1
 *
 * @this Number
 * @return {Number} e<sup>x</sup>
 */
function exp() { return Math.exp(this) }
// Number.prototype.$method("exp", function() { return Math.exp(this) });

/**
 * @method log
 * 自然対数を返します。
 *
 * ### Example
 *     (Math.E * Math.E * Math.E).log(); // => 3
 *     (1).log(); // => 0
 *     (0).log(); // => -Infinity
 *
 * @this Number
 * @return {Number} 自然対数
 */
function log() { return Math.log(this) }
// Number.prototype.$method("log", function() { return Math.log(this) });

/**
 * @method max
 * 自分自身と引数の値を比べ、大きい方の値を返します。
 *
 * ### Example
 *     (15).max(10); // => 15
 *     (15).max(90); // => 90
 *
 * @this Number
 * @param {Number} value 比較する値
 * @return {Number} 最大値
 */
function max(value) { return Math.max(this, value) }
// Number.prototype.$method("max", function(value) { return Math.max(this, value) });

/**
 * @method min
 * 自分自身と引数の値を比べ、小さい方の値を返します。
 *
 * ### Example
 *     (15).min(10); // => 10
 *     (15).min(90); // => 15
 *
 * @this Number
 * @param {Number} value 比較する値
 * @return {Number} 最小値
 */
function min(value) { return Math.min(this, value) }
// Number.prototype.$method("min", function(value) { return Math.min(this, value) });

/**
 * @method clamp
 * 指定した範囲に収めた値を返します。
 *
 * ### Example
 *     (200).clamp(0, 640); // => 200
 *     (-15).clamp(0, 640); // => 0
 *     (999).clamp(0, 640); // => 640
 *
 * @this Number
 * @param {Number} min 範囲の下限
 * @param {Number} max 範囲の上限
 * @return {Number} 範囲内に収めた値
 */
function clamp$1(min, max) { return clamp(this, min, max) }
// Number.prototype.$method("clamp", function(min, max) { return Math.clamp(this, min, max) });

/**
 * @method pow
 * 自分自身を exponent 乗した値、つまり this<sup>exponent</sup> の値を返します。
 *
 * ### Example
 *     (3).pow(2); // => 9
 *
 * @this Number
 * @param {Number} exponent 累乗する指数
 * @return {Number} 累乗した結果の値
 */
function pow(exponent) { return Math.pow(this, exponent) }
// Number.prototype.$method("pow", function(exponent) { return Math.pow(this, exponent) });

/**
 * @method sin
 * サイン（ラジアン単位）を返します。
 *
 * ### Example
 *     (Math.PI/4).sin(); // => 0.7071067811865476
 *
 * @this Number
 * @return {Number} サイン
 */
function sin() { return Math.sin(this) }
// Number.prototype.$method("sin", function() { return Math.sin(this) });

/**
 * @method sqrt
 * 平方根を返します。
 *
 * ### Example
 *     (49).sqrt(); // => 7
 *
 * @this Number
 * @return {Number} 平方根
 */
function sqrt() { return Math.sqrt(this) }
// Number.prototype.$method("sqrt", function() { return Math.sqrt(this) });

/**
 * @method tan
 * タンジェント（ラジアン単位）を返します。
 *
 * ### Example
 *     (Math.PI/4).tan(); // => 1.0
 *
 * @this Number
 * @return {Number} タンジェント
 */
function tan() { return Math.tan(this) }
// Number.prototype.$method("tan", function() { return Math.tan(this) });

/**
 * @method toDegree
 * ラジアンを度に変換します。
 *
 * ### Example
 *     Math.radToDeg(Math.PI/4); // => 45
 *
 * @this Number
 * @return {Number} 度
 */
function toDegree() { return (this * RAD_TO_DEG); }
// Number.prototype.$method("toDegree", function() { return (this*Math.RAD_TO_DEG); });

/**
 * @method toRadian
 * 度をラジアンに変換します。
 *
 * ### Example
 *     (180).toRadian(); // => 3.141592653589793
 *
 * @this Number
 * @return {Number} ラジアン
 */
function toRadian() { return this * DEG_TO_RAD; }
// Number.prototype.$method("toRadian", function() { return this*Math.DEG_TO_RAD; });

var numberExtensions = /*#__PURE__*/Object.freeze({
  __proto__: null,
  times: times,
  step: step,
  round: round,
  ceil: ceil,
  floor: floor,
  toInt: toInt,
  toHex: toHex,
  toBin: toBin,
  toUnsigned: toUnsigned,
  padding: padding$1,
  upto: upto,
  downto: downto,
  map: map,
  abs: abs,
  acos: acos,
  asin: asin,
  atan: atan,
  cos: cos,
  exp: exp,
  log: log,
  max: max,
  min: min,
  clamp: clamp$1,
  pow: pow,
  sin: sin,
  sqrt: sqrt,
  tan: tan,
  toDegree: toDegree,
  toRadian: toRadian
});

/**
 * @class global.Date
 * # 拡張した Date クラス
 * 日付を扱う Date クラスを拡張しています。
 */

var MONTH = [
  'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'
];

var WEEK = [
  'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'
];

/**
 * @method format
 * 指定したフォーマットに従って日付を文字列化します。
 *
 * <table border="1">
 *   <tr><td>変換指定文字列</td><td>意味</td></tr>
 *   <tr><td>yyyy</td><td>西暦年（4桁）</td></tr>
 *   <tr><td>yy</td><td>西暦年（2桁）</td></tr>
 *   <tr><td>y</td><td>西暦年</td></tr>
 *   <tr><td>MMMM</td><td>月（英語名）</td></tr>
 *   <tr><td>MMM</td><td>月（英語省略名）</td></tr>
 *   <tr><td>MM</td><td>月（2桁数字）</td></tr>
 *   <tr><td>M</td><td>月</td></tr>
 *   <tr><td>dd</td><td>日（2桁）</td></tr>
 *   <tr><td>d</td><td>日</td></tr>
 *   <tr><td>EEEE</td><td>曜日（英語名）</td></tr>
 *   <tr><td>EEE</td><td>曜日（英語省略名）</td></tr>
 *   <tr><td>HH</td><td>時（24時間表記・2桁）</td></tr>
 *   <tr><td>H</td><td>時（24時間表記）</td></tr>
 *   <tr><td>mm</td><td>分（2桁）</td></tr>
 *   <tr><td>m</td><td>分</td></tr>
 *   <tr><td>ss</td><td>秒（2桁）</td></tr>
 *   <tr><td>s</td><td>秒</td></tr>
 * </table>
 * 桁数が指定されているものは0パディングされます。
 *
 * ### Example
 *     (new Date()).format("yyyy-MM-dd(EEE)"); // => "2016-04-05(Tue)" など
 *
 * @this Date
 * @param {String} pattern フォーマット文字列
 * @return {String} フォーマット文字列に従って生成された文字列
 */
function format$1(pattern) {
// Date.prototype.$method('format', function(pattern) {
  var year    = this.getFullYear();
  var month   = this.getMonth();
  var date    = this.getDate();
  var day     = this.getDay();
  var hours   = this.getHours();
  var minutes = this.getMinutes();
  var seconds = this.getSeconds();
  var millseconds = this.getMilliseconds();
  
  var patterns = {
    'yyyy': padding.call(String(year), 4, '0'),
    // 'yyyy': String(year).padding(4, '0'),
    'yy': year.toString().substr(2, 2),
    'y': year,

    'MMMM': MONTH[month],
    'MMM': MONTH[month].substr(0, 3),
    'MM': padding.call(String(month+1), 2, '0'),
    // 'MM': String(month+1).padding(2, '0'),
    'M': (month+1),

    'dd': padding.call(String(date), 2, '0'),
    // 'dd': String(date).padding(2, '0'),
    'd': date,

    'EEEE': WEEK[day],
    'EEE': WEEK[day].substr(0, 3),

    'HH': padding.call(String(hours), 2, '0'),
    // 'HH': String(hours).padding(2, '0'),
    'H': hours,

    'mm': padding.call(String(minutes), 2, '0'),
    // 'mm': String(minutes).padding(2, '0'),
    'm': minutes,

    'ss': padding.call(String(seconds), 2, '0'),
    // 'ss': String(seconds).padding(2, '0'),
    's': seconds,
    
    // // date
    // 'd': String('00' + date).slice(-2),
    // 'D': WEEK[day].substr(0, 3),
    // 'j': date,
    // 'l': WEEK[day],
    
    // // month
    // 'm': String('00' + (month+1)).slice(-2),
    // 'M': MONTH[month].substr(0, 3),
    // 'n': (month+1),
    // 'F': MONTH[month],
    
    // // year
    // 'y': year.toString().substr(2, 2),
    // 'Y': year,
    
    // // time
    // 'G': hours,
    // 'H': String('00' + hours).slice(-2),
    // 'i': String('00' + minutes).slice(-2),
    // 's': String('00' + seconds).slice(-2),
    // 'S': String('000' + millseconds).slice(-3),
  };

  var regstr = '(' + Object.keys(patterns).join('|') + ')';
  var re = new RegExp(regstr, 'g');

  return pattern.replace(re, function(str) {
    return patterns[str];
  });
}

var dateExtensions = /*#__PURE__*/Object.freeze({
  __proto__: null,
  format: format$1
});

/**
 * @class global.Date
 * Dateクラスのstatic拡張
 */

/**
 * @method calculateAge
 * @static
 * 指定した誕生日から、現在または指定した日付における年齢を計算します。
 *
 * ###Reference
 * - [Javascriptで誕生日から現在の年齢を算出](http://qiita.com/n0bisuke/items/dd537bd4cbe9ab501ce8)
 *
 * ### Example
 *     Date.calculateAge("1990-01-17"); // => 26 など
 *
 * @param {String|Date} birthday 誕生日
 * @param {String|Date} [when=本日] 基準の日付
 * @return {Number} 年齢
 */
function calculateAge(birthday, when) {
// Date.$method('calculateAge', function(birthday, when) {
  // birthday
  if (typeof birthday === 'string') {
    birthday = new Date(birthday);
  }
  // when
  if (!when) {
    when = new Date();
  }
  else if (typeof when === 'string') {
    when = new Date(when);
  }

  var bn = new Date(birthday.getTime()).setFullYear(256);
  var wn = new Date(when.getTime()).setFullYear(256);
  var step = (wn < bn) ? 1 : 0;

  return (when.getFullYear() - birthday.getFullYear()) - step;
}

var dateStaticExtensions = /*#__PURE__*/Object.freeze({
  __proto__: null,
  calculateAge: calculateAge
});

/**
 * MouseEvent/Touch拡張
 * マウスのX座標.
 */
var pointX = {
  /** @this {MouseEvent|Touch} */
  get: function() {
    return this.clientX - /** @type {HTMLElement} */(this.target).getBoundingClientRect().left;
  }
};

/**
 * MouseEvent/Touch拡張
 * マウスのY座標.
 */
var pointY = {
  /** @this {MouseEvent|Touch} */
  get: function() {
    return this.clientY - /** @type {HTMLElement} */(this.target).getBoundingClientRect().top;
  }
};

/**
 * TouchEvent拡張
 * タッチイベントのX座標.
 */
var touchPointX = {
  /** @this {TouchEvent} */
  get: function() {
    return this.touches[0].clientX - /** @type {HTMLElement} */(this.target).getBoundingClientRect().left;
    // return this.touches[0].pageX - this.target.getBoundingClientRect().left - tm.global.scrollX;
  }
};

/**
 * TouchEvent拡張
 * タッチイベントのY座標.
 */
var touchPointY = {
  /** @this {TouchEvent} */
  get: function() {
    return this.touches[0].clientY - /** @type {HTMLElement} */(this.target).getBoundingClientRect().top;
    // return this.touches[0].pageY - this.target.getBoundingClientRect().top - tm.global.scrollY;
  }
};

/**
 * global.Event
 * 既存のEventオブジェクト拡張
 */

/**
 * @method stop
 * イベントのデフォルト処理 & 伝達を止める
 */
function stop() {
  // イベントキャンセル
  this.preventDefault();
  // イベント伝達を止める
  this.stopPropagation();
}


// ;(function() {

  // if (!phina.global.Event) return ;

  /**
   * @class global.Event
   * 既存のEventオブジェクト拡張
   */
    
  // /**
  //  * @method stop
  //  * イベントのデフォルト処理 & 伝達を止める
  //  */
  // Event.prototype.stop = function() {
  //   // イベントキャンセル
  //   this.preventDefault();
  //   // イベント伝達を止める
  //   this.stopPropagation();
  // };

// })();


// (function() {

//   if (!phina.global.MouseEvent) return ;

//   /**
//    * @class global.MouseEvent
//    * MouseEvent クラス
//    */
  
//   /**
//    * @method    pointX
//    * マウスのX座標.
//    */
//   MouseEvent.prototype.getter("pointX", function() {
//     return this.clientX - this.target.getBoundingClientRect().left;
//     // return this.pageX - this.target.getBoundingClientRect().left - window.scrollX;
//   });
  
//   /**
//    * @method    pointY
//    * マウスのY座標.
//    */
//   MouseEvent.prototype.getter("pointY", function() {
//     return this.clientY - this.target.getBoundingClientRect().top;
//     // return this.pageY - this.target.getBoundingClientRect().top - window.scrollY;
//   });
    
// })();


// (function() {
    
//   if (!phina.global.TouchEvent) return ;
  
  
//   /**
//    * @class global.TouchEvent
//    * TouchEvent クラス
//    */
  
//   /**
//    * @method    pointX
//    * タッチイベント.
//    */
//   TouchEvent.prototype.getter("pointX", function() {
//       return this.touches[0].clientX - this.target.getBoundingClientRect().left;
//       // return this.touches[0].pageX - this.target.getBoundingClientRect().left - tm.global.scrollX;
//   });
  
//   /**
//    * @method    pointY
//    * タッチイベント.
//    */
//   TouchEvent.prototype.getter("pointY", function() {
//       return this.touches[0].clientY - this.target.getBoundingClientRect().top;
//       // return this.touches[0].pageY - this.target.getBoundingClientRect().top - tm.global.scrollY;
//   });  
    
// })();


// (function() {
    
//   if (!phina.global.Touch) return ;
  
//   /**
//    * @class global.Touch
//    * TouchEvent クラス
//    */
  
//   /**
//    * @method    pointX
//    * タッチイベント.
//    */
//   Touch.prototype.getter("pointX", function() {
//       return this.clientX - this.target.getBoundingClientRect().left;
//   });

//   /**
//    * @method    pointY
//    * タッチイベント.
//    */
//   Touch.prototype.getter("pointY", function() {
//       return this.clientY - this.target.getBoundingClientRect().top;
//   });
    
// })();

/** @typedef {"Object"|"Array"|"ArrayStatic"|"Math"|"String"|"Number"|"Date"|"DateStatic"} ExtendableObjectType */
/** @typedef {{ [key in ExtendableObjectType]: any } } ObjectTypeMapForExtension */
/** @typedef {{ [key in ExtendableObjectType]: Function | import('./phina').AccessorExtendObject | number | string }} ExtensionMethodMap */

/**
 * カスタムメソッドを定義
 * @param {any} obj
 * @param {string} methodName
 * @param {function} func
 */
function _defineMethod(obj, methodName, func) {
  return $method.call(obj, methodName, func);
  // Object.defineProperty(obj, methodName, {
  //   value: func,
  //   enumerable: false,
  //   writable: true
  // })
}

/**
 * カスタムアクセサを定義
 * @param {any} obj
 * @param {string} accessorName
 * @param {import('./phina').AccessorExtendObject} extendObj
 */
function _defineAccessor(obj, accessorName, extendObj) {
  return accessor.call(obj, accessorName, extendObj);
}

/**
 * 汎用オブジェクト拡張関数
 * @param {any} targetObj 対象ビルトインオブジェクト ex) Array.prototype
 * @param {ExtensionMethodMap} extensionMap
 */
function _extend(targetObj, extensionMap) {
  Object.keys(extensionMap).forEach((key) => {
    var value = extensionMap[key];
    if (typeof value === "function") {
      _defineMethod(targetObj, key, value);
    } else if (typeof value === "object" && (value.get || value.set)) {
      _defineAccessor(targetObj, key, value);
    } else {
      // その他static値、Math.DEG_TO_RADなど
      targetObj[key] = value;
    }
  });
}

/**
 * オブジェクト名称 <-> 実際のオブジェクト
 * @type {ObjectTypeMapForExtension}
 */
var ExtendableObjectTypeMap = {
  Object: Object.prototype,
  Array: Array.prototype,
  ArrayStatic: Array,
  Math: Math, // MathはStaticのみ
  String: String.prototype,
  Number: Number.prototype,
  Date: Date.prototype,
  DateStatic: Date,
};

/**
 * オブジェクト名称 <-> 拡張メソッドマップ
 * @type {ObjectTypeMapForExtension}
 * */
var ExtensionTypeMap = {
  Object: objectExtensions,
  Array: arrayExtensions,
  ArrayStatic: arrayStaticExtensions,
  Math: mathExtensions,
  String: stringExtensions,
  Number: numberExtensions,
  Date: dateExtensions,
  DateStatic: dateStaticExtensions,
};

/**
 * Objectなどの標準組み込みオブジェクトの拡張を行う
 * - 引数無指定では全ての拡張を行う
 * - 拡張したいオブジェクト、メソッドを文字列で指定することも可能
 *
 * @example
 * // 全拡張（従来のphina.jsの状態）
 * extendBuiltInObject();
 *
 * // Numberオブジェクトの一部メソッドだけ拡張
 * extendBuiltInObject("Number", ["clamp", "upto"]);
 *
 * @param {ExtendableObjectType} [objectType] "Array"などの対象オブジェクト文字列
 * @param {string[]} [methodNameList] メソッド名文字列
 * @returns {void}
 */
function extendBuiltInObject(objectType, methodNameList) {
  if (!objectType) {
    // 拡張全てを一括で行う
    Object.keys(ExtendableObjectTypeMap).forEach((objType) => {
      _extend(ExtendableObjectTypeMap[objType], ExtensionTypeMap[objType]);
    });
    // _extend(Object.prototype, objectExtensions);
    // _extend(Array.prototype, arrayExtensions);
    // _extend(Array, arrayStaticExtensions);
    // _extend(String.prototype, stringExtensions);
    // _extend(Number.prototype, numberExtensions);
    // _extend(Math, mathExtensions);
    // _extend(Date.prototype, dateExtensions);
    // _extend(Date, dateStaticExtensions);
  } else {
    // 個別拡張
    var targetObject = ExtendableObjectTypeMap[objectType];
    if (!targetObject) {
      // `${objectType}は拡張可能対象ではありません`
      return;
    }
    if (methodNameList) {
      const exts = ExtensionTypeMap[objectType];

      /** @type ExtensionMethodMap */
      const methodMap = Object.create(null);
      methodNameList.forEach((methodName) => {
        if (!exts[methodName]) {
          // TODO: no method error
          return;
        }
        methodMap[methodName] = exts[methodName];
      });

      _extend(targetObject, methodMap);
    } else {
      // targetObjectの拡張全てを行う
      const exts = ExtensionTypeMap[objectType];
      _extend(targetObject, exts);
    }
  }
}

/**
 * dom/Event 一括拡張用メソッド
 */
function extendEventObject() {
  const getter$1 = getter;

  [MouseEvent, Touch].forEach((eventObject) => {
    getter$1.call(eventObject.prototype, "pointX", pointX.get);
    getter$1.call(eventObject.prototype, "pointY", pointY.get);
  });

  getter$1.call(TouchEvent.prototype, "pointX", touchPointX.get);
  getter$1.call(TouchEvent.prototype, "pointY", touchPointY.get);

  _defineMethod(Event.prototype, "stop", stop);
}

/**
 * カスタムイベントの基本パラメータ  
 * @typedef {Object} BasicEventObject
 * @property {string} type イベント名
 * @property {any} [target] イベント対象
 */

/**
 * イベントリスナとなる関数  
 * thisの参照は呼び出したオブジェクト自身となる
 * @callback PhinaEventHandler
 * @param {BasicEventObject & {[key:string]:any}} event BasicEventObjectに加え、自身で付け加えたデータをパラメータとして渡すことができる
 * @typedef {PhinaEventHandler} PhinaEventListener
 */

/**
 * @class phina.util.EventDispatcher
 * 
 * # イベントを扱うためのクラス
 * イベントを扱うためのメソッドやプロパティを定義しているクラスです。
 * phina.js が提供するクラスの多くはこの EventDispatcher クラスのサブクラスとなっているため、
 * ほとんどのクラスで容易にイベントを扱うことができます。
 *
 * 当クラスに`onhoge`のように`on~`という名前でメソッドを定義することで
 * イベントリスナを設定することもできるが、あまり推奨されない。
 * 呼び出される順序は、まずon~関数が呼び出され、その後 `on`メソッド で登録した順番。
 * 
 * @memberof phina
 */
class EventDispatcher {

  constructor() {
    /**
     * @private
     * @type {{[k: string]: PhinaEventHandler[]}}
     */
    this._listeners = {};
  }

  /**
   * イベントリスナを登録します。
   * 登録したイベントリスナは{@link #flare} や {@link #fire}を
   * 介して実行（発火）することができます。
   *
   * １つのイベントに対するイベントリスナはいくつでも登録することができます。
   *
   * いくつかのサブクラスについてはライブラリが特定条件下で発火するイベントがあります。
   * 例えば {@link #Object2D} クラスを継承したクラスではユーザーインタラクションに対して
   * "pointstart"などのイベントが発火されます。
   *
   * @example
   * const myObj = new EventDispatcher();
   * myObj.on("myevent", ()=> {
   *   console.log("Event 1");
   * });
   * myObj.on("myevent", ()=> {
   *   console.log("Event 2");
   * });
   * // イベント発火
   * myObj.flare("myevent"); // "Event 1" "Event 2"
   * 
   * @example
   * // thisはアクティブなSceneクラスのインスタンス
   * const shape = new CircleShape()
   *   .addChildTo(this)
   *   .setInteractive(true) // interactiveプロパティをtrueにする
   *   .setPosition(50, 50);
   * shape.on("pointstart", function(e) {
   *   console.log("Pointed shape");
   * });
   *
   * @chainable
   * 
   * @param {string} type イベントの種類
   * @param {PhinaEventHandler} listener イベントリスナとなる関数
   * @returns {this}
   */
  on(type, listener) {
    if (this._listeners[type] === undefined) {
      this._listeners[type] = [];
    }

    this._listeners[type].push(listener);
    return this;
  }

  /**
   * イベントリスナを削除します。
   * 
   * ある種類のイベントに対するイベントリスナをすべて削除するには {@link #clearEventListener} を使用してください。
   * 
   * @example
   * const myObj = new EventDispatcher();
   * const eventHandler = ()=> {
   *   console.log("Event fired!");
   * })
   * myObj.on("myevent", eventHandler);
   * 
   * // イベント発火
   * myObj.flare("myevent"); // "Event fired!"
   * 
   * // イベント削除
   * myObj.off("myevent", eventHandler);
   * 
   * @chainable
   * 
   * @param {string} type イベントの種類
   * @param {PhinaEventHandler} listener イベントリスナ関数
   * @returns {this}
   */
  off(type, listener) {
    var listeners = this._listeners[type];
    var index = listeners.indexOf(listener);
    if (index != -1) {
      listeners.splice(index,1);
    }
    return this;
  }

  /**
   * イベントパラメータオブジェクトを指定してイベントを発火します。
   * {@link #flare} の内部処理で使用、単独で使用することは稀
   * 
   * @example
   * const myObj = new EventDispatcher();
   * const fireParam = {type: "myevent"}
   * myObj.on("myevent", (e)=> {
   *   console.log(e); // {type: "myevent", target: myObj}
   *   console.log(e === fireParam); // -> true
   * });
   * 
   * myObj.fire(fireParam)
   * 
   * @chainable
   *
   * @param {BasicEventObject} e イベントパラメータオブジェクト
   * @returns {this}
   */
   fire(e) {
    e.target = this;
    var oldEventName = 'on' + e.type;
    if (this[oldEventName]) this[oldEventName](e);

    var listeners = this._listeners[e.type];
    if (listeners) {
      // var temp = listeners.clone();
      var temp = listeners.slice(0);
      for (var i=0,len=temp.length; i<len; ++i) {
          temp[i].call(this, e);
      }
    }

    return this;
  }

  /**
   * イベント名を指定してカスタムイベントを発火します。
   *
   * param 引数を指定することによりカスタムイベントに任意のプロパティを設定することができます。
   * これにより、呼び出し元がイベントリスナに任意の値を渡すことができます。
   * （ただし target プロパティには必ず自分自身が格納されます。）
   *
   * @example
   * const myObj = new EventDispatcher();
   * myObj.on("myevent", (e)=> {
   *   console.log(e); // {type: "myevent", target: myObj, foo: "foo"}
   * });
   * 
   * myObj.flare("myevent", {foo: "foo"});
   * 
   * @chainable
   *
   * @param {string} type カスタムイベントの名前
   * @param {any} [param] カスタムイベントにプロパティを設定するためのオブジェクト
   * @returns {this}
  */
  flare(type, param) {
    var e = {type:type};
    if (param) {
      forIn.call(param, function(key, val) {
      // param.forIn(function(key, val) {
        e[key] = val;
      });
    }
    this.fire(e);

    return this;
  }

  /**
   * 一度だけ実行されるイベントリスナを登録します。
   * 指定したイベントリスナが一度実行されると、そのイベントリスナは削除されます。
   * それ以外の挙動は {@link #on} と同じです。
   * 
   * @example
   * const myObj = new EventDispatcher();
   * myObj.one("fireonce", (e)=> {
   *   console.log("Event fired!");
   * });
   * 
   * myObj.flare("fireonce"); // "Event fired!"
   * myObj.flare("fireonce"); // イベントリスナは削除されているため、何も起きません
   * 
   * @chainable
   *
   * @param {string} type イベントの種類
   * @param {PhinaEventHandler} listener イベントリスナとなる関数
   * @returns {this}
   */
  one(type, listener) {
    var self = this;

    var func = function() {
      var result = listener.apply(self, arguments);
      self.off(type, func);
      return result;
    };

    this.on(type, func);

    return this;
  }

  /**
   * イベントリスナが登録されているかどうかを調べます。
   * 
   * 指定したイベントの種類に対するイベントリスナが登録されている場合は true、
   * そうでない場合は false を返します。
   *
   * @example
   * const myObj = new EventDispatcher();
   * myObj.on("myevent", (e)=> {
   *   console.log("Event fired!");
   * });
   * 
   * myObj.has("myevent"); // true
   * myObj.has("otherevent"); // false
   * 
   * @param {string} type イベントの種類
   * @return {boolean} 指定したイベントのイベントリスナが登録されているかどうか
   */
  has(type) {
    return (this._listeners[type] !== undefined && this._listeners[type].length !== 0) || !!this['on' + type];
  }

  /**
   * ある種類のイベントに対するイベントリスナをすべて削除します。
   *
   * 特定のイベントリスナのみを削除するには {@link #off} を使用してください。
   * 
   * @example
   * const myObj = new EventDispatcher();
   * myObj.on("myevent", (e)=> {
   *   console.log("Event fired!");
   * });
   * 
   * myObj.clearEventListener("myevent");
   * myObj.flare("myevent"); // イベントリスナは削除されているため、何も起きません
   * 
   * @chainable
   * 
   * @param {string} type イベントの種類
   * @returns {this}
   */
  clearEventListener(type) {
    var oldEventName = 'on' + type;
    if (this[oldEventName]) delete this[oldEventName];
    this._listeners[type] = [];
    return this;
  }
}

/**
 * 従来のclearメソッドも追加定義
 * サブクラス（Tweenerクラス等）でclearがオーバーライドされる場合、clearListenersを使用する
 */
$method.call(EventDispatcher.prototype, "clear", function(type) {
  // deprecatedメッセージ表示？
  return this.clearEventListener(type);
});

/**
 * @method addEventListener
 * {@link #on} のエイリアスです。
 */
/**
 * @method removeEventListener
 * {@link #off} のエイリアスです。
 */
/**
 * @method clearEventListener
 * {@link #clear} のエイリアスです。
 */
/**
 * @method hasEventListener
 * {@link #has} のエイリアスです。
 */
/**
 * @method dispatchEvent
 * {@link #fire} のエイリアスです。
 */
/**
 * @method dispatchEventByType
 * {@link #flare} のエイリアスです。
 */
const methodMap = {
  addEventListener: 'on',
  removeEventListener: 'off',
  hasEventListener: 'has',
  dispatchEvent: 'fire',
  dispatchEventByType: 'flare',
};
// methodMap.forIn(function(old, name) {
forIn.call(methodMap, function(old, name) {
  // EventDispatcher.prototype.$method(old, phina.util.EventDispatcher.prototype[name]);
  $method.call(EventDispatcher.prototype, old, EventDispatcher.prototype[name]);
});

/**
 * @class phina.util.Flow
 * tick management class
 * _extends phina.util.EventDispatcher
 */
class Flow extends EventDispatcher {

  /**
   * @constructor
   * @param {{ (resolve: Function, reject: Function): void; }} func
   * @param {boolean} [wait]
   */
  constructor(func, wait) {
    super();

    /** @type {"pending" | "resolved" | "rejected"} */
    this.status = 'pending';

    /** @type {any} */
    this.resultValue = null;

    /** @type {Function[]} */
    this._queue = [];

    this.func = func;

    if (wait !== true) {
      var self = this;
      var resolve = function() {
        self.resolve.apply(self, arguments);
        self.status = 'resolved';
      };
      var reject = function() {
        self.reject.apply(self, arguments);
        self.status = 'rejected';
      };

      this.func(resolve, reject);
    }
  }

  /**
   * @private おそらく
   * 成功
   */
  resolve(arg) {
    this.resultValue = arg;

    // キューに積まれた関数を実行
    this._queue.forEach(function(func) {
      func(this.resultValue);
    }, this);
    // this._queue.clear();
    clear.call(this._queue);
  }

  /**
   * @private おそらく
   * 失敗
   */
  reject() {

  }

  /**
   * 非同期終了時の処理を登録
   * @param {{(result: any): any}} func
   * @returns {Flow}
   */
  then(func) {
    // 成功ステータスだった場合は即実行
    if (this.status === 'resolved') {
      var value = func(this.resultValue);
      return Flow.resolve(value);
    }
    else {
      var flow = new Flow(function(resolve) {
        resolve();
      }, true);

      this._queue.push(function(arg) {
        var resultValue = func(arg);

        if (resultValue instanceof Flow) {
          resultValue.then(function(value) {
            flow.resolve(value);
          });
        }
        else {
          flow.resolve(resultValue);
        }
      });

      return flow;
    }
  }

  /**
   * @param {Flow | any} value
   * @returns {Flow}
   */
  static resolve(value) {
    if (value instanceof Flow) {
      return value;
    }
    else {
      var flow = new Flow(function(resolve) {
        resolve(value);
      });
      return flow;
    }
  }

  /**
   * @param {Flow[]} flows
   * @returns {Flow}
   */
  static all(flows) {
    return new Flow(function(resolve) {
      var count = 0;

      var args = [];

      flows.forEach(function(flow) {
        flow.then(function(d) {
          ++count;
          args.push(d);

          if (count >= flows.length) {
            resolve(args);
          }
        });
      });
    });
  }

}

/**
 * @class phina.util.Ticker
 * tick management class
 * _extends phina.util.EventDispatcher
 */
class Ticker extends EventDispatcher {

  // /** 経過フレーム数 */
  // frame = null

  // /** 1フレームの経過時間 */
  // deltaTime = null
  
  // /** 全体の経過時間 */
  // elapsedTime = null

  /**
   * @constructor
   */
  constructor() {
    super();

    /**
     * @private
     * @type {number}
     */
    this._fps;

    this.fps = 30;
    this.frame = 0;
    this.deltaTime = 0;
    this.elapsedTime = 0;
    this.isPlaying = true;
    this.runner = Ticker.runner;
  }

  /**
   * ティック処理毎に実行されるイベントハンドラを設定
   * @param {import("./eventdispatcher").PhinaEventListener} func 
   */
  tick(func) {
    this.on('tick', func);
  }

  /**
   * イベントハンドラを解除
   * @param {import("./eventdispatcher").PhinaEventListener} func 
   */
  untick(func) {
    this.off('tick', func);
  }

  /**
   * 経過時間を計測・記録しながらティック処理（アプリ更新処理）を行う
   * @returns {number} 次の更新処理までの待ち時間
   */
  run() {
    var now = (new Date()).getTime();
    // 1フレームに掛かった時間
    this.deltaTime = now - this.currentTime;
    // 全体の経過時間
    this.elapsedTime = now - this.startTime;

    var start = this.currentTime = now;
    this.flare('tick');
    var end = (new Date()).getTime();

    // フレームを更新
    this.frame += 1;

    // calculate elapsed time
    var elapsed = end-start;

    // calculate next waiting time
    var delay = Math.max(this.frameTime-elapsed, 0);

    return delay;
  }

  start() {
    var self = this;
    this.isPlaying = true;
    this.startTime = this.currentTime = (new Date()).getTime();
    var fn = function() {
      if (self.isPlaying) {
        var delay = self.run();
        self.runner(fn, delay);
      }
    };
    fn();

    return this;
  }

  resume() {
    // TODO: 
  }

  stop() {
    this.isPlaying = false;
    return this;
  }

  rewind() {
    // TODO: 
  }

  get fps() { return this._fps; }
  set fps(v) {
    this._fps = v;
    this.frameTime = 1000/this._fps;
  }

  /**
   * @param {TimerHandler} run
   * @param {number} delay
   */
  static runner(run, delay) {
    setTimeout(run, delay);
  }
  
}

/**
 * @class phina.util.Random
 * # 乱数を扱うためのクラス
 * 乱数を扱うためのメソッドやプロパティを定義しているクラスです。
 */
class Random {

  /**
   * @constructor
   * コンストラクタです。引数で {@link #seed} を設定できます。
   * 
   * @param {Number} [seed = (Date.now()) || 1] シード
   */
  constructor(seed) {
    /**
     * @private
     * @type {number}
     */
    this._seed;

    /**
     * @property {Number} [seed = 1]
     * 乱数のシードです。
     */
    this.seed = seed || (Date.now()) || 1;
  }

  /**
   * @method random
   * 0~1の乱数を返します。実行すると {@link #seed} は変わってしまいます。
   * 
   * @return {Number} 0~1 の乱数
   */
  random() {
    var seed = this.seed;
    seed = seed ^ (seed << 13);
    seed = seed ^ (seed >>> 17);
    seed = (seed ^ (seed << 5));

    this.seed = seed;

    return (seed >>> 0) / Random.MAX;
  }

  /**
   * @method randint
   * 指定された範囲内でランダムな整数値を返します。実行すると {@link #seed} は変わってしまいます。
   * 
   * @param {Number} min 範囲の最小値
   * @param {Number} max 範囲の最大値
   * @return {Number} ランダムな整数値
   */
  randint(min, max) {
    return Math.floor( this.random()*(max-min+1) ) + min;
  }

  /**
   * @method randfloat
   * 指定された範囲内でランダムな数値を返します。実行すると {@link #seed} は変わってしまいます。
   * 
   * @param {Number} min 範囲の最小値
   * @param {Number} max 範囲の最大値
   * @return {Number} ランダムな数値
   */
  randfloat(min, max) {
    return this.random()*(max-min)+min;
  }

  /**
   * @method randbool
   * ランダムな真偽値を返します。引数で百分率を指定できます。実行すると {@link #seed} は変わってしまいます。
   * 
   * @param {Number} [percent = 50] 真になる百分率
   * @return {Boolean} ランダムな真偽値
   */
  randbool(percent) {
    return this.random() < (percent === undefined ? 50 : percent) / 100;
  }

  /**
   * @method randarray
   * 任意の範囲でランダムな整数値を格納した任意の長さの配列を返します。実行すると {@link #seed} は変わってしまいます。
   * 
   * @param {Number} [len = 100] 配列の長さ
   * @param {Number} [min = 0] 範囲の最小値
   * @param {Number} [max = 100] 範囲の最大値
   * @return {Number} ランダムな整数値の入った配列
   */
  randarray(len, min, max) {
    len = len || 100;
    min = min || 0;
    max = max || 100;

    return map.call(len, function() {
    // return (len).map(function() {
      return this.randint(min, max);
    }, this);
  }

  get seed() { return this._seed; }
  set seed(v) { this._seed = (v >>> 0) || 1; }

  /**
   * @method getSeed 
   * {@link #seed} の値を取得します。
   * 
   * @return {Number} シード
   * @static
   */
  static getSeed() {
    return this.seed;
  }

  /**
   * @method setSeed
   * {@link #seed} の値をセットします。
   * 
   * @param {Number} [seed = 1] シード
   * @static
   * @chainable
   */
  static setSeed(seed) {
    this.seed = (seed >>> 0) || 1;
    return this;
  }

  /**
   * @method random
   * 0~1の乱数を返します。実行すると {@link #seed} は変わってしまいます。
   * インスタンスメソッドの {@link #random} と同じです。
   * 
   * @return {Number} 0~1 の乱数
   * @static
   */
  static random() {
    this.seed = this.xor32(this.seed);
    return (this.seed >>> 0) / this.MAX;
  }

  /**
   * @method randint
   * 指定された範囲内でランダムな整数値を返します。実行すると {@link #seed} は変わってしまいます。
   * インスタンスメソッドの {@link #randint} と同じです。
   * 
   * @param {Number} min 範囲の最小値
   * @param {Number} max 範囲の最大値
   * @return {Number} ランダムな整数値
   * @static
   */
  static randint(min, max) {
    return phina.global.Math.floor( this.random()*(max-min+1) ) + min;
  }

  /**
   * @method randfloat
   * 指定された範囲内でランダムな数値を返します。実行すると {@link #seed} は変わってしまいます。
   * インスタンスメソッドの {@link #randfloat} と同じです。
   * 
   * @param {Number} min 範囲の最小値
   * @param {Number} max 範囲の最大値
   * @return {Number} ランダムな数値
   * @static
   */
  static randfloat(min, max) {
    return this.random()*(max-min)+min;
  }

  /**
   * @method randbool
   * ランダムな真偽値を返します。引数で百分率を指定できます。実行すると {@link #seed} は変わってしまいます。
   * インスタンスメソッドの {@link #randbool} と同じです。
   * 
   * @param {Number} [percent = 50] 真になる百分率
   * @return {Boolean} ランダムな真偽値
   * @static
   */
  static randbool(percent) {
    return this.randint(0, 99) < (percent || 50);
  }

  /**
   * @method randarray
   * 任意の範囲でランダムな整数値を格納した任意の長さの配列を返します。実行すると {@link #seed} は変わってしまいます。
   * インスタンスメソッドの {@link #randarray} と同じです。
   * 
   * @param {Number} [len = 100] 配列の長さ
   * @param {Number} [min = 0] 範囲の最小値
   * @param {Number} [max = 100] 範囲の最大値
   * @return {Number} ランダムな整数値の入った配列
   * @static
   */
  static randarray(len, min, max) {
    len = len || 100;
    min = min || 0;
    max = max || 100;

    return map.call(len, function() {
    // return (len).map(function() {
      return this.randint(min, max);
    }, this);
  }


  /**
   * @method xor32
   * xorshift を用いて疑似乱数列を生成します。
   * 
   * @param {Number} seed
   * @return {Number} 疑似乱数列
   * @static
   */
  static xor32(seed) {
    seed = seed ^ (seed << 13);
    seed = seed ^ (seed >>> 17);
    seed = (seed ^ (seed << 5));

    return seed;
  }

  /**
   * @method uuid
   * uuid を生成して返します。
   * 
   * @return {String} uuid
   * @static
   */
  //http://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript
  static uuid() {
    var d = new Date().getTime();
    if(phina.global.performance && typeof phina.global.performance.now === 'function'){
      d += performance.now(); //use high-precision timer if available
    }
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      var r = (d + Math.random()*16)%16 | 0;
      d = Math.floor(d/16);
      return (c=='x' ? r : (r&0x3|0x8)).toString(16);
    });
    return uuid;
  }

}

/**
 * @property {Number} MAX
 * 内部的に使用される定数です。
 * 
 * @static
 */
Random.MAX = 4294967295;

/**
 * @property {Number} [seed = (Date.now())] シード
 * static メソッドの乱数のシードです。
 * 
 * @static
 */
Random.seed = (Date.now());


// prototype拡張はしない
// Math.$method("randint", function(min, max) {
//   return phina.util.Random.randint(min, max);
// });

// Math.$method("randfloat", function(min, max) {
//   return phina.util.Random.randfloat(min, max);
// });

/**
 * @class phina.util.Support
 * 
 */
class Support {}Support.canvas = !!phina.global.CanvasRenderingContext2D;
Support.webGL = (function() {
  return !!phina.global.CanvasRenderingContext2D && !!document.createElement('canvas').getContext('webgl');
})();
Support.webAudio = !!phina.global.AudioContext || !!phina.global['webkitAudioContext'] || !!phina.global['mozAudioContext'];

/**
 * @typedef {{
 *  width?: number;
 *  columns?: number;
 *  loop?: boolean;
 *  offset?: number;
 * }} GridOptions
 */

/**
 * @class phina.util.Grid
 */
class Grid {

  /**
   * @constructor
   * @param {GridOptions | number} _optionsOrWidth
   * @param {number} [_col]
   * @param {boolean} [_loop]
   * @param {number} [_offset]
   */
  constructor(_optionsOrWidth, _col, _loop, _offset) {
    var width, columns, loop, offset;
    if (typeof arguments[0] === 'object') {
      /** @type {GridOptions} */
      var param = arguments[0];
      width = param.width || 640;
      columns = param.columns || 12;
      loop = param.loop || false;
      offset = param.offset || 0;
    }
    else {
      width   = arguments[0] || 640;
      columns = arguments[1] || 12;
      loop    = arguments[2] || false;
      offset = arguments[3] || 0;
    }

    /** @type {number} 幅 */
    this.width = width;

    /** @type {number} 列数 */
    this.columns = columns;

    /** @type {boolean} span指定時にループするかどうか */
    this.loop = loop;

    /** @type {number} オフセット値 */
    this.offset = offset;

    /** @type {number} グリッド単位値 */
    this.unitWidth = this.width/this.columns;
  }

  /**
   * スパン指定で値を取得(負数もok)
   * @param {number} index
   * @returns {number}
   */
  span(index) {
    if (this.loop) {
      index += this.columns;
      index %= this.columns;
    }
    return this.unitWidth * index + this.offset;
  }

  /**
   * グリッド単位を返す
   * @returns {number}
   */
  unit() {
    return this.unitWidth;
  }

  /**
   * @param {number} [offset] 中心からのずれを単位数で指定
   * @returns {number}
   */
  center(offset) {
    var index = offset || 0;
    return (this.width/2) + (this.unitWidth * index);
  }

}

/**
 * @typedef {keyof Tween.EASING} TweenEasingType イージングの種類を表す文字列
 */

/**
 * @class phina.util.Tween
 * _extends phina.util.EventDispatcher
 * 
 */
class Tween extends EventDispatcher {

  /**
   * @constructor
   */
  constructor() {
    super();

    /**
     * @type {number}
     * tween経過時間
     */
    this.time = 0;

    /**
     * @private
     * @type {function|string}
     * 内部イージング関数
     * easingアクセサを介して使用  
     * setterがstring型を受け付けるのに対し、
     * getterはfunction型を返すため、とりあえず共用体とする
     */
    this._easing;
  }

  /**
   * @param {any} target
   * @param {{ [k: string]: any; }} beginProps
   * @param {{ [k: string]: any; }} finishProps
   * @param {number} duration
   * @param {TweenEasingType} easing
   * @returns {this}
   */
  fromTo(target, beginProps, finishProps, duration, easing) {
    this.target = target;
    this.beginProps = beginProps;
    this.finishProps = finishProps;
    this.duration = duration || 1000;
    this.easing = easing;

    // setup
    this.changeProps = {};
    for (var key in beginProps) {
        this.changeProps[key] = finishProps[key] - beginProps[key];
    }

    return this;
  }

  /**
   * @param {any} target
   * @param {{ [k: string]: any; }} finishProps
   * @param {number} duration
   * @param {TweenEasingType} easing
   * @returns {this}
   */
  to(target, finishProps, duration, easing) {
    var beginProps = {};

    for (var key in finishProps) {
      beginProps[key] = target[key];
    }

    this.fromTo(target, beginProps, finishProps, duration, easing);

    return this;
  }

  /**
   * @param {any} target
   * @param {{ [k: string]: any; }} beginProps
   * @param {number} duration
   * @param {TweenEasingType} easing
   * @returns {this}
   */
  from(target, beginProps, duration, easing) {
      var finishProps = {};

      for (var key in beginProps) {
        finishProps[key] = target[key];
        target[key] = beginProps[key];
      }

      this.fromTo(target, beginProps, finishProps, duration, easing);

      return this;
  }

  /**
   * @param {any} target
   * @param {{ [k: string]: any; }} props
   * @param {number} duration
   * @param {TweenEasingType} easing
   * @returns {this}
   */
  by(target, props, duration, easing) {
    var beginProps = {};
    var finishProps = {};

    for (var key in props) {
      beginProps[key] = target[key];
      finishProps[key] = target[key] + props[key];
    }

    this.fromTo(target, beginProps, finishProps, duration, easing);

    return this;
  }

  /**
   * TODO
   */
  yoyo() {
    var temp = this.beginProps;
    this.beginProps = this.finishProps;
    this.finishProps = temp;
    // this.changeProps.forIn(function(key, value, index) {
    forIn.call(this.changeProps, function(key, value, _index) {
      this.changeProps[key] = -value;
      this.target[key] = this.beginProps[key];
    }, this);
    // TODO: easing も反転させる
    // this.easing = easing;
    return this;
  }

  /**
   * 指定値分、時間を進める
   * @alias forward
   * @param {number} time
   */
  gain(time) {
    this.seek(this.time + time);
  }

  /**
   * 指定値分、時間を進める
   * @alias gain
   * @param {number} time
   */
  forward(time) {
    this.seek(this.time + time);
  }

  /**
   * 指定値分、時間を戻す
   * @param {number} time
   */
  backward(time) {
    this.seek(this.time - time);
  }

  /**
   * 時間に応じてパラメータを更新
   * @param {number} time
   * @returns {this}
   */
  seek(time) {
    // this.time = Math.clamp(time, 0, this.duration);
    this.time = clamp(time, 0, this.duration);

    // this.beginProps.forIn(
    forIn.call(this.beginProps, 
    /** @this Tween */
    function(key, value) {
      var v = /** @type function */(this.easing)(this.time, value, this.changeProps[key], this.duration);
      this.target[key] = v;
    }, this);

    return this;
  }

  get easing() { return this._easing; }
  set easing(v) {
    this._easing = Tween.EASING[/**@type {string}*/(v)] || Tween.EASING.default;
  }

}

/**
 * @static
 * イージング
 * ### Reference
 * - <http://coderepos.org/share/wiki/JSTweener>
 * - <http://coderepos.org/share/browser/lang/javascript/jstweener/trunk/src/JSTweener.js>
 * - <http://gsgd.co.uk/sandbox/jquery/easing/jquery.easing.1.3.js>
 * - <http://hosted.zeh.com.br/tweener/docs/en-us/misc/transitions.html>
 */
Tween.EASING = {

  /** default */
  "default": function(t, b, c, d) {
    return c*t/d + b;
  },
  /** linear */
  linear: function(t, b, c, d) {
    return c*t/d + b;
  },
  /** swing */
  swing: function(t, b, c, d) {
    return -c *(t/=d)*(t-2) + b;
  },
  /** easeInQuad */
  easeInQuad: function(t, b, c, d) {
    return c*(t/=d)*t + b;
  },
  /** easeOutQuad */
  easeOutQuad: function(t, b, c, d) {
    return -c *(t/=d)*(t-2) + b;
  },
  /** easeInOutQuad */
  easeInOutQuad: function(t, b, c, d) {
    if((t/=d/2) < 1) return c/2*t*t + b;
    return -c/2 *((--t)*(t-2) - 1) + b;
  },
  /** defeInCubic */
  easeInCubic: function(t, b, c, d) {
    return c*(t/=d)*t*t + b;
  },
  /** easeOutCubic */
  easeOutCubic: function(t, b, c, d) {
    return c*((t=t/d-1)*t*t + 1) + b;
  },
  /** easeInOutCubic */
  easeInOutCubic: function(t, b, c, d) {
    if((t/=d/2) < 1) return c/2*t*t*t + b;
    return c/2*((t-=2)*t*t + 2) + b;
  },
  /** easeOutInCubic */
  easeOutInCubic: function(t, b, c, d) {
    if(t < d/2) return Tween.EASING.easeOutCubic(t*2, b, c/2, d);
    return Tween.EASING.easeInCubic((t*2)-d, b+c/2, c/2, d);
  },
  /** easeInQuart */
  easeInQuart: function(t, b, c, d) {
    return c*(t/=d)*t*t*t + b;
  },
  /** easeOutQuart */
  easeOutQuart: function(t, b, c, d) {
    return -c *((t=t/d-1)*t*t*t - 1) + b;
  },
  /** easeInOutQuart */
  easeInOutQuart: function(t, b, c, d) {
    if((t/=d/2) < 1) return c/2*t*t*t*t + b;
    return -c/2 *((t-=2)*t*t*t - 2) + b;
  },
  /** easeOutInQuart */
  easeOutInQuart: function(t, b, c, d) {
    if(t < d/2) return Tween.EASING.easeOutQuart(t*2, b, c/2, d);
    return Tween.EASING.easeInQuart((t*2)-d, b+c/2, c/2, d);
  },
  /** easeInQuint */
  easeInQuint: function(t, b, c, d) {
    return c*(t/=d)*t*t*t*t + b;
  },
  /** easeOutQuint */
  easeOutQuint: function(t, b, c, d) {
    return c*((t=t/d-1)*t*t*t*t + 1) + b;
  },
  /** easeInOutQuint */
  easeInOutQuint: function(t, b, c, d) {
    if((t/=d/2) < 1) return c/2*t*t*t*t*t + b;
    return c/2*((t-=2)*t*t*t*t + 2) + b;
  },
  /** easeOutInQuint */
  easeOutInQuint: function(t, b, c, d) {
    if(t < d/2) return Tween.EASING.easeOutQuint(t*2, b, c/2, d);
    return Tween.EASING.easeInQuint((t*2)-d, b+c/2, c/2, d);
  },
  /** easeInSine */
  easeInSine: function(t, b, c, d) {
    return -c * Math.cos(t/d *(Math.PI/2)) + c + b;
  },
  /** easeOutSine */
  easeOutSine: function(t, b, c, d) {
    return c * Math.sin(t/d *(Math.PI/2)) + b;
  },
  /** easeInOutSine */
  easeInOutSine: function(t, b, c, d) {
    return -c/2 *(Math.cos(Math.PI*t/d) - 1) + b;
  },
  /** easeOutInSine */
  easeOutInSine: function(t, b, c, d) {
    if(t < d/2) return Tween.EASING.easeOutSine(t*2, b, c/2, d);
    return Tween.EASING.easeInSine((t*2)-d, b+c/2, c/2, d);
  },
  /** easeInExpo */
  easeInExpo: function(t, b, c, d) {
    return (t==0) ? b : c * Math.pow(2, 10 *(t/d - 1)) + b - c * 0.001;
  },
  /** easeOutExpo */
  easeOutExpo: function(t, b, c, d) {
    return (t==d) ? b+c : c * 1.001 *(-Math.pow(2, -10 * t/d) + 1) + b;
  },
  /** easeInOutExpo */
  easeInOutExpo: function(t, b, c, d) {
    if(t==0) return b;
    if(t==d) return b+c;
    if((t/=d/2) < 1) return c/2 * Math.pow(2, 10 *(t - 1)) + b - c * 0.0005;
    return c/2 * 1.0005 *(-Math.pow(2, -10 * --t) + 2) + b;
  },
  /** easeOutInExpo */
  easeOutInExpo: function(t, b, c, d) {
    if(t < d/2) return Tween.EASING.easeOutExpo(t*2, b, c/2, d);
    return Tween.EASING.easeInExpo((t*2)-d, b+c/2, c/2, d);
  },
  /** easeInCirc */
  easeInCirc: function(t, b, c, d) {
    return -c *(Math.sqrt(1 -(t/=d)*t) - 1) + b;
  },
  /** easeOutCirc */
  easeOutCirc: function(t, b, c, d) {
    return c * Math.sqrt(1 -(t=t/d-1)*t) + b;
  },
  /** easeInOutCirc */
  easeInOutCirc: function(t, b, c, d) {
    if((t/=d/2) < 1) return -c/2 *(Math.sqrt(1 - t*t) - 1) + b;
    return c/2 *(Math.sqrt(1 -(t-=2)*t) + 1) + b;
  },
  /** easeOutInCirc */
  easeOutInCirc: function(t, b, c, d) {
    if(t < d/2) return Tween.EASING.easeOutCirc(t*2, b, c/2, d);
    return Tween.EASING.easeInCirc((t*2)-d, b+c/2, c/2, d);
  },
  /** easeInElastic */
  easeInElastic: function(t, b, c, d, a, p) {
    var s;
    if(t==0) return b;  if((t/=d)==1) return b+c;  if(!p) p=d*.3;
    if(!a || a < Math.abs(c)) { a=c; s=p/4; } else s = p/(2*Math.PI) * Math.asin(c/a);
    return -(a*Math.pow(2,10*(t-=1)) * Math.sin((t*d-s)*(2*Math.PI)/p )) + b;
  },
  /** easeOutElastic */
  easeOutElastic: function(t, b, c, d, a, p) {
    var s;
    if(t==0) return b;  if((t/=d)==1) return b+c;  if(!p) p=d*.3;
    if(!a || a < Math.abs(c)) { a=c; s=p/4; } else s = p/(2*Math.PI) * Math.asin(c/a);
    return(a*Math.pow(2,-10*t) * Math.sin((t*d-s)*(2*Math.PI)/p ) + c + b);
  },
  /** easeInOutElastic */
  easeInOutElastic: function(t, b, c, d, a, p) {
    var s;
    if(t==0) return b;  if((t/=d/2)==2) return b+c;  if(!p) p=d*(.3*1.5);
    if(!a || a < Math.abs(c)) { a=c; s=p/4; }       else s = p/(2*Math.PI) * Math.asin(c/a);
    if(t < 1) return -.5*(a*Math.pow(2,10*(t-=1)) * Math.sin((t*d-s)*(2*Math.PI)/p )) + b;
    return a*Math.pow(2,-10*(t-=1)) * Math.sin((t*d-s)*(2*Math.PI)/p )*.5 + c + b;
  },
  /** easeOutInElastic */
  easeOutInElastic: function(t, b, c, d, a, p) {
    if(t < d/2) return Tween.EASING.easeOutElastic(t*2, b, c/2, d, a, p);
    return Tween.EASING.easeInElastic((t*2)-d, b+c/2, c/2, d, a, p);
  },
  /** easeInBack */
  easeInBack: function(t, b, c, d, s) {
    if(s == undefined) s = 1.70158;
    return c*(t/=d)*t*((s+1)*t - s) + b;
  },
  /** easeOutBack */
  easeOutBack: function(t, b, c, d, s) {
    if(s == undefined) s = 1.70158;
    return c*((t=t/d-1)*t*((s+1)*t + s) + 1) + b;
  },
  /** easeInOutBack */
  easeInOutBack: function(t, b, c, d, s) {
    if(s == undefined) s = 1.70158;
    if((t/=d/2) < 1) return c/2*(t*t*(((s*=(1.525))+1)*t - s)) + b;
    return c/2*((t-=2)*t*(((s*=(1.525))+1)*t + s) + 2) + b;
  },
  /** easeOutInBack */
  easeOutInBack: function(t, b, c, d, s) {
    if(t < d/2) return Tween.EASING.easeOutBack(t*2, b, c/2, d, s);
    return Tween.EASING.easeInBack((t*2)-d, b+c/2, c/2, d, s);
  },
  /** easeInBounce */
  easeInBounce: function(t, b, c, d) {
    return c - Tween.EASING.easeOutBounce(d-t, 0, c, d) + b;
  },
  /** easeOutBounce */
  easeOutBounce: function(t, b, c, d) {
    if((t/=d) <(1/2.75)) {
      return c*(7.5625*t*t) + b;
    } else if(t <(2/2.75)) {
      return c*(7.5625*(t-=(1.5/2.75))*t + .75) + b;
    } else if(t <(2.5/2.75)) {
      return c*(7.5625*(t-=(2.25/2.75))*t + .9375) + b;
    } else {
      return c*(7.5625*(t-=(2.625/2.75))*t + .984375) + b;
    }
  },
  /** easeInOutBounce */
  easeInOutBounce: function(t, b, c, d) {
    if(t < d/2) return Tween.EASING.easeInBounce(t*2, 0, c, d) * .5 + b;
    else return Tween.EASING.easeOutBounce(t*2-d, 0, c, d) * .5 + c*.5 + b;
  },
  /** easeOutInBounce */
  easeOutInBounce: function(t, b, c, d) {
    if(t < d/2) return Tween.EASING.easeOutBounce(t*2, b, c/2, d);
    return Tween.EASING.easeInBounce((t*2)-d, b+c/2, c/2, d);
  }

};

/**
 * @class phina.util.QueryString
 * 
 */
class QueryString {

  /**
   * @param {string} [text] 無指定のときは現在ページのURLを対象とする
   * @param {string} [sep="&"] セパレータ
   * @param {string} [eq="="] 
   * @param {boolean} [isDecode] decodeURIComponentによるデコードを行うかどうか
   * @returns {Object}
   */
  static parse(text, sep, eq, isDecode) {
    text = text || location.search.substr(1);
    sep = sep || '&';
    eq = eq || '=';
    var decode = (isDecode) ? decodeURIComponent : function(a) { return a; };
    return text.split(sep).reduce(function(obj, v) {
      var pair = v.split(eq);
      obj[pair[0]] = decode(pair[1]);
      return obj;
    }, {});
  }

  /**
   * @param {Object} value
   * @param {string} [sep="&"]
   * @param {string} [eq="="]
   * @param {boolean} [isEncode] encodeURIComponentによるエンコードを行うかどうか
   * @returns {string}
   */
  static stringify(value, sep, eq, isEncode) {
    sep = sep || '&';
    eq = eq || '=';
    var encode = (isEncode) ? encodeURIComponent : function(a) { return a; };
    return Object.keys(value).map(function(key) {
      return key + eq + encode(value[key]);
    }).join(sep);
  }
  
}

/**
 * @class phina.util.Color
 * カラークラス
 */
class Color {

  /**
   * @param {number} _r
   * @param {number} _g
   * @param {number} _b
   * @param {number} _a
   */
  constructor(_r, _g, _b, _a) {
    /** @type {number} R値 */
    this.r = 255;

    /** @type {number} G値 */
    this.g = 255;

    /** @type {number} B値 */
    this.b = 255;

    /** @type {number} A値 */
    this.a = 1.0;

    this.set.apply(this, arguments);
  }

  /**
   * セッター.
   * @param {number} r
   * @param {number} g
   * @param {number} b
   * @param {number} a
   * @returns {this}
   */
  set(r, g, b, a) {
    this.r = r;
    this.g = g;
    this.b = b;
    this.a = (a !== undefined) ? a : 1.0;
    return this;
  }

  /**
   * 数値によるセッター.
   * @param {number} r
   * @param {number} g
   * @param {number} b
   * @param {number} a
   * @returns {this}
   */
  setFromNumber(r, g, b, a) {
    this.r = r;
    this.g = g;
    this.b = b;
    this.a = (a !== undefined) ? a : 1.0;
    return this;
  }

  /**
   * 配列によるセッター
   * @param {number[]} arr
   * @returns {this}
   */
  setFromArray(arr) {
    return this.set.apply(this, arr);
  }

  /**
   * オブジェクトによるセッター
   * @param {{ r: number; g: number; b: number; a: number; }} obj
   * @returns {this}
   */
  setFromObject(obj) {
    return this.set(obj.r, obj.g, obj.b, obj.a);
  }

  /**
   * 文字列によるセッター
   * @param {string} str
   * @returns {this}
   */
  setFromString(str) {
    var color = Color.stringToNumber(str);
    return this.set(color[0], color[1], color[2], color[3]);
  }

  /**
   * 賢いセッター
   * @returns {this}
   */
  setSmart() {
    var arg = arguments[0];
    if (arguments.length >= 3) {
      this.set(arguments[0], arguments[1], arguments[2], arguments[3]);
    } else if (arg instanceof Array) {
      this.setFromArray(arg);
    } else if (arg instanceof Object) {
      this.setFromObject(arg);
    } else if (typeof(arg) == "string") {
      this.setFromString(arg);
    }
    return this;
  }

  /**
   * CSS 用 16進数文字列に変換
   * @returns {string}
   */
  toStyleAsHex() {
    return format.call("#{0}{1}{2}",
    // return "#{0}{1}{2}".format(
      padding.call(this.r.toString(16), 2, '0'),
      padding.call(this.g.toString(16), 2, '0'),
      padding.call(this.b.toString(16), 2, '0')
      // this.r.toString(16).padding(2, '0'),
      // this.g.toString(16).padding(2, '0'),
      // this.b.toString(16).padding(2, '0')
    );
  }

  /**
   * CSS 用 RGB文字列に変換
   * @returns {string}
   */
  toStyleAsRGB() {
    return format.call("rgb({r},{g},{b})", {
    // return "rgb({r},{g},{b})".format({
      r: ~~this.r,
      g: ~~this.g,
      b: ~~this.b
    });
  }


  /**
   * CSS 用 RGBA文字列に変換
   * @returns {string}
   */
  toStyleAsRGBA() {
    return format.call("rgba({r},{g},{b},{a})", {
    // return "rgba({r},{g},{b},{a})".format({
      r: ~~this.r,
      g: ~~this.g,
      b: ~~this.b,
      a: this.a
    });
  }

  /**
   * CSS 用 RGBA 文字列に変換
   * @returns {string}
   */
  toStyle() {
    return format.call("rgba({r},{g},{b},{a})", {
    // return "rgba({r},{g},{b},{a})".format({
      r: ~~this.r,
      g: ~~this.g,
      b: ~~this.b,
      a: this.a
    });
  }

  /**
   * @static
   * @member phina.util.Color
   * @method strToNum
   * @param {string} str
   * @returns {number[]}
   */
  static strToNum(str) {
    return this.stringToNumber(str);
  }

  /**
   * @param {string} str
   * @returns {number[]}
   */
  static stringToNumber(str) {
    var value = null;
    var type = null;

    if (str[0] === '#') {
      type = (str.length == 4) ? "hex111" : "hex222";
    } else if (str[0] === 'r' && str[1] === 'g' && str[2] === 'b') {
      type = (str[3] == 'a') ? "rgba" : "rgb";
    } else if (str[0] === 'h' && str[1] === 's' && str[2] === 'l') {
      type = (str[3] == 'a') ? "hsla" : "hsl";
    }

    if (type) {
      var match_set = MATCH_SET_LIST[type];
      var m = str.match(match_set.reg);
      value = match_set.exec(m);
    } else if (Color.COLOR_LIST[str]) {
      value = Color.COLOR_LIST[str];
    }

    return value;
  }

  /**
   * @static
   * @method
   * hsl を rgb に変換
   * 
   * @param {number} h
   * @param {number} s
   * @param {number} l
   * @returns {number[]} rgb数値配列
   */
  static HSLtoRGB(h, s, l) {
    var r, g, b;

    h %= 360;
    h += 360;
    h %= 360;
    s *= 0.01;
    l *= 0.01;

    if (s === 0) {
      l = Math.round(l * 255);
      return [l, l, l];
    }
    var m2 = (l < 0.5) ? l * (1 + s) : l + s - l * s;
    var m1 = l * 2 - m2;

    // red
    var temp = (h + 120) % 360;
    if (temp < 60) {
      r = m1 + (m2 - m1) * temp / 60;
    } else if (temp < 180) {
      r = m2;
    } else {
      r = m1;
    }

    // green
    temp = h;
    if (temp < 60) {
      g = m1 + (m2 - m1) * temp / 60;
    } else if (temp < 180) {
      g = m2;
    } else if (temp < 240) {
      g = m1 + (m2 - m1) * (240 - temp) / 60;
    } else {
      g = m1;
    }

    // blue
    temp = ((h - 120) + 360) % 360;
    if (temp < 60) {
      b = m1 + (m2 - m1) * temp / 60;
    } else if (temp < 180) {
      b = m2;
    } else if (temp < 240) {
      b = m1 + (m2 - m1) * (240 - temp) / 60;
    } else {
      b = m1;
    }

    return [
      Math.floor(r * 255),
      Math.floor(g * 255),
      Math.floor(b * 255)
    ];
  }

  /**
   * @static
   * @method
   * hsla を rgba に変換
   * 
   * @param {number} h
   * @param {number} s
   * @param {number} l
   * @param {number} a
   * @returns {number[]} rgba数値配列
   */
  static HSLAtoRGBA(h, s, l, a) {
    var temp = Color.HSLtoRGB(h, s, l);
    temp[3] = a;
    return temp;
  }

  /**
   * @static
   * @method
   * rgb 値からCSS colorデータ型準拠の文字列を生成
   * 
   * @param {number} r
   * @param {number} g
   * @param {number} b
   * @returns {string}
   */
  static createStyleRGB(r, g, b) {
    return "rgba(" + r + "," + g + "," + b + ")";
  }

  /**
   * @static
   * @method
   * rgba 値からCSS colorデータ型準拠の文字列を生成
   * 
   * @param {number} r
   * @param {number} g
   * @param {number} b
   * @param {number} a
   * @returns {string}
   */
  static createStyleRGBA(r, g, b, a) {
    return "rgba(" + r + "," + g + "," + b + "," + a + ")";
  }

  /**
   * @static
   * @method
   * hsl 値からCSS colorデータ型準拠の文字列を生成
   * 
   * @param {number} h
   * @param {number} s
   * @param {number} l
   * @returns {string}
   */
  static createStyleHSL(h, s, l) {
    return "hsl(" + h + "," + s + "%," + l + "%)";
  }

  /**
   * @static
   * @method
   * hsla 値からCSS colorデータ型準拠の文字列を生成
   * 
   * @param {number} h
   * @param {number} s
   * @param {number} l
   * @param {number} a
   * @returns {string}
   */
  static createStyleHSLA(h, s, l, a) {
    return "hsla(" + h + "," + s + "%," + l + "%," + a + ")";
  }

}

/**
 * @static
 * @enum {number[]}
 * カラーリスト
 */
Color.COLOR_LIST = {
  /** @property black */
  "black": [0x00, 0x00, 0x00],
  /** @property silver */
  "silver": [0xc0, 0xc0, 0xc0],
  /** @property gray */
  "gray": [0x80, 0x80, 0x80],
  /** @property white */
  "white": [0xff, 0xff, 0xff],
  /** @property maroon */
  "maroon": [0x80, 0x00, 0x00],
  /** @property red */
  "red": [0xff, 0x00, 0x00],
  /** @property purple */
  "purple": [0x80, 0x00, 0x80],
  /** @property fuchsia */
  "fuchsia": [0xff, 0x00, 0xff],
  /** @property green */
  "green": [0x00, 0x80, 0x00],
  /** @property lime */
  "lime": [0x00, 0xff, 0x00],
  /** @property olive */
  "olive": [0x80, 0x80, 0x00],
  /** @property yellow */
  "yellow": [0xff, 0xff, 0x00],
  /** @property navy */
  "navy": [0x00, 0x00, 0x80],
  /** @property blue */
  "blue": [0x00, 0x00, 0xff],
  /** @property teal */
  "teal": [0x00, 0x80, 0x80],
  /** @property aqua */
  "aqua": [0x00, 0xff, 0xff],
};

/**
 * 色文字列をnumber型配列に変換するための正規表現と関数のセット
 * @enum {{reg: RegExp, exec: (m:number[])=> number[]}}
 */
var MATCH_SET_LIST = {
  "hex111": {
    reg: /^#(\w{1})(\w{1})(\w{1})$/,
    exec: function(m) {
      return [
        parseInt(m[1] + m[1], 16),
        parseInt(m[2] + m[2], 16),
        parseInt(m[3] + m[3], 16)
      ];
    }
  },
  "hex222": {
    reg: /^#(\w{2})(\w{2})(\w{2})$/,
    exec: function(m) {
      return [
        parseInt(m[1], 16),
        parseInt(m[2], 16),
        parseInt(m[3], 16)
      ];
    }
  },
  "rgb": {
    reg: /^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,
    exec: function(m) {
      return [
        parseInt(m[1]),
        parseInt(m[2]),
        parseInt(m[3])
      ];
    }
  },
  "rgba": {
    reg: /^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1}(\.{1}\d+)?)\)$/,
    exec: function(m) {
      return [
        parseInt(m[1]),
        parseInt(m[2]),
        parseInt(m[3]),
        parseFloat(m[4])
      ];
    }
  },
  "hsl": {
    reg: /^hsl\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%\)$/,
    exec: function(m) {
      return Color.HSLtoRGB(m[1], m[2], m[3]);
    }
  },
  "hsla": {
    reg: /^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1}(\.{1}\d+)?)\)$/,
    exec: function(m) {
      return Color.HSLAtoRGBA(m[1], m[2], m[3], m[4]);
    }
  }
};

// 監視オブジェクト
// register で key を登録 (デフォルト値も一緒に？)
// event dispatcher を継承
// event dispatcher って util じゃね？
// register で登録した値を変更したら change イベントが走る


// 名前候補
//  middleman(仲立人)


/**
 * @class phina.util.ChangeDispatcher
 * _extends phina.util.EventDispatcher
 */
class ChangeDispatcher extends EventDispatcher {

  constructor() {
    super();

    this._observe = true;
  }

  /**
   * @param {string} key
   * @param {any} defaultValue
   */
  register(key, defaultValue) {
    if (arguments.length === 1) {
      var obj = arguments[0];
      forIn.call(obj, function(key, value) {
      // obj.forIn(function(key, value) {
        this.register(key, value);
      }, this);
    }
    else {
      var tempKey = '__' + key;
      this[tempKey] = defaultValue;
      accessor.call(this, key, {
      // this.accessor(key, {
        get: function() {
          return this[tempKey];
        },
        set: function(v) {
          this[tempKey] = v;
          if (this._observe) {
            this.flare('change');
          }
        },
      });
    }
    return this;
  }

  observe() {
    this._observe = true;
  }
  unobserve() {
    this._observe = false;
  }
}

/**
 * @typedef {Object} AjaxRequestOptions Ajaxクラス初期化オプション
 * @property {'GET'|'POST'|'PUT'|'DELETE'} type 
 * @property {string} url 
 * @property {string} [contentType] 
 * @property {string} [responseType] 
 * @property {any} [data] 未使用？
 */

 /**
 * @class phina.util.Ajax
 * 
 */
class Ajax {

  /**
   * @param {AjaxRequestOptions} options
   */
  static request(options) {
    var data = $safe.call({}, options, Ajax.defaults);
    // var data = ({}).$safe(options, this.defaults);

    var xhr = new XMLHttpRequest();
    var flow = new Flow(function(resolve) {
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
          if ([200, 201, 0].indexOf(xhr.status) !== -1) {
            resolve(xhr.response);
          }
        }
      };

      xhr.open(data.type, data.url);
      xhr.responseType = data.responseType;
      xhr.send(null);
    });

    return flow;
  }
  static get(url) {
    return Ajax.request({
      type: 'GET',
      url: url,
    });
  }
  static post(url) {
    return Ajax.request({
      type: 'POST',
      url: url,
    });
  }
  static put(url) {
    return Ajax.request({
      type: 'PUT',
      url: url,
    });
  }
  static del(url) {
    return Ajax.request({
      type: 'DELETE',
      url: url,
    });
  }

}

/** 
 * @static
 * @type {AjaxRequestOptions}
 */
Ajax.defaults = {
  type: 'GET',
  contentType: 'application/x-www-form-urlencoded',
  responseType: 'json',
  data: null,
  url: '',
};

/**
 * @typedef {Object} PrimitiveVector2 x,yプロパティのみの原始的なVector2
 * @property {number} x
 * @property {number} y
 */

/**
 * @class phina.geom.Vector2
 * @extends PrimitiveVector2
 * # 2次元ベクトルクラス
 * 2次元のベクトルや座標を表すクラスです。
 * 
 * @example
 * v = phina.geom.Vector2(3, 4);
 *
 */
class Vector2 {

  /**
   * @param {Number} [x=0] ベクトルの x 座標
   * @param {Number} [y=0] ベクトルの y 座標
   */
  constructor(x=0, y=0) {

    /**
     * x座標
     * @type {Number}
     */
    this.x = x;

    /**
     * y座標
     * @type {Number}
     */
    this.y = y;
  }

  /**
   * @method clone
   * this のコピーを生成して返します。
   *
   * @example
   * v = phina.geom.Vector2(3, 4);
   * v2 = v.clone();
   * v2.x == v.x; // => true
   *
   * @returns {Vector2} 生成したベクトル
   */
  clone() {
    return new Vector2(this.x, this.y);
  }

  /**
   * @method equals
   * this の各要素がすべて other と等しいかどうかを返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v2 = phina.geom.Vector2(5, 6);
   * v1.equals(v2); // => false
   *
   * @param {PrimitiveVector2} v 比較する対象のベクトル
   * @return {Boolean} 等しいかどうか
   */
  equals(v) {
    return (this.x === v.x && this.y === v.y);
  }

  /**
   * @method set
   * this の各要素の値を再設定します。
   *
   * @example
   * v = phina.geom.Vector2(3, 4);
   * v.set(5, 6);
   *
   * @chainable
   * @param {Number} x ベクトルの x 座標
   * @param {Number} y ベクトルの y 座標
   */
  set(x, y) {
    this.x = x;
    this.y = y;
    return this;
  }

  /**
   * @method add
   * @chainable
   * this に other を加えます。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v2 = phina.geom.Vector2(5, 6);
   * v1.add(v2); // => phina.geom.Vector(8, 10)
   *
   * @param {PrimitiveVector2} v ベクトル
   */
  add(v) {
    this.x += v.x;
    this.y += v.y;
    return this;
  }

  /**
   * @method sub
   * @chainable
   * this から other を減じます。
   *
   * ベクトルが座標を表す場合は、指定した座標から自分自身へと向かうベクトルが得られます。
   * 
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v2 = phina.geom.Vector2(1, 5);
   * v1.sub(v2); // => phina.geom.Vector(2, -1)
   *
   * @param {PrimitiveVector2} v ベクトル
   */
  sub(v) {
    this.x -= v.x;
    this.y -= v.y;
    return this;
  }

  /**
   * @method mul
   * @chainable
   * this の各要素に数値 n を乗じます。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v1.mul(3) // => phina.geom.Vector(9, 12)
   *
   * @param {Number} n 乗じる値
   */
  mul(n) {
    this.x *= n;
    this.y *= n;
    return this;
  }

  /**
   * @method div
   * @chainable
   * this の各要素を数値 n で割ります。
   *
   * @example
   * v1 = phina.geom.Vector2(8, 16);
   * v1.div(2) // => phina.geom.Vector(4, 8)
   *
   * @param {Number} n 割る値
   */
  div(n) {
    //console.assert(n != 0, "0 division!!");
    n = n || 0.01;
    this.x /= n;
    this.y /= n;
    return this;
  }
  /**
   * @method negate
   * @chainable
   * this の各要素の正負を反転します。
   *
   * this と同じ大きさで方向が逆のベクトルが得られます。
   *
   * @example
   * v1 = phina.geom.Vector2(3, -4);
   * v1.negate() // => phina.geom.Vector(-3, 4)
   *
   */
  negate() {
    this.x = -this.x;
    this.y = -this.y;
    
    return this;
  }

  /**
   * @method dot
   * other との内積を返します。
   *
   * 投影ベクトルを求めたり、類似度の計算に利用することができます。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v2 = phina.geom.Vector2(-2, 2);
   * v1.dot(v2) // => 2
   *
   * @param {PrimitiveVector2} v ベクトル
   * @return {Number} 内積
   */
  dot(v) {
    return this.x * v.x + this.y * v.y;
  }

  /**
   * @method cross
   * other との外積（クロス積）を返します。
   *
   * 2次元ベクトルでの外積はベクトルでなく数値を返すことに注意してください。
   * other より this 時計回りにあるときは正の値になり、反時計回りにあるときは負の値になります。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v2 = phina.geom.Vector2(3, 1);
   * v1.cross(v2) // => -8
   *
   * @param {PrimitiveVector2} v ベクトル
   * @return {Number} 外積
   */
  cross(v) {
    return (this.x*v.y) - (this.y*v.x);
  }

  /**
   * @method length
   * this の大きさを返します。
   *
   * (memo) magnitude って名前の方が良いかも. 検討中.
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v1.length(); // => 5
   *
   * @return {Number} ベクトルの大きさ
   */
  length() {
    return Math.sqrt(this.x*this.x + this.y*this.y);
  }
  
  /**
   * @method lengthSquared
   * this の大きさの自乗を返します。
   *
   * C# の名前を引用（or lengthSquare or lengthSqrt）
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v1.lengthSquared(); // => 25
   *
   * @return {Number} ベクトルの大きさの自乗
   */
  lengthSquared() {
    return this.x*this.x + this.y*this.y;
  }
  
  /**
   * @method distance
   * this と other を座標とみなしたときの2点間の距離を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(1, 2);
   * v2 = phina.geom.Vector2(4, 6);
   * v1.distance(v2); // => 5
   *
   * @param {PrimitiveVector2} v 座標を表すベクトル
   * @return {Number} 2点間の距離
   */
  distance(v) {
    return Math.sqrt( Math.pow(this.x-v.x, 2) + Math.pow(this.y-v.y, 2) );
  }
  
  /**
   * @method distanceSquared
   * this と other を座標とみなしたときの2点間の距離の自乗を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(1, 2);
   * v2 = phina.geom.Vector2(4, 6);
   * v1.distanceSquared(v2); // => 25
   *
   * @param {PrimitiveVector2} v 座標を表すベクトル
   * @return {Number} 2点間の距離の自乗
   */
  distanceSquared(v) {
    return Math.pow(this.x-v.x, 2) + Math.pow(this.y-v.y, 2);
  }

  /**
   * @method random
   * @chainable
   * 自身を角度が min から max の範囲（度単位）で大きさが len のランダムなベクトルに変換して返します。
   *
   * @example
   * phina.geom.Vector2().random(90, 180, 1); // => phina.geom.Vector2(-0.5, 0.866) など
   *
   * @param {Number} [min=0] 角度（度単位）の下限値
   * @param {Number} [max=360] 角度（度単位）の上限値
   * @param {Number} [len=1] 大きさ
   * @returns {this}
   */
  random(min, max, len) {
    var degree = Random.randfloat(min || 0, max || 360);
    var rad = degree*DEG_TO_RAD;
    var len = len || 1;

    this.x = Math.cos(rad)*len;
    this.y = Math.sin(rad)*len;

    return this;
  }
  
  /**
   * @method normalize
   * @chainable
   * this を正規化します。すなわち、this と同じ方向で大きさが1のベクトルを返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v1.normalize(); // => phina.geom.Vector2(0.6, 0.8)
   *
   * @returns {this}
   */
  normalize() {
    this.div(this.length());
    return this;
  }

  /**
   * @method toString
   * this を JSON 形式で表現した文字列を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v1.toString(); // => "{x:3, y:4}"
   *
   * @return {String} JSON 文字列
   */
  toString() {
    return format.call("{x:{x}, y:{y}}", this);
    // return "{x:{x}, y:{y}}".format(this);
  }

  /**
   * @method getDirection
   * this のおおよその方向を示した文字列を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v1.getDirection(); // => "up"
   *
   * @return {String} 方向を表す文字列（"up", "right", "down", "left"）
   */
  getDirection() {
    var angle = this.toDegree();
    if (angle < 45) {
      return "right";
    } else if (angle < 135) {
      return "down";
    } else if (angle < 225) {
      return "left"
    } else if (angle < 315) {
      return "up";
    } else {
      return "right";
    }
  }

  /**
   * @method toAngle
   * this と x 軸との角度（ラジアン単位）を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(-2, 0);
   * v1.toAngle(); // => 3.14159
   *
   * @return {Number} ベクトルの角度（ラジアン単位）
   */
  toAngle() {
    var rad = Math.atan2(this.y, this.x);
    return (rad + Math.PI*2)%(Math.PI*2);
  }
  
  /**
   * @method fromAngle
   * @chainable
   * 角度（ラジアン単位）と大きさを指定してベクトルを設定します。
   *
   * @example
   * phina.geom.Vector2().fromAngle(Math.PI/4, 2); // => phina.geom.Vector2(1.4142, 1.4142)
   *
   * @param {Number} rad 角度（ラジアン単位）
   * @param {Number} [len=1] 大きさ
   * @returns {this}
   */
  fromAngle(rad, len) {
    len = len || 1;
    this.x = Math.cos(rad)*len;
    this.y = Math.sin(rad)*len;
    
    return this;
  }

  /**
   * @method toDegree
   * this と x 軸との角度（度単位）を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(-2, 2);
   * v1.toAngle(); // => 135
   *
   * @return {Number} ベクトルの角度（度単位）
   */
  toDegree() {
    return toDegree.call(this.toAngle());
    // return this.toAngle().toDegree();
  }
  
  /**
   * @method fromDegree
   * @chainable
   * 角度（度単位）と大きさを指定してベクトルを設定します。
   *
   * @example
   * phina.geom.Vector2().fromDegree(60, 2); // => phina.geom.Vector2(1, 1.732)
   *
   * @param {Number} deg 角度（度単位）
   * @param {Number} [len=1] 大きさ
   * @returns {this}
   */
  fromDegree(deg, len) {
    // return this.fromAngle(deg.toRadian(), len);
    return this.fromAngle(toRadian.call(deg), len);
  }

  /**
   * @method rotate
   * @chainable
   * this を回転します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 1);
   * v1.rotate(Math.PI/2); // => phina.geom.Vector2(-1, 3);
   *
   * @param {Number} rad 角度（ラジアン単位）
   * @param {PrimitiveVector2} [center=Vector2(0, 0)] 回転の中心座標
   * @returns {this}
   */
  rotate(rad, center) {
    center = center || new Vector2(0, 0);

    var x1 = this.x - center.x;
    var y1 = this.y - center.y;
    var x2 = x1 * Math.cos(rad) - y1 * Math.sin(rad);
    var y2 = x1 * Math.sin(rad) + y1 * Math.cos(rad);
    this.set( center.x + x2, center.y + y2 );

    return this;
  }

  /**
   * @method min
   * @static
   * v1 と v2 の各要素に対し、より小さい方を要素とする新しいベクトルを生成して返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 1);
   * v2 = phina.geom.Vector2(-3, 2);
   * phina.geom.Vector2.min(v1, v2); // phina.geom.Vector2(-3, 1);
   *
   * @param {PrimitiveVector2} a ベクトル
   * @param {PrimitiveVector2} b ベクトル
   * @return {Vector2} 生成したベクトル
   */
  static min(a, b) {
    return new Vector2(
      (a.x < b.x) ? a.x : b.x,
      (a.y < b.y) ? a.y : b.y
    );
  }

  /**
   * @method max
   * @static
   * 2次元ベクトル v1 と v2 の各要素に対し、より大きい方を要素とする新しいベクトルを生成して返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 1);
   * v2 = phina.geom.Vector2(-3, 2);
   * phina.geom.Vector2.max(v1, v2); // phina.geom.Vector2(3, 2);
   *
   * @param {PrimitiveVector2} a ベクトル
   * @param {PrimitiveVector2} b ベクトル
   * @return {Vector2} 生成したベクトル
   */
  static max(a, b) {
    return new Vector2(
      (a.x > b.x) ? a.x : b.x,
      (a.y > b.y) ? a.y : b.y
    );
  }

  /**
   * @method add
   * @static
   * v1 に v2 を加算した新しいベクトルを生成して返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 1);
   * v2 = phina.geom.Vector2(-3, 2);
   * phina.geom.Vector2.add(v1, v2); // phina.geom.Vector2(0, 3);
   *
   * @param {PrimitiveVector2} lhs ベクトル
   * @param {PrimitiveVector2} rhs ベクトル
   * @return {Vector2} 加算した結果
   */
  static add(lhs, rhs) {
    return new Vector2(lhs.x+rhs.x, lhs.y+rhs.y);
  }
  
  /**
   * @method sub
   * @static
   * 2次元ベクトル v1 から v2 を減じた新しいベクトルを生成して返します。
   *
   * ベクトルが座標を表す場合、2つ目の座標から1つ目の座標へと向かうベクトルが得られます。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 1);
   * v2 = phina.geom.Vector2(-3, 2);
   * phina.geom.Vector2.sub(v1, v2); // phina.geom.Vector2(6, -1);
   *
   * @param {PrimitiveVector2} lhs ベクトル
   * @param {PrimitiveVector2} rhs ベクトル
   * @return {Vector2} 減算した結果
   */
  static sub(lhs, rhs) {
    return new Vector2(lhs.x-rhs.x, lhs.y-rhs.y);
  }
  
  /**
   * @method mul
   * @static
   * 2次元ベクトル v の各要素に n を乗じた新しいベクトルを生成して返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 1);
   * phina.geom.Vector2.mul(v1, 2); // phina.geom.Vector2(6, 2)
   *
   * @param {PrimitiveVector2} v ベクトル
   * @param {Number} n 乗じる値
   * @return {Vector2} 乗算した結果
   */
  static mul(v, n) {
    return new Vector2(v.x*n, v.y*n);
  }
  
  /**
   * @method div
   * @static
   * 2次元ベクトル v の各要素を n で割った新しいベクトルを生成して返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 1);
   * phina.geom.Vector2.div(v1, 2); // phina.geom.Vector2(1.5, 0.5)
   *
   * @param {PrimitiveVector2} v ベクトル
   * @param {Number} n 割る値
   * @return {Vector2} 除算した結果
   */
  static div(v, n) {
    return new Vector2(v.x/n, v.y/n);
  }
  
  /**
   * @method negate
   * @static
   * 2次元ベクトル v を反転した新しいベクトルを生成して返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 1);
   * phina.geom.Vector2.negate(); // phina.geom.Vector2(-3, -1)
   *
   * @param {PrimitiveVector2} v ベクトル
   * @return {Vector2} 反転したベクトル
   */
  static negate(v) {
    return new Vector2(-v.x, -v.y);
  }
  
  /**
   * @method dot
   * @static
   * 2次元ベクトル v1 と v2 の内積を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v2 = phina.geom.Vector2(-2, 2);
   * phina.geom.Vector2.dot(v1, v2) // => 2
   *
   * @param {PrimitiveVector2} lhs ベクトル
   * @param {PrimitiveVector2} rhs ベクトル
   * @return {Number} 内積
   */
  static dot(lhs, rhs) {
    return lhs.x * rhs.x + lhs.y * rhs.y;
  }
  
  /**
   * @method cross
   * @static
   * 2次元ベクトル v1 と v2 の外積（クロス積）を返します。
   *
   * 2次元ベクトルでの外積はベクトルでなく数値を返すことに注意してください。
   * 1つ目のベクトルが2つ目のベクトルより時計回りにあるときは正の値になり、反時計回りにあるときは負の値になります。
   *
   * @example
   * v1 = phina.geom.Vector2(3, 4);
   * v2 = phina.geom.Vector2(3, 1);
   * phina.geom.Vector2.cross(v1, v2); // => -8
   *
   * @param {PrimitiveVector2} lhs ベクトル
   * @param {PrimitiveVector2} rhs ベクトル
   * @return {Number} 外積
   */
  static cross(lhs, rhs) {
    return (lhs.x*rhs.y) - (lhs.y*rhs.x);
  }
  
  /**
   * @method distance
   * @static
   * v1 と v2 を座標とみなしたときの2点間の距離を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(1, 2);
   * v2 = phina.geom.Vector2(4, 6);
   * phina.geom.Vector2.distance(v1, v2); // => 5
   *
   * @param {PrimitiveVector2} lhs 座標を表すベクトル
   * @param {PrimitiveVector2} rhs 座標を表すベクトル
   * @return {Number} 2点間の距離
   */
  static distance(lhs, rhs) {
    return Math.sqrt( Math.pow(lhs.x-rhs.x, 2) + Math.pow(lhs.y-rhs.y, 2) );
  }

  /**
   * @method distanceSquared
   * @static
   * v1 と v2 を座標とみなしたときの2点間の距離の自乗を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(1, 2);
   * v2 = phina.geom.Vector2(4, 6);
   * phina.geom.Vector2.distanceSquared(v1, v2); // => 25
   *
   * @param {PrimitiveVector2} lhs 座標を表すベクトル
   * @param {PrimitiveVector2} rhs 座標を表すベクトル
   * @return {Number} 2点間の距離の自乗
   */
  static distanceSquared(lhs, rhs) {
    return Math.pow(lhs.x-rhs.x, 2) + Math.pow(lhs.y-rhs.y, 2);
  }

  /**
   * @method manhattanDistance
   * @static
   * v1 と v2 を座標とみなしたときの2点間のマンハッタン距離（軸に平行に進むときの最短距離）を返します。
   *
   * @example
   * v1 = phina.geom.Vector2(1, 2);
   * v2 = phina.geom.Vector2(4, 6);
   * phina.geom.Vector2.manhattanDistance(v1, v2); // => 7
   *
   * @param {PrimitiveVector2} lhs 座標を表すベクトル
   * @param {PrimitiveVector2} rhs 座標を表すベクトル
   * @return {Number} 2点間のマンハッタン距離
   */
  static manhattanDistance(lhs, rhs) {
    return Math.abs(lhs.x-rhs.x) + Math.abs(lhs.y-rhs.y);
  }
  
  /**
   * @method normal
   * @static
   * v1 と v2 を座標とみなしたときの、v2 から v1 に向かうベクトルに対する法線ベクトルを返します。
   *
   * @example
   * v1 = phina.geom.Vector2(1, 2);
   * v2 = phina.geom.Vector2(4, 6);
   * phina.geom.Vector2.normal(v1, v2); // => phina.geom.Vector2(4, -3)
   *
   * @param {PrimitiveVector2} a 座標を表すベクトル
   * @param {PrimitiveVector2} b 座標を表すベクトル
   * @return {Vector2} 法線ベクトル
   */
  static normal(a, b) {
    var temp = Vector2.sub(a, b);

    return new Vector2(-temp.y, temp.x);
  }

  /**
   * @method reflect
   * @static
   * 2次元ベクトル v を壁への入射ベクトルとして、壁に反射した際のベクトル（反射ベクトル）を返します。
   *
   * 壁の向きは法線ベクトル normal によって表します。
   *
   * @example
   * v1 = phina.geom.Vector2(4, 3);
   * normal = phina.geom.Vector2(-1, 1);
   * phina.geom.Vector2.reflect(v1, normal); // => phina.geom.Vector2(2, 5)
   *
   * @param {PrimitiveVector2} v 入射ベクトル
   * @param {PrimitiveVector2} normal 壁の法線ベクトル
   * @return {Vector2} 反射ベクトル
   */
  static reflect(v, normal) {
    var len = Vector2.dot(v, normal);
    var temp= Vector2.mul(normal, 2*len);
    
    return Vector2.sub(v, temp);
  }
  
  /**
   * @method wall
   * @static
   * 2次元ベクトル v を壁への入射ベクトルとして、壁に沿ったベクトル（壁ずりクトル）を返します。
   *
   * 壁の向きは法線ベクトル normal によって表します。
   *
   * @example
   * v1 = phina.geom.Vector2(4, 3);
   * normal = phina.geom.Vector2(-1, 1);
   * phina.geom.Vector2.wall(v1, normal); // => phina.geom.Vector2(3, 4)
   *
   * @param {PrimitiveVector2} v 入射ベクトル
   * @param {PrimitiveVector2} normal 壁の法線ベクトル
   * @return {Vector2} 壁ずりベクトル
   */
  static wall(v, normal) {
    var len = Vector2.dot(v, normal);
    var temp= Vector2.mul(normal, len);
    
    return Vector2.sub(v, temp);
  }
  
  /**
   * @method lerp
   * @static
   * v1 と v2 を媒介変数 t で線形補間します。
   * t=0.5 で v1 と v2 の中間ベクトルを求めることができます。
   *
   * @example
   * v1 = phina.geom.Vector2(1, 2);
   * v2 = phina.geom.Vector2(4, 6);
   * phina.geom.Vector2.lerp(v1, v2, 0.5); // => (2.5, 4)
   * phina.geom.Vector2.lerp(v1, v2, 0); // => (1, 2)
   * phina.geom.Vector2.lerp(v1, v2, 1); // => (4, 6)
   * 
   * @param {PrimitiveVector2} a ベクトル
   * @param {PrimitiveVector2} b ベクトル
   * @param {Number} t 媒介変数
   * @return {Vector2} 線形補間の結果
   */
  static lerp(a, b, t) {
    return new Vector2(
      a.x + (b.x-a.x)*t,
      a.y + (b.y-a.y)*t
    );
  }
  
  /**
   * @method slerp
   * @static
   * @todo
   * 補間（未実装）
   */
  static slerp(lhs, rhs, t) {
      // TODO:
      // cos...
  }

  /**
   * @method random
   * @static
   * 角度が min から max の範囲（度単位）で大きさが len のランダムなベクトルを生成して返します。
   *
   * @example
   * phina.geom.Vector2.random(90, 180, 1); // => phina.geom.Vector2(-0.5, 0.866) など
   *
   * @param {Number} [min=0] 角度（度単位）の下限値
   * @param {Number} [max=360] 角度（度単位）の上限値
   * @param {Number} [len=1] 大きさ
   * @return {Vector2} 生成したベクトル
   */
  static random(min, max, len) {
    return new Vector2().random(min, max).mul(len||1);
  }

  /**
   * @property {Vector2} ZERO ゼロベクトル
   */
  static get ZERO() { return ZERO; }

  /**
   * @property {Vector2} LEFT 左方向の単位ベクトル
   */
  static get LEFT() { return LEFT; }

  /**
   * @property {Vector2} RIGHT 右方向の単位ベクトル
   */
  static get RIGHT() { return RIGHT; }

  /**
   * @property {Vector2} UP 上方向の単位ベクトル
   */
  static get UP() { return UP; }

  /**
   * @property {Vector2} DOWN 下方向の単位ベクトル
   */
  static get DOWN() { return DOWN; }
}

var ZERO = new Vector2(0, 0);
var LEFT = new Vector2(-1, 0);
var RIGHT = new Vector2(1, 0);
var UP = new Vector2(0, -1);
var DOWN = new Vector2(0, 1);

// import { Rect } from "./rect";

/**
 * @class phina.geom.Circle
 * # 円領域を表すクラス
 * キャンバス上の円領域を扱うクラスです。
 * 
 */
class Circle {

  /**
   * @property {Number} x
   * 円の中心の x 座標
   */
  // x: 0,
  /**
   * @property {Number} y
   * 円の中心の y 座標
   */
  // y: 0,
  /**
   * @property {Number} radius
   * 円の半径
   */
  // radius: 32,

  /**
   * @method init
   * 円領域のコンストラクタです。
   *
   * ### Example
   *     circle = phina.geom.Circle(32, 64, 128);
   *
   * @param {Number} x 円の中心の x 座標
   * @param {Number} y 円の中心の y 座標
   * @param {Number} radius 半径
   */
  constructor(x, y, radius) {
    this.x = 0;
    this.y = 0;
    this.radius = 32;
    this.set(x, y, radius);
  }

  /**
   * @method set
   * @chainable
   * this の各値を再設定します。
   *
   * ### Example
   *     circle = phina.geom.Circle(32, 64, 128);
   *     circle.set(100, 200, 32);
   *
   * @param {Number} x 円を囲う矩形の左上頂点の x 座標
   * @param {Number} y 円を囲う矩形の左上頂点の x 座標
   * @param {Number} radius 半径
   * @returns {this}
   */
  set(x, y, radius) {
    this.x = x;
    this.y = y;
    this.radius = radius;

    return this;
  }

  /**
   * @method moveTo
   * @chainable
   * 円領域を座標 (x, y) に移動します。(x, y) は円の中心を表します。
   *
   * ### Example
   *     circle = phina.geom.Circle(300, 300, 40);
   *     circle.left; // => 260
   *     circle.moveTo(100, 100);
   *     circle.left; // => 60
   *
   * @param {Number} x 移動先の x 座標
   * @param {Number} y 移動先の y 座標
   * @returns {this}
   */
  moveTo(x, y) {
    this.x = x;
    this.y = y;
    return this;
  }

  /**
   * @method moveBy
   * @chainable
   * 円領域を (x, y) だけ移動します。
   *
   * ### Example
   *     circle = phina.geom.Circle(300, 300, 40);
   *     circle.left; // => 260
   *     circle.moveBy(100, 100);
   *     circle.left; // => 460
   *
   * @param {Number} x 移動量の x 座標
   * @param {Number} y 移動量の y 座標
   * @returns {this}
   */
  moveBy(x, y) {
    this.x += x;
    this.y += y;
    return this;
  }

  /**
   * @method contains
   * 座標 (x, y) が円領域の中に含まれるかどうかを返します。
   *
   * ### Example
   *     circle = phina.geom.Circle(300, 300, 100);
   *     circle.contains(350, 350); // =>  true
   *     circle.contains(350, 400); // => false
   *
   * @param {Number} x 判定する対象の x 座標
   * @param {Number} y 判定する対象の y 座標
   * @return {Boolean} 指定した座標が円領域の中に含まれるかどうか
   */
  contains(x, y) {
    var lenX = this.x-x;
    var lenY = this.y-y;
    var lenSquared = (lenX*lenX)+(lenY*lenY);

    return lenSquared <= this.radius*this.radius;
  }

  /**
   * @method clone
   * this のコピーを生成して返します。
   *
   * ### Example
   *     circle = phina.geom.Circle(50, 100, 40);
   *     circle2 = circle.clone();
   *     circle2.x == circle.x; // => true
   *
   * @return {Circle} 生成した円領域
   */
  clone() {
    return new Circle(this.x, this.y, this.radius);
  }

  /**
   * @method toRect
   * 円に外接する正方形を表す矩形領域を生成して返します。
   *
   * ### Example
   *     circle = phina.geom.Circle(50, 100, 40);
   *     rect = circle.toRect();
   *     rect.x; // => 10
   *     rect.y; // => 60
   *     rect.width; // => 80
   * 
   * @return {Object} 生成した矩形領域
   */
  toRect() {
    // 循環参照回避のため、Rect側で定義
    // var size = this.size;
    // return new Rect(this.x - this.radius, this.y - this.radius, size, size);
  }

  /**
   * @method toArray
   * this の各値を要素とする配列を生成して返します。
   *
   * ### Example
   *     circle = phina.geom.Circle(50, 100, 40);
   *     rect.toArray(); // => [50, 100, 40]
   *
   * @return {Number[]} 生成した配列
   */
  toArray() {
    return [this.x, this.y, this.radius];
  }

  /**
   * @property {Number} left
   * キャンバス左端から円の左端までの距離
   *
   * 現時点では読み取り専用です。
   *
   * ### Example
   *     circle = phina.geom.Circle(200, 300, 100);
   *     circle.left; // => 100
   *     circle.top; // => 200
   *     circle.right; // => 300
   *     circle.bottom; // => 400
   */
  get left()   { return this.x - this.radius; }
  set left(v)  {
    // TODO: 
  }

  /**
   * @property {Number} top
   * キャンバス上端から円の上端までの距離
   *
   * 現時点では読み取り専用です。
   */
  get top()   { return this.y - this.radius; }
  set top(v)  {
    // TODO: 
  }

  /**
   * @property {Number} right
   * キャンバス右端から円の右端までの距離
   *
   * 現時点では読み取り専用です。
   */
  get right()   { return this.x + this.radius; }
  set right(v)  {
    // TODO: 
  }

  /**
   * @property {Number} bottom
   * キャンバス下端から円の下端までの距離
   *
   * 現時点では読み取り専用です。
   */
  get bottom()   { return this.y + this.radius; }
  set bottom(v)  {
    // TODO: 
  }
    
  /**
   * @property {Number} size
   * 円の直径
   *
   * 現時点では読み取り専用です。
   */
  get size()   { return this.radius*2; }
  set size(v)  {
    // TODO: 検討中
  }
}

/**
 * @class phina.geom.Rect
 * # 矩形領域を表すクラス
 * キャンバス上の矩形領域を扱うクラスです。
 * 
 * ### Example
 *     rect = phina.geom.Rect(8, 16, 32, 64);
 */
class Rect {

  /**
   * @param {Number} [x] 矩形の左上頂点の x 座標
   * @param {Number} [y] 矩形の左上頂点の y 座標
   * @param {Number} [width] 幅
   * @param {Number} [height] 高さ
   */
  constructor(x, y, width, height) {
    /**
     * @property {Number} x
     * 矩形の左上頂点の x 座標
     */
    this.x = 0;
    
    /**
     * @property {Number} y
     * 矩形の左上頂点の y 座標
     */
    this.y = 0;

    /**
     * @property {Number} width
     * 矩形の幅
     */
    this.width = 32;

    /**
     * @property {Number} hight
     * 矩形の高さ
     */
    this.height = 32;

    this.set(x, y, width, height);
  }

  /**
   * @method set
   * @chainable
   * this の各値を再設定します。
   *
   * ### Example
   *     rect = phina.geom.Rect(8, 16, 32, 64);
   *     rect.set(0, 16, 32, 64);
   *
   * @param {Number} x 矩形の左上頂点の x 座標
   * @param {Number} y 矩形の左上頂点の y 座標
   * @param {Number} width 幅
   * @param {Number} height 高さ
   * @returns {this}
   */
  set(x, y, width, height) {
    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;

    return this;
  }

  /**
   * @method moveTo
   * @chainable
   * 矩形領域を座標 (x, y) に移動します。
   *
   * ### Example
   *     rect = phina.geom.Rect(8, 16, 32, 64);
   *     rect.centerX; // => 24
   *     rect.moveTo(0, 0);
   *     rect.centerX; // => 16
   *
   * @param {Number} x 移動先の x 座標
   * @param {Number} y 移動先の y 座標
   * @returns {this}
   */
  moveTo(x, y) {
    this.x = x;
    this.y = y;
    return this;
  }

  /**
   * @method moveBy
   * @chainable
   * 矩形領域を (x, y) だけ移動します。
   *
   * ### Example
   *     rect = phina.geom.Rect(8, 16, 32, 64);
   *     rect.moveBy(10, -10);
   *     rect.x; // => 18
   *     rect.y; // => 6
   *
   * @param {Number} x 移動量の x 座標
   * @param {Number} y 移動量の y 座標
   * @returns {this}
   */
  moveBy(x, y) {
    this.x += x;
    this.y += y;
    return this;
  }

  /**
   * @method setSizse
   * @chainable
   * 矩形領域の幅と高さを変更します。
   *
   * ### Example
   *     rect = phina.geom.Rect(8, 16, 32, 64);
   *     rect.setSize(10, 20);
   *     rect.width; // => 10
   *     rect.height; // => 20
   *
   * @param {Number} w 幅
   * @param {Number} h 高さ
   * @returns {this}
   */
  setSize(w, h) {
    this.width = w;
    this.height = h;
    return this;
  }

  /**
   * @method padding
   * @chainable
   * 矩形領域の中にパディング領域を設定します。
   *
   * 矩形領域自体のサイズはパディング領域の分だけ小さくなります。  
   * 幅の指定方法は CSS の padding 指定と同じように時計回りです。  
   * 引数が1つの場合は上下左右の値、引数が2つの場合は上下と左右の値、引数が３つの場合は上、左右、下の値と解釈します。
   *
   * ### Example
   *     rect = phina.geom.Rect(50, 100, 150, 200);
   *     rect.padding(10);
   *     rect.x; // => 60
   *     rect.y; // => 110
   *     rect.width; // => 130
   *     rect.height; // => 180
   *
   * @param {Number} top 上辺のパディング幅
   * @param {Number} right 右辺のパディング幅
   * @param {Number} bottom 下辺のパディング幅
   * @param {Number} left 左辺のパディング幅
   * @returns {this}
   */
  padding(top, right, bottom, left) {
    // css の padding に合わせて時計回りにパラメータ調整
    switch (arguments.length) {
      case 1:
        top = right = bottom = left = arguments[0];
        break;
      case 2:
        top     = bottom = arguments[0];
        right   = left   = arguments[1];
        break;
      case 3:
        top     = arguments[0];
        right   = left = arguments[1];
        bottom  = arguments[2];
        break;
    }
    
    this.x += left;
    this.y += top;
    this.width -= left+right;
    this.height-= top +bottom;
    
    return this;
  }

  /**
   * @method contains
   * 座標 (x, y) が 矩形領域の中に含まれるかどうかを返します。
   *
   * ### Example
   *     rect = phina.geom.Rect(50, 100, 150, 200);
   *     rect.contains(35, 68); // =>  true
   *     rect.contains(200, 68); // => false
   *
   * @param {Number} x 判定する対象の x 座標
   * @param {Number} y 判定する対象の y 座標
   * @return {Boolean} 指定した座標が矩形領域の中に含まれるかどうか
   */
  contains(x, y) {
    return this.left <= x && x <= this.right && this.top <= y && y <= this.bottom;
  }

  /**
   * @method clone
   * this のコピーを生成して返します。
   *
   * ### Example
   *     rect = phina.geom.Rect(50, 100, 150, 200);
   *     rect2 = rect.clone();
   *     rect2.x == rect.x; // => true
   *
   * @return {Rect} 生成した矩形領域
   */
  clone() {
    return new Rect(this.x, this.y, this.width, this.height);
  }

  /**
   * @method toCircle
   * 矩形領域内に収まる最大の円領域を生成して返します。
   *
   * ### Example
   *     rect = phina.geom.Rect(32, 64, 100, 200);
   *     circle = rect.toCircle();
   *     circle.x; // => 82
   *     circle.y; // => 164
   *     circle.radius; // => 50
   *
   * @return {Circle} 生成した円領域
   */
  toCircle() {
    var radius = ((this.width < this.height) ? this.width : this.height)/2;
    return new Circle(this.centerX, this.centerY, radius);
  }

  /**
   * @method toArray
   * this の各値を要素とする配列を生成して返します。
   *
   * ### Example
   *     rect = phina.geom.Rect(32, 64, 100, 200);
   *     rect.toArray(); // => [32, 64, 100, 200]
   *
   * @return {Number[]} 生成した配列
   */
  toArray() {
    return [this.x, this.y, this.width, this.height];
  }

  /**
   * @property {Number} left
   * キャンバス左端から矩形領域の左辺までの距離
   *
   * left を変更すると矩形領域の幅（width）が自動的に調整されます。
   *
   * ### Example
   *     rect = phina.geom.Rect(32, 64, 100, 200);
   *     rect.left; // => 32
   *     rect.width; // => 100
   *     rect.right; // => 132
   *     
   *     rect.left = 42;
   *     rect.width; // => 90
   */
  get left()   { return this.x; }
  set left(v)  { this.width -= v-this.x; this.x = v; }

  /**
   * @property {Number} top
   * キャンバス上端から矩形領域の上辺までの位置
   *
   * top を変更すると矩形領域の高さ（height）が自動的に調整されます。
   */
  get top()   { return this.y; }
  set top(v)  { this.height -= v-this.y; this.y = v; }

  /**
   * @property {Number} right
   * キャンバス左端から矩形領域の右辺までの距離
   *
   * right を変更すると矩形領域の幅（width）が自動的に調整されます。
   */
  get right()   { return this.x + this.width; }
  set right(v)  { this.width += v-this.right; }

  /**
   * @property {Number} bottom
   * キャンバス上端から矩形領域の下辺までの位置
   *
   * bottom を変更すると矩形領域の高さ（height）が自動的に調整されます。
   */
  get bottom()   { return this.y + this.height; }
  set bottom(v)  { this.height += v-this.bottom; }
  
  /**
   * @property {Number} centerX
   * 矩形領域の x 座標
   *
   * 現時点では読み取り専用です。
   */
  get centerX()   { return this.x + this.width/2; }
  set centerX(v)  {
    // TODO: 検討中
  }
  /**
   * @property {Number} centerY
   * 矩形領域の y 座標
   *
   * 現時点では読み取り専用です。
   */
  get centerY()   { return this.y + this.height/2; }
  set centerY(v)  {
    // TODO: 検討中
  }

}

/**
 * Circle.toRect
 * 循環参照を回避するため、ここで定義
 */
Circle.prototype.toRect = function() {
  var size = this.size;
  return new Rect(this.x - this.radius, this.y - this.radius, size, size);
};

/**
 * @class phina.geom.Matrix33
 * # 行列クラス
 * 3x3の行列を表すクラスです。
 * 
 * <pre>
 * | m00 m01 m02 |
 * | m10 m11 m12 |
 * | m20 m21 m22 |
 * </pre>
 */
class Matrix33 {

  /**
   * @method init
   * マトリックスクラスのコンストラクタです。
   *
   * 引数は m00, m01, m02, m10, m11, m12, m20, m21, m22 の順に指定します。
   * 引数が9個に満たない場合は単位行列を生成します。
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(1, 2, 3, 4, 5, 6, 7, 8, 9);
   *     mat2 = phina.geom.Matrix33();
   *     mat1.m00 + mat2.m00; // => 2
   *     mat1.m01 - mat2.m01; // => 2
   *
   * @param {...number} m00, m01,... 各要素の値
   */
  constructor() {
    /** @type {number} */
    this.m00;
    /** @type {number} */
    this.m01;
    /** @type {number} */
    this.m02;

    /** @type {number} */
    this.m10;
    /** @type {number} */
    this.m11;
    /** @type {number} */
    this.m12;

    /** @type {number} */
    this.m20;
    /** @type {number} */
    this.m21;
    /** @type {number} */
    this.m22;

    if (arguments.length >= 9) {
      this.set.apply(this, arguments);
    }
    else {
      this.identity();
    }
  }

  /**
   * @method set
   * @chainable this の各要素の値を再設定します。
   * 
   * ### Example
   *   mat1 = phina.geom.Matrix33(1, 2, 3, 4, 5, 6, 7, 8, 9);
   *   mat2 = phina.geom.Matrix33();
   *   mat2.set(1, 2, 3, 4, 5, 6, 7, 8, 9);
   *   mat1.toString() == mat2.toString(); // => true
   * 
   * @param {number} m00
   * @param {number} m01
   * @param {number} m02
   * @param {number} m10
   * @param {number} m11
   * @param {number} m12
   * @param {number} m20
   * @param {number} m21
   * @param {number} m22
   * @returns {this}
   */
  set(m00, m01, m02, m10, m11, m12, m20, m21, m22) {
    this.m00 = m00; this.m01 = m01; this.m02 = m02;
    this.m10 = m10; this.m11 = m11; this.m12 = m12;
    this.m20 = m20; this.m21 = m21; this.m22 = m22;

    return this;
  }

  /**
   * @method identity
   * @chainable
   * 自身を単位行列にして返します。
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(1, 2, 3, 4, 5, 6, 7, 8, 9);
   *     mat2 = phina.geom.Matrix33();
   *     mat1.identity().toString() == mat2.toString(); // => true
   *
   * @returns {this}
   */
  identity() {
    this.m00 = 1; this.m01 = 0; this.m02 = 0;
    this.m10 = 0; this.m11 = 1; this.m12 = 0;
    this.m20 = 0; this.m21 = 0; this.m22 = 1;
    return this;
  }

  /**
   * @method clone
   * 自身のコピーを生成して返します。
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(1, 2, 3, 4, 5, 6, 7, 8, 9);
   *     mat2 = mat1.clone();
   *     mat1.toString() == mat2.toString(); // => true
   *     mat1 == mat2; // => false
   *
   * @return {Matrix33} 行列オブジェクト
   */
  clone() {
    return new Matrix33(
      this.m00, this.m01, this.m02,
      this.m10, this.m11, this.m12,
      this.m20, this.m21, this.m22
    );
  }

  /**
   * @method determinant
   * 行列式を返します
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(0, -2, 0, -1, 3, 1, 4, 2, 1);
   *     mat1.determinant(); // => -10
   *     mat1.identity().determinant(); // => 1
   *
   * @return {Number} 行列式
   */
  determinant() {
    var m00 = this.m00; var m01 = this.m01; var m02 = this.m02;
    var m10 = this.m10; var m11 = this.m11; var m12 = this.m12;
    var m20 = this.m20; var m21 = this.m21; var m22 = this.m22;
    
    return m00*m11*m22 + m10*m21*m02 + m01*m12*m20 - m02*m11*m20 - m01*m10*m22 - m12*m21*m00;
  }

  /**
   * @method transpose
   * @chainable
   * 自身を転置行列にして返します。
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(1, 2, 3, 4, 5, 6, 7, 8, 9);
   *     mat2 = phina.geom.Matrix33(1, 4, 7, 2, 5, 8, 3, 6, 9);
   *     mat1.transpose().toString() == mat2.toString(); // => true
   *
   * @returns {this}
   */
  transpose() {
    var swap = function(a, b) {
      var temp = this[a];
      this[a] = this[b];
      this[b] = temp;
    }.bind(this);

    swap('m01', 'm10');
    swap('m02', 'm20');
    swap('m12', 'm21');
    
    return this;
  }

  /**
   * @method invert
   * @chainable
   * 自身を逆行列にして返します。
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(0, -1, 1, -1, 4, -2, 1, 1, 1);
   *     mat2 = mat1.clone().invert();
   *     mat3 = mat1.clone().multiply(mat2);
   *     mat3.toString() == phina.geom.Matrix33.IDENTITY.toString(); // => true
   *
   * @returns {this}
   */
  invert() {
    var m00 = this.m00; var m01 = this.m01; var m02 = this.m02;
    var m10 = this.m10; var m11 = this.m11; var m12 = this.m12;
    var m20 = this.m20; var m21 = this.m21; var m22 = this.m22;

    var det = this.determinant();

    // |m00, m01, m02|
    // |m10, m11, m12|
    // |m20, m21, m22|
    this.m00 = (m11*m22-m12*m21)/det;
    this.m01 = (m10*m22-m12*m20)/det*-1;
    this.m02 = (m10*m21-m11*m20)/det;
    
    this.m10 = (m01*m22-m02*m21)/det*-1;
    this.m11 = (m00*m22-m02*m20)/det;
    this.m12 = (m00*m21-m01*m20)/det*-1;
    
    this.m20 = (m01*m12-m02*m11)/det;
    this.m21 = (m00*m12-m02*m10)/det*-1;
    this.m22 = (m00*m11-m01*m10)/det;
    
    this.transpose();
    
    return this;

  }

  /**
   * @method multiply
   * @chainable
   * 自身に別の行列を乗じます。
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(0, -1, 1, -1, 4, -2, 1, 1, 1);
   *     mat2 = mat1.clone().invert();
   *     mat3 = mat1.clone().multiply(mat2);
   *     mat3.toString() == phina.geom.Matrix33.IDENTITY.toString(); // => true
   *
   * @param {Matrix33} mat 乗じる行列
   * @returns {this}
   */
  multiply(mat) {
    var a00 = this.m00, a01 = this.m01, a02 = this.m02;
    var a10 = this.m10, a11 = this.m11, a12 = this.m12;
    var a20 = this.m20, a21 = this.m21, a22 = this.m22;
    var b00 = mat.m00, b01 = mat.m01, b02 = mat.m02;
    var b10 = mat.m10, b11 = mat.m11, b12 = mat.m12;
    var b20 = mat.m20, b21 = mat.m21, b22 = mat.m22;

    this.m00 = a00*b00 + a01*b10 + a02*b20;
    this.m01 = a00*b01 + a01*b11 + a02*b21;
    this.m02 = a00*b02 + a01*b12 + a02*b22;

    this.m10 = a10*b00 + a11*b10 + a12*b20;
    this.m11 = a10*b01 + a11*b11 + a12*b21;
    this.m12 = a10*b02 + a11*b12 + a12*b22;

    this.m20 = a20*b00 + a21*b10 + a22*b20;
    this.m21 = a20*b01 + a21*b11 + a22*b21;
    this.m22 = a20*b02 + a21*b12 + a22*b22;
    
    return this;
  }

  /**
   * @method multiplyVector2
   * 自身に2次元ベクトル v を乗じます。
   * 2次元ベクトルは (x, y, 1) として乗算します。
   *
   * ### Example
   *     mat = phina.geom.Matrix33(0, -1, 1, -1, 4, -2, 1, 1, 1);
   *     v = phina.geom.Vector2(2, 4)
   *     mat.multiplyVector2(v) // => {x: -3, y: 12}
   *
   * @param {import("./vector2").PrimitiveVector2} v 乗じるベクトル
   * @return {Vector2} 乗算結果のベクトル
   */
  multiplyVector2(v) {
    var vx = this.m00*v.x + this.m01*v.y + this.m02;
    var vy = this.m10*v.x + this.m11*v.y + this.m12;
    
    // return phina.geom.Vector2(vx, vy);
    return new Vector2(vx, vy);
  }

  // 行
  /**
   * @method getRow
   * row 番目の行を配列で返します。row が 0、1、2 のいずれかでなければ null を返します。
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(1, 2, 3, 4, 5, 6, 7, 8, 9);
   *     mat1.getRow(0); // [1, 2, 3]
   *     mat1.getRow(1); // [4, 5, 6]
   *     mat1.getRow(9); // null
   *
   * @param {0|1|2} row 行番号
   * @return {Number[]|null} 行を表す配列
   */
  getRow(row) {
    if ( row === 0 ) {
      return [ this.m00, this.m01, this.m02 ];
    }
    else if ( row === 1 ) {
      return [ this.m10, this.m11, this.m12 ];
    }
    else if ( row === 2 ) {
      return [ this.m20, this.m21, this.m22 ];
    }
    else {
      return null;
    }
  }

  /**
   * @method getCol
   * col 番目の列を配列で返します。col が 0、1、2 のいずれかでなければ null を返します。
   *
   * ### Example
   *     mat1 = phina.geom.Matrix33(1, 2, 3, 4, 5, 6, 7, 8, 9);
   *     mat1.getCol(0); // [1, 4, 7]
   *     mat1.getCol(1); // [2, 5, 8]
   *     mat1.getRow(-1); // null
   *
   * @param {0|1|2} col 列番号
   * @return {Number[]|null} 列を表す配列
   */
  getCol(col) {
    if ( col === 0 ) {
      return [ this.m00, this.m10, this.m20 ];
    }
    else if ( col === 1 ) {
      return [ this.m01, this.m11, this.m21 ];
    }
    else if ( col === 2 ) {
      return [ this.m02, this.m12, this.m22 ];
    }
    else {
      return null;
    }
  }

  /**
   * @method toString
   * 行列を JSON 形式で表現した文字列を返します。
   *
   * ### Example
   *     v = phina.geom.Vector2(3, 4);
   *     v2 = v.clone();
   *     v2.x == v.x; // => true
   *
   * @return {String} JSON 文字列
   */
  toString() {
    return format.call("|{m00}, {m01}, {m02}|\n|{m10}, {m11}, {m12}|\n|{m20}, {m21}, {m22}|", this);
    // return "|{m00}, {m01}, {m02}|\n|{m10}, {m11}, {m12}|\n|{m20}, {m21}, {m22}|".format(this);
  }

  /**
   * デフォルト単位行列を返す
   */
  static get IDENTITY() {
    return IDENTITY
  }
}

var IDENTITY = new Matrix33().identity();

/**
* @class phina.geom.Collision
* # 衝突判定用クラス
* 衝突判定のためのクラスです。すべてのメソッドがスタティックメソッドです。
* 
*/
class Collision {

  /**
   * @method testCircleCircle
   * @static
   * 2つの円領域が重なっているかどうかを判定します
   *
   * ### Example
   *     circle1 = phina.geom.Circle(100, 100, 30);
   *     circle2 = phina.geom.Circle(130, 140, 30);
   * phina.geom.Collision.testCircleCircle(circle1, circle2); // => true
   *
   * @param {Circle} circle0 円領域オブジェクト
   * @param {Circle} circle1 円領域オブジェクト
   * @return {Boolean} 領域が重なっているかどうか
   */
  static testCircleCircle(circle0, circle1) {
    var distanceSquared = Vector2.distanceSquared(circle0, circle1);
    return distanceSquared <= Math.pow(circle0.radius + circle1.radius, 2);
  }
  /**
   * @method testRectRect
   * @static
   * 2つの矩形領域が重なっているかどうかを判定します
   *
   * ### Example
   *     rect1 = phina.geom.Rect(100, 100, 30, 40);
   *     rect2 = phina.geom.Rect(200, 200, 10, 10);
   *     phina.geom.Collision.testRectRect(rect1, rect2); // => false
   *
   * @param {Rect} rect0 矩形領域オブジェクト
   * @param {Rect} rect1 矩形領域オブジェクト
   * @return {Boolean} 領域が重なっているかどうか
   */
  static testRectRect(rect0, rect1) {
    return (rect0.left < rect1.right) && (rect0.right > rect1.left) &&
      (rect0.top < rect1.bottom) && (rect0.bottom > rect1.top);
  }
  /**
   * @method testCircleRect
   * @static
   * 円領域と矩形領域が重なっているかどうかかを判定します
   *
   * ### Example
   *     circle = phina.geom.Circle(100, 100, 30);
   *     rect = phina.geom.Rect(100, 100, 30, 40);
   *     phina.geom.Collision.testCircleRect(circle, rect); // => true
   *
   * @param {Circle} circle 円領域オブジェクト
   * @param {Rect} rect 矩形領域オブジェクト
   * @return {Boolean} 領域が重なっているかどうか
   */
  static testCircleRect(circle, rect) {
    // まずは大きな矩形で判定(高速化)
    var bigRect = new Rect(rect.left-circle.radius, rect.top-circle.radius, rect.width+circle.radius*2, rect.height+circle.radius*2);
    if (bigRect.contains(circle.x, circle.y) === false) {
      return false;
    }
    
    // 2種類の矩形と衝突判定
    var r = new Rect(rect.left-circle.radius, rect.top, rect.width+circle.radius*2, rect.height);
    if (r.contains(circle.x, circle.y)) {
      return true;
    }
    r.set(rect.left, rect.top-circle.radius, rect.width, rect.height+circle.radius*2);
    if (r.contains(circle.x, circle.y)) {
      return true;
    }
    
    // 円と矩形の４点の判定
    var c = new Circle(circle.x, circle.y, circle.radius);
    // left top
    if (c.contains(rect.left, rect.top)) {
      return true;
    }
    // right top
    if (c.contains(rect.right, rect.top)) {
      return true;
    }
    // right bottom
    if (c.contains(rect.right, rect.bottom)) {
      return true;
    }
    // left bottom
    if (c.contains(rect.left, rect.bottom)) {
      return true;
    }
    
    return false;
  }
  /**
   * @method testCircleLine
   * @static
   * 円領域と線分が重なっているかどうかを判定します
   *
   * ### Example
   *     circle = phina.geom.Circle(100, 100, 20);
   *     p1 = phina.geom.Vector2(0, 0);
   *     p2 = phina.geom.Vector2(300, 400);
   *     phina.geom.Collision.testCircleLine(circle, p1, p2); // => true
   *
   * @param {Circle} circle 円領域オブジェクト
   * @param {import("./vector2").PrimitiveVector2} p1 線分の端の座標
   * @param {import("./vector2").PrimitiveVector2} p2 線分の端の座標
   * @return {Boolean} 円領域と線分が重なっているかどうか
   */
  static testCircleLine (circle, p1, p2) {
    // 先に線分端との判定
    if (circle.contains(p1.x, p1.y) || circle.contains(p2.x, p2.y)) return true;
    // 半径の2乗
    var r2 = circle.radius * circle.radius;
    // 円の中心座標
    var p3 = new Vector2(circle.x, circle.y);
    // 各ベクトル
    var p1p2 = Vector2.sub(p1, p2);
    var p1p3 = Vector2.sub(p1, p3);
    var p2p3 = Vector2.sub(p2, p3);
    // 外積
    var cross = Vector2.cross(p1p2, p1p3);
    // 外積の絶対値の2乗
    var cross2 = cross * cross;
    // p1p2の長さの2乗
    var length2 = p1p2.lengthSquared();
    // 円の中心から線分までの垂線の距離の2乗
    var d2 = cross2 / length2;
    // 円の半径の2乗より小さいなら重複
    if (d2 <= r2) {
      var dot1 = Vector2.dot(p1p3, p1p2);
      var dot2 = Vector2.dot(p2p3, p1p2);
      // 通常は内積の乗算
      if (dot1 * dot2 <= 0) return true;
    }
    return false;
  }
  /**
   * @method testLineLine
   * @static
   * 2つの線分が重なっているかどうかを判定します
   * 参考：http://www5d.biglobe.ne.jp/~tomoya03/shtml/algorithm/Intersection.htm
   *
   * ### Example
   *     p1 = phina.geom.Vector2(100, 100);
   *     p2 = phina.geom.Vector2(200, 200);
   *     p3 = phina.geom.Vector2(150, 240);
   *     p4 = phina.geom.Vector2(200, 100);
   * phina.geom.Collision.testLineLine(p1, p2, p3, p4); // => true
   *
   * @param {import("./vector2").PrimitiveVector2} p1 線分1の端の座標
   * @param {import("./vector2").PrimitiveVector2} p2 線分1の端の座標
   * @param {import("./vector2").PrimitiveVector2} p3 線分2の端の座標
   * @param {import("./vector2").PrimitiveVector2} p4 線分2の端の座標
   * @return {Boolean} 線分1と線分2が重なっているかどうか
   */
  static testLineLine (p1, p2, p3, p4) {
    //同一ＸＹ軸上に乗ってる場合の誤判定回避
    if (p1.x == p2.x && p1.x == p3.x && p1.x == p4.x) {
      var min = Math.min(p1.y, p2.y);
      var max = Math.max(p1.y, p2.y);
      if (min <= p3.y && p3.y <= max || min <= p4.y && p4.y <= max) return true;
      return false;
    }
    if (p1.y == p2.y && p1.y == p3.y && p1.y == p4.y) {
      var min = Math.min(p1.x, p2.x);
      var max = Math.max(p1.x, p2.x);
      if (min <= p3.x && p3.x <= max || min <= p4.x && p4.x <= max) return true;
      return false;
    }
    //通常判定
    var a = (p1.x - p2.x) * (p3.y - p1.y) + (p1.y - p2.y) * (p1.x - p3.x);
    var b = (p1.x - p2.x) * (p4.y - p1.y) + (p1.y - p2.y) * (p1.x - p4.x);
    var c = (p3.x - p4.x) * (p1.y - p3.y) + (p3.y - p4.y) * (p3.x - p1.x);
    var d = (p3.x - p4.x) * (p2.y - p3.y) + (p3.y - p4.y) * (p3.x - p2.x);
    return a * b <= 0 && c * d <= 0;
  }
  /**
   * @method testRectLine
   * @static
   * 矩形と線分が重なっているかどうかを判定します
   *
   * ### Example
   *     rect = phina.geom.Rect(120, 130, 40, 50);
   *     p1 = phina.geom.Vector2(100, 100);
   *     p2 = phina.geom.Vector2(200, 200);
   * phina.geom.Collision.testRectLine(rect, p1, p2); // => true
   *
   * @param {Rect} rect 矩形領域オブジェクト
   * @param {import("./vector2").PrimitiveVector2} p1 線分の端の座標
   * @param {import("./vector2").PrimitiveVector2} p2 線分の端の座標
   * @return {Boolean} 矩形と線分が重なっているかどうか
   */
  static testRectLine (rect, p1, p2) {
      //包含判定(p1が含まれてれば良いのでp2の判定はしない）
      if (rect.left <= p1.x && p1.x <= rect.right && rect.top <= p1.y && p1.y <= rect.bottom ) return true;

      //矩形の４点
      var r1 = new Vector2(rect.left, rect.top);     //左上
      var r2 = new Vector2(rect.right, rect.top);    //右上
      var r3 = new Vector2(rect.right, rect.bottom); //右下
      var r4 = new Vector2(rect.left, rect.bottom);  //左下

      //矩形の４辺をなす線分との接触判定
      if (Collision.testLineLine(p1, p2, r1, r2)) return true;
      if (Collision.testLineLine(p1, p2, r2, r3)) return true;
      if (Collision.testLineLine(p1, p2, r3, r4)) return true;
      if (Collision.testLineLine(p1, p2, r1, r4)) return true;
      return false;
  }

}

/**
 * @class phina.geom.Vector3
 * # 3次元ベクトルクラス（未実装）
 * 3次元のベクトルや座標を表すクラスです。
 */
class Vector3 {

  /**
   * @param {number} [x=0]
   * @param {number} [y=0]
   * @param {number} [z=0]
   */
  constructor(x, y, z) {
    /**
     * x座標
     * @type {number}
     */
    this.x = x || 0;

    /**
     * y座標
     * @type {number}
     */
    this.y = y || 0;

    /**
     * z座標
     * @type {number}
     */
    this.z = z || 0;

    /**
     * z軸回転角度
     */
    this.alpha = 0;

    /**
     * x軸回転角度
     */
    this.beta = 0;

    /**
     * y軸回転角度
     */
    this.gamma = 0;
  }

}

/**
 * Canvasのfillstyle/strokeStyleの値として使用できる型。文字列の場合、CSS colorデータ型に準拠するもの
 * @typedef {string | CanvasGradient | CanvasPattern} CanvasStyle
 */

/**
 * @class phina.graphics.Canvas
 * キャンバス拡張クラス
 */
class Canvas {

  /**
   * @param {string | HTMLCanvasElement} [canvas] ベースとなるcanvas要素。文字列で指定するときは`#phina`のようにセレクタ形式にする。指定しなかった場合は新規作成される
   */
  constructor(canvas) {
    /** @type HTMLCanvasElement */
    this.canvas;
    if (typeof canvas === 'string') {
      this.canvas = document.querySelector(canvas);
    } else {
      this.canvas = canvas || document.createElement('canvas');
    }

    /** @type HTMLCanvasElement */
    this.domElement = this.canvas;

    /** @type CanvasRenderingContext2D */
    this.context = this.canvas.getContext('2d');
    this.context.lineCap = 'round';
    this.context.lineJoin = 'round';
  }

  /**
   * サイズをセット
   * @param {number} width
   * @param {number} height
   * @returns {this}
   */
  setSize(width, height) {
    this.canvas.width   = width;
    this.canvas.height  = height;
    return this;
  }

  /**
   * サイズを画面（ウィンドウサイズ）に合わせてリセット
   * @returns {this}
   */
  setSizeToScreen() {
    this.canvas.style.position  = "fixed";
    this.canvas.style.margin    = "0px";
    this.canvas.style.padding   = "0px";
    this.canvas.style.left      = "0px";
    this.canvas.style.top       = "0px";
    return this.setSize(window.innerWidth, window.innerHeight);
  }

  /**
   * 比率を維持しながらサイズを画面（ウィンドウサイズ）に合わせる
   * @param {boolean} [isEver=true] ウィンドウリサイズで変更が必要になるたびにリサイズ処理をするかどうか
   * @returns {void}
   */
  fitScreen(isEver) {
    isEver = isEver === undefined ? true : isEver;

    var _fitFunc = function() {
      var e = this.domElement;
      var s = e.style;
      
      s.position = "absolute";
      s.margin = "auto";
      s.left = "0px";
      s.top  = "0px";
      s.bottom = "0px";
      s.right = "0px";

      var rateWidth = e.width/window.innerWidth;
      var rateHeight= e.height/window.innerHeight;
      var rate = e.height/e.width;
      
      if (rateWidth > rateHeight) {
        s.width  = Math.floor(innerWidth)+"px";
        s.height = Math.floor(innerWidth*rate)+"px";
      }
      else {
        s.width  = Math.floor(innerHeight/rate)+"px";
        s.height = Math.floor(innerHeight)+"px";
      }
    }.bind(this);
    
    // 一度実行しておく
    _fitFunc();

    // リサイズ時のリスナとして登録しておく
    if (isEver) {
      phina.global.addEventListener("resize", _fitFunc, false);
    }
  }

  /**
   * クリア
   * @param {number} [x=0]
   * @param {number} [y=0]
   * @param {number} [width]
   * @param {number} [height]
   * @returns {this}
   */
  clear(x, y, width, height) {
    x = x || 0;
    y = y || 0;
    width = width || this.width;
    height= height|| this.height;
    this.context.clearRect(x, y, width, height);
    return this;
  }

  /**
   * @param {CanvasStyle} fillStyle
   * @param {number} [x]
   * @param {number} [y]
   * @param {number} [width]
   * @param {number} [height]
   * @returns {this}
   */
  clearColor(fillStyle, x, y, width, height) {
    x = x || 0;
    y = y || 0;
    width = width || this.width;
    height= height|| this.height;

    var context = this.context;

    context.save();
    context.setTransform(1.0, 0.0, 0.0, 1.0, 0.0, 0.0); // 行列初期化
    context.fillStyle = fillStyle;     // 塗りつぶしスタイルセット
    context.fillRect(x, y, width, height);
    context.restore();

    return this;
  }


  /**
   * パスを開始(リセット)
   * @returns {this}
   */
  beginPath() {
    this.context.beginPath();
    return this;
  }

  /**
   * パスを閉じる
   * @returns {this}
   */
  closePath() {
    this.context.closePath();
    return this;
  }


  /**
   * 新規パス生成
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  moveTo(x, y) {
    this.context.moveTo(x, y);
    return this;
  }

  /**
   * パスに追加
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  lineTo(x, y) {
    this.context.lineTo(x, y);
    return this;
  }

  /**
   * 
   * @returns {this}
   */
  quadraticCurveTo() {
    this.context.quadraticCurveTo.apply(this.context, arguments);
    return this;
  }

  /**
   * 
   * @returns {this}
   */
  bezierCurveTo() {
    this.context.bezierCurveTo.apply(this.context, arguments);
    return this;
  }

  /**
   * パス内を塗りつぶす
   * @returns {this}
   */
  fill() {
    this.context.fill();
    return this;
  }

  /**
   * パス上にラインを引く
   * @returns {this}
   */
  stroke() {
    this.context.stroke();
    return this;
  }

  /**
   * クリップ
   * @returns {this}
   */
  clip() {
    this.context.clip();
    return this;
  }

      
  /**
   * 点描画
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  drawPoint(x, y) {
    return this.strokeRect(x, y, 1, 1);
  }

  /**
   * ラインパスを作成
   * @param {number} x0
   * @param {number} y0
   * @param {number} x1
   * @param {number} y1
   * @returns {this}
   */
  line(x0, y0, x1, y1) {
    return this.moveTo(x0, y0).lineTo(x1, y1);
  }
  
  /**
   * ラインを描画
   * @param {number} x0
   * @param {number} y0
   * @param {number} x1
   * @param {number} y1
   * @returns {this}
   */
  drawLine(x0, y0, x1, y1) {
    return this.beginPath().line(x0, y0, x1, y1).stroke();
  }

  /**
   * ダッシュラインを描画
   * @param {number} x0
   * @param {number} y0
   * @param {number} x1
   * @param {number} y1
   * @param {string|number} pattern
   * @returns {this}
   */
  drawDashLine(x0, y0, x1, y1, pattern) {
    var patternTable = null;
    if (typeof(pattern) == "string") {
      patternTable = pattern;
    }
    else {
      pattern = pattern || 0xf0f0;
      patternTable = pattern.toString(2);
    }
    // patternTable = patternTable.padding(16, '1');
    patternTable = padding.call(patternTable, 16, '1');
    
    var vx = x1-x0;
    var vy = y1-y0;
    var len = Math.sqrt(vx*vx + vy*vy);
    vx/=len; vy/=len;
    
    var x = x0;
    var y = y0;
    for (var i=0; i<len; ++i) {
      if (patternTable[i%16] == '1') {
        this.drawPoint(x, y);
        // this.fillRect(x, y, this.context.lineWidth, this.context.lineWidth);
      }
      x += vx;
      y += vy;
    }
    
    return this;
  }

  /**
   * v0(x0, y0), v1(x1, y1) から角度を求めて矢印を描画
   * http://hakuhin.jp/as/rotation.html
   * @param {number} x0
   * @param {number} y0
   * @param {number} x1
   * @param {number} y1
   * @param {number} arrowRadius
   * @returns {this}
   */
  drawArrow(x0, y0, x1, y1, arrowRadius) {
    var vx = x1-x0;
    var vy = y1-y0;
    var angle = Math.atan2(vy, vx)*180/Math.PI;
    
    this.drawLine(x0, y0, x1, y1);
    this.fillPolygon(x1, y1, arrowRadius || 5, 3, angle);
    
    return this;
  }


  /**
   * lines
   * @returns {this}
   */
  lines() {
    this.moveTo(arguments[0], arguments[1]);
    for (var i=1,len=arguments.length/2; i<len; ++i) {
      this.lineTo(arguments[i*2], arguments[i*2+1]);
    }
    return this;
  }

  /**
   * ラインストローク描画
   * @returns {this}
   */
  strokeLines() {
    this.beginPath();
    this.lines.apply(this, arguments);
    this.stroke();
    return this;
  }

  /**
   * ライン塗りつぶし描画
   * @returns {this}
   */
  fillLines() {
    this.beginPath();
    this.lines.apply(this, arguments);
    this.fill();
    return this;
  }
  
  /**
   * 四角形パスを作成する
   * @param {number} _x
   * @param {number} _y
   * @param {number} _width
   * @param {number} _height
   * @returns {this}
   */
  rect(_x, _y, _width, _height) {
    this.context.rect.apply(this.context, arguments);
    return this;
  }
  
  /**
   * 四角形塗りつぶし描画
   * @returns {this}
   */
  fillRect() {
    this.context.fillRect.apply(this.context, arguments);
    return this;
  }
  
  /**
   * 四角形ライン描画
   * @returns {this}
   */
  strokeRect() {
    this.context.strokeRect.apply(this.context, arguments);
    return this;
  }
  
  /**
   * 角丸四角形パス
   * @param {number} x
   * @param {number} y
   * @param {number} width
   * @param {number} height
   * @param {number} radius
   * @returns {this}
   */
  roundRect(x, y, width, height, radius) {
    var l = x + radius;
    var r = x + width - radius;
    var t = y + radius;
    var b = y + height - radius;
    
    /*
    var ctx = this.context;
    ctx.moveTo(l, y);
    ctx.lineTo(r, y);
    ctx.quadraticCurveTo(x+width, y, x+width, t);
    ctx.lineTo(x+width, b);
    ctx.quadraticCurveTo(x+width, y+height, r, y+height);
    ctx.lineTo(l, y+height);
    ctx.quadraticCurveTo(x, y+height, x, b);
    ctx.lineTo(x, t);
    ctx.quadraticCurveTo(x, y, l, y);
    /**/
    
    this.context.arc(l, t, radius,     -Math.PI, -Math.PI*0.5, false);  // 左上
    this.context.arc(r, t, radius, -Math.PI*0.5,            0, false);  // 右上
    this.context.arc(r, b, radius,            0,  Math.PI*0.5, false);  // 右下
    this.context.arc(l, b, radius,  Math.PI*0.5,      Math.PI, false);  // 左下
    this.closePath();
    
    return this;
  }

  /**
   * 角丸四角形塗りつぶし
   * @param {number} x
   * @param {number} y
   * @param {number} width
   * @param {number} height
   * @param {number} radius
   * @returns {this}
   */
  fillRoundRect(x, y, width, height, radius) {
    return this.beginPath().roundRect(x, y, width, height, radius).fill();
  }

  /**
   * 角丸四角形ストローク描画
   * @param {number} x
   * @param {number} y
   * @param {number} width
   * @param {number} height
   * @param {number} radius
   * @returns {this}
   */
  strokeRoundRect(x, y, width, height, radius) {
    return this.beginPath().roundRect(x, y, width, height, radius).stroke();
  }

  /**
   * 円のパスを設定
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @returns {this}
   */
  circle(x, y, radius) {
    this.context.arc(x, y, radius, 0, Math.PI*2, false);
    return this;
  }
  
  /**
   * 塗りつぶし円を描画
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @returns {this}
   */
  fillCircle(x, y, radius) {
    var c = this.context;
    c.beginPath();
    c.arc(x, y, radius, 0, Math.PI*2, false);
    c.closePath();
    c.fill();
    return this;
  }
  
  /**
   * ストローク円を描画
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @returns {this}
   */
  strokeCircle(x, y, radius) {
    var c = this.context;
    c.beginPath();
    c.arc(x, y, radius, 0, Math.PI*2, false);
    c.closePath();
    c.stroke();
    return this;
  }

  /**
   * 円弧のパスを設定
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} startAngle
   * @param {number} endAngle
   * @param {boolean} [anticlockwise]
   * @returns {this}
   */
  arc(x, y, radius, startAngle, endAngle, anticlockwise) {
    this.context.arc(x, y, radius, startAngle, endAngle, anticlockwise);
    return this;
  }
  
  /**
   * 塗りつぶし円弧を描画
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} startAngle
   * @param {number} endAngle
   * @param {boolean} [anticlockwise]
   * @returns {this}
   */
  fillArc(x, y, radius, startAngle, endAngle, anticlockwise) {
    return this.beginPath().arc(x, y, radius, startAngle, endAngle, anticlockwise).fill();
  }
  
  /**
   * ストローク円弧を描画
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} startAngle
   * @param {number} endAngle
   * @param {boolean} [anticlockwise]
   * @returns {this}
   */
  strokeArc(x, y, radius, startAngle, endAngle, anticlockwise) {
    return this.beginPath().arc(x, y, radius, startAngle, endAngle, anticlockwise).stroke();
  }


  /**
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} startAngle
   * @param {number} endAngle
   * @param {boolean} [anticlockwise]
   * @returns {this}
   */
  pie(x, y, radius, startAngle, endAngle, anticlockwise) {
    var context = this.context;
    context.beginPath();
    context.moveTo(0, 0);
    context.arc(x, y, radius, startAngle, endAngle, anticlockwise);
    context.closePath();
    return this;
  }

  /**
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} startAngle
   * @param {number} endAngle
   * @param {boolean} [anticlockwise]
   * @returns {this}
   */
  fillPie(x, y, radius, startAngle, endAngle, anticlockwise) {
    return this.beginPath().pie(x, y, radius, startAngle, endAngle, anticlockwise).fill();
  }

  /**
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} startAngle
   * @param {number} endAngle
   * @param {boolean} [anticlockwise]
   * @returns {this}
   */
  strokePie(x, y, radius, startAngle, endAngle, anticlockwise) {
    return this.beginPath().pie(x, y, radius, startAngle, endAngle, anticlockwise).stroke();
  }

  
  /**
   * ポリゴンパス
   * @param {number} x
   * @param {number} y
   * @param {number} size
   * @param {number} sides
   * @param {number} [offsetAngle]
   * @returns {this}
   */
  polygon(x, y, size, sides, offsetAngle) {
    var radDiv = (Math.PI*2)/sides;
    var radOffset = (offsetAngle!==undefined) ? offsetAngle*Math.PI/180 : -Math.PI/2;
    
    this.moveTo(x + Math.cos(radOffset)*size, y + Math.sin(radOffset)*size);
    for (var i=1; i<sides; ++i) {
      var rad = radDiv*i+radOffset;
      this.lineTo(
        x + Math.cos(rad)*size,
        y + Math.sin(rad)*size
      );
    }
    this.closePath();
    return this;
  }

  /**
   * ポリゴン塗りつぶし
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} sides
   * @param {number} [offsetAngle]
   * @returns {this}
   */
  fillPolygon(x, y, radius, sides, offsetAngle) {
    return this.beginPath().polygon(x, y, radius, sides, offsetAngle).fill();
  }

  /**
   * ポリゴンストローク描画
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} sides
   * @param {number} [offsetAngle]
   * @returns {this}
   */
  strokePolygon(x, y, radius, sides, offsetAngle) {
    return this.beginPath().polygon(x, y, radius, sides, offsetAngle).stroke();
  }
  
  /**
   * star
   * @param {number} [x=0]
   * @param {number} [y=0]
   * @param {number} [radius=64]
   * @param {number} [sides=5]
   * @param {any} [sideIndent=0.38]
   * @param {number} [offsetAngle]
   */
  star(x, y, radius, sides, sideIndent, offsetAngle) {
    x = x || 0;
    y = y || 0;
    radius = radius || 64;
    sides = sides || 5;
    var sideIndentRadius = radius * (sideIndent || 0.38);
    var radOffset = (offsetAngle) ? offsetAngle*Math.PI/180 : -Math.PI/2;
    var radDiv = (Math.PI*2)/sides/2;

    this.moveTo(
      x + Math.cos(radOffset)*radius,
      y + Math.sin(radOffset)*radius
    );
    for (var i=1; i<sides*2; ++i) {
      var rad = radDiv*i + radOffset;
      var len = (i%2) ? sideIndentRadius : radius;
      this.lineTo(
        x + Math.cos(rad)*len,
        y + Math.sin(rad)*len
      );
    }
    this.closePath();

    return this;
  }

  /**
   * 星を塗りつぶし描画
   * @param {number} [x]
   * @param {number} [y]
   * @param {number} [radius]
   * @param {number} [sides]
   * @param {any} [sideIndent]
   * @param {number} [offsetAngle]
   * @returns {this}
   */
  fillStar(x, y, radius, sides, sideIndent, offsetAngle) {
    this.beginPath().star(x, y, radius, sides, sideIndent, offsetAngle).fill();
    return this;
  }

  /**
   * 星をストローク描画
   * @param {number} [x]
   * @param {number} [y]
   * @param {number} [radius]
   * @param {number} [sides]
   * @param {any} [sideIndent]
   * @param {number} [offsetAngle]
   * @returns {this}
   */
  strokeStar(x, y, radius, sides, sideIndent, offsetAngle) {
    this.beginPath().star(x, y, radius, sides, sideIndent, offsetAngle).stroke();
    return this;
  }

  /**
   * heart
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} angle
   * @returns {this}
   */
  heart(x, y, radius, angle) {
    var half_radius = radius*0.5;
    // var rad = (angle === undefined) ? Math.PI/4 : Math.degToRad(angle);
    var rad = (angle === undefined) ? Math.PI/4 : degToRad(angle);

    // 半径 half_radius の角度 angle 上の点との接線を求める
    var p = Math.cos(rad)*half_radius;
    var q = Math.sin(rad)*half_radius;

    // 円の接線の方程式 px + qy = r^2 より y = (r^2-px)/q
    var x2 = -half_radius;
    var y2 = (half_radius*half_radius-p*x2)/q;

    // 中心位置調整
    var height = y2 + half_radius;
    var offsetY = half_radius-height/2;

    // パスをセット
    this.moveTo(0+x, y2+y+offsetY);

    this.arc(-half_radius+x, 0+y+offsetY, half_radius, Math.PI-rad, Math.PI*2);
    this.arc(half_radius+x, 0+y+offsetY, half_radius, Math.PI, rad);
    this.closePath();

    return this;
  }

  /**
   * fill heart
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} angle
   * @returns {this}
   */
  fillHeart(x, y, radius, angle) {
    return this.beginPath().heart(x, y, radius, angle).fill();
  }

  /**
   * stroke heart
   * @param {number} x
   * @param {number} y
   * @param {number} radius
   * @param {number} angle
   * @returns {this}
   */
  strokeHeart(x, y, radius, angle) {
    return this.beginPath().heart(x, y, radius, angle).stroke();
  }

 /**
  * http://stackoverflow.com/questions/14169234/the-relation-of-the-bezier-curve-and-ellipse
  * @param {number} x
  * @param {number} y
  * @param {number} w
  * @param {number} h
  * @returns {this}
  */
  ellipse(x, y, w, h) {
    var ctx = this.context;
    var kappa = 0.5522848;

    var ox = (w / 2) * kappa; // control point offset horizontal
    var oy = (h / 2) * kappa; // control point offset vertical
    var xe = x + w;           // x-end
    var ye = y + h;           // y-end
    var xm = x + w / 2;       // x-middle
    var ym = y + h / 2;       // y-middle

    ctx.moveTo(x, ym);
    ctx.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);
    ctx.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);
    ctx.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);
    ctx.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);
    // ctx.closePath();

    return this;
  }

  /**
   * @param {number} x
   * @param {number} y
   * @param {number} width
   * @param {number} height
   * @returns {this}
   */
  fillEllipse(x, y, width, height) {
    return this.beginPath().ellipse(x, y, width, height).fill();
  }

  /**
   * @param {number} x
   * @param {number} y
   * @param {number} width
   * @param {number} height
   * @returns {this}
   */
  strokeEllipse(x, y, width, height) {
    return this.beginPath().ellipse(x, y, width, height).stroke();
  }

  /**
   * 
   * @returns {this}
   */
  fillText() {
    this.context.fillText.apply(this.context, arguments);
    return this;
  }

  /**
   * 
   * @returns {this}
   */
  strokeText() {
    this.context.strokeText.apply(this.context, arguments);
    return this;
  }

  /**
   * 画像を描画
   * @returns {void} this返し忘れ？
   */
  drawImage() {
    this.context.drawImage.apply(this.context, arguments);
  }

  /**
   * 行列をセット
   * @param {number} m11
   * @param {number} m12
   * @param {number} m21
   * @param {number} m22
   * @param {number} dx
   * @param {number} dy
   * @returns {this}
   */
  setTransform(m11, m12, m21, m22, dx, dy) {
    this.context.setTransform(m11, m12, m21, m22, dx, dy);
    return this;
  }

  /**
   * 行列をリセット
   * @returns {this}
   */
  resetTransform() {
    this.setTransform(1.0, 0.0, 0.0, 1.0, 0.0, 0.0);
    return this;
  }
  /**
   * 中心に移動
   * @returns {this}
   */
  transformCenter() {
    this.context.setTransform(1, 0, 0, 1, this.width/2, this.height/2);
    return this;
  }

  /**
   * 移動
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  translate(x, y) {
    this.context.translate(x, y);
    return this;
  }
  
  /**
   * 回転
   * @param {number} rotation
   * @returns {this}
   */
  rotate(rotation) {
    this.context.rotate(rotation);
    return this;
  }
  
  /**
   * スケール
   * @param {number} scaleX
   * @param {number} scaleY
   * @returns {this}
   */
  scale(scaleX, scaleY) {
    this.context.scale(scaleX, scaleY);
    return this;
  }

  /**
   * 状態を保存
   * @returns {this}
   */
  save() {
    this.context.save();
    return this;
  }

  /**
   * 状態を復元
   * @returns {this}
   */
  restore() {
    this.context.restore();
    return this;
  }

  /**
   * 画像として保存
   * @param {string} [mime_type="image/png"]
   * @returns {void}
   */
  saveAsImage(mime_type) {
    mime_type = mime_type || "image/png";
    var data_url = this.canvas.toDataURL(mime_type);
    // data_url = data_url.replace(mime_type, "image/octet-stream");
    window.open(data_url, "save");
    
    // toDataURL を使えば下記のようなツールが作れるかも!!
    // TODO: プログラムで絵をかいて保存できるツール
  }

  /**
   * 幅
   */
  get width()   { return this.canvas.width; }
  set width(v)  { this.canvas.width = v; }

  /**
   * 高さ
   */
  get height()   { return this.canvas.height; }
  set height(v)  { this.canvas.height = v; }

  get fillStyle()   { return this.context.fillStyle; }
  set fillStyle(v)  { this.context.fillStyle = v; }

  get strokeStyle()   { return this.context.strokeStyle; }
  set strokeStyle(v)  { this.context.strokeStyle = v; }

  get globalAlpha()   { return this.context.globalAlpha; }
  set globalAlpha(v)  { this.context.globalAlpha = v; }

  get globalCompositeOperation()   { return this.context.globalCompositeOperation; }
  set globalCompositeOperation(v)  { this.context.globalCompositeOperation = v; }

  get shadowBlur()   { return this.context.shadowBlur; }
  set shadowBlur(v)  { this.context.shadowBlur = v; }

  get shadowColor()   { return this.context.shadowColor; }
  set shadowColor(v)  { this.context.shadowColor = v; }

  get shadowOffsetX()   { return this.context.shadowOffsetX; }
  set shadowOffsetX(v)  { this.context.shadowOffsetX = v; }

  get shadowOffsetY()   { return this.context.shadowOffsetY; }
  set shadowOffsetY(v)  { this.context.shadowOffsetY = v; }

  get lineCap()   { return this.context.lineCap; }
  set lineCap(v)  { this.context.lineCap = v; }

  get lineJoin()   { return this.context.lineJoin; }
  set lineJoin(v)  { this.context.lineJoin = v; }

  get miterLimit()   { return this.context.miterLimit; }
  set miterLimit(v)  { this.context.miterLimit = v; }

  get lineWidth()   { return this.context.lineWidth; }
  set lineWidth(v)  { this.context.lineWidth = v; }

  get font()   { return this.context.font; }
  set font(v)  { this.context.font = v; }

  get textAlign()   { return this.context.textAlign; }
  set textAlign(v)  { this.context.textAlign = v; }

  get textBaseline()   { return this.context.textBaseline; }
  set textBaseline(v)  { this.context.textBaseline = v; }

  get imageSmoothingEnabled()   { return this.context.imageSmoothingEnabled; }
  set imageSmoothingEnabled(v)  {
    this.context.imageSmoothingEnabled = v;
    this.context['webkitImageSmoothingEnabled'] = v;
    this.context['mozImageSmoothingEnabled'] = v;
  }

  /**
   * テキストの長さを計測
   * @param {string} font
   * @param {string} text
   * @returns {TextMetrics}
   */
  static measureText(font, text) {
    this._context.font = font;
    return this._context.measureText(text);
  }

  /**
   * 線形グラデーションを生成
   * @returns {CanvasGradient}
   */
  static createLinearGradient() {
    return this._context.createLinearGradient.apply(this._context, arguments);
  }

  /**
   * 円形グラデーションを生成
   * @returns {CanvasGradient}
   */
  static createRadialGradient() {
    return this._context.createRadialGradient.apply(this._context, arguments);
  }

}

/**
 * デフォルトのプライベートCanvasコンテキスト  
 * Staticメソッド用
 */
Canvas._context = (function() {
  if (Support.canvas) {
    return document.createElement('canvas').getContext('2d');
  }
  else {
    return null;
  }
})();

// import { first, last, clear } from "../core/array"

/**
 * @class phina.input.Input
 * _extends phina.util.EventDispatcher
 */
class Input extends EventDispatcher {

  /**
   * @constructor
   * @param {HTMLCanvasElement | HTMLDocument} domElement KeyBoardサブクラスではHTMLDocument、それ以外のサブクラスではHTMLCanvasElement
   */
  constructor(domElement) {
    super();

    this.domElement = domElement || window.document;

    this.position = new Vector2(0, 0);
    this.startPosition = new Vector2(0, 0);
    this.deltaPosition = new Vector2(0, 0);
    this.prevPosition = new Vector2(0, 0);
    this._tempPosition = new Vector2(0, 0);

    this.maxCacheNum = Input.defaults.maxCacheNum;
    this.minDistance = Input.defaults.minDistance;
    this.maxDistance = Input.defaults.maxDistance;
    this.cachePositions = [];
    this.flickVelocity = new Vector2(0, 0);

    this.flags = 0;
    
    /**
     * KeyBoardクラス拡張時の型エラー対策のためunion型とするが、本クラスではnumberとして使用
     * @type {number | {[k: string]: number}}
     */
    this.last;
  }

  /**
   * 更新
   * @returns {void}
   */
  update() {
    this.last = this.now;
    this.now = this.flags;
    this.start = (this.now ^ this.last) & this.now;
    this.end   = (this.now ^ this.last) & this.last;

    // 変化値を更新
    this.deltaPosition.x = this._tempPosition.x - this.position.x;
    this.deltaPosition.y = this._tempPosition.y - this.position.y;

    if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) {
      this._moveFlag = false;
    }
    else {
      this._moveFlag = true;
    }

    if (this.start) {
      this.startPosition.set(this.position.x, this.position.y);
    }

    // 前回の座標を更新
    this.prevPosition.set(this.position.x, this.position.y);

    // 現在の位置を更新
    this.position.set(this._tempPosition.x, this._tempPosition.y);

    if (this.cachePositions.length > this.maxCacheNum) {
      this.cachePositions.shift();
    }
    this.cachePositions.push(this.position.clone());
  }

  /**
   * @param {number} x
   * @param {number} y
   * @param {number} [flag=1] デフォルトは1(true)
   * @returns {void}
   */
  _start(x, y, flag) {
    flag = (flag !== undefined) ? flag : 1;
    // console.log('start', x, y);
    this._move(x, y);

    this.flags |= flag;

    x = this._tempPosition.x;
    y = this._tempPosition.y;
    this.position.set(x, y);
    this.prevPosition.set(x, y);

    this.flickVelocity.set(0, 0);
    // this.cachePositions.clear();
    this.cachePositions.length = 0;
  }

  /**
   * @param {number} [flag=1]
   * @returns {void}
   */
  _end(flag) {
    flag = (flag !== undefined) ? flag : 1;
    this.flags &= ~(flag);

    if (this.cachePositions.length < 2) return;

    // var first = this.cachePositions.first;
    // var last = this.cachePositions.last;
    var first = this.cachePositions[0];
    var last = this.cachePositions[this.cachePositions.length-1];

    var v = Vector2.sub(last, first);

    var len = v.length();

    if (len > this.minDistance) {
      // var normalLen = len.clamp(this.minDistance, this.maxDistance);
      var normalLen = clamp(len, this.minDistance, this.maxDistance);
      v.div(len).mul(normalLen);
      this.flickVelocity.set(v.x, v.y);
    }

    // this.cachePositions.clear();
    this.cachePositions.length = 0;
  }

  /**
   * スケールを考慮して位置を移動
   * @param {number} x
   * @param {number} y
   * @returns {void}
   */
  _move(x, y) {
    this._tempPosition.x = x;
    this._tempPosition.y = y;

    // adjust scale
    var elm = /** @type {HTMLCanvasElement} */(this.domElement);
    var rect = elm.getBoundingClientRect();
    if (rect.width) {
      this._tempPosition.x *= elm.width / rect.width;
    }
    if (rect.height) {
      this._tempPosition.y *= elm.height / rect.height;
    }
  }

  /**
   * @property    x
   * x座標値
   */
  get x() { return this.position.x; }
  set x(v) { this.position.x = v; }

  /**
   * @property    y
   * y座標値
   */
  get y() { return this.position.y; }
  set y(v) { this.position.y = v; }

  /**
   * @property    dx
   * dx値
   */
  get dx() { return this.deltaPosition.x; }
  set dx(v) { this.deltaPosition.x = v; }

  /**
   * @property    dy
   * dy値
   */
  get dy() { return this.deltaPosition.y; }
  set dy(v) { this.deltaPosition.y = v; }

  /**
   * @property    fx
   * fx値
   */
  get fx() { return this.flickVelocity.x; }
  set fx(v) { this.flickVelocity.x = v; }

  /**
   * @property    fy
   * fy値
   */
  get fy() { return this.flickVelocity.y; }
  set fy(v) { this.flickVelocity.y = v; }

}

Input.defaults = {
  maxCacheNum: 3,
  minDistance: 10,
  maxDistance: 100,
};

/**
 * @class phina.input.Keyboard
 * _extends phina.input.Input
 */
class Keyboard extends Input {

  /**
   * @constructor
   * @param {Document} domElement
   */
  constructor(domElement) {
    super(domElement);

    /** @type {HTMLDocument} */
    this.domElement;

    /** @type {{[k: number]: boolean}} */
    this.key = {};
    /** @type {{[k: number]: any}} true|false or 1|0 */
    this.press  = {};
    /** @type {{[k: number]: any}} */
    this.down   = {};
    /** @type {{[k: number]: any}} */
    this.up     = {};
    /** @type {{[k: number]: any}} */
    this.last   = {};

    /** @type {number | null} */
    this._keydown = null;
    /** @type {number | null} */
    this._keyup = null;
    /** @type {number | null} */
    this._keypress = null;

    var self = this;
    this.domElement.addEventListener('keydown', function(e) {
      self.key[e.keyCode] = true;
      self._keydown = e.keyCode;
    });

    this.domElement.addEventListener('keyup', function(e) {
      self.key[e.keyCode] = false;
      self._keyup = e.keyCode;
    });
    this.domElement.addEventListener('keypress', function(e) {
      self._keypress = e.keyCode;
    });
  }

  /**
   * 情報更新処理
   * 毎フレーム呼んで下さい.
   * @returns {this}
   */
  update() {
    // TODO: 一括ビット演算で行うよう修正する
    for (var k in this.key) {
      this.last[k]    = this.press[k];
      this.press[k]   = this.key[k];
      
      this.down[k] = (this.press[k] ^ this.last[k]) & this.press[k];
      this.up[k] = (this.press[k] ^ this.last[k]) & this.last[k];
    }

    if (this._keydown) {
      this.flare('keydown', { keyCode: this._keydown });
      this._keydown = null;
    }
    if (this._keyup) {
      this.flare('keyup', { keyCode: this._keyup });
      this._keyup = null;
    }
    if (this._keypress) {
      this.flare('keypress', { keyCode: this._keypress });
      this._keypress = null;
    }
    
    return this;
  }

  /**
   * キーを押しているかをチェック
   * @param   {number|keyof typeof Keyboard.KEY_CODE} key keyCode or keyName
   * @returns {Boolean}   チェック結果
   */
  getKey(key) {
    if (typeof(key) === "string") {
      key = Keyboard.KEY_CODE[key];
    }
    return !!this.press[key] === true;
  }
  
  /**
   * キーを押したかをチェック
   * @param   {number|keyof typeof Keyboard.KEY_CODE} key keyCode or keyName
   * @returns {Boolean}   チェック結果
   */
  getKeyDown(key) {
    if (typeof(key) == "string") {
      key = Keyboard.KEY_CODE[key];
    }
    return this.down[key] == true;
  }
  
  /**
   * キーを離したかをチェック
   * @param   {number|keyof typeof Keyboard.KEY_CODE} key keyCode or keyName
   * @returns {Boolean}   チェック結果
   */
  getKeyUp(key) {
    if (typeof(key) == "string") {
      key = Keyboard.KEY_CODE[key];
    }
    return this.up[key] == true;
  }
  
  /**
   * キーの方向を Angle(Degree) で取得
   * @returns {Boolean}   角度(Degree)
   */
  getKeyAngle() {
    var angle = null;
    var arrowBit =
      // (this.getKey("left")   << 3) | // 1000
      // (this.getKey("up")     << 2) | // 0100
      // (this.getKey("right")  << 1) | // 0010
      // (this.getKey("down"));         // 0001
      (this.getKey("left") ? 1 : 0   << 3) | // 1000
      (this.getKey("up") ? 1 : 0     << 2) | // 0100
      (this.getKey("right") ? 1 : 0  << 1) | // 0010
      (this.getKey("down") ? 1 : 0);         // 0001
    
    if (arrowBit !== 0 && Keyboard.ARROW_BIT_TO_ANGLE_TABLE.hasOwnProperty(arrowBit)) {
      angle = Keyboard.ARROW_BIT_TO_ANGLE_TABLE[arrowBit];
    }
    
    return angle;
  }

  /**
   * キーの押している向きを取得
   * 正規化されている
   * @returns {Vector2}
   */
  getKeyDirection() {
    var direction = new Vector2(0, 0);

    if (this.getKey("left")) {
      direction.x = -1;
    }
    else if (this.getKey("right")) {
      direction.x = 1;
    }
    if (this.getKey("up")) {
      direction.y = -1;
    }
    else if (this.getKey("down")) {
      direction.y = 1;
    }

    if (direction.x && direction.y) {
      direction.div(Math.SQRT2);
    }

    return direction;
  }
  
  /**
   * キーの状態を設定する
   * @param {string | number} key
   * @param {boolean} flag
   * @returns {this}
   */
  setKey(key, flag) {
    if (typeof(key) == "string") {
      key = Keyboard.KEY_CODE[key];
    }
    this.key[key] = flag;
    
    return this;
  }

  /**
   * キーを全て離したことにする
   * @returns {this}
   */
  clearKey() {
    this.key = {};
    
    return this;
  }

}


/**
 * @static
 * @enum {number}
 * 方向のアングル jsduckでは数字をプロパティに指定できない？
 */
Keyboard.ARROW_BIT_TO_ANGLE_TABLE = {
  /* @property 下 */
  0x01: 270,
  /* @property 右 */
  0x02:   0,
  /* @property 上 */
  0x04:  90,
  /* @property 左 */
  0x08: 180,

  /* @property 右上 */
  0x06:  45,
  /* @property 右下 */
  0x03: 315,
  /* @property 左上 */
  0x0c: 135,
  /* @property 左下 */
  0x09: 225,

  // 三方向同時押し対応
  // 想定外の操作だが対応しといたほうが無難
  /* @property 右上左 */
  0x0e:  90,
  /* @property 上左下 */
  0x0d: 180,
  /* @property 左下右 */
  0x0b: 270,
  /* @property 下右上 */
  0x07:   0,
};

/**
 * @static
 * @enum {number}
 * キー番号
 */
Keyboard.KEY_CODE = {
  /* @property */
  "backspace" : 8,
  /* @property */
  "tab"       : 9,
  /* @property */
  "enter"     : 13,
  /* @property */
  "return"    : 13,
  /* @property */
  "shift"     : 16,
  /* @property */
  "ctrl"      : 17,
  /* @property */
  "alt"       : 18,
  /* @property */
  "pause"     : 19,
  /* @property */
  "capslock"  : 20,
  /* @property */
  "escape"    : 27,
  /* @property */
  "pageup"    : 33,
  /* @property */
  "pagedown"  : 34,
  /* @property */
  "end"       : 35,
  /* @property */
  "home"      : 36,
  /* @property */
  "left"      : 37,
  /* @property */
  "up"        : 38,
  /* @property */
  "right"     : 39,
  /* @property */
  "down"      : 40,
  /* @property */
  "insert"    : 45,
  /* @property */
  "delete"    : 46,
  
  /* @property */
  "0" : 48,
  /* @property */
  "1" : 49,
  /* @property */
  "2" : 50,
  /* @property */
  "3" : 51,
  /* @property */
  "4" : 52,
  /* @property */
  "5" : 53,
  /* @property */
  "6" : 54,
  /* @property */
  "7" : 55,
  /* @property */
  "8" : 56,
  /* @property */
  "9" : 57,
  /* @property */
  
  "a" : 65,
  /* @property */
  "A" : 65,
  /* @property */
  "b" : 66,
  /* @property */
  "B" : 66,
  /* @property */
  "c" : 67,
  /* @property */
  "C" : 67,
  /* @property */
  "d" : 68,
  /* @property */
  "D" : 68,
  /* @property */
  "e" : 69,
  /* @property */
  "E" : 69,
  /* @property */
  "f" : 70,
  /* @property */
  "F" : 70,
  /* @property */
  "g" : 71,
  /* @property */
  "G" : 71,
  /* @property */
  "h" : 72,
  /* @property */
  "H" : 72,
  /* @property */
  "i" : 73,
  /* @property */
  "I" : 73,
  /* @property */
  "j" : 74,
  /* @property */
  "J" : 74,
  /* @property */
  "k" : 75,
  /* @property */
  "K" : 75,
  /* @property */
  "l" : 76,
  /* @property */
  "L" : 76,
  /* @property */
  "m" : 77,
  /* @property */
  "M" : 77,
  /* @property */
  "n" : 78,
  /* @property */
  "N" : 78,
  /* @property */
  "o" : 79,
  /* @property */
  "O" : 79,
  /* @property */
  "p" : 80,
  /* @property */
  "P" : 80,
  /* @property */
  "q" : 81,
  /* @property */
  "Q" : 81,
  /* @property */
  "r" : 82,
  /* @property */
  "R" : 82,
  /* @property */
  "s" : 83,
  /* @property */
  "S" : 83,
  /* @property */
  "t" : 84,
  /* @property */
  "T" : 84,
  /* @property */
  "u" : 85,
  /* @property */
  "U" : 85,
  /* @property */
  "v" : 86,
  /* @property */
  "V" : 86,
  /* @property */
  "w" : 87,
  /* @property */
  "W" : 87,
  /* @property */
  "x" : 88,
  /* @property */
  "X" : 88,
  /* @property */
  "y" : 89,
  /* @property */
  "Y" : 89,
  /* @property */
  "z" : 90,
  /* @property */
  "Z" : 90,
  
  /* @property */
  "numpad0" : 96,
  /* @property */
  "numpad1" : 97,
  /* @property */
  "numpad2" : 98,
  /* @property */
  "numpad3" : 99,
  /* @property */
  "numpad4" : 100,
  /* @property */
  "numpad5" : 101,
  /* @property */
  "numpad6" : 102,
  /* @property */
  "numpad7" : 103,
  /* @property */
  "numpad8" : 104,
  /* @property */
  "numpad9" : 105,
  /* @property */
  "multiply"      : 106,
  /* @property */
  "add"           : 107,
  /* @property */
  "subtract"      : 109,
  /* @property */
  "decimalpoint"  : 110,
  /* @property */
  "divide"        : 111,

  /* @property */
  "f1"    : 112,
  /* @property */
  "f2"    : 113,
  /* @property */
  "f3"    : 114,
  /* @property */
  "f4"    : 115,
  /* @property */
  "f5"    : 116,
  /* @property */
  "f6"    : 117,
  /* @property */
  "f7"    : 118,
  /* @property */
  "f8"    : 119,
  /* @property */
  "f9"    : 120,
  /* @property */
  "f10"   : 121,
  /* @property */
  "f11"   : 122,
  /* @property */
  "f12"   : 123,
  
  /* @property */
  "numlock"   : 144,
  /* @property */
  "scrolllock": 145,
  /* @property */
  "semicolon" : 186,
  /* @property */
  "equalsign" : 187,
  /* @property */
  "comma"     : 188,
  /* @property */
  "dash"      : 189,
  /* @property */
  "period"    : 190,
  /* @property */
  "forward slash" : 191,
  /* @property */
  "/": 191,
  /* @property */
  "grave accent"  : 192,
  /* @property */
  "open bracket"  : 219,
  /* @property */
  "back slash"    : 220,
  /* @property */
  "close bracket"  : 221,
  /* @property */
  "single quote"  : 222,
  /* @property */
  "space"         : 32

};

/**
 * @class phina.input.Mouse
 * _extends phina.input.Input
 */
class Mouse extends Input {

  /**
   * @constructor
   * @param {HTMLCanvasElement} domElement
   */
  constructor(domElement) {
    super(domElement);

    this.id = 0;

    /** @type {HTMLCanvasElement} */
    this.domElement;

    var self = this;
    this.domElement.addEventListener('mousedown', function(e) {
      self._start(pointX.get.call(e), pointY.get.call(e), 1<<e.button);
      // self._start(e.pointX, e.pointY, 1<<e.button);
    });

    this.domElement.addEventListener('mouseup', function(e) {
      self._end(1<<e.button);
    });
    this.domElement.addEventListener('mousemove', function(e) {
      self._move(pointX.get.call(e), pointY.get.call(e));
      // self._move(e.pointX, e.pointY);
    });

    // マウスがキャンバス要素の外に出た場合の対応
    this.domElement.addEventListener('mouseout', function(e)  {
      self._end(1);
    });
  }

  /**
   * ボタン取得
   * @param {string | number} button
   * @returns {boolean}
   */
  getButton(button) {
    if (typeof(button) == "string") {
      button = BUTTON_MAP[button];
    }
    
    return (this.now & button) != 0;
  }

  /**
   * ボタンダウン取得
   * @param {string | number} button
   * @returns {boolean}
   */
  getButtonDown(button) {
    if (typeof(button) === 'string') {
      button = BUTTON_MAP[button];
    }

    return (this.start & button) != 0;
  }
      
  /**
   * ボタンアップ取得
   * @param {string | number} button
   * @returns {boolean}
   */
  getButtonUp(button) {
    if (typeof(button) == "string") {
      button = BUTTON_MAP[button];
    }
    
    return (this.end & button) != 0;
  }

}

/** @static @property */
Mouse.BUTTON_LEFT = 0x1;
/** @static @property */
Mouse.BUTTON_MIDDLE = 0x2;
/** @static @property */
Mouse.BUTTON_RIGHT = 0x4;

/**
 * @type {{[k: string]: number}}
 */
var BUTTON_MAP = {
  "left"  : Mouse.BUTTON_LEFT,
  "middle": Mouse.BUTTON_MIDDLE,
  "right" : Mouse.BUTTON_RIGHT
};

Mouse.prototype.getPointing = function() { return this.getButton("left"); };
Mouse.prototype.getPointingStart = function() { return this.getButtonDown("left"); };
Mouse.prototype.getPointingEnd = function() { return this.getButtonUp("left"); };

/**
 * @class phina.input.Touch
 * _extends phina.input.Input
 */
class Touch$1 extends Input {

  /**
   * @constructor
   * @param {HTMLCanvasElement} domElement
   * @param {boolean} [isMulti]
   */
  constructor(domElement, isMulti) {
    super(domElement);

    this.id = null;

    /** @type {boolean} */
    this.released = undefined;

    if (isMulti === true) {
      return ;
    }

    var self = this;
    this.domElement.addEventListener('touchstart', function(e) {
      self._start(touchPointX.get.call(e), touchPointY.get.call(e));
      // self._start(e.pointX, e.pointY, true);
    });

    this.domElement.addEventListener('touchend', function(e) {
      self._end();
    });
    this.domElement.addEventListener('touchmove', function(e) {
      self._move(touchPointX.get.call(e), touchPointY.get.call(e));
      // self._move(e.pointX, e.pointY);
    });
  }

  /**
   * タッチしているかを判定
   * @returns {boolean}
   */
  getTouch() {
    return this.now != 0;
  }
  
  /**
   * タッチ開始時に true
   * @returns {boolean}
   */
  getTouchStart() {
    return this.start != 0;
  }
  
  /**
   * タッチ終了時に true
   * @returns {boolean}
   */
  getTouchEnd() {
    return this.end != 0;
  }

}

/**
 * @method
 * ポインティング状態取得(mouse との差異対策)
 */
Touch$1.prototype.getPointing        = Touch$1.prototype.getTouch;
/**
 * @method
 * ポインティングを開始したかを取得(mouse との差異対策)
 */
Touch$1.prototype.getPointingStart   = Touch$1.prototype.getTouchStart;
/**
 * @method
 * ポインティングを終了したかを取得(mouse との差異対策)
 */
Touch$1.prototype.getPointingEnd     = Touch$1.prototype.getTouchEnd;


/**
 * @class phina.input.TouchList
 */
class TouchList {

  /**
   * @param {HTMLCanvasElement} domElement
   */
  constructor(domElement) {
    this.domElement = domElement;

    /** @type {Touch[]} */
    this.touches = [];

    /** @type {{[id:number]: Touch}} */
    var touchMap = this.touchMap = {};

    // 32bit 周期でIDをループさせる
    this._id = new Uint32Array(1);

    var self = this;
    var each = Array.prototype.forEach;
    this.domElement.addEventListener('touchstart', function(e) {
      each.call(e.changedTouches, function(t) {
        var touch = self.getEmpty();
        touchMap[t.identifier] = touch;
        touch._start(pointX.get.call(t), pointY.get.call(t));
        // touch._start(t.pointX, t.pointY);
      });
    });

    this.domElement.addEventListener('touchend', function(e) {
      each.call(e.changedTouches, function(t) {
        var id = t.identifier;
        var touch = touchMap[id];
        touch._end();
        delete touchMap[id];
      });
    });
    this.domElement.addEventListener('touchmove', function(e) {
      each.call(e.changedTouches, function(t) {
        var touch = touchMap[t.identifier];
        touch._move(pointX.get.call(t), pointY.get.call(t));
        // touch._move(t.pointX, t.pointY);
      });
      stop.call(e);
    });

    // iPhone では 6本指以上タッチすると強制的にすべてのタッチが解除される
    this.domElement.addEventListener('touchcancel', function(e) {
      console.warn('この端末での同時タッチ数の制限を超えました。');
      each.call(e.changedTouches, function(t) {
        var id = t.identifier;
        var touch = touchMap[id];
        touch._end();
        delete touchMap[id];
      });
      stop.call(e);
    });
  }

  /**
   * 空のTouchクラスを生成して追加、返す
   * @returns {Touch}
   */
  getEmpty() {
    var touch = new Touch$1(this.domElement, true);
  
    touch.id = this.id;
    this.touches.push(touch);

    return touch;
  }

  /**
   * @param {string | number} id
   * @returns {Touch}
   */
  getTouch(id) {
    return this.touchMap[id];
  }

  /**
   * @param {Touch} touch
   * @returns {void}
   */
  removeTouch(touch) {
    var i = this.touches.indexOf(touch);
    this.touches.splice(i, 1);
  }

  /**
   * @returns {void}
   */
  update() {
    this.touches.forEach(function(touch) {
      if (!touch.released) {
        touch.update();

        if (touch.flags === 0) {
          touch.released = true;
        }
      }
      else {
        touch.released = false;
        this.removeTouch(touch);
      }

    }, this);
  }

  get id() { return this._id[0]++; }

}

/**
 * Gamepad API指定インターフェイス：https://developer.mozilla.org/en-US/docs/Web/API/Gamepad
 * 混同回避のためのエイリアス
 * @typedef {Gamepad} RawGamepad
 */

/**
 * @class phina.input.GamepadManager
 * _extends phina.util.EventDispatcher
 * 
 * ゲームパッドマネージャー.
 * ゲームパッド接続状況の監視、個々のゲームパッドの入力状態の更新を行う.
 */
class GamepadManager extends EventDispatcher {

  /**
   * @constructor
   */
  constructor() {
    super();

    /**
     * 作成済みphina.input.Gamepadオブジェクトのリスト
     *
     * @type {Object.<number, PhinaGamepad>}
     */
    this.gamepads = {};

    /**
     * 作成済みゲームパッドのindexのリスト
     * 
     * @protected
     * @type {number[]}
     */
    this._created = [];

    /**
     * ラップ前Gamepadのリスト
     * 
     * @protected
     * @type {RawGamepad[]}
     */
    this._rawgamepads = [];

    /**
     * RawGamepadのtimestampとの比較用
     * 
     * @protected
     * @type {Object.<number, number>}
     */
    this._prevTimestamps = {};

    /**
     * Gamepad取得関数
     * 
     * @protected
     * @type {typeof Navigator.prototype.getGamepads | (()=> void)}
     */
    this._getGamepads;

    /** @type {globalThis} */
    var global = phina.global;
    var navigator = global.navigator;
    if (navigator && navigator.getGamepads) {
      this._getGamepads = navigator.getGamepads.bind(navigator);
    } else if (navigator && /** @type {any} */(navigator)['webkitGetGamepads']) {
      this._getGamepads = /** @type {any} */(navigator)['webkitGetGamepads'].bind(navigator);
    } else {
      this._getGamepads = function() {};
    }

    global.addEventListener('gamepadconnected', 
    /** @this GamepadManager */
    function(e) {
      var gamepad = this.get(e.gamepad.index);
      gamepad.connected = true;
      this.flare('connected', {
        gamepad: gamepad,
      });
    }.bind(this));

    global.addEventListener('gamepaddisconnected',
    /** @this GamepadManager */
    function(e) {
      var gamepad = this.get(e.gamepad.index);
      gamepad.connected = false;
      this.flare('disconnected', {
        gamepad: gamepad,
      });
    }.bind(this));
  }

  /**
   * 更新処理
   * 要毎フレーム実行
   * 
   * @returns {void}
   */
  update() {
    this._poll();

    for (var i = 0, end = this._created.length; i < end; i++) {
      var index = this._created[i];
      var rawgamepad = this._rawgamepads[index];

      if (!rawgamepad) {
        continue;
      }

      if (rawgamepad.timestamp && (rawgamepad.timestamp === this._prevTimestamps[i])) {
        this.gamepads[index]._updateStateEmpty();
        continue;
      }

      this._prevTimestamps[i] = rawgamepad.timestamp;
      this.gamepads[index]._updateState(rawgamepad);
    }
  }

  /**
   * 指定されたindexのGamepadオブジェクトを返す.
   * 未作成の場合は作成して返す.
   * 
   * @param {number} [index=0]
   * @returns {PhinaGamepad}
   */
  get(index) {
    index = index || 0;

    if (!this.gamepads[index]) {
      this._created.push(index);
      this.gamepads[index] = new PhinaGamepad(index);
    }

    return this.gamepads[index];
  }

  /**
   * 指定されたindexのGamepadオブジェクトを破棄する.
   * 破棄されたGamepadオブジェクトは以降更新されない.
   * 
   * @param {number} index
   * @returns {void}
   */
  dispose(index) {
    if (contains.call(this._created, index)) {
    // if (this._created.contains(index)) {
      var gamepad = this.get(index);
      delete this.gamepads[index];
      erase.call(this._created, index);
      // this._created.erase(index);

      gamepad.connected = false;
    }
  }

  /**
   * 指定されたindexのゲームパッドが接続中かどうかを返す.
   * Gamepadオブジェクトが未作成の場合でも動作する.
   * 
   * @param {number} [index=0]
   * @returns {boolean}
   */
  isConnected(index) {
    index = index || 0;

    return this._rawgamepads[index] && this._rawgamepads[index].connected;
  }

  /**
   * @protected
   * @returns {void}
   */
  _poll() {
    var rawGamepads = this._getGamepads();
    if (rawGamepads) {
      clear.call(this._rawgamepads);
      // this._rawgamepads.clear();

      for (var i = 0, end = rawGamepads.length; i < end; i++) {
        if (rawGamepads[i]) {
          this._rawgamepads.push(
            /** @type {RawGamepad} */ (rawGamepads[i])
          );
        }
      }
    }
  }

  // _static: {
  //   /** ブラウザがGamepad APIに対応しているか. */
  //   isAvailable: (function() {
  //     var nav = phina.global.navigator;
  //     if (!nav) return false;

  //     return (!!nav.getGamepads) || (!!nav.webkitGetGamepads);
  //   })(),
  // }

}

// static props
/** ブラウザがGamepad APIに対応しているか. */
GamepadManager.isAvailable = (function() {
  var nav = phina.global.navigator;
  if (!nav) return false;

  return (!!nav.getGamepads) || (!!nav['webkitGetGamepads']);
})();


/**
 * @typedef {Object} PhinaGamepadButtonState gamepadボタンパラメータ
 * @property {number} value ボタンの状態を表すdouble型の数値 参考：https://developer.mozilla.org/en-US/docs/Web/API/GamepadButton/value
 * @property {*} pressed 0 | 1 (false | true)
 * @property {*} last 0 | 1 (false | true)
 * @property {*} down 0 | 1 (false | true)
 * @property {*} up 0 | 1 (false | true)
 */

/**
 * @class phina.input.Gamepad
 * ゲームパッド
 *
 * 直接インスタンス化せず、phina.input.GamepadManagerオブジェクトから取得して使用する.
 * 
 * ※"Gamepad"という名前のインターフェイスがすでに存在するため、
 * （https://developer.mozilla.org/en-US/docs/Web/API/Gamepad）
 * 混同回避のためクラス名を変更
 */
class PhinaGamepad {

  /**
   * @param {number} [index=0]
   */
  constructor(index) {
    this.index = index || 0;

    /** @type {PhinaGamepadButtonState[]} */
    // this.buttons = Array.range(0, 16).map(function() {
    this.buttons = range.call([], 0, 16).map(function() {
      return {
        value: 0,
        pressed: false,
        last: false,
        down: false,
        up: false,
      };
    });

    /**
     * アナログスティック傾き管理用
     * 
     * @type {Vector2[]}
     */
    this.sticks = range.call([], 0, 2).map(function() {
    // this.sticks = Array.range(0, 2).map(function() {
      return new Vector2(0, 0);
    });
    this.id = null;
    this.connected = false;
    this.mapping = null;
    this.timestamp = null;
  }

  /**
   * ボタンが押されているか.
   * 
   * @param {number|keyof typeof PhinaGamepad.BUTTON_CODE} button ボタンコード数値、あるいはラベル文字列
   * @returns {boolean}
   */
  getKey(button) {
    if (typeof(button) === 'string') {
      button = PhinaGamepad.BUTTON_CODE[button];
    }
    if (this.buttons[button]) {
      return this.buttons[button].pressed;
    } else {
      return false;
    }
  }

  /**
   * ボタンを押した.
   * 
   * @param {number|keyof typeof PhinaGamepad.BUTTON_CODE} button ボタンコード数値、あるいはラベル文字列
   * @returns {boolean}
   */
  getKeyDown(button) {
    if (typeof(button) === 'string') {
      button = PhinaGamepad.BUTTON_CODE[button];
    }
    if (this.buttons[button]) {
      return this.buttons[button].down;
    } else {
      return false;
    }
  }

  /**
   * ボタンを離した.
   * 
   * @param {number|keyof typeof PhinaGamepad.BUTTON_CODE} button ボタンコード数値、あるいはラベル文字列
   * @returns {boolean}
   */
  getKeyUp(button) {
    if (typeof(button) === 'string') {
      button = PhinaGamepad.BUTTON_CODE[button];
    }
    if (this.buttons[button]) {
      return this.buttons[button].up;
    } else {
      return false;
    }
  }

  /**
   * 十字キーの入力されている方向を度数単位で返す。
   * 
   * @returns {number | null} どの方向にも当てはまらない時はnull
   */
  getKeyAngle() {
    var angle = null;
    var arrowBit =
      (this.getKey('left') ? 1 : 0 << 3) | // 1000
      (this.getKey('up') ? 1 : 0 << 2) | // 0100
      (this.getKey('right') ? 1 : 0 << 1) | // 0010
      (this.getKey('down') ? 1 : 0); // 0001

    if (arrowBit !== 0 && ARROW_BIT_TO_ANGLE_TABLE.hasOwnProperty(arrowBit)) {
      angle = ARROW_BIT_TO_ANGLE_TABLE[
        /** @type {keyof typeof ARROW_BIT_TO_ANGLE_TABLE} */ (arrowBit)
      ];
    }

    return angle;
  }

  /**
   * 十字キーの入力されている方向をVector2で
   * 正規化されている.
   * 
   * @returns {Vector2}
   */
  getKeyDirection() {
    var direction = new Vector2(0, 0);

    if (this.getKey('left')) {
      direction.x = -1;
    } else if (this.getKey('right')) {
      direction.x = 1;
    }
    if (this.getKey('up')) {
      direction.y = -1;
    } else if (this.getKey('down')) {
      direction.y = 1;
    }

    if (direction.x && direction.y) {
      direction.div(Math.SQRT2);
    }

    return direction;
  }

  /**
   * スティックの入力されている方向.
   * 
   * @param {number} [stickId=0]
   * @returns {number | null} 対応するスティックがない場合はnull
   */
  getStickAngle(stickId) {
    stickId = stickId || 0;
    var stick = this.sticks[stickId];
    return stick ? Math.atan2(-stick.y, stick.x) : null;
  }

  /**
   * スティックの入力されている方向をVector2で取得
   * 
   * Vector2は参照ではなく、複製されて返却される
   * 
   * @param {number} [stickId=0] 省略すると0（通常左アナログスティックに対応するid）となる
   * @returns {Vector2} 対応するスティックが存在しない場合は初期化したVector2を返却
   */
  getStickDirection(stickId) {
    stickId = stickId || 0;
    return this.sticks ? this.sticks[stickId].clone() : new Vector2(0, 0);
  }

  /**
   * @public GamepadManagerからアクセス
   * @param {RawGamepad} gamepad
   */
  _updateState(gamepad) {
    this.id = gamepad.id;
    this.connected = gamepad.connected;
    this.mapping = gamepad.mapping;
    this.timestamp = gamepad.timestamp;

    for (var i = 0, iend = gamepad.buttons.length; i < iend; i++) {
      this._updateButton(gamepad.buttons[i], i);
    }

    for (var j = 0, jend = gamepad.axes.length; j < jend; j += 2) {
      this._updateStick(gamepad.axes[j + 0], j / 2, 'x');
      this._updateStick(gamepad.axes[j + 1], j / 2, 'y');
    }
  }

  /**
   * ボタンの入力状態をリセット
   * 
   * @public GamepadManagerからアクセス
   */
  _updateStateEmpty() {
    for (var i = 0, iend = this.buttons.length; i < iend; i++) {
      this.buttons[i].down = false;
      this.buttons[i].up = false;
    }
  }

   /**
    * @protected
    * @param {number | GamepadButton} value
    * @param {number} buttonId
    */
   _updateButton(value, buttonId) {
    if (this.buttons[buttonId] === undefined) {
      this.buttons[buttonId] = {
        value: 0,
        pressed: false,
        last: false,
        down: false,
        up: false,
      };
    }
    
    var button = this.buttons[buttonId];

    button.last = button.pressed;

    if (typeof value === 'object') {
      button.value = value.value;
      button.pressed = value.pressed;
    } else {
      button.value = value;
      button.pressed = value > PhinaGamepad.ANALOGUE_BUTTON_THRESHOLD;
    }

    button.down = (button.pressed ^ button.last) & button.pressed;
    button.up = (button.pressed ^ button.last) & button.last;
  }

  /**
   * @protected
   * @param {number} value
   * @param {number} stickId
   * @param {"x"|"y"} axisName
   */
  _updateStick(value, stickId, axisName) {
    if (this.sticks[stickId] === undefined) {
      this.sticks[stickId] = new Vector2(0, 0);
    }
    this.sticks[stickId][axisName] = value;
  }

}

/** ブラウザがGamepad APIに対応しているか. */
PhinaGamepad.isAvailable = (function() {
  var nav = phina.global.navigator;
  if (!nav) return false;

  return (!!nav.getGamepads) || (!!nav['webkitGetGamepads']);
})();

/** アナログ入力対応のボタンの場合、どの程度まで押し込むとonになるかを表すしきい値. */
PhinaGamepad.ANALOGUE_BUTTON_THRESHOLD = 0.5;

/** ボタン名とボタンIDのマップ. */
PhinaGamepad.BUTTON_CODE = {
  'a': 0,
  'b': 1,
  'x': 2,
  'y': 3,

  'l1': 4,
  'r1': 5,
  'l2': 6,
  'r2': 7,

  'select': 8,
  'start': 9,

  'l3': 10,
  'r3': 11,

  'up': 12,
  'down': 13,
  'left': 14,
  'right': 15,

  'special': 16,

  'A': 0,
  'B': 1,
  'X': 2,
  'Y': 3,

  'L1': 4,
  'R1': 5,
  'L2': 6,
  'R2': 7,

  'SELECT': 8,
  'START': 9,

  'L3': 10,
  'R3': 11,

  'UP': 12,
  'DOWN': 13,
  'LEFT': 14,
  'RIGHT': 15,

  'SPECIAL': 16,
};

var ARROW_BIT_TO_ANGLE_TABLE = {
  0x00: null,

  /* @property 下 */
  0x01: 270,
  /* @property 右 */
  0x02: 0,
  /* @property 上 */
  0x04: 90,
  /* @property 左 */
  0x08: 180,

  /* @property 右上 */
  0x06: 45,
  /* @property 右下 */
  0x03: 315,
  /* @property 左上 */
  0x0c: 135,
  /* @property 左下 */
  0x09: 225,

  // 三方向同時押し対応
  // 想定外の操作だが対応しといたほうが無難
  /* @property 右上左 */
  0x0e: 90,
  /* @property 上左下 */
  0x0d: 180,
  /* @property 左下右 */
  0x0b: 270,
  /* @property 下右上 */
  0x07: 0,
};

/**
 * @class phina.input.Accelerometer
 * スマートフォンのセンサー情報
 */
class Accelerometer {
  /**
   * @constructor
   */
  constructor() {
    var self = this;

    /** @property  gravity 重力センサー */
    this.gravity        = new Vector3(0, 0, 0);

    /** @property  acceleration 加速度センサー */
    this.acceleration   = new Vector3(0, 0, 0);

    /** @property  rotation 回転加速度センサー */
    this.rotation       = new Vector3(0, 0, 0);

    /** @property  orientation スマートフォンの傾き */
    this.orientation    = new Vector3(0, 0, 0);

    if (phina.isMobile()) {
      phina.global.addEventListener("devicemotion", function(e) {
        var acceleration = self.acceleration;
        var gravity = self.gravity;
        var rotation = self.rotation;
        
        if (e.acceleration) {
          acceleration.x = e.acceleration.x;
          acceleration.y = e.acceleration.y;
          acceleration.z = e.acceleration.z;
        }
        if (e.accelerationIncludingGravity) {
          gravity.x = e.accelerationIncludingGravity.x;
          gravity.y = e.accelerationIncludingGravity.y;
          gravity.z = e.accelerationIncludingGravity.z;
        }
        if (e.rotationRate) {
          rotation.x = rotation.beta  = e.rotationRate.beta;
          rotation.y = rotation.gamma = e.rotationRate.gamma;
          rotation.z = rotation.alpha = e.rotationRate.alpha;
        }
      });
      
      phina.global.addEventListener("deviceorientation", function(e) {
        var orientation = self.orientation;
        orientation.alpha   = e.alpha;  // z(0~360)
        orientation.beta    = e.beta;   // x(-180~180)
        orientation.gamma   = e.gamma;  // y(-90~90)
      });
    }
  }

}

/**
 * @class phina.app.Updater
 */
class Updater {

  /**
   * @param {import('../game/gameapp').AppUnion} app
   */
  constructor(app) {
    this.app = app;
  }

  /**
   * @param {import('../app/scene').Scene} root 
   */
  update(root) {
    this._updateElement(root);
  }

  /**
   * @private
   * @param {import('../app/element').Element} element
   */
  _updateElement(element) {
    var app = this.app;

    // 更新するかを判定
    if (element.awake === false) return ;

    // エンターフレームイベント
    if (element.has('enterframe')) {
      element.flare('enterframe', {
        app: this.app,
      });
    }

    // 更新
    if (element.update) element.update(app);

    // 子供を更新
    var len = element.children.length;
    if (element.children.length > 0) {
      var tempChildren = element.children.slice();
      for (var i=0; i<len; ++i) {
        this._updateElement(tempChildren[i]);
      }
    }
  }

}

/**
 * Interactiveクラスのappとして必要なプロパティ
 * @typedef {{
 *   on: typeof import('../util/eventdispatcher').EventDispatcher.prototype.on
 *   domElement?: HTMLCanvasElement
 *   pointer?: import('../display/domapp').Pointer
 *   pointers?: import('../display/domapp').Pointer[]
 * }} InteractableApp
 */

/**
 * @class phina.app.Interactive
 */
class Interactive {

  /**
   * @param {InteractableApp} app 
   */
  constructor(app) {
    this.app = app;
    this._enable = true;
    this.multiTouch = true;
    this.cursor = {
      normal: '',
      hover: 'pointer',
    };

    /** @type {import('./object2d').Object2D[]} */
    this._holds = [];
    this.app.on('changescene', function() {
      clear.call(this._holds);
      // this._holds.clear();
    }.bind(this));
  }

  /**
   * @returns {this}
   */
  enable() {
    this._enable = true;
    return this;
  }

  /**
   * @returns {this}
   */
  disable() {
    this._enable = false;
    return this;
  }

  /**
   * 指定要素のインタラクションチェック開始  
   * @param {import('./element').Element | import('./object2d').Object2D} root Sceneクラスに渡されるため
   */
  check(root) {
    // カーソルのスタイルを反映
    if (this.app.domElement) {
      if (this._holds.length > 0) {
        this.app.domElement.style.cursor = this.cursor.hover;
      }
      else {
        this.app.domElement.style.cursor = this.cursor.normal;
      }
    }

    if (!this._enable || !this.app.pointers) return ;
    this._checkElement(root);
  }

  /**
   * 指定要素のインタラクションチェック  
   * 子供がいれば再帰処理
   * @private
   * @param {import('./element').Element | import('./object2d').Object2D} element 
   */
  _checkElement(element) {
    var app = this.app;

    // 更新するかを判定
    if (element.awake === false) return ;

    // 子供を更新
    var len = element.children.length;
    if (element.children.length > 0) {
      var tempChildren = element.children.slice();
      for (var i=0; i<len; ++i) {
        this._checkElement(tempChildren[i]);
      }
    }

    // タッチ判定
    this._checkPoint(element);
  }

  /**
   * タッチ判定を行う
   * @private
   * @param {import('./element').Element | import('./object2d').Object2D} obj 
   */
  _checkPoint(obj) {
    var _obj = /** @type {import('./object2d').Object2D} */(obj);
    if (this.multiTouch) {
      this.app.pointers.forEach(function(p) {
        if (p.id !== null) {
          this.__checkPoint(_obj, p);
        }
      }, this);
    }
    else {
      this.__checkPoint(_obj, this.app.pointer);
    }
  }

  /**
   * @private
   * @param {import('./object2d').Object2D} obj
   * @param {import('../display/domapp').Pointer} p
   */
  __checkPoint(obj, p) {
    if (!obj.interactive) return ;

    var prevOverFlag = obj._overFlags[p.id];
    var overFlag = obj.hitTest(p.x, p.y);
    obj._overFlags[p.id] = overFlag;

    var e = {
      pointer: p,
      interactive: this,
      over: overFlag,
    };

    if (!prevOverFlag && overFlag) {
      obj.flare('pointover', e);

      if (obj.boundingType && obj.boundingType !== 'none') {
        this._holds.push(obj);
      }
    }
    if (prevOverFlag && !overFlag) {
      obj.flare('pointout', e);
      // this._holds.erase(obj);
      erase.call(this._holds, obj);
    }

    if (overFlag) {
      if (p.getPointingStart()) {
        obj._touchFlags[p.id] = true;
        obj.flare('pointstart', e);
        // クリックフラグを立てる
        obj._clicked = true;
      }
    }

    if (obj._touchFlags[p.id]) {
      obj.flare('pointstay', e);
      if (p._moveFlag) {
        obj.flare('pointmove', e);
      }
    }

    if (obj._touchFlags[p.id]===true && p.getPointingEnd()) {
      obj._touchFlags[p.id] = false;
      obj.flare('pointend', e);

      if (phina.isMobile() && obj._overFlags[p.id]) {
        obj._overFlags[p.id] = false;
        obj.flare('pointout', e);
        // this._holds.erase(obj);
        erase.call(this._holds, obj);
      }
    }
  }

}

/**
 * Accessoryのtargetプロパティとして最低限かどうか
 * @typedef {{
 *   detach: (accessor: Accessory)=> any
 *   [k: string]: any
 * }} AccessoryTarget
 */

/**
 * Accessoryアタッチ可能オブジェクト
 * @typedef {{
 *   attach: (accessor: Accessory)=> any
 * } & AccessoryTarget } AccessoryAttachable
 */

/**
 * @class phina.accessory.Accessory
 * _extends phina.util.EventDispatcher
 */
class Accessory extends EventDispatcher {

  /**
   * @constructor
   * @param {AccessoryTarget} [target]
   */
  constructor(target) {
    super();

    /**
     * 操作対象
     * @type {AccessoryTarget | undefined}
     */
    this.target = target;
  }

  /**
   * 更新関数
   * アタッチしたtargetのenterframeイベントを経由して
   * 毎フレーム実行される
   * 
   * 主にサブクラスで拡張してAccessoryとしての特徴づけを行う
   * 
   * @virtual
   * @protected
   * @param {*} _app Appクラスインスタンス
   */
  update(_app) {}

  /**
   * 操作対象を設定
   * 
   * @param {AccessoryTarget} target
   * @returns {this}
   */
  setTarget(target) {
    if (this.target === target) return this;

    this.target = target;
    return this;
  }

  /**
   * アタッチ対象を返す
   * 
   * @returns {AccessoryTarget | undefined}
   */
  getTarget() {
    return this.target;
  }

  /**
   * アタッチ対象が存在するかどうか
   * 
   * @returns {boolean}
   */
  isAttached() {
    return !!this.target;
  }

  /**
   * 対象に自身をアタッチさせる
   * 
   * @template {AccessoryAttachable} T
   * @param {T} element
   * @returns {this}
   */
  attachTo(element) {
    element.attach(this);
    this.setTarget(element);
    return this;
  }

  /**
   * targetに自身へのアタッチを外させ、target参照を切る
   * 
   * @returns {void}
   */
  remove() {
    if (!this.target) return;
    this.target.detach(this);
    this.target = undefined;
  }

}

// Element側で拡張
// phina.app.Element.prototype.$method('attach', function(accessory) {
//   if (!this.accessories) {
//     this.accessories = [];
//     this.on('enterframe', function(e) {
//       this.accessories.each(function(accessory) {
//         accessory.update && accessory.update(e.app);
//       });
//     });
//   }

//   this.accessories.push(accessory);
//   accessory.setTarget(this);
//   accessory.flare('attached');

//   return this;
// });

// phina.app.Element.prototype.$method('detach', function(accessory) {
//   if (this.accessories) {
//     this.accessories.erase(accessory);
//     accessory.setTarget(null);
//     accessory.flare('detached');
//   }

//   return this;
// });

/**
 * @typedef {"normal" | "delta" | "fps"} TweenerUpdateType tweener更新タイプ
 * 
 * @typedef {"to" | "by" | "from"} TweenerTaskMode tweenerタスクモード
 * 
 * @typedef {{
 *   type: "tween",
 *   mode: TweenerTaskMode,
 *   props: Object,
 *   duration?: number,
 *   easing?: import("../util/tween").TweenEasingType,
 * }} TweenTypeTaskParam Tweenクラスを使用するタスクの設定用パラメータ
 * 
 * @typedef {{
 *   type: "wait" | "call" | "set",
 *   data: {[key: string]: any}
 * }} CommonTypeTaskParam その他の汎用タスク用パラメータ
 * 
 * @typedef {TweenTypeTaskParam | CommonTypeTaskParam} TaskParamUnion
 */

/**
 * @class phina.accessory.Tweener
 * # Tweener
 * Tweenerはオブジェクトのプロパティに対して、
 * Tweenアニメーションの効果を与えるクラスです。  
 * 主に {@link phina.app.Element} とそのサブクラスで使用されます。
 * _extends phina.accessory.Accessory
 */
class Tweener extends Accessory {

  /**
   * @constructor
   * @param {import("./accessory").AccessoryTarget} [target]
   */
  constructor(target) {
    super(target);

    /**
     * アニメーションを更新する方法を指定します。  
     * 変更するとdurationによる時間の進み方が変わります。  
     * 詳しくは{@link #UPDATE_MAP}を参照してください。
     * @type {TweenerUpdateType}
     */
    this.updateType = 'delta';

    this._init();
  }

  /**
   * @private
   * 初期化
   */
  _init() {
    this._loop = false;

    /** @type {TaskParamUnion[]} */
    this._tasks = [];

    this._index = 0;
    this.playing = true;
    this._update = this._updateTask;
  }

  /**
   * @param {import('../app/baseapp').BaseApp} app
   */
  update(app) {
    this._update(app);
  }

  /**
   * {@link #updateType}を変更します。
   * @chainable
   * @param {TweenerUpdateType} type 更新方法を表す文字列
   * @returns {this}
   */
  setUpdateType(type) {
    this.updateType = type;
    return this;
  }

  /**
   * propsで指定した値になるまで、durationで指定した時間をかけて、アニメーションさせます。
   * @chainable
   * @param {{[key: string]: any}} props 変更したいプロパティをkeyとしたオブジェクト
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  to(props, duration, easing) {
    this._add({
      type: 'tween',
      mode: 'to',
      props: props,
      duration: duration,
      easing: easing,
    });
    return this;
  }

  /**
   * アニメーション開始時の値とpropsで指定した値を加算した値になるまで、durationで指定した時間をかけて、アニメーションさせます。
   * @chainable
   * @param {{[key: string]: any}} props 変更したいプロパティをkeyとしたオブジェクト
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  by(props, duration, easing) {
    this._add({
      type: 'tween',
      mode: 'by',
      props: props,
      duration: duration,
      easing: easing,
    });

    return this;
  }

  /**
   * propsで指定した値からアニメーション開始時の値になるまで、durationで指定した時間をかけて、アニメーションさせます。
   * @chainable
   * @param {{[key: string]: any}} props 変更したいプロパティをkeyとしたオブジェクト
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  from(props, duration, easing) {
    this._add({
      type: 'tween',
      mode: 'from',
      props: props,
      duration: duration,
      easing: easing,
    });
    return this;
  }

  /**
   * 指定した時間が経過するまで待機します。
   * @chainable
   * @param {Number} time waitする時間
   * @returns {this}
   */
  wait(time) {
    this._add({
      type: 'wait',
      data: {
        limit: time,
      },
    });
    return this;
  }

  /**
   * 現在設定されているアニメーションが終了した時に呼び出される関数をセットします。
   * @chainable
   * @param {Function} func 呼び出される関数
   * @param {Object} [self] (optional) func内でthisにしたいオブジェクト。
   * @param {Object[]} [args] (optional) funcの引数にしたい値
   * @returns {this}
   */
  call(func, self, args) {
    this._add({
      type: 'call',
      data: {
        func: func,
        self: self || this,
        args: args,
      },
    });
    return this;
  }

  /**
   * 現在設定されているアニメーションが終了した時にプロパティをセットします。  
   * 第一引数にオブジェクトをセットすることもできます。
   * @chainable
   * @param {String | Object} key valueをセットするプロパティ名か、変更したいプロパティをkeyとしたオブジェクト。
   * @param {Object} [value] (optional) セットする値
   * @returns {this}
   */
  set(key, value) {
    var values = null;
    if (arguments.length == 2) {
      values = {};
      values[key] = value;
    }
    else {
      values = key;
    }
    this._tasks.push({
      type: "set",
      data: {
        values: values
      }
    });

    return this;
  }

  /**
   * x, yに対して、 {@link #to} の処理を行います。
   * @chainable
   * @param {Number} x
   * @param {Number} y
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  moveTo(x, y, duration, easing) {
    return this.to({ x: x, y: y }, duration, easing);
  }
  
  /**
   * x, yに対して、 {@link #by} の処理を行います。
   * @chainable
   * @param {Number} x
   * @param {Number} y
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  moveBy(x, y, duration, easing) {
    return this.by({ x: x, y: y }, duration, easing);
  }

  /**
   * rotationに対して、 {@link #to} の処理を行います。
   * @chainable
   * @param {Number} rotation
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  rotateTo(rotation, duration, easing) {
    return this.to({ rotation: rotation }, duration, easing);
  }
  
  /**
   * rotationに対して、 {@link #by} の処理を行います。
   * @chainable
   * @param {Number} rotation
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  rotateBy(rotation, duration, easing) {
    return this.by({ rotation: rotation }, duration, easing);
  }

  /**
   * scaleX, scaleYに対して {@link #to} の処理を行います。
   * @chainable
   * @param {Number} scale scaleXとscaleYに設定する値
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  scaleTo(scale, duration, easing) {
    return this.to({ scaleX: scale, scaleY: scale }, duration, easing);
  }
  /**
   * scaleX, scaleYに対して {@link #by} の処理を行います。
   * @chainable
   * @param {Number} scale scaleXとscaleYに設定する値
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  scaleBy(scale, duration, easing) {
    return this.by({ scaleX: scale, scaleY: scale }, duration, easing);
  }

  /**
   * alphaに対して {@link #to} の処理を行います。
   * @chainable
   * @param {Number} value alphaに設定する値
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  fade(value, duration, easing) {
    return this.to({ alpha: value }, duration, easing);
  }

  /**
   * alphaを0にするアニメーションを設定します。
   * @chainable
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  fadeOut(duration, easing) {
    return this.fade(0.0, duration, easing);
  }

  /**
   * alphaを1にするアニメーションを設定します。
   * @chainable
   * @param {Number} [duration] (optional) アニメーションにかける時間
   * @param {import("../util/tween").TweenEasingType} [easing] (optional) easing {@link phina.util.Tween#EASING}を参照してください。
   * @returns {this}
   */
  fadeIn(duration, easing) {
    return this.fade(1.0, duration, easing);
  }

  /**
   * アニメーション開始
   * @chainable
   * @returns {this}
   */
  play() {
    this.playing = true;
    return this;
  }

  /**
   * アニメーションを一時停止
   * @chainable
   * @returns {this}
   */
  pause() {
    this.playing = false;
    return this;
  }

  /**
   * アニメーションを停止し、最初まで巻き戻します。
   * @chainable
   * @returns {this}
   */
  stop() {
    this.playing = false;
    this.rewind();
    return this;
  }

  /**
   * アニメーションを巻き戻す
   * @chainable
   * @returns {this}
   */
  rewind() {
    this._update = this._updateTask;
    this._index = 0;
    return this;
  }

  yoyo() {
    // TODO: 最初の値が分からないので反転できない...
    this._update = this._updateTask;
    this._index = 0;
    each$1.call(this._tasks, function(task) {
    // this._tasks.each(function(task) {
      if (task.type === 'tween') ;
    });
    this.play();

    return this;
  }

  /**
   * アニメーションループ設定
   * @chainable
   * @param {Boolean} flag
   * @returns {this}
   */
  setLoop(flag) {
    this._loop = flag;
    return this;
  }

  /**
   * アニメーションをクリア
   * @chainable
   * @override {EventDispatcher#clear}を上書き
   * @returns {this}
   */
  clear() {
    this._init();
    return this;
  }

  /**
   * @typedef {[string, ...any]} TweenParamArray
   * JSON形式でアニメーションを設定します。
   * @chainable
   * 
   * ```
   * [
   *   [method, arg1, arg2,,,],
   *   ['to', {value: 100}, 1000, 'swing'],
   *   ['wait', 1000],
   *   ['set', 'text', 'END']
   * ]
   * ```
   * 
   * @param {Object} json
   * @param {Boolean} json.loop (optional) ループする場合true
   * @param {TweenParamArray} json.tweens 設定するアニメーション
   * @returns {this}
   */
  fromJSON(json) {
    if (json.loop !== undefined) {
      this.setLoop(json.loop);
    }

    each$1.call(json.tweens, 
    // json.tweens.each(
      /**
       * @this Tweener
       * @param {TweenParamArray} t
       */
      function(t) {
        t = clone.call(t);
        // t = t.clone();
        var method = t.shift();
        this[method].apply(this, t);
      }, this
    );

    return this;
  }

  /**
   * @param {TaskParamUnion} params
   */
  _add(params) {
    this._tasks.push(params);
  }

  /**
   * @param {import('../app/baseapp').BaseApp} app
   */
  _updateTask(app) {
    if (!this.playing) return ;

    var task = this._tasks[this._index];
    if (!task) {
      if (this._loop) {
        this.rewind();
        this._update(app);
      }
      else {
        this.playing = false;
      }
      return ;
    }
    else {
      ++this._index;
    }

    if (task.type === 'tween') {
      // this._tween = phina.util.Tween();
      this._tween = new Tween();

      var duration = task.duration || this._getDefaultDuration();
      if (task.mode === 'to') {
        this._tween.to(this.target, task.props, duration, task.easing);
      }
      else if (task.mode === 'by') {
        this._tween.by(this.target, task.props, duration, task.easing);
      }
      else {
        this._tween.from(this.target, task.props, duration, task.easing);
      }
      this._update = this._updateTween;
      this._update(app);
    }
    else if (task.type === 'wait') {
      this._wait = {
        time: 0,
        limit: task.data.limit,
      };

      this._update = this._updateWait;
      this._update(app);
    }
    else if (task.type === 'call') {
      task.data.func.apply(task.data.self, task.data.args);
      // 1フレーム消費しないよう再帰
      this._update(app);
    }
    else if (task.type === 'set') {
      $extend.call(this.target, task.data.values);
      // this.target.$extend(task.data.values);
      // 1フレーム消費しないよう再帰
      this._update(app);
    }
  }

  /**
   * @param {import('../app/baseapp').BaseApp} app
   */
  _updateTween(app) {
    var tween = this._tween;
    var time = this._getUnitTime(app);

    tween.forward(time);
    this.flare('tween');

    if (tween.time >= tween.duration) {
      delete this._tween;
      this._tween = null;
      this._update = this._updateTask;
    }
  }

  /**
   * @param {import('../app/baseapp').BaseApp} app
   */
  _updateWait(app) {
    var wait = this._wait;
    var time = this._getUnitTime(app);
    wait.time += time;

    if (wait.time >= wait.limit) {
      delete this._wait;
      this._wait = null;
      this._update = this._updateTask;
    }
  }

  /**
   * @private
   * @param {import('../app/baseapp').BaseApp} app
   */
  _getUnitTime(app) {
    var obj = UPDATE_MAP[this.updateType];
    if (obj) {
      return obj.func(app);
    }
    else {
      return 1000 / app.fps;
    }
  }

  /**
   * @private
   */
  _getDefaultDuration() {
    var obj = UPDATE_MAP[this.updateType];
    return obj && obj.duration;
  }

}

/**
 * @static
 * {@link #updateType}に設定する更新方法の定義です。
 * 下記の表に定義済みの更新方法を{@link #updateType}に設定することで、
 * アニメーションの更新方法を変更することができます。
 * 
 * | 更新方法 | 単位(デフォルト値) | 1フレームあたりのアニメーション速度 |
 * |-|-|-|
 * | normal | ミリ秒(1000) | app.fpsによって変化 |
 * | delta | ミリ秒(1000) | 経過時間によって変化 |
 * | fps | フレーム(30) | 必ず同じ速度で変化 |
 * 
 * @type {{
 *   [key in TweenerUpdateType]: {
 *     func: (app: import('../app/baseapp').BaseApp)=> number,
 *     duration: number,
 *   }
 * }}
 */
var UPDATE_MAP = Tweener.UPDATE_MAP = {
  normal: {
    func: function(app) {
      return 1000 / app.fps;
    },
    duration: 1000,
  },

  delta: {
    func: function(app) {
      return app.ticker.deltaTime;
    },
    duration: 1000,
  },

  fps: {
    func: function() {
      return 1;
    },
    duration: 30,
  },

};

// Element側で拡張
// /**
//  * @member phina.app.Element
//  * @property tweener
//  * 自身にアタッチ済みの{@link phina.accessory.Tweener}オブジェクト。
//  */
// phina.app.Element.prototype.getter('tweener', function() {
//   if (!this._tweener) {
//     this._tweener = phina.accessory.Tweener().attachTo(this);
//   }
//   return this._tweener;
// });

/**
 * Draggableのtargetに指定可能なオブジェクト型
 * @typedef {{
 *   x: number
 *   y: number
 *   flare: (type: string)=> any
 *   setInteractive: (flag: boolean)=> any
 * } & import("./accessory").AccessoryAttachable } DraggableTarget
 */

/**
 * @class phina.accessory.Draggable
 * _extends phina.accessory.Accessory
 * 
 * 対象をドラッグ可能にするAccessory派生クラス
 * 
 * phina.app.Element派生クラスであれば、
 * draggableゲッターにアクセスするだけで有効化することも可能
 * 
 * ### イベント発火について
 * ドラッグ開始時に`dragstart`、
 * ドラッグ移動毎に`drag`、
 * ドラッグ終了時に時に`dragend`
 * イベントをそれぞれ自身および対象オブジェクト両方で発火する
 * 
 * @example
 * const target = new phina.display.Sprite("player");
 * const draggable = new phina.accessory.Draggable().attachTo(target);
 * draggable.on("dragend", ()=> {
 *   if (!isValidatePosition(target)) draggable.back()
 * })
 * 
 * @example
 * // Activate by getter
 * const el = new phina.app.Element();
 * el.draggable;
 * 
 */
class Draggable extends Accessory {

  /**
   * @constructor
   * 
   * @param {DraggableTarget} [target]
   * targetを受け取るが、それだけでは有効化されないことに注意
   * 同時に有効化する場合はattachToを使って付与する
   */
  constructor(target) {
    super(target);

    /** @type {DraggableTarget} */
    this.target;

    /**
     * @private
     * @type {boolean}
     */
    this._dragging = false;

    /**
     * @private
     * @type {boolean}
     * ※未使用
     */
    this._enable;

    /**
     * ドラッグ開始位置、処理毎に更新される
     * @type {Vector2}
     */
    this.initialPosition = new Vector2(0, 0);

    var self = this;
    this.on('attached',
    /** @this {Draggable} */
    function() {
      this.target.setInteractive(true);

      self._dragging = false;

      this.target.on('pointstart', 
      /** @this {DraggableTarget} */
      function() {
        if (Draggable._lock) return ;

        self._dragging = true;
        self.initialPosition.x = this.x;
        self.initialPosition.y = this.y;
        self.flare('dragstart');
        this.flare('dragstart');
      });

      this.target.on('pointmove', 
      /** @this {DraggableTarget} */
      function(e) {
        if (!self._dragging) return ;

        this.x += e.pointer.dx;
        this.y += e.pointer.dy;
        self.flare('drag');
        this.flare('drag');
      });

      this.target.on('pointend', 
      /** @this {DraggableTarget} */
      function(e) {
        if (!self._dragging) return ;

        self._dragging = false;
        self.flare('dragend');
        this.flare('dragend');
      });
    });
  }

  /**
   * ドラッグ開始位置にターゲットを戻す
   * パラメータ指定することでtweenerアニメーションを使って戻すことも可能
   * 
   * 終了時に`backend`イベントを発火
   * 
   * @param {number} [time] アニメーション時間（ミリ秒）。無指定の場合は即座に戻す
   * @param {import("../util/tween").TweenEasingType} [easing='easeOutElastic'] アニメーション種類
   * @returns {void}
   */
  back(time, easing) {
    if (time) {
      var t = this.target;
      t.setInteractive(false);
      var tweener = new Tweener().attachTo(t);
      tweener
        .to({
          x: this.initialPosition.x,
          y: this.initialPosition.y,
        }, time, easing || 'easeOutElastic')
        .call(function() {
          tweener.remove();

          t.setInteractive(true);
          this.flare('backend');
        }, this);
    }
    else {
      this.target.x = this.initialPosition.x;
      this.target.y = this.initialPosition.y;
      this.flare('backend');
    }
  }

  /**
   * @private ※未使用のため
   * @returns {void}
   */
  enable() {
    this._enable = true;
  }

  /**
   * 全てのインスタンスでドラッグを無効化する
   * 
   * @returns {void}
   */
  static lock() {
    this._lock = true;
  }

  /**
   * 全てのインスタンスでドラッグ無効化を解除
   * 
   * @returns {void}
   */
  static unlock() {
    this._lock = false;
  }

}

/**
 * @private
 * @type {boolean}
 */
Draggable._lock = false;

// Element側で定義
// phina.app.Element.prototype.getter('draggable', function() {
//   if (!this._draggable) {
//     this._draggable = phina.accessory.Draggable().attachTo(this);
//   }
//   return this._draggable;
// });

/**
 * TODO: Elementのプロパティを引き継ぎたい…
 * @typedef {Element | any} ElementBasedObject
 * _typedef {{[k: string]: any} & Element} ElementBasedObject
 */

/**
 * Elementに適合するためのプロパティを保持してるかチェック: template用
 * @typedef {{
 *   addChild: (el: Elementizable)=> Elementizable
 *   remove: ()=> Elementizable
 *   parent?: Elementizable
 *   has: (type:string)=> boolean
 *   flare: (type:string)=> any
 * }} Elementizable 
 */

/**
 * @class phina.app.Element
 * _extends phina.util.EventDispatcher
 * # 主に要素の親子関係を扱うクラス
 * 主に親子関係等を定義するクラスです。
 */
class Element extends EventDispatcher {

  /**
   * @constructor
   */
  constructor() {
    super();

    /**
     * @type {ElementBasedObject | null}
     * 親要素
     */
    this.parent = null;

    /**
     * @type {ElementBasedObject[]}
     * 子要素配列
     */
    this.children = [];

    /**
     * @type {boolean}
     * 有効かどうか
     */
    this.awake = true;

    /**
     * @type {boolean}
     * 要素クリック管理用フラグ
     */
    this._clicked = false;

    /**
     * @type {import('../accessory/accessory').Accessory[]}
     * Accessory配列
     * attachメソッドによって初期化
     */
    this.accessories = undefined;

    /**
     * @private
     * @type {Tweener}
     * 内部Tweenerクラス
     * tweenerアクセサによって初期化
     */
    this._tweener = undefined;

    /**
     * @private
     * @type {Draggable}
     */
    this._draggable = undefined;
  }

  /**
   * @method addChild
   * 自身に子要素を追加します。
   *
   * 自身を子要素として引数で指定した要素に追加するには {@link #addChildTo} を使用してください。
   *
   * @template {Elementizable} T
   * @param {T} child 追加する子要素
   * @returns {T} 追加した子要素
   */
  addChild(child) {
    if (child.parent) child.remove();

    child.parent = this;
    this.children.push(child);

    child.has('added') && child.flare('added');

    return child;
  }

  /**
   * @method addChildTo
   * 自身を子要素として引数で指定した要素に追加します。
   *
   * 自身に子要素を追加するには {@link #addChild} を使用してください。
   *
   * @template {Elementizable} T
   * @param {T} parent 自身を子要素として追加する要素
   * @returns {this}
   */
  addChildTo(parent) {
    parent.addChild(this);

    return this;
  }

  /**
   * @method addChildAt
   * 自身を、指定した要素の子要素の任意の配列インデックスに追加します。
   *
   * @template {Elementizable} T
   * @param {T} child 追加する子要素
   * @param {Number} index インデックス番号
   * @returns {T} 追加した子要素
   */
  addChildAt(child, index) {
    if (child.parent) child.remove();

    child.parent = this;
    this.children.splice(index, 0, child);

    child.has('added') && child.flare('added');

    return child;
  }

  /**
   * @method getChildAt
   * 指定したインデックスの子要素を返します。
   *
   * @param {Number} index インデックス番号
   * @returns {ElementBasedObject} 指定したインデックスの子要素
   */
  getChildAt(index) {
    // return this.children.at(index);
    return at.call(this.children, index);
  }

  /**
   * @todo
   * @method getChildByName
   * 指定した名前の子要素を返します。（未実装）
   */
  getChildByName(name) {
    // TODO:
  }

  /**
   * @method getChildIndex
   * 指定した子要素のインデックス番号を返します。
   *
   * @param {ElementBasedObject} child 子要素
   * @return {Number} 指定した子要素のインデックス番号
   */
  getChildIndex(child) {
    return this.children.indexOf(child);
  }

  /**
   * @method getParent
   * 指定した要素の親要素を返します。
   *
   * @return {ElementBasedObject} 指定した要素の親要素
   */
  getParent() {
    return this.parent;
  }

  /**
   * @method getRoot
   * 指定した要素の階層ツリーのルートを返します。
   *
   * @return {ElementBasedObject} 指定した要素の階層ツリーのルート
   */
  getRoot() {
    /** @type {ElementBasedObject} */
    var elm = this;
    for (elm=this.parent; elm.parent != null; elm = elm.parent) {

    }
    return elm;
  }

  /**
   * @method removeChild
   * @chainable
   * 指定した要素を自身の子要素から削除します。
   *
   * @template {Elementizable} T
   * @param {T} child 要素
   * @returns {this}
   */
  removeChild(child) {
    var index = this.children.indexOf(child);
    if (index !== -1) {
      this.children.splice(index, 1);
      child.has('removed') && child.flare('removed');
    }
    return this;
  }

  /**
   * @method remove
   * 自身を親要素の子要素から削除します。
   * @returns {this}
   */
  remove() {
    if (!this.parent) return ;

    this.parent.removeChild(this);
    this.parent = null;

    return this;
  }

  /**
   * @method isAwake
   * 自身が有効かどうかを返します。
   *
   * @return {Boolean} 有効かどうか
   */
  isAwake() {
    return this.awake;
  }

  /**
   * @method wakeUp
   * 自身を有効にします。
   * @returns {this}
   */
  wakeUp() {
    this.awake = true;
    return this;
  }

  /**
   * @method sleep
   * 自身を無効にします。
   * @returns {this}
   */
  sleep() {
    this.awake = false;
    return this;
  }

  /**
   * @virtual
   * 更新用仮想関数
   * @param {import("../game/gameapp").AppUnion} [_app] アプリケーションクラス
   * @returns {any}
   */
  update(_app) {}

  /**
   * @method fromJSON
   * JSON 形式を使って自身に子要素を追加することができます。
   *
   * ### Example
   *      this.fromJSON({
   *        "children": {
   *          "label": {                  //キー名が追加する子要素の名前になる
   *            "className": "Label",     //クラス
   *            "arguments": ['hello!'],  //初期化時の引数
   *            "x":320,                  //その他プロパティ
   *            "y":480,
   *          },
   *        },
   *      });
   * 
   * @typedef {{
   *   children?: fromJSONData
   *   className?: string | (new (...args: any)=> any)
   *   arguments?: any
   *   [otherProp: string]: any
   * }} fromJSONData
   * @param {fromJSONData} json JSON 形式
   * @returns {this}
   */
  fromJSON(json) {

    var createChildren = 
      /**
       * @param {string | number} name
       * @param {fromJSONData} data
       */
      function(name, data) {
      var args = data.arguments;
      args = (args instanceof Array) ? args : [args];

      var _class;
      var element;
      if (typeof data.className === 'string') {
        // is phina class
        _class = phina.using(data.className);
        element = _class.apply(null, args);
      } else if (typeof data.className === 'function') {
        // is ES class
        // FIXME: インスタンス化にスプレッド構文が必要なため、es5サポートの場合babelが必要
        element = new data.className(...args);
      }

      element.name = name;
      this[name] = element;

      element.fromJSON(data);
      element.addChildTo(this);
    }.bind(this);

    forIn.call(json, function(key, value) {
    // json.forIn(function(key, value) {
      if (key === 'children') {
        forIn.call(value, function(name, data) {
        // value.forIn(function(name, data) {
          createChildren(name, data);
        });
      }
      else {
        if (key !== 'type' && key !== 'className') {
          this[key] = value;
        }
      }
    }, this);

    return this;
  }

  // /**
  //  * @method toJSON
  //  * 自身の子要素を JSON 形式で返します。
  //  *
  //  * @return {JSON} JSON形式
  //  */
  // toJSON() {
  //   var keys = Object.keys(phina.using(this.className).defaults || {});

  //   this._hierarchies.forEach(function(e) {
  //     var d = e.defaults;
  //     if (d) {
  //       Object.keys(d).forEach(function(k) {
  //         if (keys.indexOf(k) === -1) {
  //           keys.push(k);
  //         }
  //       });
  //     }
  //   });

  //   keys.push('name', 'className');

  //   var json = {};
  //   // keys.each(function(key) {
  //   keys.forEach(function(key) {
  //     json[key] = this[key];
  //   }, this);

  //   var children = this.children.map(function(child) {
  //     return child.toJSON();
  //   });

  //   if (children.length) {
  //     json.children = {};
  //     // children.each(function(child, i) {
  //     children.forEach(function(child, i) {
  //       json.children[child.name || (child.className + '_' + i)] = child;
  //     });
  //   }

  //   return json;
  // }

  /**
   * accessoryを付与する
   * @param  {import('../accessory/accessory').Accessory} accessory Accessory継承クラス
   * @return {this}
   */
  attach(accessory) {
    if (!this.accessories) {
      this.accessories = [];
      this.on('enterframe', function(e) {
        this.accessories.forEach(function(accessory) {
          accessory.update && accessory.update(e.app);
        });
      });
    }

    this.accessories.push(accessory);
    accessory.setTarget(this);
    accessory.flare('attached');

    return this;
  }

  /**
   * accessoryを削除
   * @param  {import('../accessory/accessory').Accessory} accessory Accessory継承クラス
   * @return {this}
   */
  detach(accessory) {
    if (this.accessories) {
      // this.accessories.erase(accessory);
      erase.call(this.accessories, accessory);
      accessory.setTarget(null);
      accessory.flare('detached');
    }

    return this;
  }

  /**
   * 自身に付与（attach）された内部tweenerオブジェクトを返却
   * 
   * アクセス時に存在しない場合、新たにTweenerを生成・付与する
   */
  get tweener() {
    if (!this._tweener) {
      this._tweener = new Tweener().attachTo(this);
    }
    return this._tweener;
  }

  /**
   * 自身に付与（attach）された内部draggableオブジェクトを返却
   * 
   * アクセス時に存在しない場合、新たにDraggableを生成・付与する
   * その際自動で有効化されるため、アクセスした地点でドラッグ可能になる
   */
  get draggable() {
    if (!this._draggable) {
      this._draggable = new Draggable().attachTo(this);
    }
    return this._draggable;
  }
}

/**
 * @typedef {string|number} SceneLabel
 */

/**
 * exitメソッド用パラメータ
 * @typedef {{
 *   nextLabel?: SceneLabel
 *   [key: string]: any,
 * }} NextArgumentsForExit
 */

/**
 * SceneのAppクラス参照として最低限のインタフェースを備えた型
 * @typedef {{
 *   popScene: typeof import("./baseapp").BaseApp.prototype.popScene
 *   [key: string]: any,
 * }} SceneAppAppliable
 */

/**
 * @class phina.app.Scene
 * _extends phina.app.Element
 */
class Scene extends Element {

  constructor() {
    super();

    /**
     * Appクラス参照
     * @type {SceneAppAppliable?}
     */
    this.app;

    /**
     * 次のシーンを表すラベル
     * @type {SceneLabel}
     */
    this.nextLabel;

    /**
     * 次のシーンに渡される引数を保持
     * ManagerSceneクラスで使用
     * @type {any}
     */
    this.nextArguments;
  }

  /**
   * 現在のシーンを抜ける
   * 
   * @example
   * const scene = new Scene();
   * scene.exit("nextscenelabel", {score: 128})
   * // or
   * scene.exit({nextLabel:"nextscenelabel", score: 128})
   * 
   * @param {SceneLabel | NextArgumentsForExit} [nextLabelOrArguments]
   * 次シーンのラベル、もしくはラベル込みの引数オブジェクト
   * 
   * @param {any} [nextArguments]
   * 引数オブジェクト
   * 第一引数をラベル文字列で指定した場合に設定
   * 
   * @returns {this}
   */
  exit(nextLabelOrArguments, nextArguments) {
    if (!this.app) return ;

    if (arguments.length > 0) {
      if (typeof arguments[0] === 'object') {
        nextLabelOrArguments = arguments[0].nextLabel || this.nextLabel;
        nextArguments = arguments[0];
      }

      this.nextLabel = /** @type {SceneLabel} */(nextLabelOrArguments);
      this.nextArguments = nextArguments;
    }

    this.app.popScene();

    return this;
  }

}

/**
 * @typedef {(
 *   Scene |
 *   import("../display/displayscene").DisplayScene |
 *   import("../game/managerscene.js").ManagerScene
 * )} SceneTypeUnion
 */

/**
 * @class phina.app.BaseApp
 * _extends phina.util.EventDispatcher
 * 
 * アプリケーションクラスの基底クラス
 */
class BaseApp extends EventDispatcher {

  /**
   * @constructor
   */
  constructor() {
    super();

    /**
     * シーンのスタック
     * @protected
     * @type {SceneTypeUnion[]}
     */
    this._scenes = [new Scene()];

    /**
     * シーンのインデックス値
     * アクティブ中のシーン管理に使用
     * @protected
     * @type {number}
     */
    this._sceneIndex = 0;

    /**
     * 更新処理が有効な状態かどうか
     * @type {boolean}
     */
    this.awake = true;

    /** @type {Updater} */
    this.updater = new Updater(this);

    /** @type {Interactive} */
    this.interactive = new Interactive(this);

    /** @type {Ticker} */
    this.ticker = new Ticker();
    
    /**
     * tickerによって毎フレーム実行されるアプリ内部処理
     * @private
     * @type {import("../util/eventdispatcher").PhinaEventHandler | null}
     */
    this._loopCaller;
  }

  /**
   * アプリケーションを開始
   * 
   * @returns {this}
   */
  run() {
    var self = this;
    this._loopCaller = function() {
      self._loop();
    };
    this.ticker.tick(this._loopCaller);

    this.ticker.start();

    return this;
  }

  /**
   * アプリケーションを完全停止
   * 
   * @returns {this}
   */
  kill() {
    this.ticker.stop();
    if (this._loopCaller) this.ticker.untick(this._loopCaller);
    return this;
  }

  /**
   * 指定したシーンに切り替える
   * 
   * @param {SceneTypeUnion} scene
   * @returns {this}
   */
  replaceScene(scene) {
    this.flare('replace');
    this.flare('changescene');

    if (this.currentScene) {
      this.currentScene.app = null;
    }
    this.currentScene = scene;
    this.currentScene.app = this;
    this.currentScene.flare('enter', {
      app: this,
    });

    return this;
  }

  /**
   * 指定したsceneに遷移する
   * 
   * replaceSceneとは違い、遷移前のシーンは停止して保持し続ける。
   * そのため、ポーズやオブション画面などの一時的なシーンでの使用に最適
   * 
   * 具体的にはシーンスタックにシーンを追加しつつ、
   * インデックス値を進めることでシーン遷移する
   * 
   * @param {Scene} scene
   * @returns {this}
   */
  pushScene(scene) {
    this.flare('push');
    this.flare('changescene');

    this.currentScene.flare('pause', {
      app: this,
    });

    this._scenes.push(scene);
    ++this._sceneIndex;

    this.flare('pushed');

    scene.app = this;
    scene.flare('enter', {
      app: this,
    });

    return this;
  }

  /**
   * 現在のシーンを抜け、直前のシーンに戻る
   * ポーズやオブション画面など、一時的なシーンを抜ける際に使用
   * 
   * pushScene同様、シーンスタックの操作によって
   * アクティブなシーンを切り替える
   * 
   * @returns {Scene | void} 抜けたSceneオブジェクト、処理できなかった場合は何も返さない
   */
  popScene() {
    this.flare('pop');
    this.flare('changescene');

    // Keep rootScene
    if (this._scenes.length <= 1) return;

    var scene = /** @type {Scene} */(this._scenes.pop());
    --this._sceneIndex;

    scene.flare('exit', {
      app: this,
    });
    scene.app = null;

    this.flare('poped');

    this.currentScene.flare('resume', {
      app: this,
      prevScene: scene,
    });

    return scene;
  }

  /**
   * アプリケーションの再開
   * 更新処理の実行を再開する
   * 
   * @returns {this}
   */
  start() {
    this.awake = true;

    return this;
  }

  /**
   * アプリケーションの一時停止
   * 更新処理を実行しないようにする
   * 
   * @returns {this}
   */
  stop() {
    this.awake = false;

    return this;
  }

  /**
   * stats.js( https://github.com/mrdoob/stats.js/ )を実行し、
   * パフォーマンスモニターを表示する
   * 
   * stats.jsがグローバルで読み込まれていない場合、
   * cdnjsからr14版スクリプトを読み込む
   * 
   * @returns {this}
   */
  enableStats() {
    if (phina.global['Stats']) {
      this.stats = new phina.global['Stats']();
      document.body.appendChild(this.stats.domElement);
    }
    else {
      // console.warn("not defined stats.");
      var STATS_URL = 'https://cdnjs.cloudflare.com/ajax/libs/stats.js/r14/Stats.js';
      var script = document.createElement('script');
      script.src = STATS_URL;
      document.body.appendChild(script);
      script.onload = function() {
        this.enableStats();
      }.bind(this);
    }
    return this;
  }

  /**
   * dat.GUI( https://github.com/dataarts/dat.gui )を初期化し、
   * そのインスタンスをコールバック関数に渡して実行
   * 
   * dat.GUIがグローバルで読み込まれていない場合、
   * cdnjsからv0.5.1版スクリプトを読み込む
   * 
   * @param {(datGUIObject?: any) => any} callback
   * @returns {this}
   */
  enableDatGUI(callback) {
    if (phina.global['dat']) {
      var gui = new phina.global['dat'].GUI();
      callback(gui);
    }
    else {
      // console.warn("not defined dat.GUI.");
      var URL = 'https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5.1/dat.gui.js';
      var script = document.createElement('script');
      script.src = URL;
      document.body.appendChild(script);
      script.onload = function() {
        var gui = new phina.global['dat'].GUI();
        callback(gui);
      }.bind(this);
    }
    return this;
  }

  /**
   * @protected
   * ループ処理関数
   * 
   * @returns {void}
   */
  _loop() {
    this._update();
    this.interactive.check(this.currentScene);
    this._draw();

    // stats update
    if (this.stats) this.stats.update();
  }

  /**
   * @protected
   * 更新処理関数
   * 
   * @returns {void}
   */
  _update() {
    if (this.awake) {
      // エンターフレームイベント
      if (this.has('enterframe')) {
        this.flare('enterframe');
      }

      this.update && this.update();
      this.updater.update(this.currentScene);
    }
  }

  /**
   * 更新用仮想関数
   * 
   * @virtual
   * @returns {any}
   */
  update() {}

  /**
   * 描画用仮想関数
   * 
   * @virtual
   * @returns {any}
   */
  _draw() {}

  /**
   * 現在アクティブ中のシーン
   */
  get currentScene()   { return this._scenes[this._sceneIndex]; }
  set currentScene(v)  { this._scenes[this._sceneIndex] = v; }

  /**
   * 根本シーン。インスタンス化の際に自動的に設定
   */
  get rootScene()   { return this._scenes[0]; }
  set rootScene(v)  { this._scenes[0] = v; }

  /**
   * 経過フレーム数
   */
  get frame() { return this.ticker.frame; }
  set frame(v) { this.ticker.frame = v; }

  /**
   * Frame per second  
   * 秒間の更新および描画処理回数
   */
  get fps() { return this.ticker.fps; }
  set fps(v) { this.ticker.fps = v; }

  /**
   * 前フレームでの処理にかかった時間
   */
  get deltaTime() { return this.ticker.deltaTime; }

  /**
   * アプリケーション開始からの経過時間
   */
  get elapsedTime() { return this.ticker.elapsedTime; }

  /**
   * 現在の時間（最後の更新時のUNIXタイムスタンプ）
   */
  get currentTime() { return this.ticker.currentTime; }

  /**
   * アプリケーション開始時間（UNIXタイムスタンプ）
   */
  get startTime() { return this.ticker.startTime; }
}

/**
 * 判定処理の際、どのような形状として扱うか
 * @typedef {"rect"|"circle"|"none"} Object2DBoundingType
 */

/**
 * @typedef {{
 *  x?: Number,
 *  y?: Number,
 *  scaleX?: Number,
 *  scaleY?: Number,
 *  rotation?: Number,
 *  originX?: Number,
 *  originY?: Number,
 *  width?: Number,
 *  height?: Number,
 *  radius?: Number,
 *  boundingType?: Object2DBoundingType,
 * }} Object2DOptions
 */

/**
 * @class phina.app.Object2D
 * Object2D
 * _extends phina.app.Element
 */
class Object2D extends Element {

  // /** 位置 */
  // position: null,
  // /** 回転 */
  // rotation: 0,
  // /** スケール */
  // scale: null,
  // /** 基準位置 */
  // origin: null,

  /**
   * @param {Object2DOptions} [options]
   */
  constructor(options) {
    super();

    options = $safe.call({}, options, Object2D.defaults);
    // options = ({}).$safe(options, phina.app.Object2D.defaults);

    /** @type {Vector2} 位置 */
    this.position = new Vector2(options.x, options.y);

    /** @type {Vector2} スケール */
    this.scale    = new Vector2(options.scaleX, options.scaleY);

    /** @type {number} 回転（度数単位） */
    this.rotation = options.rotation || 0;

    /** @type {Vector2} 基準位置、回転軸 */
    this.origin   = new Vector2(options.originX, options.originY);

    /**
     * @private
     * @type {Matrix33}
     * ローカル変換行列
     */
    this._matrix = new Matrix33().identity();
    /**
     * @type {Matrix33 | null}
     * ワールド変換行列
     */
    this._worldMatrix = new Matrix33().identity();

    /**
     * @private
     * @type {number} 行列計算用キャッシュ値
     */
    this._cachedRotation;
    /**
     * @private
     * @type {number} 行列計算用キャッシュ値
     */
    this._sr;
    /**
     * @private
     * @type {number} 行列計算用キャッシュ値
     */
    this._cr;

    /**
     * @type {boolean}
     * インタラクション可能かどうか
     */
    this.interactive = false;
    /**
     * @type {{ [id: number]: boolean }}
     * Interactiveクラスでのフラグ処理用
     */
    this._overFlags = {};
    /**
     * @type {{ [id: number]: boolean }}
     * Interactiveクラスでのフラグ処理用
     */
    this._touchFlags = {};

    /**
     * @protected
     * @type {number}
     */
    this._width;
    /**
     * @protected
     * @type {number}
     */
    this._height;
    /**
     * 半径: boundingTypeがcircleの場合のみ使用
     * @private
     * @type {number}
     */
    this._radius;
    /**
     * 直径: boundingTypeがcircleの際にwidth/height値として使用  
     * radiusアクセサsetの際に更新
     * @private
     * @type {number}
     */
    this._diameter;

    this.width = options.width;
    this.height = options.height;
    this.radius = options.radius;
    /**
     * 当たり判定範囲の種別
     * @type {Object2DBoundingType}
     */
    this.boundingType = options.boundingType;

    /** @type {Object2D|PhinaElement} */
    this.parent;
  }

  /**
   * 点と衝突しているかを判定
   * @param {Number} x
   * @param {Number} y
   */
  hitTest(x, y) {
    if (this.boundingType === 'rect') {
      return this.hitTestRect(x, y);
    }
    else if (this.boundingType === 'circle') {
      return this.hitTestCircle(x, y);
    }
    else {
      // none の場合
      return true;
    }
  }

  /**
   * 自身を矩形として、点と衝突しているかを判定
   * @param {number} x
   * @param {number} y
   * @returns {boolean}
   */
  hitTestRect(x, y) {
    var p = this.globalToLocal(new Vector2(x, y));

    var left   = -this.width*this.originX;
    var right  = +this.width*(1-this.originX);
    var top    = -this.height*this.originY;
    var bottom = +this.height*(1-this.originY);

    return ( left < p.x && p.x < right ) && ( top  < p.y && p.y < bottom );
  }

  /**
   * 自身を円形として、点と衝突しているかを判定
   * @param {number} x
   * @param {number} y
   * @returns {boolean}
   */
  hitTestCircle(x, y) {
    // 円判定
    var p = this.globalToLocal(new Vector2(x, y));
    if (((p.x)*(p.x)+(p.y)*(p.y)) < (this.radius*this.radius)) {
        return true;
    }
    return false;
  }

  /**
   * 要素と衝突しているかを判定
   * @param {Object2D} elm
   * @returns {boolean}
   */
  hitTestElement(elm) {
    var rect0 = this;
    var rect1 = elm;
    return (rect0.left < rect1.right) && (rect0.right > rect1.left) &&
           (rect0.top < rect1.bottom) && (rect0.bottom > rect1.top);
  }

  /**
   * 渡された座標をローカル座標に変換して返す
   * @param {import("../geom/vector2").PrimitiveVector2} p 値は変更しません
   * @returns {Vector2} 新規作成されたローカル座標オブジェクト
   */
  globalToLocal(p) {
    var matrix = this._worldMatrix.clone();
    matrix.invert();
    // matrix.transpose();

    var temp = matrix.multiplyVector2(p);

    return temp;
  }

  /**
   * インタラクション可能かどうかを変更  
   * 同時にboundingTypeも変更可能
   * @param {boolean} flag
   * @param {Object2DBoundingType} [type]
   * @returns {this}
   */
  setInteractive(flag, type) {
    this.interactive = flag;
    if (type) {
      this.boundingType = type;
    }

    return this;
  }

  /**
   * X 座標値をセット
   * @param {Number} x
   * @returns {this}
   */
  setX(x) {
    this.position.x = x;
    return this;
  }
  
  /**
   * Y 座標値をセット
   * @param {Number} y
   * @returns {this}
   */
  setY(y) {
    this.position.y = y;
    return this;
  }
  
  /**
   * XY 座標をセット
   * @param {Number} x
   * @param {Number} y
   * @returns {this}
   */
  setPosition(x, y) {
    this.position.x = x;
    this.position.y = y;
    return this;
  }

  /**
   * 回転をセット
   * @param {Number} rotation
   * @returns {this}
   */
  setRotation(rotation) {
    this.rotation = rotation;
    return this;
  }

  /**
   * スケールをセット
   * @param {Number} x
   * @param {Number} [y] 省略した場合、xパラメータ値が適用されます
   * @returns {this}
   */
  setScale(x, y) {
    this.scale.x = x;
    if (arguments.length <= 1) {
        this.scale.y = x;
    } else {
        this.scale.y = y;
    }
    return this;
  }
  
  /**
   * 基準点をセット
   * @param {Number} x
   * @param {Number} y
   * @returns {this}
   */
  setOrigin(x, y) {
    this.origin.x = x;
    this.origin.y = y;
    return this;
  }
  
  /**
   * 幅をセット
   * @param {Number} width
   * @returns {this}
   */
  setWidth(width) {
    this.width = width;
    return this;
  }
  
  /**
   * 高さをセット
   * @param {Number} height
   * @returns {this}
   */
  setHeight(height) {
    this.height = height;
    return this;
  }
  
  /**
   * サイズ(幅, 高さ)をセット
   * @param {Number} width
   * @param {Number} height
   * @returns {this}
   */
  setSize(width, height) {
    this.width  = width;
    this.height = height;
    return this;
  }

  /**
   * @param {Object2DBoundingType} type
   * @returns {this}
   */
  setBoundingType(type) {
    this.boundingType = type;
    return this;
  }

  /**
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  moveTo(x, y) {
    this.position.x = x;
    this.position.y = y;
    return this;
  }

  /**
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  moveBy(x, y) {
    this.position.x += x;
    this.position.y += y;
    return this;
  }

  /**
   * グローバル行列を計算
   * @returns {this}
   */
  _calcWorldMatrix() {
    if (!this.parent) return ;

    // cache check
    if (this.rotation != this._cachedRotation) {
      this._cachedRotation = this.rotation;

      var r = this.rotation*(Math.PI/180);
      this._sr = Math.sin(r);
      this._cr = Math.cos(r);
    }

    var local = this._matrix;
    var parent = /** @type {Object2D} */(this.parent)._worldMatrix || Matrix33.IDENTITY;
    var world = this._worldMatrix;

    // ローカルの行列を計算
    local.m00 = this._cr * this.scale.x;
    local.m01 =-this._sr * this.scale.y;
    local.m10 = this._sr * this.scale.x;
    local.m11 = this._cr * this.scale.y;
    local.m02 = this.position.x;
    local.m12 = this.position.y;

    // cache
    var a00 = local.m00; var a01 = local.m01; var a02 = local.m02;
    var a10 = local.m10; var a11 = local.m11; var a12 = local.m12;
    var b00 = parent.m00; var b01 = parent.m01; var b02 = parent.m02;
    var b10 = parent.m10; var b11 = parent.m11; var b12 = parent.m12;

    // 親の行列と掛け合わせる
    world.m00 = b00 * a00 + b01 * a10;
    world.m01 = b00 * a01 + b01 * a11;
    world.m02 = b00 * a02 + b01 * a12 + b02;

    world.m10 = b10 * a00 + b11 * a10;
    world.m11 = b10 * a01 + b11 * a11;
    world.m12 = b10 * a02 + b11 * a12 + b12;

    return this;
  }

  /**
   * @property    x
   * x座標値
   */
  get x()   { return this.position.x; }
  set x(v)  { this.position.x = v; }

  /**
   * @property    y
   * y座標値
   */
  get y()   { return this.position.y; }
  set y(v)  { this.position.y = v; }

  /**
   * @property    originX
   * x座標値
   */
  get originX()   { return this.origin.x; }
  set originX(v)  { this.origin.x = v; }

  /**
   * @property    originY
   * y座標値
   */
  get originY()   { return this.origin.y; }
  set originY(v)  { this.origin.y = v; }

  /**
   * @property    scaleX
   * スケールX値
   */
  get scaleX()   { return this.scale.x; }
  set scaleX(v)  { this.scale.x = v; }
  
  /**
   * @property    scaleY
   * スケールY値
   */
  get scaleY()   { return this.scale.y; }
  set scaleY(v)  { this.scale.y = v; }
  
  /**
   * @property    width
   * width
   */
  get width()   {
    return (this.boundingType === 'rect') ?
      this._width : this._diameter;
  }
  set width(v)  { this._width = v; }

  /**
   * @property    height
   * height
   */
  get height()   {
    return (this.boundingType === 'rect') ?
      this._height : this._diameter;
  }
  set height(v)  { this._height = v; }

  /**
   * @property    radius
   * 半径
   */
  get radius()   {
    return (this.boundingType === 'rect') ?
      (this.width+this.height)/4 : this._radius;
  }
  set radius(v)  {
    this._radius = v;
    this._diameter = v*2;
  }
  
  /**
   * @property    top
   * 左
   */
  get top()   { return this.y - this.height*this.originY; }
  set top(v)  { this.y = v + this.height*this.originY; }

  /**
   * @property    right
   * 左
   */
  get right()   { return this.x + this.width*(1-this.originX); }
  set right(v)  { this.x = v - this.width*(1-this.originX); }

  /**
   * @property    bottom
   * 左
   */
  get bottom()   { return this.y + this.height*(1-this.originY); }
  set bottom(v)  { this.y = v - this.height*(1-this.originY); }

  /**
   * @property    left
   * 左
   */
  get left()   { return this.x - this.width*this.originX; }
  set left(v)  { this.x = v + this.width*this.originX; }

  /**
   * @property    centerX
   * centerX
   */
  get centerX()   { return this.x + this.width/2 - this.width*this.originX; }
  // set centerX(v)  {
  //   // TODO: どうしようかな??
  // }

  /**
   * @property    centerY
   * centerY
   */
  get centerY()   { return this.y + this.height/2 - this.height*this.originY; }
  // set centerY(v)  {
  //   // TODO: どうしようかな??
  // }
}

/**
 * @type {Object2DOptions}
 * @static
 */
Object2D.defaults = {
  x: 0,
  y: 0,
  scaleX: 1,
  scaleY: 1,
  rotation: 0,
  originX: 0.5,
  originY: 0.5,
  width: 64,
  height: 64,
  radius: 32,
  boundingType: 'rect',
};

/**
 * phina独自のPointer型
 * @typedef {Mouse | PhinaTouch} Pointer
 */

/**
 * DomApp初期化オプション  
 * domElementもしくはqueryいずれかは必ず指定すること
 * @typedef {{
 *  domElement?: HTMLCanvasElement;
 *  query?: string; 
 *  fps?: number; 
 *  runner?: (run: TimerHandler, delay: number) => void;
 * }} DomAppOptions
 */

/**
 * @class phina.display.DomApp
 * _extends phina.app.BaseApp
 */
class DomApp extends BaseApp {

  /**
   * @constructor
   * @param {DomAppOptions} options
   */
  constructor(options) {
    super();

    /** @type HTMLCanvasElement */
    this.domElement;

    if (options.domElement) {
      this.domElement = options.domElement;
    }
    else {
      if (options.query) {
        this.domElement = document.querySelector(options.query);
      }
      else {
        console.assert('error');
      }
    }

    if (options.fps !== undefined) {
      this.fps = options.fps;
    }
    
    if(typeof options.runner === 'function') {
      this.ticker.runner = options.runner;
    }

    this.mouse = new Mouse(this.domElement);
    this.touch = new Touch$1(this.domElement);
    this.touchList = new TouchList(this.domElement);
    this.keyboard = new Keyboard(document);
    // // 加速度センサーを生成
    // this.accelerometer = phina.input.Accelerometer();

    // ポインタをセット(PC では Mouse, Mobile では Touch)
    /** @type {Pointer} */
    this.pointer = this.touch;
    /** @type {Pointer[]} */
    this.pointers = this.touchList.touches;
    this.domElement.addEventListener("touchstart", 
    /** @this DomApp */
    function () {
      this.pointer = this.touch;
      this.pointers = this.touchList.touches;
    }.bind(this));
    this.domElement.addEventListener("mouseover", 
    /** @this DomApp */
    function () {
      this.pointer = this.mouse;
      this.pointers = [this.mouse];
    }.bind(this));

    // keyboard event
    this.keyboard.on('keydown', function(e) {
      this.currentScene && this.currentScene.flare('keydown', {
        keyCode: e.keyCode,
      });
    }.bind(this));
    this.keyboard.on('keyup', function(e) {
      this.currentScene && this.currentScene.flare('keyup', {
        keyCode: e.keyCode,
      });
    }.bind(this));
    this.keyboard.on('keypress', function(e) {
      this.currentScene && this.currentScene.flare('keypress', {
        keyCode: e.keyCode,
      });
    }.bind(this));

    // click 対応
    var eventName = phina.isMobile() ? 'touchend' : 'mouseup';
    this.domElement.addEventListener(eventName, this._checkClick.bind(this));

    // 決定時の処理をオフにする(iPhone 時のちらつき対策)
    this.domElement.addEventListener("touchstart", function(e) { stop.call(e); });
    this.domElement.addEventListener("touchmove", function(e) { stop.call(e); });

    // ウィンドウフォーカス時イベントリスナを登録
    phina.global.addEventListener('focus', function() {
      this.flare('focus');
      this.currentScene.flare('focus');
    }.bind(this), false);
    // ウィンドウブラー時イベントリスナを登録
    phina.global.addEventListener('blur', function() {
      this.flare('blur');
      this.currentScene.flare('blur');
    }.bind(this), false);

    // 更新関数を登録
    this.on('enterframe', function() {
      this.mouse.update();
      this.touch.update();
      this.touchList.update();
      this.keyboard.update();
    });
  }

  /**
   * @private
   * touchend/mouseupでの疑似clickイベント処理
   * @param {*} _e 
   */
  _checkClick(_e) {
    /** @param {import('../app/element').Element} element */
    var _check = function(element) {
      if (element.children.length > 0) {
        element.children.forEach(function(child) {
          _check(child);
        });
      }
      if (element._clicked && element.has('click')) {
        element.flare('click');
      }
      element._clicked = false;
    };

    _check(this.currentScene);
  }

}

/**
 * @typedef {import("../app/element").Element & {
 *   backgroundColor?: import("../graphics/canvas").CanvasStyle
 * }} RenderableScene
 */

/**
 * @typedef {import("./displayelement").DisplayElement & {
 *   clip?: (canvas: import('../graphics/canvas').Canvas)=> any,
 *   draw?: (canvas: import('../graphics/canvas').Canvas)=> any
 * }} RenderableElement
 */

/**
 * @class phina.display.CanvasRenderer
 */
class CanvasRenderer {

  /**
   * @param {import('../graphics/canvas').Canvas} canvas
   */
  constructor(canvas) {
    this.canvas = canvas;
    this._context = this.canvas.context;
  }

  /**
   * @param {RenderableScene} scene
   */
  render(scene) {
    this.canvas.clear();
    if (scene.backgroundColor) {
      this.canvas.clearColor(scene.backgroundColor);
    }

    this._context.save();
    this.renderChildren(scene);
    this._context.restore();
  }

  /**
   * @param {import("../app/element").ElementBasedObject} obj
   */
  renderChildren(obj) {
    // 子供たちも実行
    if (obj.children.length > 0) {
      var tempChildren = /** @type {RenderableElement[]}*/(obj.children.slice());
      for (var i=0,len=tempChildren.length; i<len; ++i) {
        this.renderObject(tempChildren[i]);
      }
    }
  }

  /**
   * @param {RenderableElement} obj
   */
  renderObject(obj) {
    if (obj.visible === false && !obj.interactive) return;

    obj._calcWorldMatrix && obj._calcWorldMatrix();

    if (obj.visible === false) return;

    obj._calcWorldAlpha && obj._calcWorldAlpha();

    var context = this.canvas.context;

    context.globalAlpha = obj._worldAlpha;
    context.globalCompositeOperation = obj.blendMode;

    if (obj._worldMatrix) {
      // 行列をセット
      var m = obj._worldMatrix;
      context.setTransform( m.m00, m.m10, m.m01, m.m11, m.m02, m.m12 );
    }

    if (obj.clip) {

      context.save();

      obj.clip(this.canvas);
      context.clip();

      if (obj.draw) obj.draw(this.canvas);

      // 子供たちも実行
      if (obj.renderChildBySelf === false && obj.children.length > 0) {
          var tempChildren = obj.children.slice();
          for (var i=0,len=tempChildren.length; i<len; ++i) {
              this.renderObject(tempChildren[i]);
          }
      }

      context.restore();
    }
    else {
      if (obj.draw) obj.draw(this.canvas);

      // 子供たちも実行
      if (obj.renderChildBySelf === false && obj.children.length > 0) {
        var tempChildren = obj.children.slice();
        for (var i=0,len=tempChildren.length; i<len; ++i) {
          this.renderObject(tempChildren[i]);
        }
      }

    }
  }

}

/**
 * @typedef {{
 *   width?: number,
 *   height?: number,
 *   imageSmoothing?: boolean,
 *   backgroundColor?: import("../graphics/canvas").CanvasStyle,
 * }} DisplaySceneOptions
 */

/**
 * @class phina.display.DisplayScene
 * _extends phina.app.Scene
 */
class DisplayScene extends Scene {

  /**
   * @param {DisplaySceneOptions} [params]
   */
  constructor(params) {
    super();

    params = $safe.call({}, params, DisplayScene.defaults);
    // params = ({}).$safe(params, DisplayScene.defaults);

    this.canvas = new Canvas();
    this.canvas.setSize(params.width, params.height);
    this.renderer = new CanvasRenderer(this.canvas);
    this.backgroundColor = (params.backgroundColor) ? params.backgroundColor : null;

    this.width = params.width;
    this.height = params.height;
    this.gridX = new Grid(params.width, 16);
    this.gridY = new Grid(params.height, 16);

    // TODO: 一旦むりやり対応
    this.interactive = true;
    // this.setInteractive = function(flag) {
    //   this.interactive = flag;
    // };
    this._overFlags = {};
    this._touchFlags = {};

    var ctx = this.canvas.context;
    if (params.imageSmoothing === false) {
      ctx.imageSmoothingEnabled = false;
      ctx['webkitImageSmoothingEnabled'] = false;
      ctx['msImageSmoothingEnabled'] = false;
    }
  }

  /**
   * @param {boolean} flag
   */
  setInteractive(flag) {
    this.interactive = flag;
  }

  hitTest() {
    return true;
  }

  /**
   * @virtual
   * @param {import("../display/canvasapp").CanvasApp} [_app] アプリケーション本体の参照
   */
  update(_app) {}

  /**
   * @returns {void}
   */
  _update() {
    if (this.update) {
      this.update();
    }
  }

  /**
   * @returns {void}
   */
  _render() {
    this.renderer.render(this);
  }

}

/** @type DisplaySceneOptions */
DisplayScene.defaults = {
  width: 640,
  height: 960,
  imageSmoothing: true,
};

/**
 * CanvasApp初期化オプション  
 * DisplaySceneの初期化に使われることも考え、そのオプションパラメータも継承
 * @typedef {{ 
 *  append?: boolean
 *  columns?: number
 *  backgroundColor?: import("../graphics/canvas").CanvasStyle
 *  fit?: boolean
 *  pixelated?: boolean
 * } 
 * & import("./domapp").DomAppOptions
 * & import("./displayscene").DisplaySceneOptions } CanvasAppOptions
 */

/**
 * @class phina.display.CanvasApp
 * _extends phina.display.DomApp
 */
class CanvasApp extends DomApp {

  /**
   * @constructor
   * @param {CanvasAppOptions} options
   */
  constructor(options) {
    options = $safe.call((options || {}), CanvasApp.defaults);
    // options = (options || {}).$safe(CanvasApp.defaults);
    
    if (!options.query && !options.domElement) {
      options.domElement = document.createElement('canvas');
      if (options.append) {
        document.body.appendChild(options.domElement);
      }
    }
    super(options);

    this.gridX = new Grid({
      width: options.width,
      columns: options.columns,
    });
    this.gridY = new Grid({
      width: options.height,
      columns: options.columns,
    });

    this.canvas = new Canvas(this.domElement);
    this.canvas.setSize(options.width, options.height);

    this.backgroundColor = (options.backgroundColor !== undefined) ? options.backgroundColor : 'white';

    this.replaceScene(new DisplayScene({
      width: options.width,
      height: options.height,
    }));

    if (options.fit) {
      this.fitScreen();
    }

    if (options.pixelated) {
      // チラつき防止
      // ドット絵ゲームのサポート
      // https://drafts.csswg.org/css-images/#the-image-rendering
      // https://developer.mozilla.org/en-US/docs/Web/CSS/image-rendering#Browser_compatibility
      if (navigator.userAgent.match(/Firefox\/\d+/)) {
        this.domElement.style.imageRendering = 'crisp-edges';
      } else {
        this.domElement.style.imageRendering = 'pixelated';
      }
    }

    // pushScene, popScene 対策
    this.on('push', function() {
      // onenter 対策で描画しておく
      if (this.currentScene.canvas) {
        this._draw();
      }
    });
  }

  /**
   * @override
   * 描画処理
   */
  _draw() {
    if (this.backgroundColor) {
      this.canvas.clearColor(this.backgroundColor);
    } else {
      this.canvas.clear();
    }

    var currentScene = /** @type {DisplayScene} */(this.currentScene);
    if (currentScene.canvas) {
      currentScene._render();

      // this._scenes.each(
      this._scenes.forEach(
      /** @param {DisplayScene} scene */
      function(scene) {
        var c = scene.canvas;
        if (c) {
          this.canvas.context.drawImage(c.domElement, 0, 0, c.width, c.height);
        }
      }, this);
    }
  }

  /**
   * CanvasクラスのfitScreenを実行
   * @returns {void}
   */
  fitScreen() {
    this.canvas.fitScreen();
  }

}

/**
 * @static
 * @type {CanvasAppOptions}
 */
CanvasApp.defaults = {
  width: 640,
  height: 960,
  columns: 12,
  fit: true,
  append: true,
};

/**
 * @typedef {{
 *   alpha?: number,
 *   visible?: boolean,
 * } & import("../app/object2d").Object2DOptions} DisplayElementOptions
 */

/**
 * globalCompositeOperation(https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation) のtypeと同じ
 * @typedef { 'source-over' | 'source-in' | 'source-out' | 'source-atop' | 'destination-over' | 'destination-in' | 'destination-out' | 'destination-atop' | 'lighter' | 'copy' | 'xor' | 'multiply' | 'screen' | 'overlay' | 'darken' | 'lighten' | 'color-dodge' | 'color-burn' | 'hard-light' | 'soft-light' | 'difference' | 'exclusion' | 'hue' | 'saturation' | 'color' | 'luminosity'} BlendMode
 */

/**
 * @class phina.display.DisplayElement
 * _extends phina.app.Object2D
 */
class DisplayElement extends Object2D {

  /**
   * @param {DisplayElementOptions} [options] 
   */
  constructor(options) {
    options = $safe.call({}, options||{}, DisplayElement.defaults);
    // options = ({}).$safe(options || {}, phina.display.DisplayElement.defaults);
    super(options);

    /**
     * 表示フラグ
     * @type {boolean}
     */
    this.visible = (options.visible != null) ? options.visible : true;

    /**
     * アルファ値
     * @type {number}
     */
    this.alpha = (options.alpha != null) ? options.alpha : 1.0;

    /**
     * ブレンドモード
     * @type {BlendMode}
     */
    this.blendMode = "source-over";

    /**
     * 子供を 自分のCanvasRenderer で描画するか
     * @type {boolean}
     */
    this.renderChildBySelf = false;

    /** @type {DisplayElement} 型アサーション */
    this.parent;

    /**
     * グローバルアルファ内部値
     * @type {number}
     */
    this._worldAlpha = 1.0;
  }

  /**
   * アルファ値をセット
   * @param {number} alpha
   * @returns {this}
   */
  setAlpha(alpha) {
    this.alpha = alpha;
    return this;
  }

  /**
   * 表示/非表示をセット
   * @param {boolean} flag
   * @returns {this}
   */
  setVisible(flag) {
    this.visible = flag;
    return this;
  }

  /**
   * 表示
   * @returns {this}
   */
  show() {
    this.visible = true;
    return this;
  }

  /**
   * 非表示
   * @returns {this}
   */
  hide() {
    this.visible = false;
    return this;
  }

  /**
   * グローバルアルファ値の再計算
   * @returns {void}
   */
  _calcWorldAlpha() {
    if (this.alpha < 0) {
      this._worldAlpha = 0;
      return;
    }
    if (!this.parent) {
      this._worldAlpha = this.alpha;
      return ;
    }
    else {
      var worldAlpha = (this.parent._worldAlpha !== undefined) ? this.parent._worldAlpha : 1.0;
      // alpha
      this._worldAlpha = worldAlpha * this.alpha;
    }
  }

}

/**
 * @type {DisplayElementOptions}
 */
DisplayElement.defaults = {
  alpha: 1.0,
  visible: true,
};

/**
 * @class phina.asset.AssetManager
 * 
 */
class AssetManager {

  /**
   * @param {string} type "sound"、"image"などのアセット種類
   * @param {string} key アセットのキー
   */
  static get(type, key) {
    return this.assets[type] && this.assets[type][key];
  }

  /**
   * @param {string | number} type "sound"、"image"などのアセット種類
   * @param {string | number} key アセット登録キー
   * @param {any} asset Assetオブジェクト
   */
  static set(type, key, asset) {
    if (!this.assets[type]) {
      this.assets[type] = {};
    }
    this.assets[type][key] = asset;
  }

  /**
   * 未実装
   * @param {*} type 
   * @param {*} key 
   */
  static contains(type, key) {
    return ;
  }

}

AssetManager.assets = {
  image: {},
  sound: {},
  spritesheet: {},
};

/**
 * Sprite画像ソースとして使えるオブジェクト型
 * TextureクラスやCanvasクラスなど
 * @typedef {{
 *   domElement: HTMLCanvasElement | HTMLImageElement;
 *   [key: string]: any;
 * }} SpriteImage
 */

/**
 * AssetManagerに登録した画像キー、もしくはSpriteImageオブジェクト
 * @typedef {string | SpriteImage} SpriteImageSrc
 */

/**
 * @class phina.display.Sprite
 * _extends phina.display.DisplayElement
 */
class Sprite extends DisplayElement {

  /**
   * @param {SpriteImageSrc} image
   * @param {number} [width]
   * @param {number} [height]
   */
  constructor(image, width, height) {
    super();

    /**
     * スプライト元画像（テクスチャ）。setImageで初期化
     * @private
     * @type {SpriteImage}
     */
    this._image;

    /**
     * フレームインデックス。setImageで初期化
     * @private
     * @type {number}
     */
    this._frameIndex;

    /**
     * 画像描画範囲
     * @type {Rect}
     */
    this.srcRect = new Rect();

    this.setImage(image, width, height);
  }

  /**
   * @param {import("../graphics/canvas").Canvas} canvas 
   */
  draw(canvas) {
    var image = this.image.domElement;

    // canvas.context.drawImage(image,
    //   0, 0, image.width, image.height,
    //   -this.width*this.origin.x, -this.height*this.origin.y, this.width, this.height
    //   );

    var srcRect = this.srcRect;
    canvas.context.drawImage(image,
      srcRect.x, srcRect.y, srcRect.width, srcRect.height,
      -this._width*this.originX, -this._height*this.originY, this._width, this._height
      );
  }

  /**
   * スプライト元画像を設定
   * @param {SpriteImageSrc} image
   * @param {number} [width]
   * @param {number} [height]
   * @returns {this}
   */
  setImage(image, width, height) {
    if (typeof image === 'string') {
      image = AssetManager.get('image', image);
    }
    this._image = /**@type {SpriteImage} */ (image);
    this.width = this._image.domElement.width;
    this.height = this._image.domElement.height;

    if (width) { this.width = width; }
    if (height) { this.height = height; }

    this.frameIndex = 0;

    return this;
  }

  /**
   * フレームインデックスを指定し、そのフレームに合わせて描画範囲を更新  
   * @param {number} index フレームインデックス。最大値を超えた場合はループ
   * @param {number} [width] フレームサイズ幅
   * @param {number} [height] フレームサイズ高さ
   * @returns {this}
   */
  setFrameIndex(index, width, height) {
    var tw  = width || this._width;      // tw
    var th  = height || this._height;    // th
    var row = ~~(this.image.domElement.width / tw);
    var col = ~~(this.image.domElement.height / th);
    var maxIndex = row*col;
    index = index%maxIndex;
    
    var x = index%row;
    var y = ~~(index/row);
    this.srcRect.x = x*tw;
    this.srcRect.y = y*th;
    this.srcRect.width  = tw;
    this.srcRect.height = th;

    this._frameIndex = index;

    return this;
  }

  get image() {return this._image;}
  set image(v) {
    this.setImage(v);
  }

  get frameIndex() {return this._frameIndex;}
  set frameIndex(idx) {
    this.setFrameIndex(idx);
  }
}

/**
 * @class phina.display.PlainElement
 * _extends phina.display.DisplayElement
 */
class PlainElement extends DisplayElement {

  /**
   * @param {DisplayElement.defaults} options 
   */
  constructor(options) {
    super(options);
    this.canvas = new Canvas();
    this.canvas.setSize(this.width, this.height);
  }

  /**
   * @param {Canvas} canvas
   * @returns {void}
   */
  draw(canvas) {
    var image = this.canvas.domElement;
    var w = image.width;
    var h = image.height;

    var x = -w*this.origin.x;
    var y = -h*this.origin.y;

    canvas.context.drawImage(image,
      0, 0, w, h,
      x, y, w, h
      );
  }
}

/**
 * @class phina.display.Layer
 * _extends phina.display.DisplayElement
 */
class Layer extends DisplayElement {

  /**
   * @param {DisplayElement.defaults} [options] 
   */
  constructor(options) {
    options = $safe.call({}, options||{}, {
    // options = ({}).$safe(options, {
      width: 640,
      height: 960,
    });
    super(options);
    this.width = options.width;
    this.height = options.height;
    this.gridX = new Grid(options.width, 16);
    this.gridY = new Grid(options.height, 16);
    this.renderChildBySelf = true;

    /**
     * @type HTMLCanvasElement 
     */
    this.domElement;
  }

  /**
   * @param {Canvas} canvas
   * @returns {void}
   */
  draw(canvas) {
    if (!this.domElement) return ;

    var image = this.domElement;
    canvas.context.drawImage(image,
      0, 0, image.width, image.height,
      -this.width*this.originX, -this.height*this.originY, this.width, this.height
      );
  }
}


/**
 * @class phina.display.CanvasLayer
 * _extends phina.display.Layer
 */
class CanvasLayer extends Layer {

  /**
   * @param {DisplayElement.defaults} options 
   */
  constructor(options) {
    super(options);
    this.canvas = new Canvas();
    this.canvas.width  = this.width;
    this.canvas.height = this.height;

    this.renderer = new CanvasRenderer(this.canvas);
    this.domElement = this.canvas.domElement;

    this.on('enterframe',
    /** @this CanvasLayer */
    function() {
      var temp = this._worldMatrix;
      this._worldMatrix = null;
      this.renderer.render(this);
      this._worldMatrix = temp;
    });
  }

  /**
   * @param {Canvas} canvas
   * @returns {void}
   */
  draw(canvas) {
    var image = this.domElement;
    canvas.context.drawImage(image,
      0, 0, image.width, image.height,
      -this.width*this.originX, -this.height*this.originY, this.width, this.height
      );
  }
}

var THREE = phina.global['THREE'];

/**
 * @class phina.display.ThreeLayer
 * _extends phina.display.Layer
 */
class ThreeLayer extends Layer {

  // scene: null,
  // camera: null,
  // light: null,
  // renderer: null,

  constructor(options) {
    super(options);

    this.scene = new THREE.Scene();

    this.camera = new THREE.PerspectiveCamera( 75, options.width / options.height, 1, 10000 );
    this.camera.position.z = 1000;

    this.light = new THREE.DirectionalLight( 0xffffff, 1 );
    this.light.position.set( 1, 1, 1 ).normalize();
    this.scene.add( this.light );

    this.renderer = new THREE.WebGLRenderer();
    this.renderer.setClearColor( 0xf0f0f0 );
    this.renderer.setSize( options.width, options.height );

    this.on('enterframe',
    /** @this ThreeLayer */
    function() {
      this.renderer.render( this.scene, this.camera );
    });

    this.domElement = this.renderer.domElement;
  }
}

/**
 * Shapeクラスオプション
 * @typedef {{
 *   padding?: number,
 *   backgroundColor?: import('../graphics/canvas').CanvasStyle,
 *   fill?: import('../graphics/canvas').CanvasStyle | false,
 *   stroke?: import('../graphics/canvas').CanvasStyle | false,
 *   strokeWidth?: number,
 *   lineCap?: CanvasLineCap,
 *   lineJoin?: CanvasLineJoin,
 *   shadow?: string | false,
 *   shadowBlur?: number,
 * } & import('../display/displayelement').DisplayElementOptions } ShapeOptions
 */

/**
 * @class phina.display.Shape
 * _extends phina.display.PlainElement
 */
class Shape extends PlainElement {

  /**
   * @param {ShapeOptions} [options]
   */
  constructor(options) {
    // options = ({}).$safe(options || {}, phina.display.Shape.defaults);
    options = $safe.call({}, options||{}, Shape.defaults);

    super(options);

    this.padding = options.padding;

    this.backgroundColor = options.backgroundColor;
    this.fill = options.fill;
    this.stroke = options.stroke;
    this.strokeWidth = options.strokeWidth;
    this.lineCap = options.lineCap;
    this.lineJoin = options.lineJoin;

    this.shadow = options.shadow;
    this.shadowBlur = options.shadowBlur;

    this.watchDraw = true;
    this._dirtyDraw = true;

    /** @this Shape */
    var checkRender = function() {
      // render
      if (this.watchDraw && this._dirtyDraw === true) {
        this.render(this.canvas);
        this._dirtyDraw = false;
      }
    };

    this.on('enterframe', checkRender);
    this.on('added', checkRender);
  }

  calcCanvasWidth() {
    return this.width + this.padding*2;
  }

  calcCanvasHeight() {
    return this.height + this.padding*2;
  }

  calcCanvasSize () {
    return {
      width: this.calcCanvasWidth(),
      height: this.calcCanvasHeight(),
    };
  }

  isStrokable() {
    return this.stroke && 0 < this.strokeWidth;
  }

  /**
   * @virtual
   * @param  {import('../graphics/canvas').Canvas} _canvas 
   * @returns {any}
   */
  prerender(_canvas) {

  }

  /**
   * @virtual
   * @param  {import('../graphics/canvas').Canvas} _canvas 
   * @returns {any}
   */
  postrender(_canvas) {

  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   * @returns {void}
   */
  renderFill(canvas) {
    canvas.fill();
  }

  /**
   * @param {import('../graphics/canvas').Canvas} canvas 
   * @returns {void}
   */
  renderStroke(canvas) {
    canvas.stroke();
  }

  /**
   * @param {import('../graphics/canvas').Canvas} canvas 
   * @returns {this}
   */
  render(canvas) {
    var context = canvas.context;
    // リサイズ
    var size = this.calcCanvasSize();
    canvas.setSize(size.width, size.height);
    // クリアカラー
    canvas.clearColor(this.backgroundColor);
    // 中心に座標を移動
    canvas.transformCenter();

    // 描画前処理
    this.prerender(this.canvas);

    // ストローク描画
    if (this.isStrokable()) {
      context.strokeStyle = /** @type {import('../graphics/canvas').CanvasStyle} */(this.stroke);
      context.lineWidth = this.strokeWidth;
      context.lineCap = this.lineCap;
      context.lineJoin = this.lineJoin;
      context.shadowBlur = 0;
      this.renderStroke(canvas);
    }

    // 塗りつぶし描画
    if (this.fill) {
      context.fillStyle = this.fill;

      // shadow の on/off
      if (this.shadow) {
        context.shadowColor = this.shadow;
        context.shadowBlur = this.shadowBlur;
      }
      else {
        context.shadowBlur = 0;
      }

      this.renderFill(canvas);
    }

    // 描画後処理
    this.postrender(this.canvas);

    return this;
  }

  /**
   * 指定プロパティを監視し、変更があったらダーティフラグを立てて再描画を促す
   * @param {string} key
   * @returns {void}
   */
  static watchRenderProperty(key) {
    // this.prototype.$watch(key, function(newVal, oldVal) {
    $watch.call(this.prototype, key, function(newVal, oldVal) {
      if (newVal !== oldVal) {
        this._dirtyDraw = true;
      }
    });
  }

  /**
   * Shape.watchRenderPropertyをまとめて行う
   * @param {string[]} keys
   * @returns {void}
   */
  static watchRenderProperties(keys) {
    var watchRenderProperty = this.watchRenderProperty || Shape.watchRenderProperty;
    keys.forEach(function(key) {
      watchRenderProperty.call(this, key);
    }, this);
  }

}

/**
 * @type {ShapeOptions}
 * @static
 */
Shape.defaults = {
  width: 64,
  height: 64,
  padding: 8,

  backgroundColor: '#aaa',
  fill: '#00a',
  stroke: '#aaa',
  strokeWidth: 4,
  lineCap: 'round',
  lineJoin: 'round',

  shadow: false,
  shadowBlur: 4,
};

// _defined
Shape.watchRenderProperties([
  'width',
  'height',
  'radius',
  'padding',
  'backgroundColor',
  'fill',
  'stroke',
  'strokeWidth',
  'lineCap',
  'lineJoin',
  'shadow',
  'shadowBlur',
]);


/**
 * @typedef {{
 *   cornerRadius?: number
 * } & ShapeOptions } RectangleShapeOptions
 */

  /**
 * @class phina.display.RectangleShape
 * _extends phina.display.Shape
 * 矩形描画クラス
 */
class RectangleShape extends Shape {

  /**
   * @param {RectangleShapeOptions} [options]
   */
  constructor(options) {
    // options = ({}).$safe(options || {}, phina.display.RectangleShape.defaults);
    options = $safe.call({}, options||{}, RectangleShape.defaults);

    super(options);

    this.cornerRadius = options.cornerRadius;
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    canvas.roundRect(-this.width/2, -this.height/2, this.width, this.height, this.cornerRadius);
  }

}

/**
 * @type {RectangleShapeOptions}
 * @static
 */
RectangleShape.defaults = {
  backgroundColor: 'transparent',
  fill: 'blue',
  stroke: '#aaa',
  strokeWidth: 4,
  cornerRadius: 0,
};

// _defined
Shape.watchRenderProperty.call(RectangleShape, 'cornerRadius');


/**
 * @typedef {{
 *   radius?: number
 * } & ShapeOptions } CircleShapeOptions
 */

/**
 * @class phina.display.CircleShape
 * _extends phina.display.Shape
 */
class CircleShape extends Shape {

  /**
   * @param {CircleShapeOptions} [options]
   */
  constructor(options) {
    // options = ({}).$safe(options || {}, phina.display.CircleShape.defaults);
    options = $safe.call({}, options||{}, CircleShape.defaults);

    super(options);

    this.setBoundingType('circle');
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    canvas.circle(0, 0, this.radius);
  }

}

/**
 * @type {CircleShapeOptions}
 * @static
 */
CircleShape.defaults = {
  backgroundColor: 'transparent',
  fill: 'red',
  stroke: '#aaa',
  strokeWidth: 4,
  radius: 32,
};


/**
 * @class phina.display.TriangleShape
 * _extends phina.display.Shape
 */
class TriangleShape extends Shape {

  /**
   * @param {CircleShapeOptions} [options]
   */
  constructor(options) {
    // options = ({}).$safe(options || {}, phina.display.TriangleShape.defaults);
    options = $safe.call({}, options||{}, TriangleShape.defaults);

    super(options);

    this.setBoundingType('circle');
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    canvas.polygon(0, 0, this.radius, 3);
  }

}

/**
 * @type {CircleShapeOptions}
 * @static
 */
TriangleShape.defaults = {
  backgroundColor: 'transparent',
  fill: 'green',
  stroke: '#aaa',
  strokeWidth: 4,

  radius: 32,
};


/**
 * @typedef {{
 *   sides?: number,
 * } & CircleShapeOptions } PolygonShapeOptions
 */
/**
 * @typedef {{
 *   sideIndent?: number,
 * } & PolygonShapeOptions } StarShapeOptions
 */

/**
 * @class phina.display.StarShape
 * _extends phina.display.Shape
 */
class StarShape extends Shape {

  /**
   * @param {StarShapeOptions} [options] 
   */
  constructor(options) {
    // options = ({}).$safe(options || {}, phina.display.StarShape.defaults);
    options = $safe.call({}, options||{}, StarShape.defaults);

    super(options);

    this.setBoundingType('circle');
    this.sides = options.sides;
    this.sideIndent = options.sideIndent;
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    canvas.star(0, 0, this.radius, this.sides, this.sideIndent);
  }

}

/**
 * @type {StarShapeOptions}
 * @static
 */
StarShape.defaults = {
  backgroundColor: 'transparent',
  fill: 'yellow',
  stroke: '#aaa',
  strokeWidth: 4,

  radius: 32,
  sides: 5,
  sideIndent: 0.38,
};

// _defined
Shape.watchRenderProperty.call(StarShape, 'sides');
Shape.watchRenderProperty.call(StarShape, 'sideIndent');


/**
 * @class phina.display.PolygonShape
 * _extends phina.display.Shape
 */
class PolygonShape extends Shape {

  /**
   * @param {PolygonShapeOptions} [options] 
   */
  constructor(options) {
    // options = ({}).$safe(options || {}, phina.display.PolygonShape.defaults);
    options = $safe.call({}, options||{}, PolygonShape.defaults);

    super(options);

    this.setBoundingType('circle');
    this.sides = options.sides;
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    canvas.polygon(0, 0, this.radius, this.sides);
  }

}

/**
 * @type {PolygonShapeOptions}
 * @static
 */
PolygonShape.defaults = {
  backgroundColor: 'transparent',
  fill: 'cyan',
  stroke: '#aaa',
  strokeWidth: 4,

  radius: 32,
  sides: 5,
};

// defined
Shape.watchRenderProperty.call(PolygonShape, 'sides');


/**
 * @typedef {{
 *   cornerAngle?: number,
 * } & CircleShapeOptions } HeartShapeOptions
 */

/**
 * @class phina.display.HeartShape
 * _extends phina.display.Shape
 */
class HeartShape extends Shape {

  /**
   * @param {HeartShapeOptions} [options]
   */
  constructor(options) {
    // options = ({}).$safe(options || {}, phina.display.HeartShape.defaults);
    options = $safe.call({}, options||{}, HeartShape.defaults);

    super(options);

    this.setBoundingType('circle');
    this.cornerAngle = options.cornerAngle;
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    canvas.heart(0, 0, this.radius, this.cornerAngle);
  }

}

/**
 * @type {HeartShapeOptions}
 * @static
 */
HeartShape.defaults = {
  backgroundColor: 'transparent',
  fill: 'pink',
  stroke: '#aaa',
  strokeWidth: 4,

  radius: 32,
  cornerAngle: 45,
};

// defined
Shape.watchRenderProperty.call(HeartShape, 'cornerAngle');


/**
 * @typedef {{
 *   paths?: Vector2[]
 * } & ShapeOptions } PathShapeOptions
 */

/**
 * @class phina.display.PathShape
 * _extends phina.display.Shape
 */
class PathShape extends Shape {
  // paths: null,

  /**
   * @param {PathShapeOptions} [options]
   */
  constructor(options) {
    // options = ({}).$safe(options || {}, phina.display.PathShape.defaults);
    options = $safe.call({}, options||{}, PathShape.defaults);

    super(options);
    this.paths = options.paths || [];
    this.lineJoin = options.lineJoin;
    this.lineCap = options.lineCap;
  }

  /**
   * @param {Vector2[]} paths
   * @returns {this}
   */
  setPaths (paths) {
    this.paths = paths;
    this._dirtyDraw = true;
    return this;
  }

  /**
   * @returns {this}
   */
  clear () {
    this.paths.length = 0;
    this._dirtyDraw = true;
    return this;
  }

  /**
   * @param {Vector2[]} paths 
   * @returns {this}
   */
  addPaths (paths) {
    [].push.apply(this.paths, paths);
    this._dirtyDraw = true;
    return this;
  }

  /**
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  addPath (x, y) {
    this.paths.push(new Vector2(x, y));
    this._dirtyDraw = true;
    return this;
  }

  /**
   * @param {string | number} i
   * @returns {Vector2}
   */
  getPath (i) {
    return this.paths[i];
  }

  /**
   * @returns {Vector2[]} paths 
   */
  getPaths () {
    return this.paths;
  }

  /**
   * @param {string | number} i
   * @param {number} x
   * @param {number} y
   */
  changePath (i, x, y) {
    this.paths[i].set(x, y);
    this._dirtyDraw = true;
    return this;
  }

  /**
   * @returns {{width: number, height: number}}
   */
  calcCanvasSize () {
    var paths = this.paths;
    if (paths.length === 0) {
      return {
        width: this.padding * 2,
        height:this.padding * 2,
      };
    }
    var maxX = -Infinity;
    var maxY = -Infinity;
    var minX = Infinity;
    var minY = Infinity;

    for (var i = 0, len = paths.length; i < len; ++i) {
      var path = paths[i];
      if (maxX < path.x) { maxX = path.x; }
      if (minX > path.x) { minX = path.x; }
      if (maxY < path.y) { maxY = path.y; }
      if (minY > path.y) { minY = path.y; }
    }
    return {
      width: Math.max(Math.abs(maxX), Math.abs(minX)) * 2 + this.padding * 2,
      height: Math.max(Math.abs(maxY), Math.abs(minY)) * 2 + this.padding * 2,
    };
  }

  /**
   * @returns {number}
   */
  calcCanvasWidth () {
    return this.calcCanvasSize().width;
  }

  /**
   * @returns {number}
   */
  calcCanvasHeight () {
    return this.calcCanvasSize().height;
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  prerender (canvas) {
    var paths = this.paths;
    if (paths.length > 1) {
      var c = canvas.context;
      var p = paths[0];
      c.beginPath();
      c.moveTo(p.x, p.y);
      for (var i = 1, len = paths.length; i < len; ++i) {
        p = paths[i];
        c.lineTo(p.x, p.y);
      }
    }
  }

}

/**
 * @type {PathShapeOptions}
 * @static
 */
PathShape.defaults = {
  fill: false,
  backgroundColor: 'transparent',
};

/**
 * @typedef {{
 *   text?: string
 *   fontSize?: number
 *   fontWeight?: string | number
 *   fontFamily?: string
 *   align?: CanvasTextAlign
 *   baseline?: CanvasTextBaseline
 *   lineHeight?: number
 * } & import("./shape").ShapeOptions } LabelOptions
 */

/**
 * @class phina.display.Label
 * _extends phina.display.Shape
 */
class Label extends Shape {

  /**
   * @constructor
   * @param {LabelOptions} [options]
   */
  constructor(options) {
    if (typeof arguments[0] !== 'object') {
      options = { text: arguments[0], };
    }
    else {
      options = arguments[0];
    }

    options = $safe.call({}, options||{}, Label.defaults);
    // options = ({}).$safe(options, phina.display.Label.defaults);

    super(options);

    /** @type {string|number} */
    this._text;

    this.text = options.text;
    this.fontSize = options.fontSize;
    this.fontWeight = options.fontWeight;
    this.fontFamily = options.fontFamily;
    this.align = options.align;
    this.baseline = options.baseline;
    this.lineHeight = options.lineHeight;
  }

  /**
   * @returns {number}
   */
  calcCanvasWidth() {
    var width = 0;
    var canvas = this.canvas;
    canvas.context.font = this.font;
    this._lines.forEach(function(line) {
      var w = canvas.context.measureText(line).width;
      if (width < w) {
        width = w;
      }
    }, this);
    if (this.align !== 'center') width*=2;

    return width + this.padding*2;
  }

  /**
   * @returns {number}
   */
  calcCanvasHeight() {
    var height = this.fontSize * this._lines.length;
    if (this.baseline !== 'middle') height*=2;
    return height*this.lineHeight + this.padding*2;
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    var context = canvas.context;
    context.font = this.font;
    context.textAlign = this.align;
    context.textBaseline = this.baseline;

    var lines = this._lines;
    this.lineSize = this.fontSize*this.lineHeight;
    this._offset = -Math.floor(lines.length/2)*this.lineSize;
    this._offset += ((lines.length+1)%2) * (this.lineSize/2);
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  renderFill(canvas) {
    var context = canvas.context;
    this._lines.forEach(function(line, i) {
      context.fillText(line, 0, i*this.lineSize+this._offset);
    }, this);
  }

  /**
   * @param  {import('../graphics/canvas').Canvas} canvas 
   */
  renderStroke(canvas) {
    var context = canvas.context;
    this._lines.forEach(function(line, i) {
      context.strokeText(line, 0, i*this.lineSize+this._offset);
    }, this);
  }

  /**
   * text
   * @returns {string|number}
   */
  get text() { return this._text; }
  set text(v) {
    this._text = v;
    this._lines = (this.text + '').split('\n');
  }

  /**
   * @returns {string}
   */
  get font() {
    return format.call("{fontWeight} {fontSize}px {fontFamily}", this);
    // return "{fontWeight} {fontSize}px {fontFamily}".format(this);
  }

}

/**
 * @type {LabelOptions}
 * @static
 */
Label.defaults = {
  backgroundColor: 'transparent',

  fill: 'black',
  stroke: null,
  strokeWidth: 2,

  // 
  text: 'Hello, world!',
  // 
  fontSize: 32,
  fontWeight: '',
  fontFamily: "'HiraKakuProN-W3'", // Hiragino or Helvetica,
  // 
  align: 'center',
  baseline: 'middle',
  lineHeight: 1.2,
};

// defined
Shape.watchRenderProperty.call(Label, 'text');
Shape.watchRenderProperty.call(Label, 'fontSize');
Shape.watchRenderProperty.call(Label, 'fontWeight');
Shape.watchRenderProperty.call(Label, 'fontFamily');
Shape.watchRenderProperty.call(Label, 'align');
Shape.watchRenderProperty.call(Label, 'baseline');
Shape.watchRenderProperty.call(Label, 'lineHeight');

/**
 * Spriteクラスなど、FrameAnimationのtargetとして適正な型
 * @typedef {{
 *   srcRect: import("../geom/rect").Rect
 *   width: number
 *   height: number
 * } & import("./accessory").AccessoryTarget } FrameAnimationTarget
 */

/**
 * @class phina.accessory.FrameAnimation
 * _extends phina.accessory.Accessory
 * 
 * フレームアニメーション制御を行うAccessory派生クラス
 * 
 * 予めロード（パース）したスプライトシートJSONデータを使い、
 * Spriteクラスのフレーム範囲を制御することでアニメーションを実現する
 * @see https://qiita.com/alkn203/items/a287c7524193f5f4ca90
 * 
 * @example
 * // 予め"player_ss"という名前でスプライトシート画像、Jsonデータをアセット登録しておく
 * // player_ssには"walk"という名前のアニメーションを定義
 * const target = new phina.display.Sprite("player_ss");
 * const frameAnim = new phina.accessory.FrameAnimation("player_ss").attachTo(target);
 * frameAnim.gotoAndPlay("walk");
 */
class FrameAnimation extends Accessory {

  /**
   * @constructor
   * @param {string} ss ロード済みスプライトシートデータAssetキー
   */
  constructor(ss) {
    super();

    /** @type {FrameAnimationTarget} */
    this.target;

    /**
     * スプライトシートオブジェクト
     * 
     * @type {import('../asset/spritesheet').SpriteSheet}
     */
    this.ss = AssetManager.get('spritesheet', ss);

    /**
     * 再生中のアニメーションのデータオブジェクト
     * 
     * @type {import("../asset/spritesheet").SpriteSheetAnimationData | null}
     */
    this.currentAnimation;

    /**
     * 再生中のアニメーション名
     * 
     * @type {(string | number) | null}
     */
    this.currentAnimationName;

    /**
     * 停止状態
     * 
     * @type {boolean}
     */
    this.paused = true;

    /**
     * フレームサイズに合わせて対象の幅・高さを変えるかどうか
     * 
     * @type {boolean}
     */
    this.fit = true;

    /**
     * 現在のアニメーションフレームを表すインデックス値
     * 
     * @type {number}
     * @protected
     */
    this.currentFrameIndex;

    /**
     * アニメーション更新用のアプリフレームのカウント値
     * 
     * @type {number}
     * @protected
     */
    this.frame;

    /**
     * 終了フラグ：trueの時はupdate時にcurrentFrameIndexがリセットされる
     * 
     * @type {boolean}
     * @protected
     */
    this.finished = false;
  }

  /**
   * @param {*} _app Appクラスインスタンス
   */
  update(_app) {
    if (this.paused) return ;
    if (!this.currentAnimation) return ;

    if (this.finished) {
      this.finished = false;
      this.currentFrameIndex = 0;
      return ;
    }

    ++this.frame;
    if (this.frame%this.currentAnimation.frequency === 0) {
      ++this.currentFrameIndex;
      this._updateFrame();
    }
  }

  /**
   * 指定アニメーションを再生
   * 
   * @param {string | number} name アニメーション名
   * @param {boolean} [keep=true] 同名アニメーションがすでに再生中の場合、そのままにするかどうか
   * @returns {this}
   */
  gotoAndPlay(name, keep) {
    keep = (keep !== undefined) ? keep : true;
    if (keep && this.currentAnimation
             && name === this.currentAnimationName
             && this.currentFrameIndex < this.currentAnimation.frames.length
             && !this.paused) {
      return this;
    }
    this.currentAnimationName = name;
    this.frame = 0;
    this.currentFrameIndex = 0;
    this.currentAnimation = this.ss.getAnimation(name);
    this._updateFrame();

    this.paused = false;

    return this;
  }

  /**
   * 指定アニメーション及びその冒頭フレームをセット後、停止状態にする
   * 
   * @param {string} name アニメーション名
   * @returns {this}
   */
  gotoAndStop(name) {
    this.currentAnimationName = name;
    this.frame = 0;
    this.currentFrameIndex = 0;
    this.currentAnimation = this.ss.getAnimation(name);
    this._updateFrame();

    this.paused = true;

    return this;
  }

  /**
   * フレーム更新処理
   * 
   * @protected
   * @returns {void}
   */
  _updateFrame() {
    if (!this.currentAnimation) return;

    var anim = this.currentAnimation;
    if (this.currentFrameIndex >= anim.frames.length) {
      if (anim.next) {
        this.gotoAndPlay(anim.next);
        return ;
      }
      else {
        this.paused = true;
        this.finished = true;
        return ;
      }
    }

    var index = anim.frames[this.currentFrameIndex];
    var frame = this.ss.getFrame(index);
    this.target.srcRect.set(frame.x, frame.y, frame.width, frame.height);

    if (this.fit) {
      this.target.width = frame.width;
      this.target.height = frame.height;
    }
  }

}

/**
 * @typedef {{
 *   x: number
 *   y: number
 *   setInteractive: (flag:boolean) => any
 * } & import("./accessory").AccessoryAttachable } FlickableTarget
 */

/**
 * @class phina.accessory.Flickable
 * Flickable
 * _extends phina.accessory.Accessory
 */
class Flickable extends Accessory {

  /**
   * @constructor
   * @param {FlickableTarget} target
   */
  constructor(target) {
    super(target);

    /** @type {FlickableTarget} */
    this.target;

    /**
     * フリック開始位置
     */
    this.initialPosition = new Vector2(0, 0);

    /**
     * 摩擦値
     * @default 0.9
     */
    this.friction = 0.9;

    /**
     * 速度ベクトル
     */
    this.velocity = new Vector2(0, 0);

    /**
     * 上下の移動を許可するかどうか（初期値：true）
     * @default true
     */
    this.vertical = true;

    /**
     * 左右の移動を許可するかどうか（初期値：true）
     * @default true
     */
    this.horizontal = true;

    /**
     * キャッシュした差分値
     * @protected
     */
    this.cacheList = [];

    var self = this;
    this.on('attached', 
    /** @this {Flickable} */
    function() {
      this.target.setInteractive(true);

      this.target.on('pointstart', function(e) {
        self.initialPosition.set(this.x, this.y);
        self.velocity.set(0, 0);
      });
      this.target.on('pointstay', function(e) {
        if (self.horizontal) {
          this.x += e.pointer.dx;
        }
        if (self.vertical) {
          this.y += e.pointer.dy;
        }

        if (self.cacheList.length > 3) self.cacheList.shift();
        self.cacheList.push(e.pointer.deltaPosition.clone());
      });

      this.target.on('pointend', function(e) {
        // 動きのある delta position を後ろから検索　
        var delta = self.cacheList.reverse().find(function(v) {
          return v.lengthSquared() > 10;
        });
        clear.call(self.cacheList);
        // self.cacheList.clear();

        if (delta) {
          self.velocity.x = delta.x;
          self.velocity.y = delta.y;

          self.flare('flickstart', {
            direction: delta.normalize(),
          });
        }
        else {
          self.flare('flickcancel');
        }

        // self.flare('flick');
        // self.flare('flickend');
      });
    });
  }

  /**
   * 更新関数
   * @param {*} _app Appクラスインスタンス
   */
  update(_app) {
    if (!this.target) return ;

    this.velocity.x *= this.friction;
    this.velocity.y *= this.friction;

    if (this.horizontal) {
      this.target.position.x += this.velocity.x;
    }
    if (this.vertical) {
      this.target.position.y += this.velocity.y;
    }
  }

  /**
   * 位置・速度をフリック前に戻す
   * @returns {void}
   */
  cancel() {
    this.target.x = this.initialPosition.x;
    this.target.y = this.initialPosition.y;
    this.velocity.set(0, 0);

    // TODO: 
    // this.setInteractive(false);
    // this.tweener.clear()
    //     .move(this.initialX, this.initialY, 500, "easeOutElastic")
    //     .call(function () {
    //         this.setInteractive(true);
    //         this.fire(tm.event.Event("backend"));
    //     }.bind(this));
  }

  /**
   * フリック可能にする
   * @returns {void}
   */
  enable() {
    this._enable = true;
  }

}

// TODO: Element側で呼ぶ？
// phina.app.Element.prototype.getter('flickable', function() {
//   if (!this._flickable) {
//     this._flickable = phina.accessory.Flickable().attachTo(this);
//   }
//   return this._flickable;
// });

/**
 * @typedef {{
 *   position: import("../geom/vector2").PrimitiveVector2
 * } & import("./accessory").AccessoryAttachable } PhysicalTarget
 */

/**
 * @class phina.accessory.Physical
 * 本物ではないので名前変えるかも
 * FakePhysical or MarioPhysical or LiePhysical
 * RetroPysical or PysicaLike
 * _extends phina.accessory.Accessory
 */
class Physical extends Accessory  {

  /**
   * @constructor
   * @param {PhysicalTarget} target
   */
  constructor(target) {
    super(target);

    /**
     * かかっている力のベクトル
     */
    this.velocity = new Vector2(0, 0);

    /**
     * 重力ベクトル
     */
    this.gravity = new Vector2(0, 0);

    /**
     * 摩擦値
     * @default 1.0
     */
    this.friction = 1.0;
  }

  /**
   * 更新関数
   * @param {*} _app Appクラスインスタンス
   */
  update(_app) {
    var t = /** @type {PhysicalTarget} */(this.target);

    this.velocity.x *= this.friction;
    this.velocity.y *= this.friction;

    this.velocity.x += this.gravity.x;
    this.velocity.y += this.gravity.y;

    t.position.x += this.velocity.x;
    t.position.y += this.velocity.y;
  }

  /**
   * 力ベクトルをセット
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  force(x, y) {
    this.velocity.set(x, y);
    return this;
  }

  /**
   * 力ベクトルに値を加算
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  addForce(x, y) {
    this.velocity.x += x;
    this.velocity.y += y;
    return this;
  }

  /**
   * 重力ベクトルをセット
   * @param {number} x
   * @param {number} y
   * @returns {this}
   */
  setGravity(x, y) {
    this.gravity.set(x, y);
    return this;
  }

  /**
   * 摩擦値をセット
   * @param {number} fr
   * @returns {this}
   */
  setFriction(fr) {
    this.friction = fr;
    return this;
  }
}

// phina.app.Element.prototype.getter('physical', function() {
//   if (!this._physical) {
//     this._physical = phina.accessory.Physical().attachTo(this);
//   }
//   return this._physical;
// });

/** @typedef {string | import("./file").FileAssetLoadParam | any} AssetSrc 基本的には文字列だがAsset種類によって変わる */

/**
 * @class phina.asset.Asset
 * _extends phina.util.EventDispatcher
 */
class Asset extends EventDispatcher {

  // serverError: false,
  // notFound: false,
  // loadError: false,

  /**
   * @constructor
   */
  constructor() {
    super();

    this.loaded = false;
    this.serverError = false;
    this.notFound = false;
    this.loadError = false;

    /** @type {AssetSrc} */
    this.src = undefined;
  }

  /**
   * @param {AssetSrc} src
   * @returns {Flow}
   */
  load(src) {
    this.src = src;
    return new Flow(this._load.bind(this));
  }

  /**
   * ロード済みかどうか
   * @returns {boolean}
   */
  isLoaded() {
    return this.loaded;
  }

  /**
   * アセット種類に応じてサブクラスでオーバーライド
   * @protected
   * @param {(...args: any) => any} resolve
   */
  _load(resolve) {
    var self = this;
    setTimeout(function() {
      self.loaded = true;
      resolve();
    }, 100);
  }

  /**
   * @virtual
   * ロード失敗時にダミーをセットする
   */
  loadDummy() { }

}

var getFirst = function(array) { return first.get.call(array); };
var getLast = function(array) { return last.get.call(array); };

/**
 * @class phina.asset.Texture
 * _extends phina.asset.Asset
 */
class Texture extends Asset {

  /**
   * @constructor
   */
  constructor() {
    super();

    /** @type {HTMLImageElement|HTMLCanvasElement} */
    this.domElement = new Image();
    
    /** @type {string} */
    this.src;
  }

  /**
   * @protected
   * @override
   * @param {(...args: any) => any} resolve
   */
  _load(resolve) {
    this.domElement = new Image();

    var isLocal = (location.protocol == 'file:');
    if ( !isLocal && !(/^data:/.test(this.src)) ) ;

    var self = this;
    this.domElement.onload = function(e) {
      self.loaded = true;
      resolve(self);
    };
    /** @param {Event} e */
    this.domElement.onerror = function(e) {
      console.error(format.call("[phina.js] not found `{0}`!", this.src));
      // console.error("[phina.js] not found `{0}`!".format(this.src));

      // var key = self.src.split('/').last.replace('.png', '').split('?').first.split('#').first;
      var key = getFirst(
        getFirst(
          getLast(
            self.src.split('/')
          ).replace('.png', '').split('?')
        ).split('#')
      );

      // 型アサーション
      var target = /** @type {HTMLImageElement} */ (e.target);
      target.onerror = null;
      target.src = "http://dummyimage.com/128x128/444444/eeeeee&text=" + key;
    };

    this.domElement.src = this.src;
  }

  /**
   * 新たにTextureをクローン生成して返す
   * @returns {Texture}
   */
  clone() {
    var image = this.domElement;
    var canvas = new Canvas().setSize(image.width, image.height);
    var t = new Texture();
    canvas.context.drawImage(image, 0, 0);
    t.domElement = canvas.domElement;
    return t;
  }

  /**
   * @param {{ r: number; g: number; b: number; }} [color]
   * @returns {void}
   */
  transmit(color) {
    // imagaオブジェクトをゲット
    var image = this.domElement;
    // 新規canvas作成
    var canvas = new Canvas().setSize(image.width, image.height);
    // 新規canvasに描画
    canvas.context.drawImage(image, 0, 0);
    // canvas全体のイメージデータ配列をゲット
    var imageData = canvas.context.getImageData(0, 0, canvas.width, canvas.height);
    var data = imageData.data;
    // 透過色の指定がなければ左上のrgb値を抽出
    var r = (color !== undefined) ? color.r : data[0];
    var g = (color !== undefined) ? color.g : data[1];
    var b = (color !== undefined) ? color.b : data[2];
    // 配列を4要素目から4つ飛び（アルファ値）でループ
    // (3).step(data.length, 4, function(i) {
    step.call(3, data.length, 4, function(i) {
      // rgb値を逆算でゲットし、左上のrgbと比較
      if (data[i - 3] === r && data[i - 2] === g && data[i - 1] === b) {
        // 一致した場合はアルファ値を書き換える
        data[i] = 0;
      }
    });
    // 書き換えたイメージデータをcanvasに戻す
    canvas.context.putImageData(imageData, 0, 0);

    this.domElement = canvas.domElement;
  }

  /**
   * @typedef {(pixel: Uint8ClampedArray, index: number, x: number, y: number, imageData: ImageData )=> void} FilterFunc
   * @param {FilterFunc | FilterFunc[]} filters
   * @returns {this}
   */
  filter(filters) {
    if (!filters) {
      return this;
    }
    if (!Array.isArray(filters)) {
      filters = [filters];
    }
    var image = this.domElement;
    var w = image.width;
    var h = image.height;
    var canvas = new Canvas().setSize(w, h);

    /** @type {ImageData} */
    var imageData = null;

    canvas.context.drawImage(image, 0, 0);
    imageData = canvas.context.getImageData(0, 0, w, h);
    filters.forEach( function (fn) {
      if (typeof fn == 'function') {
        // h.times( function (y) {
        times.call(h, function (y) {
          // w.times( function (x) {
          times.call(w, function (x) {
            var i = (y * w + x) * 4;
            var pixel = imageData.data.slice(i, i + 4);
            fn(pixel, i, x, y, imageData);
          });
        });
      }
    });
    canvas.context.putImageData(imageData, 0, 0);
    this.domElement = canvas.domElement;
    return this;
  }

}

/**
 * @class phina.asset.Sound
 * _extends phina.asset.Asset
 */
class Sound extends Asset {

  /**
   * @constructor
   */
  constructor() {
    super();
    this._loop = false;
    this._loopStart = 0;
    this._loopEnd = 0;
    this._playbackRate = 1;
    this.context = Sound.getAudioContext();
    this.gainNode = this.context.createGain();

    /** @type {(AudioBufferSourceNode | OscillatorNode)?} */
    this.source;

    /** @type {string} */
    this.src;
  }

  /**
   * 音源を再生
   * 音源終了時に"ended"イベントを発生
   * 
   * @param {number} [when=0] 指定の秒数、再生を遅らせる
   * @param {number} [offset=0] 音源のどの時間位置で再生するかを秒数指定
   * @param {number} [duration] 再生時間を秒数指定
   * @returns {this}
   */
  play(when, offset, duration) {
    when = when ? when + this.context.currentTime : 0;
    offset = offset || 0;

    if (this.source) ;

    var source = this.source = this.context.createBufferSource();
    var buffer = source.buffer = this.buffer;
    source.loop = this._loop;
    source.loopStart = this._loopStart;
    source.loopEnd = this._loopEnd;
    source.playbackRate.value = this._playbackRate;

    // connect
    source.connect(this.gainNode);
    this.gainNode.connect(Sound.getMasterGain());

    // play
    if (duration !== undefined) {
      source.start(when, offset, duration);
    }
    else {
      source.start(when, offset);
    }

    // check play end
    source.addEventListener('ended', function(){
      this.flare('ended');
    }.bind(this));

    return this;
  }

  /**
   * 再生を停止（再生中でなかった時は何もしない）  
   * 再生中だった場合、同時に"stop", "ended"イベントを発火する
   * 
   * @returns {this}
   */
  stop() {
    if (this.source) {
      // stop すると source.endedも発火する
      this.source.stop && this.source.stop(0);
      this.source = null;
      this.flare('stop');
    }

    return this;
  }

  /**
   * 再生を一時停止
   * 同時に"pause"イベントを発火する
   * 
   * @returns {this}
   */
  pause() {
    /** @type {AudioBufferSourceNode} */
    (this.source).playbackRate.value = 0;
    this.flare('pause');
    return this;
  }

  /**
   * 再生を再開
   * 同時に"resume"イベントを発火する
   * 
   * @returns {this}
   */
  resume() {
    /** @type {AudioBufferSourceNode} */
    (this.source).playbackRate.value = this._playbackRate;
    this.flare('resume');
    return this;
  }

  /**
   * @private
   * 未実装
   * 
   * @param {*} type 
   */
  _oscillator(type) {
    var context = this.context;

    var oscillator = context.createOscillator();

    // Sine wave is type = “sine”
    // Square wave is type = “square”
    // Sawtooth wave is type = “saw”
    // Triangle wave is type = “triangle”
    // Custom wave is type = “custom” 
    oscillator.type = type || 'sine';

    this.source = oscillator;
    // connect
    this.source.connect(context.destination);
  }

  /**
   * AudioBufferからロード
   * 
   * @param {AudioBuffer} [buffer] 
   */
  loadFromBuffer(buffer) {
    var context = this.context;

    // set default buffer
    if (!buffer) {
      buffer = context.createBuffer( 1, 44100, 44100 );
      var channel = buffer.getChannelData(0);

      for( var i=0; i < channel.length; i++ )
      {
        channel[i] = Math.sin( i / 100 * Math.PI);
      }
    }

    // source
    this.buffer = buffer;
  }

  /**
   * ループ設定
   * 
   * @param {boolean} loop
   * @returns {this}
   */
  setLoop(loop) {
    this.loop = loop;
    return this;
  }

  /**
   * ループ開始位置を秒数で設定
   * 
   * @param {number} loopStart
   * @returns {this}
   */
  setLoopStart(loopStart) {
    this.loopStart = loopStart;
    return this;
  }

  /**
   * ループ終了位置を秒数で設定
   * 
   * @param {number} loopEnd
   * @returns {this}
   */
  setLoopEnd(loopEnd) {
    this.loopEnd = loopEnd;
    return this;
  }
  
  /**
   * 再生速度を設定
   * @see https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode/playbackRate
   * 
   * @param {number} playbackRate
   * @returns {this}
   */
  setPlaybackRate(playbackRate) {
    this.playbackRate = playbackRate;
    return this;
  }

  /**
   * @override
   * @param {(...args: any) => any} r
   */
  _load(r) {
    if (/^data:/.test(this.src)) {
      this._loadFromURIScheme(r);
    }
    else {
      this._loadFromFile(r);
    }
  }

  /**
   * @private
   * @param {(...args: any) => any} r
   */
  _loadFromFile(r) {
    var self = this;

    var xml = new XMLHttpRequest();
    xml.open('GET', this.src);
    xml.onreadystatechange = function() {
      if (xml.readyState === 4) {
        if ([200, 201, 0].indexOf(xml.status) !== -1) {

          // 音楽バイナリーデータ
          var data = xml.response;

          // webaudio 用に変換
          self.context.decodeAudioData(data, function(buffer) {
            self.loadFromBuffer(buffer);
            r(self);
          }, function() {
            console.warn("音声ファイルのデコードに失敗しました。(" + self.src + ")");
            r(self);
            self.flare('decodeerror');
          });

        } else if (xml.status === 404) {
          // not found

          self.loadError = true;
          self.notFound= true;
          r(self);
          self.flare('loaderror');
          self.flare('notfound');

        } else {
          // サーバーエラー

          self.loadError = true;
          self.serverError = true;
          r(self);
          self.flare('loaderror');
          self.flare('servererror');
        }
      }
    };

    xml.responseType = 'arraybuffer';

    xml.send(null);
  }

  /**
   * @private
   * @param {(...args: any) => any} r
   */
  _loadFromURIScheme(r) {
    var byteString = '';
    if (this.src.split(',')[0].indexOf('base64') >= 0) {
      byteString = atob(this.src.split(',')[1]);
    }
    else {
      byteString = unescape(this.src.split(',')[1]);
    }

    var self = this;
    var len = byteString.length;
    var buffer = new Uint8Array(len);

    for (var i=0; i<len; ++i) {
      buffer[i] = byteString.charCodeAt(i);
    }

    // webaudio 用に変換
    this.context.decodeAudioData(buffer.buffer, function(buffer) {
      self.loadFromBuffer(buffer);
      r(self);
    }, function() {
      console.warn("音声ファイルのデコードに失敗しました。(" + self.src + ")");
      self.loaded = true;
      r(self);
    });
  }

  /**
   * @override
   * ダミーバッファをロード
   */
  loadDummy() {
    this.loadFromBuffer();
  }

  /**
   * 音量
   */
  get volume()  { return this.gainNode.gain.value; }
  set volume(v) { this.gainNode.gain.value = v; }

  /**
   * ループ設定
   */
  get loop()  { return this._loop; }
  set loop(v) {
    this._loop = v;
  }

  /**
   * ループ開始時間位置(second)
   */
  get loopStart()  { return this._loopStart; }
  set loopStart(v) {
    this._loopStart = v;
  }

  /**
   * ループ終了時間位置(second)
   */
  get loopEnd()  { return this._loopEnd; }
  set loopEnd(v) {
    this._loopEnd = v;
  }

  /**
   * 再生速度
   */
  get playbackRate() { return this._playbackRate; }
  set playbackRate(v) {
    this._playbackRate = v;
    this.source = /** @type {AudioBufferSourceNode} */(this.source);
    if (this.source && this.source.playbackRate.value !== 0) {
      this.source.playbackRate.value = v;
    }
  }

  /**
   * マスターのゲインノードを返します。  
   * GainNodeが未生成の場合は生成して返します。
   * @returns {GainNode}
   */
  static getMasterGain() {
    if(!this._masterGain) {
      var context = this.getAudioContext();
      this._masterGain = context.createGain();
      this._masterGain.connect(context.destination);
    }
    return this._masterGain;
  }

  /**
   * WebAudioのコンテキストを生成して返します。  
   * すでに生成済みの場合はそれを返します。  
   * WebAudio未サポートの場合はnullを返します。
   * @returns {AudioContext | null}
   */
  static getAudioContext() {
    if (!Support.webAudio) return null;

    if (this.context) return this.context;

    var g = phina.global;
    var context = null;

    if (g.AudioContext) {
      context = new AudioContext();
    }
    else if (g['webkitAudioContext']) {
      context = new g['webkitAudioContext']();
    }
    else if (g['mozAudioContext']) {
      context = new g['mozAudioContext']();
    }

    this.context = context;

    return context;
  }

  /**
   * マスター音量を取得
   */
  static get volume() {
    return this.getMasterGain().gain.value;
  }

  /**
   * マスター音量をセット
   * @param {number} v
   */
  static set volume(v) {
    this.getMasterGain().gain.value = v;
  }
}

/**
 * @class phina.asset.Script
 * _extends phina.asset.Asset
 */
class Script extends Asset {

  /**
   * @constructor
   */
  constructor() {
    super();
    
    /** @type {string} */
    this.src;
  }

  _load(resolve) {
    var self = this;
    this.domElement = document.createElement('script');
    this.domElement.src = this.src;

    this.domElement.onload = function() {
      resolve(self);
    }.bind(this);

    document.body.appendChild(this.domElement);
  }

}

/**
 * @typedef {Object} SpriteSheetFrameData
 * @property {number} x フレーム左上x座標
 * @property {number} y フレーム左上y座標
 * @property {number} width フレーム横幅
 * @property {number} height フレーム縦幅
 */

 /**
 * 各アニメーションの詳細
 * @typedef {Object} SpriteSheetAnimationData
 * @property {number[]} frames フレーム番号順の数列 ex) [0, 1, 2]
 * @property {string | number} next 現アニメーション終了時に移行したいアニメーション名、ループさせたい場合は同じアニメーションを指定
 * @property {number} frequency フレーム更新頻度（間隔）
 */

/**
 * SpriteSheetAnimationDataの配列版
 * @typedef {[
 *   number, // 開始フレームindex
 *   number, // 終了フレームindex
 *   string | number, // next
 *   number  // frequency
 * ]} SpriteSheetAnimationDataArray
 */

/**
 * アニメーションテーブル
 * @typedef {{
 *   [key in (string | number)]: SpriteSheetAnimationData
 * }} SpriteSheetAnimationTable
 */

/**
 * @typedef {Object} SpriteSheetFrameSetupParam
 * @property {number} width １フレームの横幅
 * @property {number} height １フレームの縦幅
 * @property {number} rows 横のフレーム数
 * @property {number} cols 縦のフレーム数
 */

/**
 * SpriteSheetクラスセットアップ用のデータオブジェクト
 * @typedef {Object} SpriteSheetSetupParam
 * @property {SpriteSheetFrameSetupParam} frame フレームのサイズ・分割数データ
 * @property {{
 *   [key in (string | number)]: SpriteSheetAnimationData | SpriteSheetAnimationDataArray
 * }} animations
 */

/**
 * @class phina.asset.SpriteSheet
 * _extends phina.asset.Asset
 */
class SpriteSheet extends Asset {

  /**
   * @constructor
   */
  constructor() {
    super();

    /**
     * jsonファイルへのパス文字列、もしくはjsonデータオブジェクトそのもの
     * @type {string | SpriteSheetSetupParam}
     */
    this.src;

    /**
     * 総フレーム数
     * @type {number}
     */
    this.frame;

    /** @type {SpriteSheetFrameData[]} */
    this.frames;

    /** @type {SpriteSheetAnimationTable} */
    this.animations;
  }

  /**
   * @param {SpriteSheetSetupParam} params
   * @returns {this}
   */
  setup(params) {
    this._setupFrame(params.frame);
    this._setupAnim(params.animations);
    return this;
  }

  /**
   * @override
   * @param {(arg0: this) => void} resolve
   * @returns {void}
   */
  _load(resolve) {

    var self = this;

    if (typeof this.src === 'string') {
      var xml = new XMLHttpRequest();
      xml.open('GET', this.src);
      xml.onreadystatechange = function() {
        if (xml.readyState === 4) {
          if ([200, 201, 0].indexOf(xml.status) !== -1) {
            var data = xml.responseText;
            var json = JSON.parse(data);

            self.setup(json);

            resolve(self);
          }
        }
      };

      xml.send(null);
    }
    else {
      this.setup(this.src);
      resolve(self);
    }

  }

  /**
   * @private
   * @param {SpriteSheetFrameSetupParam} frame
   */
  _setupFrame(frame) {
    /** @type {SpriteSheetFrameData[]} */
    var frames = this.frames = [];
    var unitWidth = frame.width;
    var unitHeight = frame.height;

    var count = frame.rows * frame.cols;
    this.frame = count;

    times.call(count, function(i) {
    // (count).times(function(i) {
      var xIndex = i%frame.cols;
      var yIndex = (i/frame.cols)|0;

      frames.push({
        x: xIndex*unitWidth,
        y: yIndex*unitHeight,
        width: unitWidth,
        height: unitHeight,
      });
    });
  }

  /**
   * @private
   * @param {SpriteSheetSetupParam["animations"]} animations
   */
  _setupAnim(animations) {
    this.animations = {};

    // デフォルトアニメーション
    this.animations["default"] = {
        frames: range.call([], 0, this.frame),
        // frames: [].range(0, this.frame),
        next: "default",
        frequency: 1,
    };

    // animations.forIn(
    forIn.call(animations, 
    /**
     * @this {SpriteSheet}
     * @param {string | number} key
     * @param {SpriteSheetAnimationData | SpriteSheetAnimationDataArray} value
     */
    function(key, value) {
      var anim = value;

      if (anim instanceof Array) {
        this.animations[key] = {
          frames: range.call([], anim[0], anim[1]),
          // frames: [].range(anim[0], anim[1]),
          next: anim[2],
          frequency: anim[3] || 1,
        };
      }
      else {
        this.animations[key] = {
          frames: anim.frames,
          next: anim.next,
          frequency: anim.frequency || 1
        };
      }

    }, this);
  }

  /**
   * フレームを取得
   * @param {number} index
   * @returns {SpriteSheetFrameData}
   */
  getFrame(index) {
    return this.frames[index];
  }

  /**
   * @param {string | number} [name="default"]
   * @returns {SpriteSheetAnimationData}
   */
  getAnimation(name) {
    name = (name !== undefined) ? name : "default";
    return this.animations[name];
  }

}

/** @typedef {string|number|null} FontName 基本はstring型 */

/**
 * @class phina.asset.Font
 * _extends phina.asset.Asset
 */
class Font extends Asset {

  /**
   * @constructor
   */
  constructor() {
    super();

    /** @type {FontName} */
    this.fontName = null;
  }

  /**
   * @param {string} path
   * @returns {Flow}
   */
  load(path) {
    this.src = path;

    var reg = /(.*)(?:\.([^.]+$))/;
    var key = this.fontName || last.get.call(path.match(reg)[1].split('/'));    //フォント名指定が無い場合はpathの拡張子前を使用
    // var key = this.fontName || path.match(reg)[1].split('/').last;    //フォント名指定が無い場合はpathの拡張子前を使用
    var type = path.match(reg)[2];
    var format$1 = "unknown";
    switch (type) {
      case "ttf":
        format$1 = "truetype"; break;
      case "otf":
        format$1 = "opentype"; break;
      case "woff":
        format$1 = "woff"; break;
      case "woff2":
        format$1 = "woff2"; break;
      default:
        console.warn("サポートしていないフォント形式です。(" + path + ")");
    }
    this.format = format$1;
    this.fontName = key;

    if (format$1 !== "unknown") {
      var text = format.call("@font-face { font-family: '{0}'; src: url({1}) format('{2}'); }", key, path, format$1);
      // var text = "@font-face { font-family: '{0}'; src: url({1}) format('{2}'); }".format(key, path, format);
      var e = document.querySelector("head");
      var fontFaceStyleElement = document.createElement("style");
      if (fontFaceStyleElement.innerText) {
        fontFaceStyleElement.innerText = text;
      } else {
        fontFaceStyleElement.textContent = text;
      }
      e.appendChild(fontFaceStyleElement);
    }

    return new Flow(this._load.bind(this));
  }

  /**
   * @param {(arg0: Font) => void} resolve
   */
  _load(resolve) {
    if (this.format !== "unknown") {
      this._checkLoaded(this.fontName, 
      /** @this {Font} */
      function() {
        this.loaded = true;
        resolve(this);
      }.bind(this));
    } else {
      this.loaded = true;
      resolve(this);
    }
  }

  /**
   * @param {FontName} font
   * @param {() => any} [callback]
   */
  _checkLoaded (font, callback) {
    var canvas = new Canvas();
    var DEFAULT_FONT = canvas.context.font.split(' ')[1];
    canvas.context.font = '40px ' + DEFAULT_FONT;

    var checkText = "1234567890-^\\qwertyuiop@[asdfghjkl;:]zxcvbnm,./\!\"#$%&'()=~|QWERTYUIOP`{ASDFGHJKL+*}ZXCVBNM<>?_１２３４５６７８９０－＾￥ｑｗｅｒｔｙｕｉｏｐａｓｄｆｇｈｊｋｌｚｘｃｖｂｎｍ，．あいうかさたなをん時は金なり";
    // 特殊文字対応
    checkText += String.fromCharCode(0xf04b);

    var before = canvas.context.measureText(checkText).width;
    canvas.context.font = '40px ' + font + ', ' + DEFAULT_FONT;

    var timeoutCount = 30;
    var checkLoadFont = function () {
      var after = canvas.context.measureText(checkText).width;
      if (after !== before) {
        setTimeout(function() {
          callback && callback();
        }, 100);
      } else {
        if (--timeoutCount > 0) {
          setTimeout(checkLoadFont, 100);
        }
        else {
          callback && callback();
          console.warn("timeout font loading");
        }
      }
    };
    checkLoadFont();
  }

  /**
   * @param {FontName} name
   * @returns {this}
   */
  setFontName(name) {
    if (this.loaded) {
      console.warn("フォント名はLoad前にのみ設定が出来ます(" + name + ")");
      return this;
    }
    this.fontName = name;
    
    return this;
  }

  /**
   * @returns {FontName}
   */
  getFontName() {
    return this.fontName;
  }

}

/**
 * @typedef {{
 *   path: string,
 *   dataType: "xml"| "json",
 * }} FileAssetLoadParam
 */

/**
 * @class phina.asset.File
 * _extends phina.asset.Asset
 */
class File extends Asset {

  /**
   * @constructor
   */
  constructor() {
    super();
    this.data = undefined;
    this.dataType = undefined;
  }

  _load(resolve) {

    var params = {};

    if (typeof this.src === 'string') {
      $extend.call(params, {
      // params.$extend({
        path: this.src,
      });
    }
    else if (typeof this.src === 'object') {
      $extend.call(params, this.src);
      // params.$extend(this.src);
    }

    $safe.call(params, {
    // params.$safe({
      path: '',
      dataType: 'text',
    });

    // load
    var self = this;
    var xml = new XMLHttpRequest();
    xml.open('GET', params.path);
    xml.onreadystatechange = function() {
      if (xml.readyState === 4) {
        if ([200, 201, 0].indexOf(xml.status) !== -1) {
          /** @type {string|Document} */
          var data = xml.responseText;

          if (params.dataType === 'json') {
            data = JSON.parse(data);
          } else if (params.dataType === 'xml') {
            data = (new DOMParser()).parseFromString(data, "text/xml");
          }
          self.dataType = params.dataType;

          self.data = data;
          resolve(self);
        }
      }
    };

    xml.send(null);
    // this.domElement = new Image();
    // this.domElement.src = this.src;

    // var self = this;
    // this.domElement.onload = function() {
    //   self.loaded = true;
    //   resolve(self);
    // };
  }

}

/**
 * assetKeyのvalueは通常はstring（パス文字列）
 * ただしパース済みjsonなどの特殊な形式も受け付けるため、any型としている
 * @typedef {{
 *   [assetType: string]: {
 *     [assetKey: string]: any
 *   }
 * }} AssetLoaderLoadParam
 */

/**
 * @class phina.asset.AssetLoader
 * _extends phina.util.EventDispatcher
 */
class AssetLoader extends EventDispatcher {

  /**
   * @constructor
   * @param {{ cache: boolean }} [params]
   */
  constructor(params) {
    super();

    // params = (params || {}).$safe({
    //   cache: true,
    // });
    params = $safe.call(params||{}, { cache: true });

    this.assets = {};
    this.cache = params.cache;
  }

  /**
   * @param {AssetLoaderLoadParam} params
   * @returns {Flow}
   */
  load(params) {
    var self = this;
    var flows = [];

    var counter = 0;
    var length = 0;
    forIn.call(params, function(_type, assets) {
    // params.forIn(function(type, assets) {
      length += Object.keys(assets).length;
    });
    
    forIn.call(params, function(type, assets) {
    // params.forIn(function(type, assets) {
      forIn.call(assets, function(key, value) {
      // assets.forIn(function(key, value) {
        var func = AssetLoader.assetLoadFunctions[type];
        var flow = func(key, value);
        flow.then(function(asset) {
          if (self.cache) {
            AssetManager.set(type, key, asset);
          }
          self.flare('progress', {
            key: key,
            asset: asset,
            progress: (++counter/length),
          });
        });
        flows.push(flow);
      });
    });


    if (self.cache) {

      self.on('progress', function(e) {
        if (e.progress >= 1.0) {
          // load失敗時、対策

          forIn.call(params, function(type, assets) {
          // params.forIn(function(type, assets) {
            forIn.call(assets, function(key, value) {
            // assets.forIn(function(key, value) {
              var asset = AssetManager.get(type, key);
              if (asset.loadError) {
                var dummy = AssetManager.get(type, 'dummy');
                if (dummy) {
                  if (dummy.loadError) {
                    dummy.loadDummy();
                    dummy.loadError = false;
                  }
                  AssetManager.set(type, key, dummy);
                } else {
                  asset.loadDummy();
                }
              }
            });
          });
        }
      });
    }
    return Flow.all(flows).then(function(args) {
      self.flare('load');
    });
  }

  /**
   * アセット種類に応じたロード関数を登録
   * @param {string | number} key アセットタイプ名
   * @param {(...args: any)=> Flow} func Flowインスタンスを返す関数
   */
  static register(key, func) {
    this.assetLoadFunctions[key] = func;
    return this;
  }

}

/**
 * 登録済みアセットロード関数
 */
AssetLoader.assetLoadFunctions = {
  image: function(key, path) {
    var texture = new Texture();
    var flow = texture.load(path);
    return flow;
  },
  sound: function(key, path) {
    var sound = new Sound();
    var flow = sound.load(path);
    return flow;
  },
  spritesheet: function(key, path) {
    var ss = new SpriteSheet();
    var flow = ss.load(path);
    return flow;
  },
  script: function(key, path) {
    var script = new Script();
    return script.load(path);
  },
  font: function(key, path) {
    var font = new Font();
    font.setFontName(key);
    return font.load(path);
  },
  json: function(key, path) {
    var text = new File();
    return text.load({
      path: path,
      dataType: "json",
    });
  },
  xml: function(key, path) {
    var text = new File();
    return text.load({
      path: path,
      dataType: "xml",
    });
  },
  text: function(key, path) {
    var text = new File();
    return text.load(path);
  }
};

/**
 * @class phina.asset.SoundManager
 * 全てのクラスメンバーがstaticな静的クラス
 * サウンドの再生は基本これを使う
 * 
 * ### Ref
 * - http://evolve.reintroducing.com/_source/classes/as3/SoundManager/SoundManager.html
 * - https://github.com/nicklockwood/SoundManager
 */
class SoundManager {
  // volume: 0.8,
  // musicVolume: 0.8,
  // muteFlag: false,
  // currentMusic: null,

  /**
   * @private インスタンス化しない
   */
  constructor() {}

  /**
   * 音源を再生
   * 
   * @param {string} name 音源キー名
   * @param {number} [when=0] 指定の秒数、再生を遅らせる
   * @param {number} [offset=0] 音源のどの時間位置で再生するかを秒数指定
   * @param {number} [duration] 再生時間を秒数指定
   * @returns {import('../asset/sound').Sound}
   */
  static play(name, when, offset, duration) {
    /** @type {import('../asset/sound').Sound} */
    var sound = AssetManager.get('sound', name);

    sound.volume = this.getVolume();
    sound.play(when, offset, duration);

    return sound;
  }

  /**
   * @private 未実装のため
   */
  static stop() {
    // TODO: 
  }

  /**
   * @private 未実装のため
   */
  static pause() {
    // TODO: 
  }

  /**
   * @private 未実装のため
   */
  static fade() {
    // TODO: 
  }

  /**
   * 通常サウンド音量をセット
   * 
   * @param {number} volume
   * @returns {void}
   */
  static setVolume(volume) {
    this.volume = volume;
  }

  /**
   * 通常サウンド音量を取得
   * 
   * @returns {number}
   */
  static getVolume() {
    return this.volume;
  }

  /**
   * ミュート
   * 
   * @returns {SoundManager}
   */
  static mute() {
    this.muteFlag = true;
    if (this.currentMusic) {
      this.currentMusic.volume = 0;
    }
    return this;
  }

  /**
   * ミュート解除
   * 
   * @returns {SoundManager}
   */
  static unmute() {
    this.muteFlag = false;
    if (this.currentMusic) {
      this.currentMusic.volume = this.getVolumeMusic();
    }
    return this;
  }

  /**
   * ミュート状態かどうか
   * 
   * @returns {boolean}
   */
  static isMute() {
    return this.muteFlag;
  }

  /**
   * 音楽系の音源を再生：ループの有無などを細かく調整可能
   * 
   * @param {string} name 音源キー名
   * @param {number} [fadeTime] 指定時間をかけて音量フェードイン。単位はミリ秒
   * @param {boolean} [loop] ループするかどうか。Default: true
   * @param {number} [when=0] 指定の秒数、再生を遅らせる
   * @param {number} [offset=0] 音源のどの時間位置で再生するかを秒数指定
   * @param {number} [duration] 再生時間を秒数指定
   * @returns {import('../asset/sound').Sound} 再生したSoundクラス
   */
  static playMusic(name, fadeTime, loop, when, offset, duration) {
    loop = (loop !== undefined) ? loop : true;

    if (this.currentMusic) {
      this.stopMusic(fadeTime);
    }

    /** @type {import('../asset/sound').Sound} */
    var music = AssetManager.get('sound', name);

    music.setLoop(loop);
    music.play(when, offset, duration);

    if (fadeTime > 0) {
      var count = 32;
      var counter = 0;
      var unitTime = fadeTime/count;
      var volume = this.getVolumeMusic();

      music.volume = 0;
      var id = setInterval(function() {
        counter += 1;
        var rate = counter/count;
        music.volume = rate*volume;

        if (rate >= 1) {
          clearInterval(id);
          return false;
        }

        return true;
      }, unitTime);
    }
    else {
      music.volume = this.getVolumeMusic();
    }

    this.currentMusic = music;

    return this.currentMusic;
  }

  /**
   * 音楽を停止
   * 
   * @param {number} [fadeTime] 指定時間をかけて音量フェードアウト。単位はミリ秒
   * @returns {void}
   */
  static stopMusic(fadeTime) {
    if (!this.currentMusic) { return ; }

    var music = this.currentMusic;
    this.currentMusic = null;

    if (fadeTime > 0) {
      var count = 32;
      var counter = 0;
      var unitTime = fadeTime/count;
      var volume = this.getVolumeMusic();

      music.volume = 0;
      var id = setInterval(function() {
        counter += 1;
        var rate = counter/count;
        music.volume = volume*(1-rate);

        if (rate >= 1) {
          music.stop();
          clearInterval(id);
          return false;
        }

        return true;
      }, unitTime);
    }
    else {
      music.stop();
    }
  }

  /**
   * 音楽を一時停止
   * 
   * @returns {void}
   */
  static pauseMusic() {
    if (!this.currentMusic) { return ; }
    this.currentMusic.pause();
  }

  /**
   * 音楽を再開
   * 
   * @returns {void}
   */
  static resumeMusic() {
    if (!this.currentMusic) { return ; }
    this.currentMusic.resume();
  }

  /**
   * 音楽の音量を設定
   * 
   * @param {number} volume
   * @returns {SoundManager}
   */
  static setVolumeMusic(volume) {
    this.musicVolume = volume;
    if (this.currentMusic) {
      this.currentMusic.volume = volume;
    }

    return this;
  }

  /**
   * 音楽の音量を取得
   * 
   * @returns {number}
   */
  static getVolumeMusic() {
    return this.musicVolume;
  }

}

/**
 * 通常サウンド（SE）音量
 * @type {number}
 */
SoundManager.volume = 0.8;

/**
 * 音楽音量
 * @type {number}
 */
SoundManager.musicVolume = 0.8;

/**
 * ミュート状態
 * @type {boolean}
 */
SoundManager.muteFlag = false;

/**
 * 再生中の音楽音源
 * @type {import('../asset/sound').Sound | null}
 */
SoundManager.currentMusic = null;

/**
 * @typedef {{
 *   text?: string,
 *   fontColor?: import("../graphics/canvas").CanvasStyle,
 *   fontSize?: number,
 *   fontWeight?: string | number,
 *   fontFamily?: string,
 *   cornerRadius?: number
 * } & import('../display/shape').ShapeOptions } ButtonOptions
 */

/**
 * @class phina.ui.Button
 * Button
 * _extends phina.display.Shape
 */
class Button extends Shape {

  /**
   * @constructor
   * @param {ButtonOptions} [options]
   */
  constructor(options) {
    options = $safe.call(options || {}, Button.defaults);
    // options = (options || {}).$safe(phina.ui.Button.defaults);
    super(options);

    this.cornerRadius = options.cornerRadius;
    this.text         = options.text;
    this.fontColor    = options.fontColor;
    this.fontSize     = options.fontSize;
    this.fontWeight     = options.fontWeight;
    this.fontFamily   = options.fontFamily;

    this.setInteractive(true);
    this.on('pointend', function() {
      this.flare('push');
    });
  }

  /**
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    canvas.roundRect(-this.width/2, -this.height/2, this.width, this.height, this.cornerRadius);
  }

  /**
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  postrender(canvas) {
    var context = canvas.context;
    // text
    var font = format.call("{fontWeight} {fontSize}px {fontFamily}", this);
    // var font = "{fontWeight} {fontSize}px {fontFamily}".format(this);
    context.font = font;
    context.textAlign = 'center';
    context.textBaseline = 'middle';
    context.fillStyle = this.fontColor;
    context.fillText(this.text, 0, 0);
  }

}

/**
 * @type {ButtonOptions}
 * @static
 */
Button.defaults = {
  width: 200,
  height: 80,
  backgroundColor: 'transparent',
  fill: 'hsl(200, 80%, 60%)',
  stroke: null,

  cornerRadius: 8,
  text: 'Hello',
  fontColor: 'white',
  fontSize: 32,
  fontWeight: '',
  fontFamily: "'HiraKakuProN-W3'", // Hiragino or Helvetica,
};

// defined
Shape.watchRenderProperty.call(Button, 'cornerRadius');
Shape.watchRenderProperty.call(Button, 'text');
Shape.watchRenderProperty.call(Button, 'fontColor');
Shape.watchRenderProperty.call(Button, 'fontSize');
Shape.watchRenderProperty.call(Button, 'fontFamily');

/**
 * @typedef {{
 *   value?: number
 *   maxValue?: number
 *   gaugeColor?: import("../graphics/canvas").CanvasStyle
 *   animation?: boolean
 *   cornerRadius?: number
 * } & import('../display/shape').ShapeOptions } GaugeOptions
 */

/**
 * @class phina.ui.Gauge
 * _extends phina.display.Shape
 * 
 * @example
 * const lifeGauge = new Gauge({
 *   fill: "gray", // Gauge background color
 *   gaugeColor: "red", // Gauge main color
 *   stroke: "black" // Gauge frame color
 *   maxValue: 200,
 *   animation: true,
 * })
 * 
 * if (playerDamaged) {
 *   lifeGauge.value -= 10
 * }
 * 
 */
class Gauge extends Shape {

  /**
   * @param {GaugeOptions} [options] 
   */
  constructor(options) {
    options = $safe.call({}, options || {}, Gauge.defaults);
    // options = ({}).$safe(options || {}, phina.ui.Gauge.defaults);
    
    super(options);

    /**
     * @private
     * @type {number}
     */
    this._value = (options.value !== undefined) ? options.value : options.maxValue;

    /**
     * @type {number} 最大値
     */
    this.maxValue = options.maxValue;

    /**
     * @type {import("../graphics/canvas").CanvasStyle} ゲージの色
     */
    this.gaugeColor = options.gaugeColor;
    
    /**
     * @type {number} 最大値
     */
    this.cornerRadius = options.cornerRadius;

    /**
     * @type {number} 見た目の値
     */
    this.visualValue = (options.value !== undefined) ? options.value : options.maxValue;

    /**
     * @type {boolean} アニメーションさせるかどうか
     */
    this.animation = options.animation;

    /**
     * @type {number} アニメーション完了時間をミリ秒指定
     * @default 1000
     */
    this.animationTime = 1*1000;
  }

  /**
   * 満タンかをチェック
   * @returns {boolean}
   */
  isFull() {
    return this.value === this.maxValue;
  }

  /**
   * 空っぽかをチェック
   * @returns {boolean}
   */
  isEmpty() {
    return this.value === 0;
  }

  /**
   * @param {number} value
   * @returns {void}
   */
  setValue(value) {
    value = clamp(value, 0, this.maxValue);
    // value = Math.clamp(value, 0, this.maxValue);

    // end when now value equal value of argument
    if (this.value === value) return ;

    // fire value change event
    this.flare('change');

    this._value = value;

    if (this.animation) {
      var range = Math.abs(this.visualValue-value);
      var time = (range/this.maxValue)*this.animationTime;

      // @ts-ignore
      this.tweener.ontween = function() {
        this._dirtyDraw = true;
      }.bind(this);
      this.tweener
        .clear()
        .to({'visualValue': value}, time)
        .call(function() {
          this.flare('changed');
          if (this.isEmpty()) {
            this.flare('empty');
          }
          else if (this.isFull()) {
            this.flare('full');
          }
        }, this);
    }
    else {
      this.visualValue = value;
      this.flare('changed');
      if (this.isEmpty()) {
        this.flare('empty');
      }
      else if (this.isFull()) {
        this.flare('full');
      }
    }
  }

  /**
   * 
   * @returns {number}
   */
  getRate() {
    var rate = this.visualValue/this.maxValue;
    return rate;
  }

  /**
   * @override
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  prerender(canvas) {
    canvas.roundRect(-this.width/2, -this.height/2, this.width, this.height, this.cornerRadius);
  }

  /**
   * @override
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  postrender(canvas) {
    var rate = this.getRate();
    canvas.context.fillStyle = this.gaugeColor;
    canvas.context.save();
    canvas.context.clip();
    canvas.fillRect(-this.width/2, -this.height/2, this.width*rate, this.height);
    canvas.context.restore();
  }

  get value() {
    return this._value;
  }
  set value(v) {
    this.setValue(v);
  }

}

/**
 * @type {GaugeOptions}
 * @static
 */
Gauge.defaults = {
  width: 256,
  height: 32,
  backgroundColor: 'transparent',
  fill: 'white',
  stroke: '#aaa',
  strokeWidth: 4,
  maxValue: 100,
  gaugeColor: '#44f',
  cornerRadius: 0,
  animation: true
};

// defined
Shape.watchRenderProperty.call(Gauge, 'value');
Shape.watchRenderProperty.call(Gauge, 'maxValue');
Shape.watchRenderProperty.call(Gauge, 'gaugeColor');
Shape.watchRenderProperty.call(Gauge, 'cornerRadius');

/**
 * @typedef {{
 *   anticlockwise?: boolean
 *   showPercentage?: boolean
 * } & GaugeOptions } CircleGaugeOptions
 */

/**
 * @class phina.ui.CircleGauge
 * _extends phina.ui.Gauge
 */
class CircleGauge extends Gauge {

  /**
   * @param {CircleGaugeOptions} [options] 
   */
  constructor(options) {
    options = $safe.call(options || {}, {
    // options = (options || {}).$safe({
      backgroundColor: 'transparent',
      fill: '#aaa',
      stroke: '#222',

      radius: 64,
      anticlockwise: true,
      showPercentage: false, // TODO
    });

    super(options);

    this.setBoundingType('circle');

    this.radius = options.radius;
    this.anticlockwise = options.anticlockwise;
    this.showPercentage = options.showPercentage;
  }

  /**
   * @override
   * @param {import('../graphics/canvas').Canvas} _canvas 
   */
  prerender(_canvas) {
    var rate = this.getRate();
    var end = (Math.PI*2)*rate;
    this.startAngle = 0;
    this.endAngle = end;

    this.canvas.rotate(-Math.PI*0.5);
    this.canvas.scale(1, -1);
  }

  /**
   * @override
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  renderFill(canvas) {
    canvas.fillPie(0, 0, this.radius, this.startAngle, this.endAngle);
  }

  /**
   * @override
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  renderStroke(canvas) {
    canvas.strokeArc(0, 0, this.radius, this.startAngle, this.endAngle);
  }

  postrender() {
    // if (this.showPercentage) {
    //   // TODO:
    //   var left = Math.max(0, this.limit-this.time);
    //   this.label.text = Math.ceil(left/1000)+'';
    // }
  }

}

/**
 * @typedef {{
 *   verticalAlign?: number | keyof LabelArea.verticalAlignToOffsetMap
 *   align?: keyof LabelArea.alignToOffsetMap,
 *   baseline?: CanvasTextBaseline,
 *   scroll?: Vector2
 *   scrollX?: number
 *   scrollY?: number
 * } & import('../display/label').LabelOptions } LabelAreaOptions
 */

/**
 * @type {{[fontName: string]: {[character: string]: number }}}
 */
var textWidthCache = {};

/**
 * @class phina.ui.LabelArea
 * _extends phina.display.Label
 */
class LabelArea extends Label {

  // _lineUpdate: true,

  /**
   * @param {LabelAreaOptions} options 
   */
  constructor(options) {
    options = $safe.call({}, options, LabelArea.defaults);
    // options = {}.$safe(options, LabelArea.defaults);
    super(options);

    this._lineUpdate = true;
    this.verticalAlign = options.verticalAlign;
    this.scroll = options.scroll || new Vector2();
    this.scrollX = options.scrollX;
    this.scrollY = options.scrollY;
  }

  /**
   * @returns {number}
   */
  calcCanvasWidth () {
    return this.width + this.padding * 2;
  }

  /**
   * @returns {number}
   */
  calcCanvasHeight () {
    return this.height + this.padding * 2;
  }

  /**
   * @returns {number}
   */
  getOffsetY () {
    if (typeof this.verticalAlign === 'number') {
      return this.verticalAlign;
    }
    return LabelArea.verticalAlignToOffsetMap[this.verticalAlign] || 0;
  }

  /**
   * @returns {number}
   */
  getOffsetX () {
    return LabelArea.alignToOffsetMap[this.align] || 0;
  }

  /**
   * @returns {{ [character: string]: number }}
   */
  getTextWidthCache () {
    var cache = textWidthCache[this.font];
    return cache || (textWidthCache[this.font] = {});
  }
  
  /**
   * @param {string[]} lines 文章
   * @returns {string[]} 整形済み文字ライン
   */
  spliceLines (lines) {
    var rowWidth = this.width;
    var context = this.canvas.context;
    context.font = this.font;

    var cache = this.getTextWidthCache();

    // update cache
    each.call(this._text, function(ch) {
    // this._text.each(function(ch) {
      if (!cache[ch]) {
        cache[ch] = context.measureText(ch).width;
      }
    });
    
    var localLines = [];
    lines.forEach(function(line) {
      
      var str = '';
      var totalWidth = 0;

      // はみ出ていたら強制的に改行する
      each.call(line, function(ch) {
      // line.each(function(ch) {
        var w = cache[ch];

        if ((totalWidth+w) > rowWidth) {
          localLines.push(str);
          str = '';
          totalWidth = 0;
        }

        str += ch;
        totalWidth += w;
      });

      // 残りを push する
      localLines.push(str);

    });
    

    return localLines;
  }
  
  getLines () {
    if (this._lineUpdate === false) {
      return this._lines;
    }
    this._lineUpdate = false;

    var lines = (this.text + '').split('\n');
    if (this.width < 1) {
      this._lines = lines;
    }
    else {
      this._lines = this.spliceLines(lines);
    }

    return this._lines;
  }

  /**
   * @override
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  prerender (canvas) {
    var context = canvas.context;
    context.font = this.font;
    context.textAlign = this.align;
    context.textBaseline = this.baseline;

    var text = this.text + '';
    var lines = this.getLines();
    var length = lines.length;
    var width = this.width;
    var height = this.height;

    var fontSize = this.fontSize;
    var lineSize = fontSize * this.lineHeight;
    var offsetX = this.getOffsetX() * width;
    var offsetY = this.getOffsetY();
    if (offsetY === 0) {
      offsetY = -Math.floor(length / 2) * lineSize;
      offsetY += ((length + 1) % 2) * (lineSize / 2);
    }
    else if (offsetY < 0) {
      offsetY *= height;
    }
    else {
      offsetY = offsetY * height - length * lineSize + lineSize;
    }

    offsetY -= this.scrollY;
    offsetX -= this.scrollX;
    var start = (offsetY + height / 2) / -lineSize | 0;
    if (start < 0) { start = 0; }

    var end = (height / 2 - offsetY + lineSize * 2) / lineSize | 0;
    lines = lines.filter(function(line, i) {
      return start <= i && end > i;
    });

    this.lines = lines;
    this.offsetX = offsetX;
    this.offsetY = offsetY;
    this.lineSize = lineSize;
    this.start = start;
  }

  /**
   * @override
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  renderFill (canvas) {
    var context = canvas.context;
    var offsetX = this.offsetX;
    var offsetY = this.offsetY;
    var lineSize = this.lineSize;
    var start = this.start;
    this.lines.forEach(function(line, i) {
      context.fillText(line, offsetX, (start + i) * lineSize + offsetY);
    }, this);
  }

  /**
   * @override
   * @param {import('../graphics/canvas').Canvas} canvas 
   */
  renderStroke (canvas) {
    var context = canvas.context;
    var offsetX = this.offsetX;
    var offsetY = this.offsetY;
    var lineSize = this.lineSize;
    var start = this.start;
    this.lines.forEach(function(line, i) {
      context.strokeText(line, offsetX, (start + i) * lineSize + offsetY);
    }, this);
  }

  get text() {
    return this._text;
  }
  set text(v) {
    this._text = v;
  }

  get scrollX() {
    return this.scroll.x;
  }
  set scrollX(v) {
    this.scroll.x = v;
  }

  get scrollY() {
    return this.scroll.y;
  }
  set scrollY(v) {
    this.scroll.y = v;
  }
  
  // _static: {
  //   defaults: {
  //     verticalAlign: 'top',
  //     align: 'left',
  //     baseline: 'top',
  //     width: 320,
  //     height: 320,
  //     scrollX: 0,
  //     scrollY: 0,
  //   },
  //   alignToOffsetMap: {
  //     start: -0.5,
  //     left: -0.5,
  //     center: 0,
  //     end: 0.5,
  //     right: 0.5,
  //   },

  //   verticalAlignToOffsetMap: {
  //     top: -0.5,
  //     center: 0,
  //     middle: 0,
  //     bottom: 0.5,
  //   },
  // },

  // _defined: function() {
  //   var func = function(newVal, oldVal) {
  //     if((this._lineUpdate === false) && (newVal !== oldVal)){
  //       this._lineUpdate = true;
  //     }
  //   };

  //   [
  //     'text',
  //     'width',
  //     'fontSize',
  //     'fontWeight',
  //     'fontFamily'
  //   ].forEach(function(key) {
  //     this.$watch(key, func);
  //   }, this.prototype);

  //   phina.display.Shape.watchRenderProperties.call(this ,[
  //     'verticalAlign',
  //     'text',
  //     'scroll',
  //     'scrollX',
  //     'scrollY'
  //   ]);
  // },

  /**
   * 未定義
   * @returns {this}
   */
  enableScroll() {
    //   this.setInteractive(true);
    //   var physical = phina.accessory.Physical();
    //   physical.attachTo(this);
    //   physical.friction = 0.8;
    //   var lastForce = 0;
    //   var lastMove = 0;
    //   this.on('pointstart', function(e){
    //     lastForce = physical.velocity.y;
    //     lastMove = 0;
    //     physical.force(0, 0);
    //   });
    //   this.on('pointmove', function(e){
    //     var p = e.pointer.deltaPosition;
    //     lastMove = p.y;
    //     this.scrollY += lastMove;
    //   });

    //   this.on('pointend', function(e){
    //     physical.force(0, lastForce + lastMove);
    //   });

    return this;
  }

}

/**
 * @type {LabelAreaOptions}
 */
LabelArea.defaults = {
  verticalAlign: 'top',
  align: 'left',
  baseline: 'top',
  width: 320,
  height: 320,
  scrollX: 0,
  scrollY: 0,
};
LabelArea.alignToOffsetMap = {
  start: -0.5,
  left: -0.5,
  center: 0,
  end: 0.5,
  right: 0.5,
};
LabelArea.verticalAlignToOffsetMap = {
  top: -0.5,
  center: 0,
  middle: 0,
  bottom: 0.5,
}

// defined
;(function() {
  var func = function(newVal, oldVal) {
    if((this._lineUpdate === false) && (newVal !== oldVal)){
      this._lineUpdate = true;
    }
  };

  [
    'text',
    'width',
    'fontSize',
    'fontWeight',
    'fontFamily'
  ].forEach(function(key) {
    $watch.call(this, key, func);
    // this.$watch(key, func);
  }, LabelArea.prototype);
})();

Shape.watchRenderProperties.call(LabelArea ,[
  'verticalAlign',
  'text',
  'scroll',
  'scrollX',
  'scrollY'
]);

/**
 * @class phina.effect.Wave
 * _extends phina.display.CircleShape
 */
class Wave extends CircleShape {

  /**
   * @constructor
   * @param {import("../display/shape").CircleShapeOptions} [options]
   */
  constructor(options) {
    options = $safe.call(options || {}, {
    // options = (options || {}).$safe({
      fill: 'white',
      stroke: false,
    });

    super(options);

    var tweener = new Tweener().attachTo(this);
    tweener
      .to({scaleX:2, scaleY:2, alpha:0}, 500)
      .call(function() {
        this.remove();
      }, this);
  }
}

/**
 * @class phina.social.Twitter
 * # Twitter の共有リンクを生成するクラス
 * Twitter の共有リンクの URL を生成してくれるクラスです。
 */
class Twitter {

  /**
   * @constructor
   * 
   * コンストラクタは存在しますがインスタンスメンバはありません。
   */
  constructor() {}

  /**
   * @method phina.social.Twitter.createURL
   * @static
   * Twitterの共有リンクを生成します。引数にオブジェクトを渡すことで様々なパラメーターを設定出来ます。引数のオブジェクトは {@link #phina.social.Twitter.defaults} で安全拡張されます。
   * 
   * ### Example
   *     phina.social.Twitter.createURL(); // => http://twitter.com/intent/tweet?text=Hello%2C%20world!&hashtags=javascript%2Cphina&url={現在のURL}
   * 
   *     phina.social.Twitter.createURL({
   *       text: 'This is text',
   *       hashtags: 'hashtag1,hashtag2',
   *       url: 'http://phinajs.com'
   *     }); // => http://twitter.com/intent/tweet?text=This%20is%20text&hashtags=hashtag1%2Chashtag2&url=http%3A%2F%2Fphinajs.com
   * 
   *     phina.social.Twitter.createURL({
   *       text: 'This is text',
   *       hashtags: 'hashtag1,hashtag2',
   *       url: 'http://phinajs.com',
   *       other: 'This is other'//設定項目は適当に増やせる
   *     }); // => http://twitter.com/intent/tweet?text=This%20is%20text&hashtags=hashtag1%2Chashtag2&url=http%3A%2F%2Fphinajs.com&other=This%20is%20other
   * 
   *     phina.social.Twitter.createURL({
   *       url: 'http://phinajs.com'
   *     }); // => http://twitter.com/intent/tweet?url=http%3A%2F%2Fphinajs.com&text=Hello%2C%20world!&hashtags=javascript%2Cphina
   * 
   * @param {Twitter.defaults} options
   * @return {String} Twitter の共有リンク
   */
  static createURL (options) {
    options = $safe.call(options || {}, Twitter.defaults);
    // options = (options || {}).$safe(this.defaults);

    var queries = [];
    var euc = encodeURIComponent;
    forIn.call(options, function(key, value) {
    // options.forIn(function(key, value) {
      var str = key + '=' + euc(value);
      queries.push(str);
    });

    var url = format.call('{baseURL}/{type}?{query}', {
    // var url = '{baseURL}/{type}?{query}'.format({
      baseURL: this.baseURL,
      // type: options.type,
      type: 'tweet',
      query: queries.join('&'),
    });

    return url;
  }

}


/**
 * @property {String} [phina.social.Twitter.baseURL = 'https://twitter.com/intent']
 * Twitter の共有リンクのベースとなる URL です。
 * 
 * @static
 */
Twitter.baseURL = 'https://twitter.com/intent';

/**
 * @property {Object} phina.social.Twitter.defaults
 * デフォルト値を格納しているオブジェクトです。{@link #phina.social.Twitter.defaults.text}, {@link #phina.social.Twitter.defaults.hashtags}, {@link #phina.social.Twitter.defaults.url} を内包しています。
 * 
 * @static
 */
Twitter.defaults = {
  // type: 'tweet',

  /**
   * @property {String} [phina.social.Twitter.defaults.text = 'Hello, World']
   * デフォルトでツイートに含まれる文字列です。
   * 
   * @static
   */
  text: 'Hello, world!',

  // screen_name: 'phi_jp',

  /**
   * @property {String} [phina.social.Twitter.defaults.hashtags = 'javascript, phina_js']
   * デフォルトでツイートに含まれるハッシュタグです。
   * 
   * @static
   */
  hashtags: 'javascript,phina_js',

  // url: 'http://github.com/phi-jp/phina.js',

  /**
   * @property {String} [phina.social.Twitter.defaults.url = phina.global.location && phina.global.location.href]
   * デフォルトでツイートに含まれる URL です。
   * 
   * @static
   */
  url: phina.global.location && phina.global.location.href

  // via: 'phi_jp',
};

/**
 * @typedef {{
 *   className: string | (new (...args: any)=> any)
 *   label: import("../app/scene").SceneLabel
 *   arguments?: any
 *   nextLabel?: import("../app/scene").SceneLabel
 *   nextArguments?: any
 * }} SceneData
 */

/**
 * @typedef {{
 *   startLabel: import("../app/scene").SceneLabel
 *   scenes: SceneData[]
 * }} ManagerSceneParams
 */

/**
 * @class phina.game.ManagerScene
 * _extends phina.app.Scene
 */
class ManagerScene extends Scene {

  /**
   * @constructor
   * @param {ManagerSceneParams} params
   */
  constructor(params) {
    super();

    /** @type SceneData[] */
    this.scenes;
    /** @type number */
    this.sceneIndex;

    this.setScenes(params.scenes);

    this.on("enter", function() {
      this.gotoScene(params.startLabel || 0);
    }.bind(this));

    this.on("resume", this.onnext.bind(this));

    /**
     * @private 未使用
     */
    this.commonArguments = {};
  }

  /**
   * scenes をセット
   * 
   * @param {SceneData[]} scenes
   * @returns {this}
   */
  setScenes(scenes) {
    this.scenes = scenes;
    this.sceneIndex = 0;

    return this;
  }

  /**
   * @private
   * Sceneクラスをインスタンス化して返す
   * 
   * @param {SceneData} data Sceneデータ
   * @param {any} args インスタンス化の際のコンストラクタの引数
   * @returns {Scene}
   */
  _instantiateScene(data, args) {
    // Scene初期化引数
    // typescriptが何故かargumentsに反応して余計な引数定義を生成するため、文字列参照とする
    var initArguments = $extend.call({}, data["arguments"], args);
    // var initArguments = {}.$extend(data.arguments, args);

    /** @type {Scene} */
    var scene;

    /** @type {(new (args: any)=> any)} */
    var SceneConstructor;
    if (typeof data.className === 'string') {
      // 文字列型の場合：phina.define、あるいはグローバルスコープ（window）に直接定義されたクラスの文字列
      SceneConstructor = phina.using(data.className);
      if (typeof SceneConstructor !== 'function') {
        SceneConstructor = phina.using('phina.game.' + data.className);
      }
    } else if (typeof data.className === 'function') {
      // 関数型の場合：純粋なclassと見なす
      SceneConstructor = data.className;
    }
    scene = new SceneConstructor(initArguments);

    // 次シーンパラメータが無い場合の処理
    if (!scene.nextLabel) {
      scene.nextLabel = data.nextLabel;
    }
    if (!scene.nextArguments) {
      scene.nextArguments = data.nextArguments;
    }

    return scene
  }

  /**
   * 指定したlabelに対応するシーンへ飛ぶ  
   * Sceneクラスをインスタンス化してappにreplaceSceneさせる  
   * 
   * @param  {import("../app/scene").SceneLabel} label シーンラベル
   * @param  {any} [args] Sceneにわたす引数がある場合に指定
   * @returns {this}
   */
  replaceScene(label, args) {
    var index = (typeof label == 'string') ? this.labelToIndex(label) : label||0;
    if (!this.scenes[index]) {
      console.error(format.call('phina.js error: `{0}` に対応するシーンがありません.', label));
    }
    var scene = this._instantiateScene(this.scenes[index], args);
    this.app.replaceScene(scene);
    this.sceneIndex = index;

    return this;
  }

  /**
   * 指定したlabelに対応するシーンへ飛ぶ  
   * replaceSceneとの違いはapp.replaceSceneではなく、
   * app.pushSceneを実行する点
   * 
   * @param {import("../app/scene").SceneLabel} label シーンラベル
   * @param {any} args Sceneコンストラクタの引数
   * @returns {this}
   */
  gotoScene(label, args) {
    var index = (typeof label == 'string') ? this.labelToIndex(label) : label||0;
    if (!this.scenes[index]) {
      console.error(format.call('phina.js error: `{0}` に対応するシーンがありません.', label));
    }
    var scene = this._instantiateScene(this.scenes[index], args);
    this.app.pushScene(scene);
    this.sceneIndex = index;

    return this;
  }

  /**
   * 次のシーンへ飛ぶ  
   * シーンが存在しない場合、"finish"イベントを発火して終了
   * 
   * @param {any} args 次のSceneコンストラクタの引数
   * @returns {this}
   */
  gotoNext(args) {
    var data = this.scenes[this.sceneIndex];
    var nextIndex = null;

    if (data.nextLabel) {
      // 次のラベルが設定されていた場合
      nextIndex = this.labelToIndex(data.nextLabel);
    }
    else if (this.sceneIndex+1 < this.scenes.length) {
      // index上の次のシーンに遷移
      nextIndex = this.sceneIndex+1;
    }

    if (nextIndex !== null) {
      this.gotoScene(nextIndex, args);
    }
    else {
      this.flare("finish");
    }

    return this;
  }

  /**
   * 現在のシーンのインデックスを取得
   * 
   * @returns {number}
   */
  getCurrentIndex() {
    return this.sceneIndex;
  }

  /**
   * 現在のシーンのラベルを取得
   * 
   * @returns {import("../app/scene").SceneLabel} label
   */
  getCurrentLabel() {
    return this.scenes[this.sceneIndex].label;
  }

  /**
   * ラベルからインデックスに変換
   * 
   * @param {import("../app/scene").SceneLabel} label
   */
  labelToIndex(label) {
    var data = this.scenes.filter(function(data) {
      return data.label == label;
    })[0];

    return this.scenes.indexOf(data);
  }

  /**
   * インデックスからラベルに変換
   * 
   * @param {number} index
   * @returns {import("../app/scene").SceneLabel} label
   */
  indexToLabel(index) {
    return this.scenes[index].label;
  }

  /**
   * @private
   * {@link BaseApp#popScene} の際にresumeイベント経由で実行され、
   * 対応する次のシーンに移行する
   * 
   * @param {{ prevScene: { nextLabel: import("../app/scene").SceneLabel; nextArguments: any; }; }} e
   * @returns {void}
   */
  onnext(e) {
    var nextLabel = e.prevScene.nextLabel;
    var nextArguments = e.prevScene.nextArguments;
    if (nextLabel) {
      this.gotoScene(nextLabel, nextArguments);
    }
    else {
      this.gotoNext(nextArguments);
    }
  }

}

/**
 * @typedef {{
 *   lie?: boolean,
 *   exitType?: 'auto'
 *   assets?: import("../asset/assetloader").AssetLoaderLoadParam
 * } & import("../display/displayscene").DisplaySceneOptions } LoadingSceneOptions
 */

/**
 * @class phina.game.LoadingScene
 * _extends phina.display.DisplayScene
 */
class LoadingScene extends DisplayScene {

  /**
   * @constructor
   * @param {LoadingSceneOptions} [options]
   */
  constructor(options) {
    options = $safe.call({}, options, LoadingScene.defaults);
    // options = ({}).$safe(options, phina.game.LoadingScene.defaults);
    super(options);

    this.gauge = new Gauge({
      value: 0,
      width: this.width,
      height: 12,
      fill: '#aaa',
      stroke: false,
      gaugeColor: 'hsla(200, 100%, 80%, 0.8)',
      padding: 0,
    }).addChildTo(this)
      .setPosition(
        this.gridX.center(),
        0,
      )
      .setOrigin(
        0.5, 
        0
      );
    // this.fromJSON({
    //   children: {
    //     gauge: {
    //       className: 'phina.ui.Gauge',
    //       arguments: {
    //         value: 0,
    //         width: this.width,
    //         height: 12,
    //         fill: '#aaa',
    //         stroke: false,
    //         gaugeColor: 'hsla(200, 100%, 80%, 0.8)',
    //         padding: 0,
    //       },
    //       x: this.gridX.center(),
    //       y: 0,
    //       originY: 0,
    //     }
    //   }
    // });

    var loader = new AssetLoader();

    if (options.lie) {
      this.gauge.animationTime = 10*1000;
      this.gauge.value = 90;

      loader.on('load', function() {
        this.gauge.animationTime = 0;
        this.gauge.value = 100;
      }.bind(this));
    }
    else {
      this.gauge.animationTime = 100;
      loader.on('progress', function(e) {
        this.gauge.value = e.progress * 100;
      }.bind(this)) ;
    }

    this.gauge.on('full', function() {
      if (options.exitType === 'auto') {
        this.app.popScene();
      }
      this.flare('loaded');
    }.bind(this));

    loader.load(options.assets);
  }

}

/** @type LoadingSceneOptions */
LoadingScene.defaults = {
  exitType: 'auto',
  lie: false,
};

/**
 * @typedef {Object} SplashSceneOptionExtend
 * @property {string} [imageURL] 表示するスプラッシュ画像パス
 */

/**
 * @class phina.game.SplashScene
 * _extends phina.display.DisplayScene
 */
class SplashScene extends DisplayScene {

  /**
   * @param {import("../display/displayscene").DisplaySceneOptions} [options]
   */
  constructor(options) {
    var defaults = SplashScene.defaults;
    super(options);

    var texture = new Texture();
    texture.load(defaults.imageURL).then(
    /** @this SplashScene */
    function() {
      this._init();
    }.bind(this));
    this.texture = texture;
  }

  /**
   * @private
   * 初期化関数
   */
  _init() {
    this.sprite = new Sprite(this.texture).addChildTo(this);

    this.sprite.setPosition(this.gridX.center(), this.gridY.center());
    this.sprite.alpha = 0;

    this.sprite.tweener
      .clear()
      .to({alpha:1}, 500, 'easeOutCubic')
      .wait(1000)
      .to({alpha:0}, 500, 'easeOutCubic')
      .wait(250)
      .call(function() {
        this.exit();
      }, this)
      ;
  }

}

/** @type {import("../display/displayscene").DisplaySceneOptions & SplashSceneOptionExtend} */
SplashScene.defaults = {
  imageURL: 'http://cdn.rawgit.com/phi-jp/phina.js/develop/logo.png',
};

/**
 * @typedef {Object} TitleSceneOptionExtend
 * @property {string} [title] タイトル文字列
 * @property {string} [message] 未使用
 * @property {import("../graphics/canvas").CanvasStyle} [fontColor] タイトルラベルの色
 * @property {string} [backgroundImage] 未使用
 * @property {"touch"|""} [exitType] "touch"指定時に自動でタッチ遷移イベントを付与
 * 
 * @typedef {import("../display/displayscene").DisplaySceneOptions & TitleSceneOptionExtend} TitleSceneOptions
 */

/**
 * @class phina.game.TitleScene
 * _extends phina.display.DisplayScene
 */
class TitleScene extends DisplayScene {

  /**
   * @constructor
   * @param {TitleSceneOptions} [params]
   */
  constructor(params) {
    params = $safe.call({}, params, TitleScene.defaults);
    // params = ({}).$safe(params, phina.game.TitleScene.defaults);
    super(params);

    this.backgroundColor = params.backgroundColor;

    this.fromJSON({
      children: {
        titleLabel: {
          className: Label,
          // className: 'phina.display.Label',
          arguments: {
            text: params.title,
            fill: params.fontColor,
            stroke: false,
            fontSize: 64,
          },
          x: this.gridX.center(),
          y: this.gridY.span(4),
        }
      }
    });

    if (params.exitType === 'touch') {
      this.fromJSON({
        children: {
          touchLabel: {
            className: Label,
            // className: 'phina.display.Label',
            arguments: {
              text: "TOUCH START",
              fill: params.fontColor,
              stroke: false,
              fontSize: 32,
            },
            x: this.gridX.center(),
            y: this.gridY.span(12),
          },
        },
      });

      this.on('pointend', function() {
        this.exit();
      });
    }
  }

}

/**
 * @type {TitleSceneOptions}
 */
TitleScene.defaults = {
  title: 'phina.js games',
  message: '',

  fontColor: 'white',
  backgroundColor: 'hsl(200, 80%, 64%)',
  backgroundImage: '',

  exitType: 'touch',
};

/**
 * @typedef {{
 *   fontColor?: string,
 *   exitType?: 'touch'
 * } & import("../display/displayscene").DisplaySceneOptions } PauseSceneOptions
 */

/**
 * @class phina.game.PauseScene
 * _extends phina.display.DisplayScene
 */
class PauseScene extends DisplayScene {

  /**
   * @constructor
   * @param {PauseSceneOptions} [params]
   */
  constructor(params) {
    params = $safe.call({}, params, PauseScene.defaults);
    // params = ({}).$safe(params, phina.game.PauseScene.defaults);
    super(params);

    this.backgroundColor = params.backgroundColor;

    this.fromJSON({
      children: {
        text: {
          className: Label,
          // className: 'phina.display.Label',
          arguments: {
            text: 'Pause',
            fill: params.fontColor,
            stroke: null,
            fontSize: 48,
          },
          x: this.gridX.center(),
          y: this.gridY.center(),
        },
      }
    });

    if (params.exitType === 'touch') {
      this.on('pointend', function() {
        this.exit();
      });
    }
  }

}

/** @type PauseSceneOptions */
PauseScene.defaults =  {
  fontColor: 'white',
  backgroundColor: 'hsla(0, 0%, 0%, 0.85)',

  exitType: 'touch',
};

/**
 * @typedef {Object} ResultSceneOptionExtend
 * @property {number} [score] [description]
 * @property {string} [message] [description]
 * @property {string} [hashtags] [description]
 * @property {string} [url] [description]
 * @property {"touch"} [exitType] [description]
 * @property {import("../graphics/canvas").CanvasStyle} [fontColor] [description]
 * @property {import("../graphics/canvas").CanvasStyle} [backgroundColor]
 * @property {string} [backgroundImage] 未使用
 * 
 * @typedef {import("../display/displayscene").DisplaySceneOptions & ResultSceneOptionExtend} ResultSceneOptions
 */

/**
 * @class phina.game.ResultScene
 * _extends phina.display.DisplayScene
 */
class ResultScene extends DisplayScene {

  /**
   * @constructor
   * @param {ResultSceneOptions} [params]
   */
  constructor(params) {
    params = $safe.call({}, params, ResultScene.defaults);
    // params = ({}).$safe(params, phina.game.ResultScene.defaults);
    super(params);

    var message = format.call(params.message, params);
    // var message = params.message.format(params);

    this.backgroundColor = params.backgroundColor;

    this.fromJSON({
      children: {
        scoreText: {
          className: Label,
          // className: 'phina.display.Label',
          arguments: {
            text: 'score',
            fill: params.fontColor,
            stroke: null,
            fontSize: 48,
          },
          x: this.gridX.span(8),
          y: this.gridY.span(4),
        },
        scoreLabel: {
          className: Label,
          // className: 'phina.display.Label',
          arguments: {
            text: params.score+'',
            fill: params.fontColor,
            stroke: null,
            fontSize: 72,
          },
          x: this.gridX.span(8),
          y: this.gridY.span(6),
        },

        messageLabel: {
          className: Label,
          // className: 'phina.display.Label',
          arguments: {
            text: message,
            fill: params.fontColor,
            stroke: null,
            fontSize: 32,
          },
          x: this.gridX.center(),
          y: this.gridY.span(9),
        },

        shareButton: {
          className: Button,
          // className: 'phina.ui.Button',
          arguments: [{
            text: '★',
            width: 128,
            height: 128,
            fontColor: params.fontColor,
            fontSize: 50,
            cornerRadius: 64,
            fill: 'rgba(240, 240, 240, 0.5)',
            // stroke: '#aaa',
            // strokeWidth: 2,
          }],
          x: this.gridX.center(-3),
          y: this.gridY.span(12),
        },
        playButton: {
          className: Button,
          // className: 'phina.ui.Button',
          arguments: [{
            text: '▶',
            width: 128,
            height: 128,
            fontColor: params.fontColor,
            fontSize: 50,
            cornerRadius: 64,
            fill: 'rgba(240, 240, 240, 0.5)',
            // stroke: '#aaa',
            // strokeWidth: 2,
          }],
          x: this.gridX.center(3),
          y: this.gridY.span(12),

          interactive: true,
          onpush: function() {
            this.exit();
          }.bind(this),
        },
      }
    });

    if (params.exitType === 'touch') {
      this.on('pointend', function() {
        this.exit();
      });
    }

    /** @type Button & {onclick: Function} */
    this.shareButton;

    this.shareButton.onclick = function() {
      var text = format.call('Score: {0}\n{1}', params.score, message);
      // var text = 'Score: {0}\n{1}'.format(params.score, message);
      var url = Twitter.createURL({
        text: text,
        hashtags: params.hashtags,
        url: params.url,
      });
      window.open(url, 'share window', 'width=480, height=320');
    };
  }

}

/** @type {ResultSceneOptions} */
ResultScene.defaults = {
  score: 16,

  message: 'this is phina.js project.',
  hashtags: 'phina_js,game,javascript',
  url: phina.global.location && phina.global.location.href,

  fontColor: 'white',
  backgroundColor: 'hsl(200, 80%, 64%)',
  backgroundImage: '',
};

/**
 * デフォルトシーンのオプション統合型
 * @typedef { import("./titlescene").TitleSceneOptions
 * & import("./pausescene").PauseSceneOptions
 * & import("./resultscene").ResultSceneOptions
 * & import("../game/loadingscene").LoadingSceneOptions
 * } DefaultSceneOptions
 */

/**
 * @typedef {{
 *   scenes?: import("./managerscene").SceneData[]
 *   startLabel?: import("../app/scene").SceneLabel
 *   autoPause?: boolean
 *   debug?: boolean
 *   loadingScene?: typeof DisplayScene
 *   pauseScene?: typeof DisplayScene
 * } 
 * & import("../display/canvasapp").CanvasAppOptions
 * } GameAppOptions
 */

/**
 * デフォルトのmain class
 */
class DefaultMainScene extends DisplayScene {
  constructor(options) {
    super(options);
    console.log('This is MainScene');
  }
}
/**
 * クラスがphina.defineによって定義（グローバルに定義）されているかどうかをチェック
 * @param {string} className クラス名。phina.game[className]で定義されているかも調べる
 * @returns {boolean}
 */
function isGameClassDefined(className) {
  if (
    typeof phina.using(className) === 'function'
    || typeof phina.using('phina.game.' + className) === 'function'
  ) {
    return true
  }
  return false;
}

/**
 * @class phina.game.GameApp
 * _extends phina.display.CanvasApp
 */
class GameApp extends CanvasApp {
  /**
   * @param {GameAppOptions & DefaultSceneOptions} [options]
   */
  constructor(options) {
    options = /** @type {GameAppOptions} */($safe.call(options || {}, {
    // options = (options || {}).$safe({
      startLabel: 'title',
    }));
    super(options);

    /** @type {any} dat.GUIインスタンス */
    this.gui = undefined;

    var startLabel = options.startLabel || 'title';

    var scenes = options.scenes || [
      {
        className: isGameClassDefined("SplashScene") ? "SplashScene" : SplashScene,
        label: 'splash',
        nextLabel: 'title',
      },
      {
        className: isGameClassDefined("TitleScene") ? "TitleScene" : TitleScene,
        label: 'title',
        nextLabel: 'main',
      },
      {
        className: isGameClassDefined("MainScene") ? "MainScene" : DefaultMainScene,
        label: 'main',
        nextLabel: 'result',
      },
      {
        className: isGameClassDefined("ResultScene") ? "ResultScene" : ResultScene,
        label: 'result',
        nextLabel: 'title',
      },
    ];

    scenes = each$1.call(scenes, function(s) {
      s.arguments = s.arguments || options;
    });

    var scene = new ManagerScene({
      startLabel: startLabel,
      scenes: scenes,
    });

    if (options.assets) {
      // ローディング：esm版では独自のLoadingSceneはオプションで渡せるようにする

      var loadingOptions = $extend.call({}, options, {
      // var loadingOptions = ({}).$extend(options, {
        exitType: '',
      });
      // グローバル定義のLoadingSceneを探す（従来）
      // -> なければオプションをチェック 
      // -> これもなければデフォルトのLoadingSceneを使う
      var definedLoadingClass = phina.using("LoadingScene") || phina.using("phina.game.LoadingScene");
      var loading = (typeof definedLoadingClass === 'function') 
        ? definedLoadingClass(loadingOptions)
        : (options.loadingScene != null)
          ? new options.loadingScene(loadingOptions) 
          : new LoadingScene(loadingOptions)
      ;
      this.replaceScene(loading);

      loading.onloaded = function() {
        this.replaceScene(scene);
        if (options.debug) {
          this._enableDebugger();
        }
      }.bind(this);
    }
    else {
      this.replaceScene(scene);
      if (options.debug) {
        this._enableDebugger();
      }
    }

    // 自動でポーズする
    // esm版では独自のポーズシーンはオプションで渡す
    // 引数が渡せないのは元から
    if (options.autoPause) {
      this.on('blur', function() {
        var definedPauseScene = phina.using("phina.game.PauseScene");
        var pauseScene = (typeof definedPauseScene === 'function') 
          ? definedPauseScene() 
          : (options.pauseScene) 
            ? new options.pauseScene(options) 
            : new PauseScene();
        this.pushScene(pauseScene);
      });
    }
  }

  /**
   * @private
   */
  _enableDebugger() {
    if (this.gui) return ;

    this.enableDatGUI(
    /**
     * @this {GameApp}
     * @param {{ addFolder: (arg0: string) => any; }} gui Dat.guiインスタンス
     */
    function(gui) {
      var f = gui.addFolder('scenes');
      var funcs = {};
      each$1.call(/** @type {ManagerScene} */(this.rootScene).scenes, function(scene) {
      // this.rootScene.scenes.each(function(scene) {
        funcs[scene.label] = function() {
          this.rootScene.replaceScene(scene.label);
          console.log(this._scenes.length);
        }.bind(this);
        return scene;
      }, this);

      forIn.call(funcs, function(key, value) {
      // funcs.forIn(function(key, value) {
        f.add(funcs, key);
      });
      f.open();

      this.gui = gui;
    }.bind(this));
  }
}

/**
 * Appクラス統合型
 * @typedef {import('../app/baseapp').BaseApp | import('../display/domapp').DomApp | import('../display/canvasapp').CanvasApp | GameApp} AppUnion
 */

/**
 * @typedef {Object} CountSceneOptionExtend
 * @property {number|number[]} [count] カウントダウン回数。配列で渡した場合、その逆順でカウントダウンを行う
 * @property {import("../index.esm").CanvasStyle} [fontColor] フォントの色
 * @property {number} [fontSize] フォントサイズ
 * @property {string} [exitType] 'auto'のとき、自動でpopScene
 * 
 * @typedef {import("../display/displayscene").DisplaySceneOptions & CountSceneOptionExtend} CountSceneOptions
 */

/**
 * @class phina.game.CountScene
 * _extends phina.display.DisplayScene
 * 
 * 自動でカウントダウンを行う一時用Scene
 * メインのシーンでゲーム開始前にpushSceneするのが一般的な使い方
 */
class CountScene extends DisplayScene {

  /**
   * @constructor
   * @param {CountSceneOptions} [options]
   */
  constructor(options) {
    super(options);

    options = $safe.call(options || {}, CountScene.defaults);
    // options = (options || {}).$safe(phina.game.CountScene.defaults);

    this.backgroundColor = options.backgroundColor;

    this.fromJSON({
      children: {
        label: {
          className: Label,
          // className: 'phina.display.Label',
          arguments: {
            fill: options.fontColor,
            fontSize: options.fontSize,
            stroke: false,
          },
          x: this.gridX.center(),
          y: this.gridY.center(),
        },
      }
    });

    /** @type {Label} */
    this.label;

    /** @type {number[]} */
    this.countList;

    if (options.count instanceof Array) {
      this.countList = clone.call(options.count).reverse();
      // this.countList = options.count.clone().reverse();
    }
    else {
      this.countList = range.call([], 1, options.count+1);
      // this.countList = Array.range(1, options.count+1);
    }
    this.counter = this.countList.length;
    this.exitType = options.exitType;

    this._updateCount();
  }

  _updateCount() {
    var endFlag = this.counter <= 0;
    var index = --this.counter;

    this.label.text = this.countList[index];

    this.label.scale.set(1, 1);
    this.label.tweener
      .clear()
      .to({
        scaleX: 1,
        scaleY: 1,
        alpha: 1,
      }, 250)
      .wait(500)
      .to({
        scaleX: 1.5,
        scaleY: 1.5,
        alpha: 0.0
      }, 250)
      .call(
      /** @this CountScene */
      function() {
        if (this.counter <= 0) {
          this.flare('finish');
          if (this.exitType === 'auto') {
            this.app.popScene();
          }
        }
        else {
          this._updateCount();
        }
      }, this);
  }

}

/** @type {CountSceneOptions} */
CountScene.defaults = {
  count: 3,

  width: 640,
  height: 960,

  fontColor: 'white',
  fontSize: 164,
  backgroundColor: 'rgba(50, 50, 50, 1)',

  exitType: 'auto',
};




/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _tiledmap_Tiledmap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tiledmap/Tiledmap */ "./src/tiledmap/Tiledmap.js");
/* harmony import */ var _tiledmap_Tileset__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tiledmap/Tileset */ "./src/tiledmap/Tileset.js");


})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9waGluYS50aWxlZG1hcC5qcy8uL3NyYy90aWxlZG1hcC9UaWxlZG1hcC5qcyIsIndlYnBhY2s6Ly9waGluYS50aWxlZG1hcC5qcy8uL3NyYy90aWxlZG1hcC9UaWxlc2V0LmpzIiwid2VicGFjazovL3BoaW5hLnRpbGVkbWFwLmpzLy4vc3JjL3RpbGVkbWFwL1hNTExvYWRlci5qcyIsIndlYnBhY2s6Ly9waGluYS50aWxlZG1hcC5qcy8uL25vZGVfbW9kdWxlcy9waGluYS5qcy9idWlsZC9waGluYS5lc20uanMiLCJ3ZWJwYWNrOi8vcGhpbmEudGlsZWRtYXAuanMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcGhpbmEudGlsZWRtYXAuanMvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3BoaW5hLnRpbGVkbWFwLmpzL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vcGhpbmEudGlsZWRtYXAuanMvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9waGluYS50aWxlZG1hcC5qcy93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3BoaW5hLnRpbGVkbWFwLmpzLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBcUM7QUFDK0M7O0FBRTdFLHVCQUF1QixpREFBUztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHdCQUF3QjtBQUM1QztBQUNBO0FBQ0E7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TztBQUNwQixhQUFhLE9BQU87QUFDcEIsZUFBZSxTQUFTO0FBQ3hCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixlQUFlLFNBQVM7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGVBQWU7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O0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxRQUFRO0FBQ3JCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsUUFBUTtBQUNyQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxRQUFRO0FBQ3JCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsUUFBUTtBQUNyQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGFB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QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsS0FBSztBQUNwQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhLGtCQUFrQjtBQUMvQjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsZUFBZSxrQkFBa0I7QUFDakM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBLGFBQWEsZ0JBQWdCO0FBQzdCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsZ0JBQWdCO0FBQzdCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsZ0JBQWdCO0FBQzdCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFD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ckMsY0FBYyxPQUFPO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDLHFDQUFxQztBQUNyQyxzQ0FBc0M7QUFDdEMsT0FBTztBQUNQO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLG1DQUFtQztBQUNoRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGFBQWEsNkJBQTZCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhLGlDQUFpQztBQUM5QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLE9BQU87QUFDMUI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLGdCQUFnQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZUFBZSxnQ0FBZ0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhLDREQUE0RDtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsNERBQTREO0FBQ3pFO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLE9BQU87QUFDMUI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDREQUE0RDtBQUN6RTtBQUNBO0FBQ0EsMEJBQTBCLDhCQUE4QjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsb0NBQW9DO0FBQ2pEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxvQkFBb0I7QUFDeEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYSxnQkFBZ0I7QUFDN0I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsRUFBRTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYSxnQkFBZ0I7QUFDN0IsZUFBZTtBQUNmO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isb0JBQW9CO0FBQ3BDLGFBQWEsRUFBRTtBQUNmLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7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QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixLQUFLO0FBQ3RCO0FBQ0E7QUFDQSx3RUFBd0U7O0FBRXhFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0EsUUFBUTs7QUFFUjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7O0FBRVI7QUFDQTtBQUNBLFFBQVE7O0FBRVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxjQUFjLDJDQUEyQztBQUN6RCxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxjQUFjLDJDQUEyQztBQUN6RCxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLGNBQWM7QUFDM0I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNB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QUNkO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGFBQWEsRUFBRTtBQUNmO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsZ0JBQWdCO0FBQzdCLGFBQWEsUUFBUTtBQUNyQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLDhDQUE4QztBQUNsRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsZ0JBQWdCO0FBQzdCO0FBQ0E7QUFDQTs7QUFFQSxlQUFlLGdCQUFnQjtBQUMvQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtB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QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBOztBQUVBLEtBQUs7OztBQUdMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhLG9DQUFvQztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixXQUFXOztBQUUvQjtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYSxvQ0FBb0M7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQSxhQUFhLG9DQUFvQztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7O0FBRVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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Q1A7O0FBRUE7O0FBRUEsV0FBVyxrQkFBa0I7QUFDN0I7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUU0cEM7Ozs7Ozs7VUNqN2pCNXBDO1VBQ0E7O1VBRUE7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7O1VBRUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7Ozs7O1dDdEJBO1dBQ0E7V0FDQTtXQUNBO1dBQ0Esd0NBQXdDLHlDQUF5QztXQUNqRjtXQUNBO1dBQ0EsRTs7Ozs7V0NQQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLEVBQUU7V0FDRjtXQUNBO1dBQ0EsQ0FBQyxJOzs7OztXQ1BELHdGOzs7OztXQ0FBO1dBQ0E7V0FDQTtXQUNBLHNEQUFzRCxrQkFBa0I7V0FDeEU7V0FDQSwrQ0FBK0MsY0FBYztXQUM3RCxFOzs7Ozs7Ozs7Ozs7O0FDTjZDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1hNTExvYWRlcn0gZnJvbSBcIi4vWE1MTG9hZGVyXCJcbmltcG9ydCB7QXNzZXRMb2FkZXIsIEFzc2V0TWFuYWdlciwgQ2FudmFzLCBUZXh0dXJlLCAkc2FmZSwgJGV4dGVuZH0gZnJvbSBcInBoaW5hLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBUaWxlZE1hcCBleHRlbmRzIFhNTExvYWRlcntcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgIHN1cGVyKCk7XG4gICAgICB0aGlzLmltYWdlID0gbnVsbDtcbiAgICAgIHRoaXMudGlsZXNldHMgPSBudWxsO1xuICAgICAgdGhpcy5sYXllcnMgPSBudWxsO1xuICAgICAgdGhpcy5wYXRoID0gXCJcIjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDjg57jg4Pjg5fjgqTjg6Hjg7zjgrjlj5blvpdcbiAgICAgKiBAcGFyYW0gbGF5ZXJOYW1lIHtTdHJpbmd9XG4gICAgICogQHJldHVybnMge1RleHR1cmV8bnVsbH1cbiAgICAgKi9cbiAgICBnZXRJbWFnZShsYXllck5hbWUpIHtcbiAgICAgIGlmIChsYXllck5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZW5lcmF0ZUltYWdlKGxheWVyTmFtZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5oyH5a6a44Oe44OD44OX44Os44Kk44Ok44O844KS6YWN5YiX44Go44GX44Gm5Y+W5b6XXG4gICAgICogQHBhcmFtIGxheWVyTmFtZSB7U3RyaW5nfVxuICAgICAqIEByZXR1cm5zIHtudWxsfCp9XG4gICAgICovXG4gICAgZ2V0TWFwRGF0YShsYXllck5hbWUpIHtcbiAgICAgIC8v44Os44Kk44Ok44O85qSc57SiXG4gICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5sYXllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMubGF5ZXJzW2ldLm5hbWUgPT09IGxheWVyTmFtZSkge1xuICAgICAgICAgIC8v44Kz44OU44O844KS6L+U44GZXG4gICAgICAgICAgcmV0dXJuIHRoaXMubGF5ZXJzW2ldLmRhdGEuY29uY2F0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOOCquODluOCuOOCp+OCr+ODiOOCsOODq+ODvOODl+OCkuWPluW+l++8iOaMh+WumuOBjOeEoeOBhOWgtOWQiOOAgeWFqOODrOOCpOODpOODvOOCkumFjeWIl+OBq+OBl+OBpui/lOOBme+8iVxuICAgICAqIEBwYXJhbSBncm91cE5hbWUge1N0cmluZ31cbiAgICAgKiBAcmV0dXJucyB7KltdfGFueX1cbiAgICAgKi9cbiAgICBnZXRPYmplY3RHcm91cChncm91cE5hbWUpIHtcbiAgICAgIGdyb3VwTmFtZSA9IGdyb3VwTmFtZSB8fCBudWxsO1xuICAgICAgY29uc3QgbHMgPSBbXTtcbiAgICAgIGNvbnN0IGxlbiA9IHRoaXMubGF5ZXJzLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMubGF5ZXJzW2ldLnR5cGUgPT09IFwib2JqZWN0Z3JvdXBcIikge1xuICAgICAgICAgIGlmIChncm91cE5hbWUgPT0gbnVsbCB8fCBncm91cE5hbWUgPT09IHRoaXMubGF5ZXJzW2ldLm5hbWUpIHtcbiAgICAgICAgICAgIC8v44Os44Kk44Ok44O85oOF5aCx44KS44Kv44Ot44O844Oz44GZ44KLXG4gICAgICAgICAgICBjb25zdCBvYmogPSB0aGlzLl9jbG9uZU9iamVjdExheWVyKHRoaXMubGF5ZXJzW2ldKTtcbiAgICAgICAgICAgIGlmIChncm91cE5hbWUgIT09IG51bGwpIHJldHVybiBvYmo7XG4gICAgICAgICAgICBscy5wdXNoKG9iaik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog44Kq44OW44K444Kn44Kv44OI44Os44Kk44Ok44O844KS44Kv44Ot44O844Oz44GX44Gm6L+U44GZXG4gICAgICogQHBhcmFtIHNyY0xheWVyIHtTdHJpbmd9XG4gICAgICogQHJldHVybnMge2FueX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jbG9uZU9iamVjdExheWVyKHNyY0xheWVyKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSAkc2FmZS5jYWxsKHt9LCBzcmNMYXllcik7XG4gICAgICByZXN1bHQub2JqZWN0cyA9IFtdO1xuICAgICAgLy/jg6zjgqTjg6Tjg7zlhoXjgqrjg5bjgrjjgqfjgq/jg4jjga7jgrPjg5Tjg7xcbiAgICAgIHNyY0xheWVyLm9iamVjdHMuZm9yRWFjaChvYmogPT4ge1xuICAgICAgICBjb25zdCByZXNPYmogPSB7XG4gICAgICAgICAgcHJvcGVydGllczogJHNhZmUuY2FsbCh7fSwgb2JqLnByb3BlcnRpZXMpLFxuICAgICAgICB9XG4gICAgICAgICRleHRlbmQuY2FsbChyZXNPYmosIG9iaik7XG4gICAgICAgIGlmIChvYmouZWxsaXBzZSkgcmVzT2JqLmVsbGlwc2UgPSBvYmouZWxsaXBzZTtcbiAgICAgICAgaWYgKG9iai5naWQpIHJlc09iai5naWQgPSBvYmouZ2lkO1xuICAgICAgICBpZiAob2JqLnBvbHlnb24pIHJlc09iai5wb2x5Z29uID0gb2JqLnBvbHlnb24uY2xvbmUoKTtcbiAgICAgICAgaWYgKG9iai5wb2x5bGluZSkgcmVzT2JqLnBvbHlsaW5lID0gb2JqLnBvbHlsaW5lLmNsb25lKCk7XG4gICAgICAgIHJlc3VsdC5vYmplY3RzLnB1c2gocmVzT2JqKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDjg4fjg7zjgr/jga7jg5Hjg7zjgrnjgpLooYzjgYZcbiAgICAgKiBAcGFyYW0gZGF0YSB7WE1MRG9jdW1lbnR9XG4gICAgICogQHJldHVybnMge1Byb21pc2U8dW5rbm93bj59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcGFyc2UoZGF0YSkge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAvL+OCv+OCpOODq+WxnuaAp+aDheWgseWPluW+l1xuICAgICAgICBjb25zdCBtYXAgPSBkYXRhLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtYXAnKVswXTtcbiAgICAgICAgY29uc3QgYXR0ciA9IHRoaXMuX2F0dHJUb0pTT04obWFwKTtcbiAgICAgICAgJGV4dGVuZC5jYWxsKHRoaXMsIGF0dHIpO1xuICAgICAgICB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLl9wcm9wZXJ0aWVzVG9KU09OKG1hcCk7XG5cbiAgICAgICAgLy/jgr/jgqTjg6vjgrvjg4Pjg4jlj5blvpdcbiAgICAgICAgdGhpcy50aWxlc2V0cyA9IHRoaXMuX3BhcnNlVGlsZXNldHMoZGF0YSk7XG4gICAgICAgIHRoaXMudGlsZXNldHMuc29ydCgoYSwgYikgPT4gYS5maXJzdGdpZCAtIGIuZmlyc3RnaWQpO1xuXG4gICAgICAgIC8v44Os44Kk44Ok44O85Y+W5b6XXG4gICAgICAgIHRoaXMubGF5ZXJzID0gdGhpcy5fcGFyc2VMYXllcnMoZGF0YSk7XG5cbiAgICAgICAgLy/jgqTjg6Hjg7zjgrjjg4fjg7zjgr/oqq3jgb/ovrzjgb9cbiAgICAgICAgdGhpcy5fY2hlY2tJbWFnZSgpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy/jg57jg4Pjg5fjgqTjg6Hjg7zjgrjnlJ/miJBcbiAgICAgICAgICAgIHRoaXMuaW1hZ2UgPSB0aGlzLl9nZW5lcmF0ZUltYWdlKCk7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfSk7XG4gICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOOCv+OCpOODq+OCu+ODg+ODiOOBruODkeODvOOCuVxuICAgICAqIEBwYXJhbSB4bWwge1hNTERvY3VtZW50fVxuICAgICAqIEByZXR1cm5zIHsqW119XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcGFyc2VUaWxlc2V0cyh4bWwpIHtcbiAgICAgIGNvbnN0IGVhY2ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaDtcbiAgICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICAgIGNvbnN0IHRpbGVzZXRzID0geG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0aWxlc2V0Jyk7XG4gICAgICBlYWNoLmNhbGwodGlsZXNldHMsIGFzeW5jIHRpbGVzZXQgPT4ge1xuICAgICAgICBjb25zdCB0ID0ge307XG4gICAgICAgIGNvbnN0IGF0dHIgPSB0aGlzLl9hdHRyVG9KU09OKHRpbGVzZXQpO1xuICAgICAgICBpZiAoYXR0ci5zb3VyY2UpIHtcbiAgICAgICAgICB0LmlzT2xkRm9ybWF0ID0gZmFsc2U7XG4gICAgICAgICAgdC5zb3VyY2UgPSB0aGlzLnBhdGggKyBhdHRyLnNvdXJjZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvL+aXp+ODh+ODvOOCv+W9ouW8j++8iOacquWvvuW/nO+8iVxuICAgICAgICAgIHQuaXNPbGRGb3JtYXQgPSB0cnVlO1xuICAgICAgICAgIHQuZGF0YSA9IHRpbGVzZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdC5maXJzdGdpZCA9IGF0dHIuZmlyc3RnaWQ7XG4gICAgICAgIGRhdGEucHVzaCh0KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog44Os44Kk44Ok44O85oOF5aCx44Gu44OR44O844K5XG4gICAgICogQHBhcmFtIHhtbCB7WE1MRG9jdW1lbnR9XG4gICAgICogQHJldHVybnMgeypbXX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9wYXJzZUxheWVycyh4bWwpIHtcbiAgICAgIGNvbnN0IGVhY2ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaDtcbiAgICAgIGNvbnN0IGRhdGEgPSBbXTtcblxuICAgICAgY29uc3QgbWFwID0geG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwibWFwXCIpWzBdO1xuICAgICAgY29uc3QgbGF5ZXJzID0gW107XG4gICAgICBlYWNoLmNhbGwobWFwLmNoaWxkTm9kZXMsIGVsbSA9PiB7XG4gICAgICAgIGlmIChlbG0udGFnTmFtZSA9PT0gXCJsYXllclwiIHx8IGVsbS50YWdOYW1lID09PSBcIm9iamVjdGdyb3VwXCIgfHwgZWxtLnRhZ05hbWUgPT09IFwiaW1hZ2VsYXllclwiKSB7XG4gICAgICAgICAgbGF5ZXJzLnB1c2goZWxtKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGxheWVycy5mb3JFYWNoKGxheWVyID0+IHtcbiAgICAgICAgc3dpdGNoIChsYXllci50YWdOYW1lKSB7XG4gICAgICAgICAgY2FzZSBcImxheWVyXCI6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIC8v6YCa5bi444Os44Kk44Ok44O8XG4gICAgICAgICAgICAgIGNvbnN0IGQgPSBsYXllci5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZGF0YScpWzBdO1xuICAgICAgICAgICAgICBjb25zdCBlbmNvZGluZyA9IGQuZ2V0QXR0cmlidXRlKFwiZW5jb2RpbmdcIik7XG4gICAgICAgICAgICAgIGNvbnN0IGwgPSB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcImxheWVyXCIsXG4gICAgICAgICAgICAgICAgICBuYW1lOiBsYXllci5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpLFxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIGlmIChlbmNvZGluZyA9PT0gXCJjc3ZcIikge1xuICAgICAgICAgICAgICAgICAgbC5kYXRhID0gdGhpcy5fcGFyc2VDU1YoZC50ZXh0Q29udGVudCk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5jb2RpbmcgPT09IFwiYmFzZTY0XCIpIHtcbiAgICAgICAgICAgICAgICAgIGwuZGF0YSA9IHRoaXMuX3BhcnNlQmFzZTY0KGQudGV4dENvbnRlbnQpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY29uc3QgYXR0ciA9IHRoaXMuX2F0dHJUb0pTT04obGF5ZXIpO1xuICAgICAgICAgICAgICAkZXh0ZW5kLmNhbGwobCwgYXR0cik7XG4gICAgICAgICAgICAgIGwucHJvcGVydGllcyA9IHRoaXMuX3Byb3BlcnRpZXNUb0pTT04obGF5ZXIpO1xuXG4gICAgICAgICAgICAgIGRhdGEucHVzaChsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgLy/jgqrjg5bjgrjjgqfjgq/jg4jjg6zjgqTjg6Tjg7xcbiAgICAgICAgICBjYXNlIFwib2JqZWN0Z3JvdXBcIjpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgY29uc3QgbCA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdGdyb3VwXCIsXG4gICAgICAgICAgICAgICAgb2JqZWN0czogW10sXG4gICAgICAgICAgICAgICAgbmFtZTogbGF5ZXIuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSxcbiAgICAgICAgICAgICAgICB4OiBwYXJzZUZsb2F0KGxheWVyLmdldEF0dHJpYnV0ZShcIm9mZnNldHhcIikpIHx8IDAsXG4gICAgICAgICAgICAgICAgeTogcGFyc2VGbG9hdChsYXllci5nZXRBdHRyaWJ1dGUoXCJvZmZzZXR5XCIpKSB8fCAwLFxuICAgICAgICAgICAgICAgIGFscGhhOiBsYXllci5nZXRBdHRyaWJ1dGUoXCJvcGFjaXR5XCIpIHx8IDEsXG4gICAgICAgICAgICAgICAgY29sb3I6IGxheWVyLmdldEF0dHJpYnV0ZShcImNvbG9yXCIpIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgZHJhd29yZGVyOiBsYXllci5nZXRBdHRyaWJ1dGUoXCJkcmF3b3JkZXJcIikgfHwgbnVsbCxcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgZWFjaC5jYWxsKGxheWVyLmNoaWxkTm9kZXMsIGVsbSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVsbS5ub2RlVHlwZSA9PT0gMykgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGNvbnN0IGQgPSB0aGlzLl9hdHRyVG9KU09OKGVsbSk7XG4gICAgICAgICAgICAgICAgZC5wcm9wZXJ0aWVzID0gdGhpcy5fcHJvcGVydGllc1RvSlNPTihlbG0pO1xuICAgICAgICAgICAgICAgIC8v5a2Q6KaB57Sg44Gu6Kej5p6QXG4gICAgICAgICAgICAgICAgaWYgKGVsbS5jaGlsZE5vZGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgZWxtLmNoaWxkTm9kZXMuZm9yRWFjaChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUubm9kZVR5cGUgPT09IDMpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgLy/mpZXlhoZcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUubm9kZU5hbWUgPT09ICdlbGxpcHNlJykge1xuICAgICAgICAgICAgICAgICAgICAgIGQuZWxsaXBzZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy/lpJrop5LlvaJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUubm9kZU5hbWUgPT09ICdwb2x5Z29uJykge1xuICAgICAgICAgICAgICAgICAgICAgIGQucG9seWdvbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHIgPSB0aGlzLl9hdHRyVG9KU09OX3N0cihlKTtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwbCA9IGF0dHIucG9pbnRzLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICBwbC5mb3JFYWNoKGZ1bmN0aW9uKHN0cikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHRzID0gc3RyLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucG9seWdvbi5wdXNoKHt4OiBwYXJzZUZsb2F0KHB0c1swXSksIHk6IHBhcnNlRmxvYXQocHRzWzFdKX0pO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8v57ea5YiGXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLm5vZGVOYW1lID09PSAncG9seWxpbmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZC5wb2x5bGluZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHIgPSB0aGlzLl9hdHRyVG9KU09OX3N0cihlKTtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwbCA9IGF0dHIucG9pbnRzLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICBwbC5mb3JFYWNoKHN0ciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdHMgPSBzdHIuc3BsaXQoXCIsXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wb2x5bGluZS5wdXNoKHt4OiBwYXJzZUZsb2F0KHB0c1swXSksIHk6IHBhcnNlRmxvYXQocHRzWzFdKX0pO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbC5vYmplY3RzLnB1c2goZCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBsLnByb3BlcnRpZXMgPSB0aGlzLl9wcm9wZXJ0aWVzVG9KU09OKGxheWVyKTtcblxuICAgICAgICAgICAgICBkYXRhLnB1c2gobCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIC8v44Kk44Oh44O844K444Os44Kk44Ok44O8XG4gICAgICAgICAgY2FzZSBcImltYWdlbGF5ZXJcIjpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgY29uc3QgbCA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcImltYWdlbGF5ZXJcIixcbiAgICAgICAgICAgICAgICBuYW1lOiBsYXllci5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpLFxuICAgICAgICAgICAgICAgIHg6IHBhcnNlRmxvYXQobGF5ZXIuZ2V0QXR0cmlidXRlKFwib2Zmc2V0eFwiKSkgfHwgMCxcbiAgICAgICAgICAgICAgICB5OiBwYXJzZUZsb2F0KGxheWVyLmdldEF0dHJpYnV0ZShcIm9mZnNldHlcIikpIHx8IDAsXG4gICAgICAgICAgICAgICAgYWxwaGE6IGxheWVyLmdldEF0dHJpYnV0ZShcIm9wYWNpdHlcIikgfHwgMSxcbiAgICAgICAgICAgICAgICB2aXNpYmxlOiAobGF5ZXIuZ2V0QXR0cmlidXRlKFwidmlzaWJsZVwiKSA9PT0gdW5kZWZpbmVkIHx8IGxheWVyLmdldEF0dHJpYnV0ZShcInZpc2libGVcIikgIT09IDApLFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICBjb25zdCBpbWFnZUVsbSA9IGxheWVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW1hZ2VcIilbMF07XG4gICAgICAgICAgICAgIGwuaW1hZ2UgPSB7c291cmNlOiBpbWFnZUVsbS5nZXRBdHRyaWJ1dGUoXCJzb3VyY2VcIil9O1xuXG4gICAgICAgICAgICAgIGRhdGEucHVzaChsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIC8v44Kw44Or44O844OXXG4gICAgICAgICAgY2FzZSBcImdyb3VwXCI6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDjgqLjgrvjg4Pjg4jjgavnhKHjgYTjgqTjg6Hjg7zjgrjjg4fjg7zjgr/jgpLoqq3jgb/ovrzjgb9cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx1bmtub3duPnxQcm9taXNlPHZvaWQ+fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NoZWNrSW1hZ2UoKSB7XG4gICAgICBjb25zdCBpbWFnZVNvdXJjZSA9IFtdO1xuICAgICAgY29uc3QgbG9hZEltYWdlID0gW107XG5cbiAgICAgIC8v5LiA6Kan5L2c5oiQXG4gICAgICB0aGlzLnRpbGVzZXRzLmZvckVhY2godGlsZXNldCA9PiB7XG4gICAgICAgIGNvbnN0IG9iaiA9IHtcbiAgICAgICAgICBpc1RpbGVzZXQ6IHRydWUsXG4gICAgICAgICAgaW1hZ2U6IHRpbGVzZXQuc291cmNlLFxuICAgICAgICB9O1xuICAgICAgICBpbWFnZVNvdXJjZS5wdXNoKG9iaik7XG4gICAgICB9KTtcbiAgICAgIHRoaXMubGF5ZXJzLmZvckVhY2gobGF5ZXIgPT4ge1xuICAgICAgICBpZiAobGF5ZXIuaW1hZ2UpIHtcbiAgICAgICAgICBjb25zdCBvYmogPSB7XG4gICAgICAgICAgICBpc1RpbGVzZXQ6IGZhbHNlLFxuICAgICAgICAgICAgaW1hZ2U6IGxheWVyLmltYWdlLnNvdXJjZSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIGltYWdlU291cmNlLnB1c2gob2JqKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8v44Ki44K744OD44OI44Gr44GC44KL44GL56K66KqNXG4gICAgICBpbWFnZVNvdXJjZS5mb3JFYWNoKGUgPT4ge1xuICAgICAgICBpZiAoZS5pc1RpbGVzZXQpIHtcbiAgICAgICAgICBjb25zdCB0c3ggPSBBc3NldE1hbmFnZXIuZ2V0KCd0c3gnLCBlLmltYWdlKTtcbiAgICAgICAgICBpZiAoIXRzeCkge1xuICAgICAgICAgICAgLy/jgqLjgrvjg4Pjg4jjgavjgarjgYvjgaPjgZ/jga7jgafjg63jg7zjg4njg6rjgrnjg4jjgavov73liqBcbiAgICAgICAgICAgIGxvYWRJbWFnZS5wdXNoKGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCBpbWFnZSA9IEFzc2V0TWFuYWdlci5nZXQoJ2ltYWdlJywgZS5pbWFnZSk7XG4gICAgICAgICAgaWYgKCFpbWFnZSkge1xuICAgICAgICAgICAgLy/jgqLjgrvjg4Pjg4jjgavjgarjgYvjgaPjgZ/jga7jgafjg63jg7zjg4njg6rjgrnjg4jjgavov73liqBcbiAgICAgICAgICAgIGxvYWRJbWFnZS5wdXNoKGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8v5LiA5ous44Ot44O844OJXG4gICAgICAvL+ODreODvOODieODquOCueODiOS9nOaIkFxuICAgICAgaWYgKGxvYWRJbWFnZS5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgYXNzZXRzID0geyBpbWFnZTogW10sIHRzeDogW10gfTtcbiAgICAgICAgbG9hZEltYWdlLmZvckVhY2goZSA9PiB7XG4gICAgICAgICAgaWYgKGUuaXNUaWxlc2V0KSB7XG4gICAgICAgICAgICBhc3NldHMudHN4W2UuaW1hZ2VdID0gZS5pbWFnZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy/jgqLjgrvjg4Pjg4jjga7jg5HjgrnjgpLjg57jg4Pjg5fjgajlkIzjgZjjgavjgZnjgotcbiAgICAgICAgICAgIGFzc2V0cy5pbWFnZVtlLmltYWdlXSA9IHRoaXMucGF0aCArIGUuaW1hZ2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgIGNvbnN0IGxvYWRlciA9IG5ldyBBc3NldExvYWRlcigpO1xuICAgICAgICAgIGxvYWRlci5sb2FkKGFzc2V0cyk7XG4gICAgICAgICAgbG9hZGVyLm9uKCdsb2FkJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50aWxlc2V0cy5mb3JFYWNoKGUgPT4ge1xuICAgICAgICAgICAgICBlLnRzeCA9IEFzc2V0TWFuYWdlci5nZXQoJ3RzeCcsIGUuc291cmNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDjg57jg4Pjg5fjgqTjg6Hjg7zjgrjkvZzmiJBcbiAgICAgKiBAcGFyYW0gbGF5ZXJOYW1lIHtTdHJpbmd9XG4gICAgICogQHJldHVybnMge1RleHR1cmV8bnVsbH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9nZW5lcmF0ZUltYWdlKGxheWVyTmFtZSkge1xuICAgICAgbGV0IG51bUxheWVyID0gMDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5sYXllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMubGF5ZXJzW2ldLnR5cGUgPT09IFwibGF5ZXJcIiB8fCB0aGlzLmxheWVyc1tpXS50eXBlID09PSBcImltYWdlbGF5ZXJcIikgbnVtTGF5ZXIrKztcbiAgICAgIH1cbiAgICAgIGlmIChudW1MYXllciA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aCAqIHRoaXMudGlsZXdpZHRoO1xuICAgICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5oZWlnaHQgKiB0aGlzLnRpbGVoZWlnaHQ7XG4gICAgICBjb25zdCBjYW52YXMgPSBuZXcgQ2FudmFzKCkuc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxheWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAvL+ODnuODg+ODl+ODrOOCpOODpOODvFxuICAgICAgICBpZiAodGhpcy5sYXllcnNbaV0udHlwZSA9PT0gXCJsYXllclwiICYmIHRoaXMubGF5ZXJzW2ldLnZpc2libGUgIT09IFwiMFwiKSB7XG4gICAgICAgICAgaWYgKGxheWVyTmFtZSA9PT0gdW5kZWZpbmVkIHx8IGxheWVyTmFtZSA9PT0gdGhpcy5sYXllcnNbaV0ubmFtZSkge1xuICAgICAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLmxheWVyc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IG1hcGRhdGEgPSBsYXllci5kYXRhO1xuICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBsYXllci53aWR0aDtcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGxheWVyLmhlaWdodDtcbiAgICAgICAgICAgIGNvbnN0IG9wYWNpdHkgPSBsYXllci5vcGFjaXR5IHx8IDEuMDtcbiAgICAgICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7XG4gICAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gbWFwZGF0YVtjb3VudF07XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAvL+ODnuODg+ODl+ODgeODg+ODl+OCkumFjee9rlxuICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0TWFwQ2hpcChjYW52YXMsIGluZGV4LCB4ICogdGhpcy50aWxld2lkdGgsIHkgKiB0aGlzLnRpbGVoZWlnaHQsIG9wYWNpdHkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8v44Kq44OW44K444Kn44Kv44OI44Kw44Or44O844OXXG4gICAgICAgIGlmICh0aGlzLmxheWVyc1tpXS50eXBlID09PSBcIm9iamVjdGdyb3VwXCIgJiYgdGhpcy5sYXllcnNbaV0udmlzaWJsZSAhPT0gXCIwXCIpIHtcbiAgICAgICAgICBpZiAobGF5ZXJOYW1lID09PSB1bmRlZmluZWQgfHwgbGF5ZXJOYW1lID09PSB0aGlzLmxheWVyc1tpXS5uYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBsYXllciA9IHRoaXMubGF5ZXJzW2ldO1xuICAgICAgICAgICAgY29uc3Qgb3BhY2l0eSA9IGxheWVyLm9wYWNpdHkgfHwgMS4wO1xuICAgICAgICAgICAgbGF5ZXIub2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgaWYgKGUuZ2lkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0TWFwQ2hpcChjYW52YXMsIGUuZ2lkLCBlLngsIGUueSwgb3BhY2l0eSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8v44Kk44Oh44O844K444Os44Kk44Ok44O8XG4gICAgICAgIGlmICh0aGlzLmxheWVyc1tpXS50eXBlID09PSBcImltYWdlbGF5ZXJcIiAmJiB0aGlzLmxheWVyc1tpXS52aXNpYmxlICE9PSBcIjBcIikge1xuICAgICAgICAgIGlmIChsYXllck5hbWUgPT09IHVuZGVmaW5lZCB8fCBsYXllck5hbWUgPT09IHRoaXMubGF5ZXJzW2ldLm5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IGltYWdlID0gQXNzZXRNYW5hZ2VyLmdldCgnaW1hZ2UnLCB0aGlzLmxheWVyc1tpXS5pbWFnZS5zb3VyY2UpO1xuICAgICAgICAgICAgY2FudmFzLmNvbnRleHQuZHJhd0ltYWdlKGltYWdlLmRvbUVsZW1lbnQsIHRoaXMubGF5ZXJzW2ldLngsIHRoaXMubGF5ZXJzW2ldLnkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCB0ZXh0dXJlID0gbmV3IFRleHR1cmUoKTtcbiAgICAgIHRleHR1cmUuZG9tRWxlbWVudCA9IGNhbnZhcy5kb21FbGVtZW50O1xuICAgICAgcmV0dXJuIHRleHR1cmU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog44Kt44Oj44Oz44OQ44K544Gu5oyH5a6a44GX44Gf5bqn5qiZ44Gr44Oe44OD44OX44OB44OD44OX44Gu44Kk44Oh44O844K444KS44Kz44OU44O844GZ44KLXG4gICAgICogQHBhcmFtIGNhbnZhcyB7SFRNTENhbnZhc0VsZW1lbnR9XG4gICAgICogQHBhcmFtIGluZGV4IHtOdW1iZXJ9XG4gICAgICogQHBhcmFtIHgge051bWJlcn1cbiAgICAgKiBAcGFyYW0geSB7TnVtYmVyfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldE1hcENoaXAoY2FudmFzLCBpbmRleCwgeCwgeSkge1xuICAgICAgLy/lr77osaHjgr/jgqTjg6vjgrvjg4Pjg4jjga7liKTliKVcbiAgICAgIGxldCB0aWxlc2V0O1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRpbGVzZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHRzeDEgPSB0aGlzLnRpbGVzZXRzW2ldO1xuICAgICAgICBjb25zdCB0c3gyID0gdGhpcy50aWxlc2V0c1tpICsgMV07XG4gICAgICAgIGlmICghdHN4Mikge1xuICAgICAgICAgIHRpbGVzZXQgPSB0c3gxO1xuICAgICAgICAgIGkgPSB0aGlzLnRpbGVzZXRzLmxlbmd0aDtcbiAgICAgICAgfSBlbHNlIGlmICh0c3gxLmZpcnN0Z2lkIDw9IGluZGV4ICYmIGluZGV4IDwgdHN4Mi5maXJzdGdpZCkge1xuICAgICAgICAgIHRpbGVzZXQgPSB0c3gxO1xuICAgICAgICAgIGkgPSB0aGlzLnRpbGVzZXRzLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy/jgr/jgqTjg6vjgrvjg4Pjg4jjgYvjgonjg57jg4Pjg5fjg4Hjg4Pjg5fjgpLlj5blvpdcbiAgICAgIGNvbnN0IHRzeCA9IHRpbGVzZXQudHN4O1xuICAgICAgY29uc3QgY2hpcCA9IHRzeC5jaGlwc1tpbmRleCAtIHRpbGVzZXQuZmlyc3RnaWRdO1xuICAgICAgY29uc3QgaW1hZ2UgPSBBc3NldE1hbmFnZXIuZ2V0KCdpbWFnZScsIGNoaXAuaW1hZ2UpO1xuICAgICAgY2FudmFzLmNvbnRleHQuZHJhd0ltYWdlKFxuICAgICAgICBpbWFnZS5kb21FbGVtZW50LFxuICAgICAgICBjaGlwLnggKyB0c3gubWFyZ2luLCBjaGlwLnkgKyB0c3gubWFyZ2luLFxuICAgICAgICB0c3gudGlsZXdpZHRoLCB0c3gudGlsZWhlaWdodCxcbiAgICAgICAgeCwgeSxcbiAgICAgICAgdHN4LnRpbGV3aWR0aCwgdHN4LnRpbGVoZWlnaHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiB0bXjjg5XjgqHjgqTjg6voqq3jgb/ovrzjgb9cbiAqIEBwYXJhbSBrZXkge1N0cmluZ31cbiAqIEBwYXJhbSBwYXRoIHtTdHJpbmd9XG4gKiBAcmV0dXJucyB7Rmxvd31cbiAqL1xuQXNzZXRMb2FkZXIuYXNzZXRMb2FkRnVuY3Rpb25zLnRteCA9IChrZXksIHBhdGgpID0+IHtcbiAgICBjb25zdCB0bXggPSBuZXcgVGlsZWRNYXAoKTtcbiAgICByZXR1cm4gdG14LmxvYWQocGF0aCk7XG59XG4iLCJpbXBvcnQge1hNTExvYWRlcn0gZnJvbSBcIi4vWE1MTG9hZGVyXCJcbmltcG9ydCB7QXNzZXRMb2FkZXIsIEFzc2V0TWFuYWdlciwgJGV4dGVuZCwgJHNhZmV9IGZyb20gXCJwaGluYS5qc1wiO1xuXG5leHBvcnQgY2xhc3MgVGlsZVNldCBleHRlbmRzIFhNTExvYWRlcntcbiAgICBjb25zdHJ1Y3Rvcih4bWwpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5pbWFnZSA9IG51bGw7XG4gICAgICAgIHRoaXMudGlsZXdpZHRoID0gMDtcbiAgICAgICAgdGhpcy50aWxlaGVpZ2h0ID0gMDtcbiAgICAgICAgdGhpcy50aWxlY291bnQgPSAwO1xuICAgICAgICB0aGlzLmNvbHVtbnMgPSAwO1xuICAgICAgICB0aGlzLnBhdGggPSBcIlwiO1xuICAgICAgICBpZiAoeG1sKSB7XG4gICAgICAgICAgICB0aGlzLmxvYWRGcm9tWE1MKHhtbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBYTUzjg5XjgqHjgqTjg6voqq3jgb/ovrzjgb9cbiAgICAgKiBAcGFyYW0geG1sIHtYTUxEb2N1bWVudH1cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx1bmtub3duPn1cbiAgICAgKi9cbiAgICBsb2FkRnJvbVhNTCh4bWwpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wYXJzZSh4bWwpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIGRhdGEge1hNTERvY3VtZW50fVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHVua25vd24+fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3BhcnNlKGRhdGEpIHtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgLy/jgr/jgqTjg6vjgrvjg4Pjg4jlj5blvpdcbiAgICAgICAgY29uc3QgdGlsZXNldCA9IGRhdGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RpbGVzZXQnKVswXTtcbiAgICAgICAgLy8gY29uc3QgcHJvcHMgPSB0aGlzLl9wcm9wZXJ0aWVzVG9KU09OKHRpbGVzZXQpO1xuXG4gICAgICAgIC8v44K/44Kk44Or44K744OD44OI5bGe5oCn5oOF5aCx5Y+W5b6XXG4gICAgICAgIGNvbnN0IGF0dHIgPSB0aGlzLl9hdHRyVG9KU09OKHRpbGVzZXQpO1xuICAgICAgICAkc2FmZS5jYWxsKGF0dHIse1xuICAgICAgICAgIHRpbGV3aWR0aDogMzIsXG4gICAgICAgICAgdGlsZWhlaWdodDogMzIsXG4gICAgICAgICAgc3BhY2luZzogMCxcbiAgICAgICAgICBtYXJnaW46IDAsXG4gICAgICAgIH0pO1xuICAgICAgICAkZXh0ZW5kLmNhbGwodGhpcywgYXR0cik7XG4gICAgICAgIHRoaXMuY2hpcHMgPSBbXTtcblxuICAgICAgICAvL+OCveODvOOCueeUu+WDj+ioreWumuWPluW+l1xuICAgICAgICB0aGlzLmltYWdlTmFtZSA9IHRpbGVzZXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ltYWdlJylbMF0uZ2V0QXR0cmlidXRlKCdzb3VyY2UnKTtcbiAgXG4gICAgICAgIC8v6YCP6YGO6Imy6Kit5a6a5Y+W5b6XXG4gICAgICAgIGNvbnN0IHRyYW5zID0gdGlsZXNldC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW1hZ2UnKVswXS5nZXRBdHRyaWJ1dGUoJ3RyYW5zJyk7XG4gICAgICAgIGlmICh0cmFucykge1xuICAgICAgICAgIHRoaXMudHJhbnNSID0gcGFyc2VJbnQodHJhbnMuc3Vic3RyaW5nKDAsIDIpLCAxNik7XG4gICAgICAgICAgdGhpcy50cmFuc0cgPSBwYXJzZUludCh0cmFucy5zdWJzdHJpbmcoMiwgNCksIDE2KTtcbiAgICAgICAgICB0aGlzLnRyYW5zQiA9IHBhcnNlSW50KHRyYW5zLnN1YnN0cmluZyg0LCA2KSwgMTYpO1xuICAgICAgICB9XG4gIFxuICAgICAgICAvL+ODnuODg+ODl+ODgeODg+ODl+ODquOCueODiOS9nOaIkFxuICAgICAgICBmb3IgKGxldCByID0gMDsgciA8IHRoaXMudGlsZWNvdW50OyByKyspIHtcbiAgICAgICAgICB0aGlzLmNoaXBzW3JdID0ge1xuICAgICAgICAgICAgICBpbWFnZTogdGhpcy5pbWFnZU5hbWUsXG4gICAgICAgICAgICAgIHg6IChyICAlIHRoaXMuY29sdW1ucykgKiAodGhpcy50aWxld2lkdGggKyB0aGlzLnNwYWNpbmcpICsgdGhpcy5tYXJnaW4sXG4gICAgICAgICAgICAgIHk6IE1hdGguZmxvb3IociAvIHRoaXMuY29sdW1ucykgKiAodGhpcy50aWxlaGVpZ2h0ICsgdGhpcy5zcGFjaW5nKSArIHRoaXMubWFyZ2luLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvL+OCpOODoeODvOOCuOODh+ODvOOCv+iqreOBv+i+vOOBv1xuICAgICAgICB0aGlzLl9sb2FkSW1hZ2UoKVxuICAgICAgICAgIC50aGVuKCgpID0+IHJlc29sdmUoKSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDjgqLjgrvjg4Pjg4jjgavnhKHjgYTjgqTjg6Hjg7zjgrjjg4fjg7zjgr/jgpLoqq3jgb/ovrzjgb9cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx1bmtub3duPn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9sb2FkSW1hZ2UoKSB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgIGNvbnN0IGltYWdlU291cmNlID0ge1xuICAgICAgICAgIGltYWdlTmFtZTogdGhpcy5pbWFnZU5hbWUsXG4gICAgICAgICAgaW1hZ2VVcmw6IHRoaXMucGF0aCArIHRoaXMuaW1hZ2VOYW1lLFxuICAgICAgICAgIHRyYW5zUjogdGhpcy50cmFuc1IsXG4gICAgICAgICAgdHJhbnNHOiB0aGlzLnRyYW5zRyxcbiAgICAgICAgICB0cmFuc0I6IHRoaXMudHJhbnNCLFxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgbGV0IGxvYWRJbWFnZSA9IG51bGw7XG4gICAgICAgIGNvbnN0IGltYWdlID0gQXNzZXRNYW5hZ2VyLmdldCgnaW1hZ2UnLCBpbWFnZVNvdXJjZS5pbWFnZSk7XG4gICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2FkSW1hZ2UgPSBpbWFnZVNvdXJjZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v44Ot44O844OJ44Oq44K544OI5L2c5oiQXG4gICAgICAgIGNvbnN0IGFzc2V0cyA9IHsgaW1hZ2U6IFtdIH07XG4gICAgICAgIGFzc2V0cy5pbWFnZVtpbWFnZVNvdXJjZS5pbWFnZU5hbWVdID0gaW1hZ2VTb3VyY2UuaW1hZ2VVcmw7XG5cbiAgICAgICAgaWYgKGxvYWRJbWFnZSkge1xuICAgICAgICAgIGNvbnN0IGxvYWRlciA9IG5ldyBBc3NldExvYWRlcigpO1xuICAgICAgICAgIGxvYWRlci5sb2FkKGFzc2V0cyk7XG4gICAgICAgICAgbG9hZGVyLm9uKCdsb2FkJywgKCkgPT4ge1xuICAgICAgICAgICAgLy/pgI/pgY7oibLoqK3lrprlj43mmKBcbiAgICAgICAgICAgIHRoaXMuaW1hZ2UgPSBBc3NldE1hbmFnZXIuZ2V0KCdpbWFnZScsIGltYWdlU291cmNlLmltYWdlVXJsKTtcbiAgICAgICAgICAgIGlmIChpbWFnZVNvdXJjZS50cmFuc1IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICBjb25zdCByID0gaW1hZ2VTb3VyY2UudHJhbnNSO1xuICAgICAgICAgICAgICBjb25zdCBnID0gaW1hZ2VTb3VyY2UudHJhbnNHO1xuICAgICAgICAgICAgICBjb25zdCBiID0gaW1hZ2VTb3VyY2UudHJhbnNCO1xuICAgICAgICAgICAgICB0aGlzLmltYWdlLmZpbHRlcigocGl4ZWwsIGluZGV4LCB4LCB5LCBiaXRtYXApID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYml0bWFwLmRhdGE7XG4gICAgICAgICAgICAgICAgaWYgKHBpeGVsWzBdID09PSByICYmIHBpeGVsWzFdID09PSBnICYmIHBpeGVsWzJdID09PSBiKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbaW5kZXgrM10gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG59XG5cbi8qKlxuICogdHN444OV44Kh44Kk44Or6Kqt44G/6L6844G/XG4gKiBAcGFyYW0ga2V5XG4gKiBAcGFyYW0gcGF0aFxuICogQHJldHVybnMge0Zsb3d9XG4gKi9cbkFzc2V0TG9hZGVyLmFzc2V0TG9hZEZ1bmN0aW9ucy50c3ggPSBmdW5jdGlvbihrZXksIHBhdGgpIHtcbiAgICBjb25zdCB0c3ggPSBuZXcgVGlsZVNldCgpO1xuICAgIHJldHVybiB0c3gubG9hZChwYXRoKTtcbn07XG5cbiIsImltcG9ydCB7QXNzZXR9IGZyb20gXCJwaGluYS5qc1wiO1xuXG5leHBvcnQgY2xhc3MgWE1MTG9hZGVyIGV4dGVuZHMgQXNzZXR7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucGF0aCA9IFwiXCI7XG4gICAgfVxuXG4gICAgbG9hZER1bW15KCkgeyB9XG5cbiAgICAvKipcbiAgICAgKiBYTUzjg5XjgqHjgqTjg6vjga7jg63jg7zjg4lcbiAgICAgKiBAcGFyYW0gcmVzb2x2ZSB7ZnVuY3Rpb259XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIF9sb2FkKHJlc29sdmUpIHtcbiAgICAgICAgLy/jg5HjgrnmipzjgY3lh7rjgZdcbiAgICAgICAgdGhpcy5wYXRoID0gXCJcIjtcbiAgICAgICAgY29uc3QgbGFzdCA9IHRoaXMuc3JjLmxhc3RJbmRleE9mKFwiL1wiKTtcbiAgICAgICAgaWYgKGxhc3QgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnBhdGggPSB0aGlzLnNyYy5zdWJzdHJpbmcoMCwgbGFzdCArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy/ntYLkuobplqLmlbDkv53lrZhcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSA9IHJlc29sdmU7XG5cbiAgICAgICAgLy8gbG9hZFxuICAgICAgICBjb25zdCB4bWwgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgeG1sLm9wZW4oJ0dFVCcsIHRoaXMuc3JjKTtcbiAgICAgICAgeG1sLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICh4bWwucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICAgIGlmIChbMjAwLCAyMDEsIDBdLmluZGV4T2YoeG1sLnN0YXR1cykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSAobmV3IERPTVBhcnNlcigpKS5wYXJzZUZyb21TdHJpbmcoeG1sLnJlc3BvbnNlVGV4dCwgXCJ0ZXh0L3htbFwiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhVHlwZSA9IFwieG1sXCI7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhcnNlKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB0aGlzLl9yZXNvbHZlKHRoaXMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHhtbC5zZW5kKG51bGwpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFhNTOODl+ODreODkeODhuOCo+OCkkpTT07jgavlpInmj5tcbiAgICAgKiBAcGFyYW0gZWxtIHtYTUxEb2N1bWVudH1cbiAgICAgKiBAcmV0dXJucyB7e319XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIF9wcm9wZXJ0aWVzVG9KU09OKGVsbSkge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gZWxtLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwicHJvcGVydGllc1wiKVswXTtcbiAgICAgICAgY29uc3Qgb2JqID0ge307XG4gICAgICAgIGlmIChwcm9wZXJ0aWVzID09PSB1bmRlZmluZWQpIHJldHVybiBvYmo7XG5cbiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBwcm9wZXJ0aWVzLmNoaWxkTm9kZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBwcm9wZXJ0aWVzLmNoaWxkTm9kZXNba107XG4gICAgICAgICAgICBpZiAocC50YWdOYW1lID09PSBcInByb3BlcnR5XCIpIHtcbiAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBwLmdldEF0dHJpYnV0ZSgndmFsdWUnKTtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlKSB2YWx1ZSA9IHAudGV4dENvbnRlbnQ7XG4gICAgICAgICAgICAgICAgLy9wcm9wZXJ0eeOBq3R5cGXmjIflrprjgYzjgYLjgaPjgZ/jgonlpInmj5tcbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gcC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJpbnRcIikge1xuICAgICAgICAgICAgICAgICAgICBvYmpbcC5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJmbG9hdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ialtwLmdldEF0dHJpYnV0ZSgnbmFtZScpXSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJib29sXCIgKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ialtwLmdldEF0dHJpYnV0ZSgnbmFtZScpXSA9IHZhbHVlID09PSBcInRydWVcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvYmpbcC5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBYTUzlsZ7mgKfjgpJKU09O44Gr5aSJ5o+bXG4gICAgICogQHBhcmFtIHNvdXJjZVxuICAgICAqIEByZXR1cm5zIHt7fX1cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgX2F0dHJUb0pTT04oc291cmNlKSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IHt9O1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZS5hdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgdmFsID0gc291cmNlLmF0dHJpYnV0ZXNbaV0udmFsdWU7XG4gICAgICAgICAgICB2YWwgPSBpc05hTihwYXJzZUZsb2F0KHZhbCkpPyB2YWw6IHBhcnNlRmxvYXQodmFsKTtcbiAgICAgICAgICAgIG9ialtzb3VyY2UuYXR0cmlidXRlc1tpXS5uYW1lXSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFhNTOWxnuaAp+OCkkpTT07jgavlpInmj5vvvIhTdHJpbmfjgafov5TjgZnvvIlcbiAgICAgKiBAcGFyYW0gc291cmNlXG4gICAgICogQHJldHVybnMge3t9fVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBfYXR0clRvSlNPTl9zdHIoc291cmNlKSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IHt9O1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZS5hdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvYmpbc291cmNlLmF0dHJpYnV0ZXNbaV0ubmFtZV0gPSBzb3VyY2UuYXR0cmlidXRlc1tpXS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENTVuODkeODvOOCuVxuICAgICAqIEBwYXJhbSBkYXRhIHtzdHJpbmd9XG4gICAgICogQHJldHVybnMgeypbXX1cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgX3BhcnNlQ1NWKGRhdGEpIHtcbiAgICAgICAgY29uc3QgbGF5ZXIgPSBbXTtcbiAgICAgICAgY29uc3QgZGF0YUxpc3QgPSBkYXRhLnNwbGl0KCcsJyk7XG4gICAgICAgIGRhdGFMaXN0LmZvckVhY2goZWxtID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KGVsbSwgMTApO1xuICAgICAgICAgICAgbGF5ZXIucHVzaChudW0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxheWVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJBU0U2NOODkeODvOOCuVxuICAgICAqIGh0dHA6Ly90aGVrYW5ub24tc2VydmVyLmFwcHNwb3QuY29tL2hlcnBpdHktZGVycGl0eS5hcHBzcG90LmNvbS9wYXN0ZWJpbi5jb20vNzVLa3MwV0hcbiAgICAgKiBAcGFyYW0gZGF0YSB7c3RyaW5nfVxuICAgICAqIEByZXR1cm5zIHsqW119XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIF9wYXJzZUJhc2U2NChkYXRhKSB7XG4gICAgICAgIGNvbnN0IHJzdCA9IFtdO1xuICAgICAgICBjb25zdCBkYXRhTGlzdCA9IGF0b2IoZGF0YS50cmltKCkpLnNwbGl0KCcnKS5tYXAoZSA9PiBlLmNoYXJDb2RlQXQoMCkpO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gZGF0YUxpc3QubGVuZ3RoIC8gNDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZGF0YUxpc3RbaSAqIDRdLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICByc3RbaV0gPSBwYXJzZUludChuLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJzdDtcbiAgICB9XG59IiwiLyohXG4gKiBwaGluYS5qcyB2MC4yLjNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICpcbiAqIENvcHlyaWdodCAoQykgcGhpXG4gKi9cbi8qKlxuICogQGNsYXNzIGdsb2JhbC5TdHJpbmdcbiAqICMg5ouh5by144GX44GfIFN0cmluZyDjgq/jg6njgrlcbiAqL1xuXG4vKipcbiAqIEBtZXRob2QgZm9ybWF0XG4gKiDjg5Xjgqnjg7zjg57jg4Pjg4jjgavlvJXmlbDjgpLpgannlKjjgZfjgZ/mloflrZfliJfjgpLov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiDlvJXmlbDjgYzjgqrjg5bjgrjjgqfjgq/jg4jjga7loLTlkIjjgIFcInvjg5fjg63jg5Hjg4bjgqPlkI19XCIg44GM44Kq44OW44K444Kn44Kv44OI44Gu44OX44Ot44OR44OG44Kj44Gu5YCk44Gr572u44GN5o+b44KP44KK44G+44GZ44CCXG4gKiDmjIflrprjgZfjgZ/jg5fjg63jg5Hjg4bjgqPjgYzjgqrjg5bjgrjjgqfjgq/jg4jjgavjgarjgYTloLTlkIjjga/nqbrmloflrZfliJfjgavjgarjgorjgb7jgZnjgIJcbiAqXG4gKiDnrKwx5byV5pWw44GM44Kq44OW44K444Kn44Kv44OI44Gn44Gq44GL44Gj44Gf5aC05ZCI44CBXCJ75pW05pWwfVwiIOOBjOWQhOW8leaVsOOBq+e9ruOBjeaPm+OCj+OCiuOBvuOBmeOAglxuICog5oyH5a6a44GX44Gf5YCk44Gu5byV5pWw44GM44Gq44GL44Gj44Gf5aC05ZCI44Gv56m65paH5a2X5YiX44Gr44Gq44KK44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBvYmogPSB7cjogMTI4LCBnOiAwLCBiOiAyNTV9O1xuICogICAgIFwiY29sb3I6IHJnYih7cn0sIHtnfSwge2J9KTtcIi5mb3JtYXQob2JqKTsgLy8gPT4gXCJjb2xvcjogcmdiKDEyOCwgMCwgMjU1KTtcIlxuICpcbiAqICAgICBcInswfSArIHsxfSA9IHsyfVwiLmZvcm1hdCg1LCA4LCAoNSs4KSk7IC8vID0+IFwiNSArIDggPSAxM1wiXG4gKlxuICogQHRoaXMgU3RyaW5nXG4gKiBAcGFyYW0ge09iamVjdH0gYXJnIOODkeODqeODoeODvOOCv+OBqOOBquOCi+OCquODluOCuOOCp+OCr+ODiFxuICogQHJldHVybiB7U3RyaW5nfSDnlJ/miJDjgZfjgZ/mloflrZfliJdcbiAqL1xuZnVuY3Rpb24gZm9ybWF0KGFyZykge1xuLy8gU3RyaW5nLnByb3RvdHlwZS4kbWV0aG9kKFwiZm9ybWF0XCIsIGZ1bmN0aW9uKGFyZykge1xuICAvLyDnva7mj5vjg5XjgqHjg7Pjgq9cbiAgdmFyIHJlcF9mbiA9IHVuZGVmaW5lZDtcbiAgXG4gIC8vIOOCquODluOCuOOCp+OCr+ODiOOBruWgtOWQiFxuICBpZiAodHlwZW9mIGFyZyA9PSBcIm9iamVjdFwiKSB7XG4gICAgLyoqIEBpZ25vcmUgKi9cbiAgICByZXBfZm4gPSBmdW5jdGlvbihtLCBrKSB7XG4gICAgICBpZiAoYXJnW2tdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBhcmdba107XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICAvLyDopIfmlbDlvJXmlbDjgaDjgaPjgZ/loLTlkIhcbiAgZWxzZSB7XG4gICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgLyoqIEBpZ25vcmUgKi9cbiAgICByZXBfZm4gPSBmdW5jdGlvbihtLCBrKSB7XG4gICAgICB2YXIgdiA9IGFyZ3NbIHBhcnNlSW50KGspIF07XG4gICAgICBpZiAodiAhPT0gdW5kZWZpbmVkICYmIHYgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHY7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgXG4gIHJldHVybiB0aGlzLnJlcGxhY2UoIC9cXHsoXFx3KylcXH0vZywgcmVwX2ZuICk7XG59XG5cblxuLyoqXG4gKiBAbWV0aG9kIGVhY2hcbiAqIOWQhOaWh+Wtl+OCkumghueVquOBq+a4oeOBl+OBquOBjOOCiemWouaVsOOCkue5sOOCiui/lOOBl+Wun+ihjOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgc3RyID0gJ2FiYyc7XG4gKiAgICAgc3RyLmVhY2goZnVuY3Rpb24oY2gpIHtcbiAqICAgICAgIGNvbnNvbGUubG9nKGNoKTtcbiAqICAgICB9KTtcbiAqICAgICAvLyA9PiAnYSdcbiAqICAgICAvLyAgICAnYidcbiAqICAgICAvLyAgICAnYydcbiAqXG4gKiBAdGhpcyBTdHJpbmdcbiAqIEBwYXJhbSB7RnVuY3Rpb259IF9jYWxsYmFjayDlkITopoHntKDjgavlr77jgZfjgablrp/ooYzjgZnjgovjgrPjg7zjg6vjg5Djg4Pjgq/plqLmlbBcbiAqIEBwYXJhbSB7T2JqZWN0fSBbX3NlbGY9dGhpc10gY2FsbGJhY2sg5YaF44GnIHRoaXMg44Go44GX44Gm5Y+C54Wn44GV44KM44KL5YCkXG4gKi9cbmZ1bmN0aW9uIGVhY2goX2NhbGxiYWNrLCBfc2VsZikge1xuLy8gU3RyaW5nLnByb3RvdHlwZS4kbWV0aG9kKFwiZWFjaFwiLCBmdW5jdGlvbigpIHtcbiAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgcmV0dXJuIHRoaXM7XG59XG5cbi8vID09PT09PT09PT1cbi8vIOS7peS4i+ODqeOCpOODluODqeODquWGheOBp+OBr+acquS9v+eUqFxuLy8gPT09PT09PT09PVxuXG4vKipcbiAqIEBtZXRob2QgdHJpbVxuICog5paH5a2X5YiX5YWI6aCt44Go5pyr5bC+44Gu56m655m95paH5a2X44KS5YWo44Gm5Y+W44KK6Zmk44GE44Gf5paH5a2X5YiX44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjUmVmZXJlbmNlXG4gKiAtIFtTdHJpbmcgRnVuY3Rpb25zIGZvciBKYXZhc2NyaXB0IOKAkyB0cmltLCB0byBjYW1lbCBjYXNlLCB0byBkYXNoZWQsIGFuZCB0byB1bmRlcnNjb3JlXShodHRwOi8vamFtZXNyb2JlcnRzLm5hbWUvYmxvZy8yMDEwLzAyLzIyL3N0cmluZy1mdW5jdGlvbnMtZm9yLWphdmFzY3JpcHQtdHJpbS10by1jYW1lbC1jYXNlLXRvLWRhc2hlZC1hbmQtdG8tdW5kZXJzY29yZS8pXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBcIiAgSGVsbG8sIHdvcmxkISAgXCIudHJpbSgpOyAvLyA9PiBcIkhlbGxvLCB3b3JsZCFcIlxuICogXG4gKiBAdGhpcyBTdHJpbmdcbiAqIEByZXR1cm4ge1N0cmluZ30g44OI44Oq44Og44GX44Gf57WQ5p6c44Gu5paH5a2X5YiXXG4gKi9cbmZ1bmN0aW9uIHRyaW0oKSB7XG4vLyBTdHJpbmcucHJvdG90eXBlLiRtZXRob2QoXCJ0cmltXCIsIGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGNhcGl0YWxpemVcbiAqIOOCreODo+ODlOOCv+ODqeOCpOOCuuOBl+OBn+aWh+Wtl+WIl+OAgeOBmeOBquOCj+OBoeOAgeOBmeOBueOBpuOBruWNmOiqnuOBruWFiOmgreOCkuWkp+aWh+Wtl+OBq+OBl+OBn+aWh+Wtl+WIl+OCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqIOWNmOiqnuOBruWFiOmgreS7peWkluOBr+Wwj+aWh+Wtl+WMluOBleOCjOOBvuOBmeOAglxuICpcbiAqICMjI1JlZmVyZW5jZVxuICogLSBb44Kt44Oj44OU44K/44Op44Kk44K6KOWNmOiqnuOBruWFiOmgreOBruWkp+aWh+Wtl+WMlinjgpLooYzjgYYgLSBvY3QgaW5hb2R1XShodHRwOi8vZC5oYXRlbmEubmUuanAvYnJhemlsLzIwMDUxMjEyLzExMzQzNjkwODMpICBcbiAqIC0gW+ODh+OCtuOCpOODs+OBqOODl+ODreOCsOODqeODoOOBrueLremWk+OBpzogamF2YXNjcmlwdOOBp+OCreODo+ODlOOCv+ODqeOCpOOCuu+8iOS4gOaWh+Wtl+ebruOCkuWkp+aWh+Wtl+OBq+OBmeOCi++8iV0oaHR0cDovL2Rlc2lnbi1wcm9ncmFtLmJsb2dzcG90LmNvbS8yMDExLzAyL2phdmFzY3JpcHQuaHRtbClcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIFwiaSBhTSBhIHBlbi5cIi5jYXBpdGFsaXplKCk7IC8vID0+IFwiSSBBbSBBIFBlbi5cIlxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICogQHJldHVybiB7U3RyaW5nfSDjgq3jg6Pjg5Tjgr/jg6njgqTjgrrjgZfjgZ/mloflrZfliJdcbiAqL1xuZnVuY3Rpb24gY2FwaXRhbGl6ZSgpIHtcbi8vIFN0cmluZy5wcm90b3R5cGUuJG1ldGhvZChcImNhcGl0YWxpemVcIiwgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnJlcGxhY2UoL1xcdysvZywgZnVuY3Rpb24od29yZCl7XG4gICAgcmV0dXJuIGNhcGl0YWxpemVGaXJzdExldHRlci5jYWxsKHdvcmQpO1xuICAgIC8vIHJldHVybiB3b3JkLmNhcGl0YWxpemVGaXJzdExldHRlcigpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGNhcGl0YWxpemVGaXJzdExldHRlclxuICog5YWI6aCt44Gu5paH5a2X44KS5aSn5paH5a2X44Gr44GX44Gm44CB44Gd44KM5Lul5aSW44KS5bCP5paH5a2X44Gr44GX44Gf5paH5a2X5YiX44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBcImkgYU0gYSBwZW4uXCIuY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKCk7IC8vIFwiSSBhbSBhIHBlbi5cIlxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICogQHJldHVybiB7U3RyaW5nfSDlhYjpoK3jga7mloflrZfjgpLlpKfmloflrZfjgavjgZfjgabjgIHjgZ3jgozku6XlpJbjgpLlsI/mloflrZfjgavjgZfjgZ/mloflrZfliJdcbiAqL1xuZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKCkge1xuLy8gU3RyaW5nLnByb3RvdHlwZS4kbWV0aG9kKFwiY2FwaXRhbGl6ZUZpcnN0TGV0dGVyXCIsIGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRoaXMuc3Vic3RyKDEpLnRvTG93ZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQG1ldGhvZCB0b0Rhc2hcbiAqIOaWh+Wtl+WIl+WGheOBruWkp+aWh+Wtl+OCkuOAjFwiLVwiICsg5bCP5paH5a2X44CN44Gr5aSJ5o+b44GX44G+44GZ44CCXG4gKlxuICogY3NzMnByb3BlcnRpZXPvvIhlbGVtZW50LnN0eWxl77yJ44Gu5ZCE44OX44Ot44OR44OG44Kj5ZCN44KSIENTUyDjga7jg5fjg63jg5Hjg4bjgqPlkI3jgavlpInmj5vjgZnjgovloLTlkIjjgavkvr/liKnjgafjgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIFwiYm9yZGVyVG9wQ29sb3JcIi50b0Rhc2goKTsgLy8gPT4gXCJib3JkZXItdG9wLWNvbG9yXCJcbiAqXG4gKiBAdGhpcyBTdHJpbmdcbiAqIEByZXR1cm4ge1N0cmluZ30g5aSJ5o+b5b6M44Gu5paH5a2X5YiXXG4gKi9cbmZ1bmN0aW9uIHRvRGFzaCgpIHtcbi8vIFN0cmluZy5wcm90b3R5cGUuJG1ldGhvZChcInRvRGFzaFwiLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMucmVwbGFjZSgvKFtBLVpdKS9nLCBmdW5jdGlvbihtKXsgcmV0dXJuICctJyttLnRvTG93ZXJDYXNlKCk7IH0pO1xufVxuXG5cbi8qKlxuICogQG1ldGhvZCB0b0hhc2hcbiAqIOODj+ODg+OCt+ODpeWApOOCkueUn+aIkOOBl+OBpui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgXCJwaGluYS5qc1wiLnRvSGFzaCgpOyAvLyA9PiAyNjc2MzI3Mzk0XG4gKlxuICogQHRoaXMgU3RyaW5nXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IENSQzMy44OP44OD44K344Ol5YCkXG4gKi9cbmZ1bmN0aW9uIHRvSGFzaCgpIHtcbi8vIFN0cmluZy5wcm90b3R5cGUuJG1ldGhvZChcInRvSGFzaFwiLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRvQ1JDMzIuY2FsbCh0aGlzKTtcbiAgLy8gcmV0dXJuIHRoaXMudG9DUkMzMigpO1xufVxuXG5cbi8qKlxuICogQG1ldGhvZCBwYWRkaW5nXG4gKiDlt6bjgavmloflrZfjgpLln4vjgoHjgabmjIflrprjgZfjgZ/moYHjgavjgZfjgb7jgZnjgIJ0aGlzIOOBruaWh+Wtl+WIl+OBr+WPs+WvhOOBm+OBleOCjOOBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgXCIxMjM0XCIucGFkZGluZygxMCk7ICAgICAgLy8gPT4gXCIgICAgICAxMjM0XCJcbiAqICAgICBcIjEyMzRcIi5wYWRkaW5nKDEwLCAnMCcpOyAvLyA9PiBcIjAwMDAwMDEyMzRcIlxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICogQHBhcmFtIHtOdW1iZXJ9IG4g5qGB5pWwXG4gKiBAcGFyYW0ge1N0cmluZ30gW2NoPVwiIFwiXSDln4vjgoHjgovmloflrZdcbiAqIEByZXR1cm4ge1N0cmluZ30g5oyH5a6a44GX44Gf5qGB44Gu5paH5a2X5YiXXG4gKi9cbmZ1bmN0aW9uIHBhZGRpbmcobiwgY2gpIHtcbi8vIFN0cmluZy5wcm90b3R5cGUuJG1ldGhvZChcInBhZGRpbmdcIiwgZnVuY3Rpb24obiwgY2gpIHtcbiAgdmFyIHN0ciA9IHRoaXMudG9TdHJpbmcoKTtcbiAgbiAgPSBuLXN0ci5sZW5ndGg7XG4gIGNoID0gKGNoIHx8ICcgJylbMF07XG4gIFxuICB3aGlsZShuLS0gPiAwKSB7IHN0ciA9IGNoICsgc3RyOyB9XG4gIFxuICByZXR1cm4gc3RyO1xufVxuLyoqXG4gKiBAbWV0aG9kIHBhZGRpbmdMZWZ0XG4gKiDlt6bjgavmloflrZfjgpLln4vjgoHjgabmjIflrprjgZfjgZ/moYHjgavjgZfjgb7jgZnjgIJ0aGlzIOOBruaWh+Wtl+WIl+OCkuWPs+WvhOOBm+OBleOCjOOBvuOBmeOAglxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICoge0BsaW5rICNwYWRkaW5nfSDjgajlkIzjgZjjgafjgZnjgIJcbiAqIEBpbmhlcml0ZG9jICNwYWRkaW5nXG4gKi9cbmZ1bmN0aW9uIHBhZGRpbmdMZWZ0KG4sIGNoKSB7XG4vLyBTdHJpbmcucHJvdG90eXBlLiRtZXRob2QoXCJwYWRkaW5nTGVmdFwiLCBmdW5jdGlvbihuLCBjaCkge1xuICB2YXIgc3RyID0gdGhpcy50b1N0cmluZygpO1xuICBuICA9IG4tc3RyLmxlbmd0aDtcbiAgY2ggPSAoY2ggfHwgJyAnKVswXTtcbiAgXG4gIHdoaWxlKG4tLSA+IDApIHsgc3RyID0gY2ggKyBzdHI7IH1cbiAgXG4gIHJldHVybiBzdHI7XG59XG5cbi8qKlxuICogQG1ldGhvZCBwYWRkaW5nUmlnaHRcbiAqIOWPs+OBq+aWh+Wtl+OCkuWfi+OCgeOBpuaMh+WumuOBl+OBn+ahgeOBq+OBl+OBvuOBmeOAgnRoaXMg44Gu5paH5a2X5YiX44Gv5bem5a+E44Gb44GV44KM44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBcIjEyMzRcIi5wYWRkaW5nUmlnaHQoMTApOyAgICAgIC8vID0+IFwiMTIzNCAgICAgIFwiXG4gKiAgICAgXCIxMjM0XCIucGFkZGluZ1JpZ2h0KDEwLCAnMCcpOyAvLyA9PiBcIjEyMzQwMDAwMDBcIlxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICogQHBhcmFtIHtOdW1iZXJ9IG4g5qGB5pWwXG4gKiBAcGFyYW0ge1N0cmluZ30gW2NoPVwiIFwiXSDln4vjgoHjgovmloflrZdcbiAqIEByZXR1cm4ge1N0cmluZ30g5oyH5a6a44GX44Gf5qGB44Gu5paH5a2X5YiXXG4gKi9cbmZ1bmN0aW9uIHBhZGRpbmdSaWdodChuLCBjaCkge1xuLy8gU3RyaW5nLnByb3RvdHlwZS4kbWV0aG9kKFwicGFkZGluZ1JpZ2h0XCIsIGZ1bmN0aW9uKG4sIGNoKSB7XG4gIHZhciBzdHIgPSB0aGlzLnRvU3RyaW5nKCk7XG4gIG4gID0gbi1zdHIubGVuZ3RoO1xuICBjaCA9IChjaCB8fCAnICcpWzBdO1xuICBcbiAgd2hpbGUobi0tID4gMCkgeyBzdHIgPSBzdHIgKyBjaDsgfVxuICBcbiAgcmV0dXJuIHN0cjtcbn1cbiAgXG4vKipcbiAqIEBtZXRob2QgcXVvdGVtZXRhXG4gKiDmraPopo/ooajnj77jga7jg6Hjgr/mloflrZfjgpLjgq/jgqnjg7zjg4jjgZfjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIFwiSGVsbG8gd29ybGQuIChjYW4geW91IGhlYXIgbWU/KVwiLnF1b3RlbWV0YSgpOyAvLyA9PiBcIkhlbGxvXFxcXCB3b3JsZFxcXFwuXFxcXCBcXFxcKGNhblxcXFwgeW91XFxcXCBoZWFyXFxcXCBtZVxcXFw/XFxcXClcIlxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICogQHJldHVybiB7U3RyaW5nfSDjgq/jgqnjg7zjg4jjgZXjgozjgZ/mloflrZfliJdcbiAqL1xuZnVuY3Rpb24gcXVvdGVtZXRhKG4pIHtcbi8vIFN0cmluZy5wcm90b3R5cGUuJG1ldGhvZChcInF1b3RlbWV0YVwiLCBmdW5jdGlvbihuKSB7XG4gIHJldHVybiB0aGlzLnJlcGxhY2UoLyhbXjAtOUEtWmEtel9dKS9nLCAnXFxcXCQxJyk7XG59XG4gIFxuLyoqXG4gKiBAbWV0aG9kIHJlcGVhdFxuICog6Ieq5YiG6Ieq6Lqr44KS5oyH5a6a44GX44Gf5Zue5pWw44Gg44GR57mw44KK6L+U44GX44Gf5paH5a2X5YiX44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBcIkFiY1wiLnJlcGVhdCg0KTsgLy8gPT4gXCJBYmNBYmNBYmNBYmNcIlxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICogQHBhcmFtIHtOdW1iZXJ9IG4g57mw44KK6L+U44GX5Zue5pWwXG4gKiBAcmV0dXJuIHtTdHJpbmd9IOaWh+Wtl+WIl1xuICovXG5mdW5jdGlvbiByZXBlYXQobikge1xuLy8gU3RyaW5nLnByb3RvdHlwZS4kbWV0aG9kKFwicmVwZWF0XCIsIGZ1bmN0aW9uKG4pIHtcbiAgLy8gVE9ETzog56K66KqN44GZ44KLXG4gIHZhciBhcnIgPSBBcnJheShuKTtcbiAgZm9yICh2YXIgaT0wOyBpPG47ICsraSkgYXJyW2ldID0gdGhpcztcbiAgcmV0dXJuIGFyci5qb2luKCcnKTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGNvdW50XG4gKiDmjIflrprjgZfjgZ/mloflrZfliJfjgYzkvZXlgIvlhaXjgaPjgabjgYTjgovjgYvjgpLjgqvjgqbjg7Pjg4jjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiDlpKfmloflrZfjg7vlsI/mloflrZfjga/ljLrliKXjgZXjgozjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIFwiVGhpcyBpcyBhIHN0cmluZy4gSXNuJ3QgaXQ/XCIuY291bnQoXCJpc1wiKTsgLy8gPT4gMlxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICogQHBhcmFtIHtTdHJpbmd9IHN0ciDoqr/jgbnjgovmloflrZfliJdcbiAqIEByZXR1cm4ge051bWJlcn0gdGhpcyDjgasgc3RyIOOBjOWFpeOBo+OBpuOBhOOCi+WAi+aVsFxuICovXG5mdW5jdGlvbiBjb3VudChzdHIpIHtcbi8vIFN0cmluZy5wcm90b3R5cGUuJG1ldGhvZChcImNvdW50XCIsIGZ1bmN0aW9uKHN0cikge1xuICB2YXIgcmUgPSBuZXcgUmVnRXhwKHN0ciwgJ2dtJyk7XG4gIHJldHVybiB0aGlzLm1hdGNoKHJlKS5sZW5ndGg7XG59XG5cbi8qKlxuICogQG1ldGhvZCBpbmNsdWRlXG4gKiDmjIflrprjgZfjgZ/mloflrZfliJfjgYzlkKvjgb7jgozjgabjgYTjgovjgYvjganjgYbjgYvjgpLov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiDlpKfmloflrZfjg7vlsI/mloflrZfjga/ljLrliKXjgZXjgozjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIFwiVGhpcyBpcyBhIHN0cmluZy5cIi5pbmNsdWRlKFwiaXNcIik7IC8vID0+IHRydWVcbiAqICAgICBcIlRoaXMgaXMgYSBzdHJpbmcuXCIuaW5jbHVkZShcIndhc1wiKTsgLy8gPT4gZmFsc2VcbiAqXG4gKiBAdGhpcyBTdHJpbmdcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIg6Kq/44G544KL5paH5a2X5YiXXG4gKiBAcmV0dXJuIHtCb29sZWFufSDlkKvjgb7jgozjgabjgYTjgovjgYvjganjgYbjgYtcbiAqL1xuZnVuY3Rpb24gaW5jbHVkZShzdHIpIHtcbi8vIFN0cmluZy5wcm90b3R5cGUuJG1ldGhvZChcImluY2x1ZGVcIiwgZnVuY3Rpb24oc3RyKSB7XG4gIHJldHVybiB0aGlzLmluZGV4T2Yoc3RyKSAhPSAtMTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIHRvQXJyYXlcbiAqIDHmloflrZfjgZrjgaTliIbop6PjgZfjgZ/phY3liJfjgpLov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIFwiMTIzNDVcIi50b0FycmF5KCk7IC8vID0+IFtcIjFcIiwgXCIyXCIsIFwiM1wiLCBcIjRcIiwgXCI1XCJdXG4gKiAgICAgXCLjgYLjgYTjgYbjgYjjgYpcIi50b0FycmF5KCk7IC8vID0+IFwi44GCXCIsIFwi44GEXCIsIFwi44GGXCIsIFwi44GIXCIsIFwi44GKXCJdXG4gKlxuICogQHRoaXMgU3RyaW5nXG4gKiBAcmV0dXJuIHtTdHJpbmdbXX0g6YWN5YiXXG4gKi9cbmZ1bmN0aW9uIHRvQXJyYXkoKSB7XG4vLyBTdHJpbmcucHJvdG90eXBlLiRtZXRob2QoXCJ0b0FycmF5XCIsIGZ1bmN0aW9uKCkge1xuICB2YXIgYXJyID0gW107XG4gIGZvciAodmFyIGk9MCxsZW49dGhpcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcbiAgICBhcnIucHVzaCh0aGlzW2ldKTtcbiAgfVxuICByZXR1cm4gYXJyO1xufVxuXG4vKipcbiAqIEBtZXRob2QgdG9PYmplY3RcbiAqIOOCreODvOOBqOWApOOBrue1hOOBv+WQiOOCj+OBm+OBjOmAo+e1kOOBleOCjOOBn+aWh+Wtl+WIl+OBi+OCieOCquODluOCuOOCp+OCr+ODiOOCkueUn+aIkOOBl+OBvuOBmeOAglxuICpcbiAqIOWApOOBryBOdW1iZXLjgIFCb29sZWFu44CBU3RyaW5nIOOBruOBhOOBmuOCjOOBi+OBruWei+OBqOOBl+OBpuipleS+oeOBleOCjOOBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgb2JqMSA9IFwibnVtPTEyOC41JmZsYWcxPXRydWUmZmxhZzI9ZmFsc2Umc3RyPWhvZ2VcIjtcbiAqICAgICBvYmoxLnRvT2JqZWN0KCk7IC8vID0+IHtudW06IDEyOC41LCBmbGFnMTogdHJ1ZSwgZmxhZzI6IGZhbHNlLCBzdHI6IFwiaG9nZVwiIH1cbiAqICAgICBcbiAqICAgICBvYmoyID0gXCJudW06LTY0LjV8ZmxhZzE6ZmFsc2V8ZmxhZzI6dHJ1ZXxzdHI6Zm9vXCI7XG4gKiAgICAgb2JqMi50b09iamVjdCgnfCcsICc6Jyk7IC8vID0+IHtudW06IC02NC41LCBmbGFnMTogZmFsc2UsIGZsYWcyOiB0cnVlLCBzdHI6IFwiZm9vXCIgfVxuICpcbiAqIEB0aGlzIFN0cmluZ1xuICogQHBhcmFtIHtTdHJpbmd9IFtzZXA9XCImXCJdIOOCu+ODkeODrOODvOOCv+aWh+Wtl1xuICogQHBhcmFtIHtTdHJpbmd9IFtlcT1cIlwiXSDjgq3jg7zjgajlgKTjga7ntYTjgb/lkIjjgo/jgZvjgpLooajjgZnmloflrZdcbiAqIEByZXR1cm4ge09iamVjdH0g44Kq44OW44K444Kn44Kv44OIXG4gKi9cbmZ1bmN0aW9uIHRvT2JqZWN0KHNlcCwgZXEpIHtcbi8vIFN0cmluZy5wcm90b3R5cGUuJG1ldGhvZChcInRvT2JqZWN0XCIsIGZ1bmN0aW9uKHNlcCwgZXEpIHtcbiAgc2VwID0gc2VwIHx8ICcmJztcbiAgZXEgID0gZXEgfHwgJz0nO1xuXG4gIHZhciBvYmogPSB7fTtcbiAgdmFyIHBhcmFtcyA9IHRoaXMuc3BsaXQoc2VwKTtcbiAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24oc3RyLCBpKSB7XG4gIC8vIHBhcmFtcy5lYWNoKGZ1bmN0aW9uKHN0ciwgaSkge1xuICAgIHZhciBwb3MgPSBzdHIuaW5kZXhPZihlcSk7XG4gICAgaWYgKHBvcyA+IDApIHtcbiAgICAgIHZhciBrZXkgPSBzdHIuc3Vic3RyaW5nKDAsIHBvcyk7XG4gICAgICAvKiogQHR5cGUgc3RyaW5nfG51bWJlcnxib29sZWFuICovXG4gICAgICB2YXIgdmFsID0gc3RyLnN1YnN0cmluZyhwb3MrMSk7XG4gICAgICB2YXIgbnVtID0gTnVtYmVyKHZhbCk7XG5cbiAgICAgIGlmICghaXNOYU4obnVtKSkge1xuICAgICAgICB2YWwgPSBudW07XG4gICAgICB9XG4gICAgICBlbHNlIGlmICh2YWwgPT09ICd0cnVlJykge1xuICAgICAgICB2YWwgPSB0cnVlO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAodmFsID09PSAnZmFsc2UnKSB7XG4gICAgICAgIHZhbCA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBvYmpba2V5XSA9IHZhbDtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBvYmo7XG59XG5cblxudmFyIHRhYmxlID0gXCIwMDAwMDAwMCA3NzA3MzA5NiBFRTBFNjEyQyA5OTA5NTFCQSAwNzZEQzQxOSA3MDZBRjQ4RiBFOTYzQTUzNSA5RTY0OTVBMyAwRURCODgzMiA3OURDQjhBNCBFMEQ1RTkxRSA5N0QyRDk4OCAwOUI2NEMyQiA3RUIxN0NCRCBFN0I4MkQwNyA5MEJGMUQ5MSAxREI3MTA2NCA2QUIwMjBGMiBGM0I5NzE0OCA4NEJFNDFERSAxQURBRDQ3RCA2RERERTRFQiBGNEQ0QjU1MSA4M0QzODVDNyAxMzZDOTg1NiA2NDZCQThDMCBGRDYyRjk3QSA4QTY1QzlFQyAxNDAxNUM0RiA2MzA2NkNEOSBGQTBGM0Q2MyA4RDA4MERGNSAzQjZFMjBDOCA0QzY5MTA1RSBENTYwNDFFNCBBMjY3NzE3MiAzQzAzRTREMSA0QjA0RDQ0NyBEMjBEODVGRCBBNTBBQjU2QiAzNUI1QThGQSA0MkIyOTg2QyBEQkJCQzlENiBBQ0JDRjk0MCAzMkQ4NkNFMyA0NURGNUM3NSBEQ0Q2MERDRiBBQkQxM0Q1OSAyNkQ5MzBBQyA1MURFMDAzQSBDOEQ3NTE4MCBCRkQwNjExNiAyMUI0RjRCNSA1NkIzQzQyMyBDRkJBOTU5OSBCOEJEQTUwRiAyODAyQjg5RSA1RjA1ODgwOCBDNjBDRDlCMiBCMTBCRTkyNCAyRjZGN0M4NyA1ODY4NEMxMSBDMTYxMURBQiBCNjY2MkQzRCA3NkRDNDE5MCAwMURCNzEwNiA5OEQyMjBCQyBFRkQ1MTAyQSA3MUIxODU4OSAwNkI2QjUxRiA5RkJGRTRBNSBFOEI4RDQzMyA3ODA3QzlBMiAwRjAwRjkzNCA5NjA5QTg4RSBFMTBFOTgxOCA3RjZBMERCQiAwODZEM0QyRCA5MTY0NkM5NyBFNjYzNUMwMSA2QjZCNTFGNCAxQzZDNjE2MiA4NTY1MzBEOCBGMjYyMDA0RSA2QzA2OTVFRCAxQjAxQTU3QiA4MjA4RjRDMSBGNTBGQzQ1NyA2NUIwRDlDNiAxMkI3RTk1MCA4QkJFQjhFQSBGQ0I5ODg3QyA2MkREMURERiAxNURBMkQ0OSA4Q0QzN0NGMyBGQkQ0NEM2NSA0REIyNjE1OCAzQUI1NTFDRSBBM0JDMDA3NCBENEJCMzBFMiA0QURGQTU0MSAzREQ4OTVENyBBNEQxQzQ2RCBEM0Q2RjRGQiA0MzY5RTk2QSAzNDZFRDlGQyBBRDY3ODg0NiBEQTYwQjhEMCA0NDA0MkQ3MyAzMzAzMURFNSBBQTBBNEM1RiBERDBEN0NDOSA1MDA1NzEzQyAyNzAyNDFBQSBCRTBCMTAxMCBDOTBDMjA4NiA1NzY4QjUyNSAyMDZGODVCMyBCOTY2RDQwOSBDRTYxRTQ5RiA1RURFRjkwRSAyOUQ5Qzk5OCBCMEQwOTgyMiBDN0Q3QThCNCA1OUIzM0QxNyAyRUI0MEQ4MSBCN0JENUMzQiBDMEJBNkNBRCBFREI4ODMyMCA5QUJGQjNCNiAwM0I2RTIwQyA3NEIxRDI5QSBFQUQ1NDczOSA5REQyNzdBRiAwNERCMjYxNSA3M0RDMTY4MyBFMzYzMEIxMiA5NDY0M0I4NCAwRDZENkEzRSA3QTZBNUFBOCBFNDBFQ0YwQiA5MzA5RkY5RCAwQTAwQUUyNyA3RDA3OUVCMSBGMDBGOTM0NCA4NzA4QTNEMiAxRTAxRjI2OCA2OTA2QzJGRSBGNzYyNTc1RCA4MDY1NjdDQiAxOTZDMzY3MSA2RTZCMDZFNyBGRUQ0MUI3NiA4OUQzMkJFMCAxMERBN0E1QSA2N0RENEFDQyBGOUI5REY2RiA4RUJFRUZGOSAxN0I3QkU0MyA2MEIwOEVENSBENkQ2QTNFOCBBMUQxOTM3RSAzOEQ4QzJDNCA0RkRGRjI1MiBEMUJCNjdGMSBBNkJDNTc2NyAzRkI1MDZERCA0OEIyMzY0QiBEODBEMkJEQSBBRjBBMUI0QyAzNjAzNEFGNiA0MTA0N0E2MCBERjYwRUZDMyBBODY3REY1NSAzMTZFOEVFRiA0NjY5QkU3OSBDQjYxQjM4QyBCQzY2ODMxQSAyNTZGRDJBMCA1MjY4RTIzNiBDQzBDNzc5NSBCQjBCNDcwMyAyMjAyMTZCOSA1NTA1MjYyRiBDNUJBM0JCRSBCMkJEMEIyOCAyQkI0NUE5MiA1Q0IzNkEwNCBDMkQ3RkZBNyBCNUQwQ0YzMSAyQ0Q5OUU4QiA1QkRFQUUxRCA5QjY0QzJCMCBFQzYzRjIyNiA3NTZBQTM5QyAwMjZEOTMwQSA5QzA5MDZBOSBFQjBFMzYzRiA3MjA3Njc4NSAwNTAwNTcxMyA5NUJGNEE4MiBFMkI4N0ExNCA3QkIxMkJBRSAwQ0I2MUIzOCA5MkQyOEU5QiBFNUQ1QkUwRCA3Q0RDRUZCNyAwQkRCREYyMSA4NkQzRDJENCBGMUQ0RTI0MiA2OEREQjNGOCAxRkRBODM2RSA4MUJFMTZDRCBGNkI5MjY1QiA2RkIwNzdFMSAxOEI3NDc3NyA4ODA4NUFFNiBGRjBGNkE3MCA2NjA2M0JDQSAxMTAxMEI1QyA4RjY1OUVGRiBGODYyQUU2OSA2MTZCRkZEMyAxNjZDQ0Y0NSBBMDBBRTI3OCBENzBERDJFRSA0RTA0ODM1NCAzOTAzQjNDMiBBNzY3MjY2MSBEMDYwMTZGNyA0OTY5NDc0RCAzRTZFNzdEQiBBRUQxNkE0QSBEOUQ2NUFEQyA0MERGMEI2NiAzN0Q4M0JGMCBBOUJDQUU1MyBERUJCOUVDNSA0N0IyQ0Y3RiAzMEI1RkZFOSBCREJERjIxQyBDQUJBQzI4QSA1M0IzOTMzMCAyNEI0QTNBNiBCQUQwMzYwNSBDREQ3MDY5MyA1NERFNTcyOSAyM0Q5NjdCRiBCMzY2N0EyRSBDNDYxNEFCOCA1RDY4MUIwMiAyQTZGMkI5NCBCNDBCQkUzNyBDMzBDOEVBMSA1QTA1REYxQiAyRDAyRUY4RFwiLnNwbGl0KCcgJyk7XG5cbi8qKlxuICogQG1ldGhvZCB0b0NSQzMyXG4gKiDmloflrZfliJfjga4gQ1JDMzIg44KS6KiI566X44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBcInBoaW5hLmpzXCIudG9DUkMzMigpOyAvLyA9PiAyNjc2MzI3Mzk0XG4gKlxuICogQHRoaXMgU3RyaW5nXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IENSQzMyIOODj+ODg+OCt+ODpeWApFxuICovXG5mdW5jdGlvbiB0b0NSQzMyKCkge1xuLy8gU3RyaW5nLnByb3RvdHlwZS4kbWV0aG9kKFwidG9DUkMzMlwiLCBmdW5jdGlvbigpIHtcbiAgdmFyIGNyYyA9IDAsIHg9MCwgeT0wO1xuICBcbiAgY3JjID0gY3JjIF4gKC0xKTtcbiAgZm9yICh2YXIgaT0wLCBpVG9wPXRoaXMubGVuZ3RoOyBpPGlUb3A7ICsraSkge1xuICAgIHkgPSAoY3JjIF4gdGhpcy5jaGFyQ29kZUF0KGkpKSAmIDB4ZmY7XG4gICAgeCA9IE51bWJlcihcIjB4XCIgKyB0YWJsZVt5XSk7XG4gICAgY3JjID0gKGNyYyA+Pj4gOCkgXiB4O1xuICB9XG4gIFxuICByZXR1cm4gKGNyYyBeICgtMSkpID4+PiAwO1xufVxuXG52YXIgc3RyaW5nRXh0ZW5zaW9ucyA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICBmb3JtYXQ6IGZvcm1hdCxcbiAgZWFjaDogZWFjaCxcbiAgdHJpbTogdHJpbSxcbiAgY2FwaXRhbGl6ZTogY2FwaXRhbGl6ZSxcbiAgY2FwaXRhbGl6ZUZpcnN0TGV0dGVyOiBjYXBpdGFsaXplRmlyc3RMZXR0ZXIsXG4gIHRvRGFzaDogdG9EYXNoLFxuICB0b0hhc2g6IHRvSGFzaCxcbiAgcGFkZGluZzogcGFkZGluZyxcbiAgcGFkZGluZ0xlZnQ6IHBhZGRpbmdMZWZ0LFxuICBwYWRkaW5nUmlnaHQ6IHBhZGRpbmdSaWdodCxcbiAgcXVvdGVtZXRhOiBxdW90ZW1ldGEsXG4gIHJlcGVhdDogcmVwZWF0LFxuICBjb3VudDogY291bnQsXG4gIGluY2x1ZGU6IGluY2x1ZGUsXG4gIHRvQXJyYXk6IHRvQXJyYXksXG4gIHRvT2JqZWN0OiB0b09iamVjdCxcbiAgdG9DUkMzMjogdG9DUkMzMlxufSk7XG5cbi8qKlxuICogQGNsYXNzIGdsb2JhbC5PYmplY3RcbiAqIE9iamVjdOOBruaLoeW8tVxuICovXG5cbi8qKlxuICog6Zai5pWw44KS6L+95YqgXG4gKiBcbiAqIEBwYXJhbSAgIHtTdHJpbmd9IG5hbWUgbmFtZVxuICogQHBhcmFtICAge0Z1bmN0aW9ufSBmblxuICovXG5mdW5jdGlvbiAkbWV0aG9kKG5hbWUsIGZuKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBuYW1lLCB7XG4gICAgdmFsdWU6IGZuLFxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHdyaXRhYmxlOiB0cnVlXG4gIH0pO1xufVxuXG4vKipcbiAqIEBtZXRob2Qgc2V0dGVyXG4gKiDjgrvjg4Pjgr/jg7zjgpLlrprnvqnjgZnjgotcbiAqIFxuICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXIgfCBzeW1ib2x9IG5hbWVcbiAqIEBwYXJhbSB7YW55fSBmblxuICovXG4vLyBPYmplY3QucHJvdG90eXBlLiRtZXRob2QoXCJzZXR0ZXJcIiwgZnVuY3Rpb24obmFtZSwgZm4pe1xuZnVuY3Rpb24gc2V0dGVyKG5hbWUsIGZuKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBuYW1lLCB7XG4gICAgc2V0OiBmbixcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gIH0pO1xufVxuXG4vKipcbiAqIEBtZXRob2QgZ2V0dGVyXG4gKiDjgrLjg4Pjgr/jg7zjgpLlrprnvqnjgZnjgotcbiAqIFxuICogQHRoaXMge09iamVjdH1cbiAqIEBwYXJhbSB7c3RyaW5nIHwgbnVtYmVyIHwgc3ltYm9sfSBuYW1lXG4gKiBAcGFyYW0ge2FueX0gZm5cbiAqL1xuLy8gT2JqZWN0LnByb3RvdHlwZS4kbWV0aG9kKFwiZ2V0dGVyXCIsIGZ1bmN0aW9uKG5hbWUsIGZuKXtcbmZ1bmN0aW9uIGdldHRlcihuYW1lLCBmbikge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgbmFtZSwge1xuICAgIGdldDogZm4sXG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICB9KTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGFjY2Vzc29yXG4gKiDjgqLjgq/jgrvjg4PjgrUo44K744OD44K/44O8L+OCsuODg+OCv+ODvCnjgpLlrprnvqnjgZnjgotcbiAqIFxuICogQHRoaXMgT2JqZWN0XG4gKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlciB8IHN5bWJvbH0gbmFtZVxuICogQHBhcmFtIHtpbXBvcnQoJy4uL3BoaW5hJykuQWNjZXNzb3JFeHRlbmRPYmplY3R9IHBhcmFtXG4gKi9cbi8vIE9iamVjdC5wcm90b3R5cGUuJG1ldGhvZChcImFjY2Vzc29yXCIsIGZ1bmN0aW9uKG5hbWUsIHBhcmFtKSB7XG5mdW5jdGlvbiBhY2Nlc3NvcihuYW1lLCBwYXJhbSkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgbmFtZSwge1xuICAgIHNldDogcGFyYW1bXCJzZXRcIl0sXG4gICAgZ2V0OiBwYXJhbVtcImdldFwiXSxcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gIH0pO1xufVxuXG4vKipcbiAqIEBtZXRob2QgZm9ySW5cbiAqIOOCquODluOCuOOCp+OCr+ODiOeUqOODq+ODvOODl+WHpueQhlxuICogXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICogQHBhcmFtIHthbnl9IHNlbGZcbiAqL1xuZnVuY3Rpb24gZm9ySW4oZm4sIHNlbGYpIHtcbiAgc2VsZiA9IHNlbGYgfHwgdGhpcztcblxuICBPYmplY3Qua2V5cyh0aGlzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSwgaW5kZXgpIHtcbiAgICB2YXIgdmFsdWUgPSB0aGlzW2tleV07XG5cbiAgICBmbi5jYWxsKHNlbGYsIGtleSwgdmFsdWUsIGluZGV4KTtcbiAgfSwgdGhpcyk7XG5cbiAgcmV0dXJuIHRoaXM7XG59XG5cbi8qKlxuICogQG1ldGhvZCAgJGV4dGVuZFxuICog5LuW44Gu44Op44Kk44OW44Op44Oq44Go56u25ZCI44GX44Gh44KD44GG44Gu44GnIGV4dGVuZCAtPiAkZXh0ZW5kIOOBqOOBl+OBvuOBl+OBn1xuICovXG5mdW5jdGlvbiAkZXh0ZW5kKCkge1xuLy8gT2JqZWN0LnByb3RvdHlwZS4kbWV0aG9kKFwiJGV4dGVuZFwiLCBmdW5jdGlvbigpIHtcbiAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChhcmd1bWVudHMsIGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgIGZvciAodmFyIHByb3BlcnR5IGluIHNvdXJjZSkge1xuICAgICAgdGhpc1twcm9wZXJ0eV0gPSBzb3VyY2VbcHJvcGVydHldO1xuICAgIH1cbiAgfSwgdGhpcyk7XG4gIHJldHVybiB0aGlzO1xufVxuXG4vKipcbiAqIEBtZXRob2QgICRzYWZlXG4gKiDlronlhajmi6HlvLVcbiAqIOS4iuabuOOBjeOBl+OBquOBhFxuICovXG5mdW5jdGlvbiAkc2FmZShzb3VyY2UpIHtcbi8vIE9iamVjdC5wcm90b3R5cGUuJG1ldGhvZChcIiRzYWZlXCIsIGZ1bmN0aW9uKHNvdXJjZSkge1xuICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGFyZ3VtZW50cywgZnVuY3Rpb24oc291cmNlKSB7XG4gICAgZm9yICh2YXIgcHJvcGVydHkgaW4gc291cmNlKSB7XG4gICAgICBpZiAodGhpc1twcm9wZXJ0eV0gPT09IHVuZGVmaW5lZCkgdGhpc1twcm9wZXJ0eV0gPSBzb3VyY2VbcHJvcGVydHldO1xuICAgIH1cbiAgfSwgdGhpcyk7XG4gIHJldHVybiB0aGlzO1xufVxuXG4vKipcbiAqIEBtZXRob2QgJHdhdGNoXG4gKiBcbiAqIEBwYXJhbSAge3N0cmluZ30ga2V5ICAgICAgIFtkZXNjcmlwdGlvbl1cbiAqIEBwYXJhbSAge2Z1bmN0aW9ufSBjYWxsYmFjayAgW2Rlc2NyaXB0aW9uXVxuICogQHJldHVybiB7dm9pZH0gICAgICAgICAgIFtkZXNjcmlwdGlvbl1cbiAqL1xuZnVuY3Rpb24gJHdhdGNoKGtleSwgY2FsbGJhY2spIHtcbi8vIE9iamVjdC5wcm90b3R5cGUuJG1ldGhvZCgnJHdhdGNoJywgZnVuY3Rpb24oa2V5LCBjYWxsYmFjaykge1xuICB2YXIgdGFyZ2V0ID0gdGhpcztcbiAgdmFyIGRlc2NyaXB0b3IgPSBudWxsO1xuXG4gIHdoaWxlKHRhcmdldCkge1xuICAgIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KTtcbiAgICBpZiAoZGVzY3JpcHRvcikge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHRhcmdldCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0YXJnZXQpO1xuICB9XG5cbiAgLy8g44GZ44Gn44Gr44Ki44Kv44K744OD44K144O844Go44GX44Gm5a2Y5Zyo44GZ44KL5aC05ZCIXG4gIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgLy8g44OH44O844K/44OH44Kj44K544Kv44Oq44OX44K/44Gu5aC05ZCIXG4gICAgaWYgKGRlc2NyaXB0b3IudmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFyIHRlbXBLZXkgPSAnX18nICsga2V5O1xuICAgICAgdmFyIHRlbXBWYWx1ZSA9IHRoaXNba2V5XTtcblxuICAgICAgdGhpc1t0ZW1wS2V5XSA9IHRlbXBWYWx1ZTtcblxuICAgICAgYWNjZXNzb3IuY2FsbCh0aGlzLCBrZXksIHtcbiAgICAgIC8vIHRoaXMuYWNjZXNzb3Ioa2V5LCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNbdGVtcEtleV07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24odikge1xuICAgICAgICAgIHZhciBvbGQgPSB0aGlzW3RlbXBLZXldO1xuICAgICAgICAgIHRoaXNbdGVtcEtleV0gPSB2O1xuICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgdiwgb2xkKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvLyDjgqLjgq/jgrvjgrXjg4fjgqPjgrnjgq/jg6rjg5fjgr/jga7loLTlkIhcbiAgICBlbHNlIHtcbiAgICAgIGFjY2Vzc29yLmNhbGwodGhpcywga2V5LCB7XG4gICAgICAvLyB0aGlzLmFjY2Vzc29yKGtleSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBkZXNjcmlwdG9yLmdldC5jYWxsKHRoaXMpO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICB2YXIgb2xkID0gZGVzY3JpcHRvci5nZXQuY2FsbCh0aGlzKTtcbiAgICAgICAgICBkZXNjcmlwdG9yLnNldC5jYWxsKHRoaXMsIHYpO1xuICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgdiwgb2xkKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBlbHNlIHtcbiAgICB2YXIgYWNjZXNza2V5ID0gJ19fJyArIGtleTtcblxuICAgIGFjY2Vzc29yLmNhbGwodGhpcywga2V5LCB7XG4gICAgLy8gdGhpcy5hY2Nlc3NvcihrZXksIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzW2FjY2Vzc2tleV07XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbih2KSB7XG4gICAgICAgIHZhciBvbGQgPSB0aGlzW2FjY2Vzc2tleV07XG4gICAgICAgIHRoaXNbYWNjZXNza2V5XSA9IHY7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgdiwgb2xkKTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cbn1cblxuLy8gPT09PT09PT09PVxuLy8g5Lul5LiL44Op44Kk44OW44Op44Oq5YaF44Gn44Gv5pyq5L2/55SoXG4vLyA9PT09PT09PT09XG5cbi8qKlxuICogQG1ldGhvZCBwcm9wZXJ0eVxuICog5aSJ5pWw44KS6L+95YqgXG4gKiBcbiAqIEBwYXJhbSAgIHtTdHJpbmd9IG5hbWUgbmFtZVxuICogQHBhcmFtICAge09iamVjdH0gdmFsXG4gKi9cbmZ1bmN0aW9uIHByb3BlcnR5KG5hbWUsIHZhbCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgbmFtZSwge1xuICAgIHZhbHVlOiB2YWwsXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICB3cml0YWJsZTogdHJ1ZVxuICB9KTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kICRnZXRcbiAqIOODkeOCueaMh+WumuOBp+WApOOCkuWPluW+l1xuICogXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKi9cbmZ1bmN0aW9uICRnZXQoa2V5KSB7XG4vLyBPYmplY3QucHJvdG90eXBlLiRtZXRob2QoJyRnZXQnLCBmdW5jdGlvbihrZXkpIHtcbiAgcmV0dXJuIGtleS5zcGxpdCgnLicpLnJlZHVjZShmdW5jdGlvbih0LCB2KSB7XG4gICAgcmV0dXJuIHQgJiYgdFt2XTtcbiAgfSwgdGhpcyk7XG59XG5cbi8qKlxuICogQG1ldGhvZCAkc2V0XG4gKiDjg5HjgrnmjIflrprjgaflgKTjgpLoqK3lrppcbiAqIFxuICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICogQHBhcmFtIHthbnl9IHZhbHVlXG4gKi9cbmZ1bmN0aW9uICRzZXQoa2V5LCB2YWx1ZSkge1xuLy8gT2JqZWN0LnByb3RvdHlwZS4kbWV0aG9kKCckc2V0JywgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICBrZXkuc3BsaXQoJy4nKS5yZWR1Y2UoZnVuY3Rpb24odCwgdiwgaSwgYXJyKSB7XG4gICAgaWYgKGkgPT09IChhcnIubGVuZ3RoLTEpKSB7XG4gICAgICB0W3ZdID0gdmFsdWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgaWYgKCF0W3ZdKSB0W3ZdID0ge307XG4gICAgICByZXR1cm4gdFt2XTtcbiAgICB9XG4gIH0sIHRoaXMpO1xufVxuXG4vKipcbiAqIEBtZXRob2QgJGhhc1xuICog44Gd44Gu44OX44Ot44OR44OG44Kj44KS5oyB44Gj44Gm44GE44KL44GL44KS5Yik5a6a44GZ44KLXG4gKiBcbiAqIEBwYXJhbSB7YW55fSBrZXlcbiAqL1xuZnVuY3Rpb24gJGhhcyhrZXkpIHtcbi8vIE9iamVjdC5wcm90b3R5cGUuJG1ldGhvZChcIiRoYXNcIiwgZnVuY3Rpb24oa2V5KSB7XG4gIHJldHVybiB0aGlzLmhhc093blByb3BlcnR5KGtleSk7XG59XG5cbi8qKlxuICogQG1ldGhvZCAgJHN0cmljdFxuICog5Y6z5qC85ouh5by1XG4gKiDjgZnjgafjgavjgYLjgaPjgZ/loLTlkIjjga/orablkYpcbiAqL1xuZnVuY3Rpb24gJHN0cmljdChzb3VyY2UpIHtcbi8vIE9iamVjdC5wcm90b3R5cGUuJG1ldGhvZChcIiRzdHJpY3RcIiwgZnVuY3Rpb24oc291cmNlKSB7XG4gIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYXJndW1lbnRzLCBmdW5jdGlvbihzb3VyY2UpIHtcbiAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBzb3VyY2UpIHtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KCF0aGlzW3Byb3BlcnR5XSwgZm9ybWF0LmNhbGwoXCJ0bSBlcnJvcjogezB9IGlzIEFscmVhZHlcIiwgcHJvcGVydHkpKTtcbiAgICAgIC8vIGNvbnNvbGUuYXNzZXJ0KCF0aGlzW3Byb3BlcnR5XSwgXCJ0bSBlcnJvcjogezB9IGlzIEFscmVhZHlcIi5mb3JtYXQocHJvcGVydHkpKTtcbiAgICAgIHRoaXNbcHJvcGVydHldID0gc291cmNlW3Byb3BlcnR5XTtcbiAgICB9XG4gIH0sIHRoaXMpO1xuICByZXR1cm4gdGhpcztcbn1cblxuLyoqXG4gKiBAbWV0aG9kICAkcGlja1xuICog44OU44OD44KvXG4gKi9cbmZ1bmN0aW9uICRwaWNrKCkge1xuLy8gT2JqZWN0LnByb3RvdHlwZS4kbWV0aG9kKFwiJHBpY2tcIiwgZnVuY3Rpb24oKSB7XG4gIHZhciB0ZW1wID0ge307XG5cbiAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChhcmd1bWVudHMsIGZ1bmN0aW9uKGtleSkge1xuICAgIGlmIChrZXkgaW4gdGhpcykgdGVtcFtrZXldID0gdGhpc1trZXldO1xuICB9LCB0aGlzKTtcblxuICByZXR1cm4gdGVtcDtcbn1cblxuLyoqXG4gKiBAbWV0aG9kICAkb21pdFxuICog44Kq44Of44OD44OIXG4gKi9cbmZ1bmN0aW9uICRvbWl0KCkge1xuLy8gT2JqZWN0LnByb3RvdHlwZS4kbWV0aG9kKFwiJG9taXRcIiwgZnVuY3Rpb24oKSB7XG4gIHZhciB0ZW1wID0ge307XG5cbiAgZm9yICh2YXIga2V5IGluIHRoaXMpIHtcbiAgICBpZiAoQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChhcmd1bWVudHMsIGtleSkgPT0gLTEpIHtcbiAgICAgIHRlbXBba2V5XSA9IHRoaXNba2V5XTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGVtcDtcbn1cblxuLyoqXG4gKiBAbWV0aG9kICAkdG9BcnJheVxuICog6YWN5YiX5YyWXG4gKi9cbmZ1bmN0aW9uICR0b0FycmF5KCkge1xuLy8gT2JqZWN0LnByb3RvdHlwZS4kbWV0aG9kKFwiJHRvQXJyYXlcIiwgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzKTtcbn1cblxuLyoqXG4gKiBbb2JzZXJ2ZSBkZXNjcmlwdGlvbl1cbiAqIEBwYXJhbSAge2FueX0gICBvYmogICAgICBbZGVzY3JpcHRpb25dXG4gKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgW2Rlc2NyaXB0aW9uXVxuICogQHJldHVybiB7dm9pZH0gICAgICAgICAgICBbZGVzY3JpcHRpb25dXG4gKi9cbmZ1bmN0aW9uIG9ic2VydmUob2JqLCBjYWxsYmFjaykge1xuLy8gT2JqZWN0LiRtZXRob2QoJ29ic2VydmUnLCBmdW5jdGlvbihvYmosIGNhbGxiYWNrKSB7XG4gIGlmIChPYmplY3RbJ29ic2VydmUnXSkgcmV0dXJuIE9iamVjdFsnb2JzZXJ2ZSddLmNhbGwob2JqLCBjYWxsYmFjayk7IC8vIGFkZFxuICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iaik7XG4gIGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICB2YXIgdGVtcEtleSA9ICdfXycgKyBrZXk7XG4gICAgdmFyIHRlbXBWYWx1ZSA9IG9ialtrZXldO1xuICAgIG9ialt0ZW1wS2V5XSA9IHRlbXBWYWx1ZTtcbiAgICBcbiAgICBhY2Nlc3Nvci5jYWxsKG9iaiwga2V5LCB7XG4gICAgLy8gb2JqLmFjY2Vzc29yKGtleSwge1xuICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbdGVtcEtleV07XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbih2KSB7XG4gICAgICAgIHRoaXNbdGVtcEtleV0gPSB2O1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG59XG5cbi8qKlxuICogW3Vub2JzZXJ2ZSBkZXNjcmlwdGlvbl1cbiAqIEBwYXJhbSAge2FueX0gICBvYmogICAgICBbZGVzY3JpcHRpb25dXG4gKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgW2Rlc2NyaXB0aW9uXVxuICogQHJldHVybiB7dm9pZH0gICAgICAgICAgICBbZGVzY3JpcHRpb25dXG4gKi9cbmZ1bmN0aW9uIHVub2JzZXJ2ZShvYmosIGNhbGxiYWNrKSB7XG4vLyBPYmplY3QuJG1ldGhvZCgndW5vYnNlcnZlJywgZnVuY3Rpb24ob2JqLCBjYWxsYmFjaykge1xuICBpZiAoT2JqZWN0Wyd1bm9ic2VydmUnXSkgcmV0dXJuIE9iamVjdFsndW5vYnNlcnZlJ10uY2FsbChvYmosIGNhbGxiYWNrKTsgLy8gYWRkXG4gIGNvbnNvbGUuYXNzZXJ0KGZhbHNlKTtcbn1cblxudmFyIG9iamVjdEV4dGVuc2lvbnMgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgJG1ldGhvZDogJG1ldGhvZCxcbiAgc2V0dGVyOiBzZXR0ZXIsXG4gIGdldHRlcjogZ2V0dGVyLFxuICBhY2Nlc3NvcjogYWNjZXNzb3IsXG4gIGZvckluOiBmb3JJbixcbiAgJGV4dGVuZDogJGV4dGVuZCxcbiAgJHNhZmU6ICRzYWZlLFxuICAkd2F0Y2g6ICR3YXRjaCxcbiAgcHJvcGVydHk6IHByb3BlcnR5LFxuICAkZ2V0OiAkZ2V0LFxuICAkc2V0OiAkc2V0LFxuICAkaGFzOiAkaGFzLFxuICAkc3RyaWN0OiAkc3RyaWN0LFxuICAkcGljazogJHBpY2ssXG4gICRvbWl0OiAkb21pdCxcbiAgJHRvQXJyYXk6ICR0b0FycmF5LFxuICBvYnNlcnZlOiBvYnNlcnZlLFxuICB1bm9ic2VydmU6IHVub2JzZXJ2ZVxufSk7XG5cbi8qKlxuICogQGNsYXNzIGdsb2JhbC5NYXRoXG4gKiAjIOaLoeW8teOBl+OBnyBNYXRoIOOCr+ODqeOCuVxuICog5pWw5a2m55qE44Gq5Yem55CG44KS5omx44GGIE1hdGgg44Kv44Op44K544KS5ouh5by144GX44Gm44GE44G+44GZ44CCXG4gKiBcbiAqIOWFqOOBpnN0YXRpY+ODoeODs+ODkOODvOOBp+OBmeOAglxuICovXG5cbi8qKlxuICogQHN0YXRpY1xuICogQG1ldGhvZCBjbGFtcFxuICog5oyH5a6a44GX44Gf5YCk44KS5oyH5a6a44GX44Gf56+E5Zuy44Gr5Y+O44KB44Gf57WQ5p6c44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBNYXRoLmNsYW1wKDEyMCwgMCwgNjQwKTsgLy8gPT4gMTIwXG4gKiAgICAgTWF0aC5jbGFtcCg5ODAsIDAsIDY0MCk7IC8vID0+IDY0MFxuICogICAgIE1hdGguY2xhbXAoLTgwLCAwLCA2NDApOyAvLyA9PiAwXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IHZhbHVlIOWApFxuICogQHBhcmFtIHtOdW1iZXJ9IG1pbiAg56+E5Zuy44Gu5LiL6ZmQXG4gKiBAcGFyYW0ge051bWJlcn0gbWF4ICDnr4Tlm7Ljga7kuIrpmZBcbiAqIEByZXR1cm4ge051bWJlcn0g5Li444KB44Gf57WQ5p6c44Gu5YCkXG4gKi9cbmZ1bmN0aW9uIGNsYW1wKHZhbHVlLCBtaW4sIG1heCkge1xuICByZXR1cm4gKHZhbHVlIDwgbWluKSA/IG1pbiA6ICggKHZhbHVlID4gbWF4KSA/IG1heCA6IHZhbHVlICk7XG59XG5cbi8qKlxuICogQHByb3BlcnR5IERFR19UT19SQURcbiAqIOW6puOCkuODqeOCuOOCouODs+OBq+WkieaPm+OBmeOCi+OBn+OCgeOBruWumuaVsOOBp+OBmeOAglxuICovXG52YXIgREVHX1RPX1JBRCA9IE1hdGguUEkvMTgwO1xuXG4vKipcbiAqIEBwcm9wZXJ0eSBSQURfVE9fREVHXG4gKiDjg6njgrjjgqLjg7PjgpLluqbjgavlpInmj5vjgZnjgovjgZ/jgoHjga7lrprmlbDjgafjgZnjgIJcbiAqL1xudmFyIFJBRF9UT19ERUcgPSAxODAvTWF0aC5QSTtcblxuXG4vLyA9PT09PT09PT09XG4vLyDku6XkuIvjg6njgqTjg5bjg6njg6rlhoXjgafjga/mnKrkvb/nlKhcbi8vID09PT09PT09PT1cblxuLyoqXG4gKiBAcHJvcGVydHkgUEhJXG4gKiDpu4Tph5Hmr5TjgafjgZnjgIJcbiAqL1xudmFyIFBISSA9ICgxICsgTWF0aC5zcXJ0KDUpKSAvIDI7XG5cbi8qKlxuICogQHN0YXRpY1xuICogQG1ldGhvZCBkZWdUb1JhZFxuICog5bqm44KS44Op44K444Ki44Oz44Gr5aSJ5o+b44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBNYXRoLmRlZ1RvUmFkKDE4MCk7IC8vID0+IDMuMTQxNTkyNjUzNTg5NzkzXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IGRlZyDluqZcbiAqIEByZXR1cm4ge051bWJlcn0g44Op44K444Ki44OzXG4gKi9cbmZ1bmN0aW9uIGRlZ1RvUmFkKGRlZykge1xuLy8gTWF0aC5kZWdUb1JhZCA9IGZ1bmN0aW9uKGRlZykge1xuICByZXR1cm4gZGVnICogREVHX1RPX1JBRDtcbn1cblxuLyoqXG4gKiBAc3RhdGljXG4gKiBAbWV0aG9kIHJhZFRvRGVnXG4gKiDjg6njgrjjgqLjg7PjgpLluqbjgavlpInmj5vjgZfjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIE1hdGgucmFkVG9EZWcoTWF0aC5QSS80KTsgLy8gPT4gNDVcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gcmFkIOODqeOCuOOCouODs1xuICogQHJldHVybiB7TnVtYmVyfSDluqZcbiAqL1xuZnVuY3Rpb24gcmFkVG9EZWcocmFkKSB7XG4vLyBNYXRoLnJhZFRvRGVnID0gZnVuY3Rpb24ocmFkKSB7XG4gIHJldHVybiByYWQgKiBSQURfVE9fREVHO1xufVxuXG4vKipcbiAqIEBzdGF0aWNcbiAqIEBtZXRob2QgaW5zaWRlXG4gKiDmjIflrprjgZfjgZ/lgKTjgYzmjIflrprjgZfjgZ/lgKTjga7nr4Tlm7LjgavjgYLjgovjgYvjganjgYbjgYvjgpLov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIE1hdGguaW5zaWRlKDk4MCwgMCwgNjQwKTsgLy8gPT4gZmFsc2VcbiAqICAgICBNYXRoLmluc2lkZSgxMjAsIDAsIDY0MCk7IC8vID0+IHRydWVcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gdmFsdWUg44OB44Kn44OD44Kv44GZ44KL5YCkXG4gKiBAcGFyYW0ge051bWJlcn0gbWluICDnr4Tlm7Ljga7kuIvpmZBcbiAqIEBwYXJhbSB7TnVtYmVyfSBtYXggIOevhOWbsuOBruS4iumZkFxuICogQHJldHVybiB7Qm9vbGVhbn0g56+E5Zuy5YaF44Gr5YCk44GM44GC44KL44GL44Gq44GE44GLXG4gKi9cbmZ1bmN0aW9uIGluc2lkZSh2YWx1ZSwgbWluLCBtYXgpIHtcbi8vIE1hdGguJG1ldGhvZChcImluc2lkZVwiLCBmdW5jdGlvbih2YWx1ZSwgbWluLCBtYXgpIHtcbiAgcmV0dXJuICh2YWx1ZSA+PSBtaW4pICYmICh2YWx1ZSkgPD0gbWF4O1xufVxuXG4vKipcbiAqIEBzdGF0aWNcbiAqIEBtZXRob2QgcmFuZGludFxuICog5oyH5a6a44GV44KM44Gf56+E5Zuy5YaF44Gn44Op44Oz44OA44Og44Gq5pW05pWw5YCk44KS55Sf5oiQ44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBNYXRoLnJhbmRpbnQoLTQsIDQpOyAvLyA9PiAtNOOAgTDjgIEz44CBNCDjgarjgalcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gbWluICDnr4Tlm7Ljga7mnIDlsI/lgKRcbiAqIEBwYXJhbSB7TnVtYmVyfSBtYXggIOevhOWbsuOBruacgOWkp+WApFxuICogQHJldHVybiB7TnVtYmVyfSDjg6njg7Pjg4Djg6DjgarmlbTmlbDlgKRcbiAqL1xuZnVuY3Rpb24gcmFuZGludChtaW4sIG1heCkge1xuLy8gTWF0aC4kbWV0aG9kKFwicmFuZGludFwiLCBmdW5jdGlvbihtaW4sIG1heCkge1xuICByZXR1cm4gTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSoobWF4LW1pbisxKSApICsgbWluO1xufVxuXG4vKipcbiAqIEBzdGF0aWNcbiAqIEBtZXRob2QgcmFuZGZsb2F0XG4gKiDmjIflrprjgZXjgozjgZ/nr4Tlm7LlhoXjgafjg6njg7Pjg4Djg6DjgarmlbDlgKTjgpLnlJ/miJDjgZfjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIE1hdGgucmFuZGZsb2F0KC00LCA0KTsgLy8gPT4gLTIuNzQ4OTE5MzgyNDAwMDkzNyDjgarjgalcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gbWluICDnr4Tlm7Ljga7mnIDlsI/lgKRcbiAqIEBwYXJhbSB7TnVtYmVyfSBtYXggIOevhOWbsuOBruacgOWkp+WApFxuICogQHJldHVybiB7TnVtYmVyfSDjg6njg7Pjg4Djg6DjgarmlbDlgKRcbiAqL1xuZnVuY3Rpb24gcmFuZGZsb2F0KG1pbiwgbWF4KSB7XG4vLyBNYXRoLiRtZXRob2QoXCJyYW5kZmxvYXRcIiwgZnVuY3Rpb24obWluLCBtYXgpIHtcbiAgcmV0dXJuIE1hdGgucmFuZG9tKCkqKG1heC1taW4pK21pbjtcbn1cblxuLyoqXG4gKiBAc3RhdGljXG4gKiBAbWV0aG9kIHJhbmRib29sXG4gKiDjg6njg7Pjg4Djg6DjgavnnJ/lgb3lgKTjgpLnlJ/miJDjgZfjgb7jgZnjgIJcbiAqIOW8leaVsOOBp+eZvuWIhueOh+OCkuaMh+WumuOBmeOCi+S6i+OCguOBp+OBjeOBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgTWF0aC5yYW5kYm9vbCgpOyAgIC8vID0+IHRydWUg44G+44Gf44GvIGZhbHNlXG4gKiAgICAgTWF0aC5yYW5kYm9vbCg4MCk7IC8vID0+IDgwJSDjga7norrnjofjgacgdHJ1ZVxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBwZXJjZW50ICDnnJ/jgavjgarjgovnmb7liIbnjodcbiAqIEByZXR1cm4ge0Jvb2xlYW59IOODqeODs+ODgOODoOOBquecn+WBveWApFxuICovXG5mdW5jdGlvbiByYW5kYm9vbChwZXJjZW50KSB7XG4vLyBNYXRoLiRtZXRob2QoXCJyYW5kYm9vbFwiLCBmdW5jdGlvbihwZXJjZW50KSB7XG4gIHJldHVybiBNYXRoLnJhbmRvbSgpIDwgKHBlcmNlbnQgPT09IHVuZGVmaW5lZCA/IDUwIDogcGVyY2VudCkgLyAxMDA7XG59XG5cbnZhciBtYXRoRXh0ZW5zaW9ucyA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICBjbGFtcDogY2xhbXAsXG4gIERFR19UT19SQUQ6IERFR19UT19SQUQsXG4gIFJBRF9UT19ERUc6IFJBRF9UT19ERUcsXG4gIFBISTogUEhJLFxuICBkZWdUb1JhZDogZGVnVG9SYWQsXG4gIHJhZFRvRGVnOiByYWRUb0RlZyxcbiAgaW5zaWRlOiBpbnNpZGUsXG4gIHJhbmRpbnQ6IHJhbmRpbnQsXG4gIHJhbmRmbG9hdDogcmFuZGZsb2F0LFxuICByYW5kYm9vbDogcmFuZGJvb2xcbn0pO1xuXG4vKlxuICogYXJyYXkuanNcbiAqL1xuXG4vKipcbiAqIEB0eXBlIHtpbXBvcnQoJy4uL3BoaW5hJykuQWNjZXNzb3JFeHRlbmRPYmplY3R9IGZpcnN0XG4gKiDmnIDliJ3jga7opoHntKDjgpLov5TjgZnjgIHjgoLjgZfjgY/jga/jgZ3jgZPjgavjgrvjg4Pjg4jjgZnjgotcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIGFyciA9IFs2LCA1LCAyLCAzLCAxLCA0XTtcbiAqICAgICBhcnIuZmlyc3Q7IC8vID0+IDZcbiAqL1xuY29uc3QgZmlyc3QgPSB7XG4vLyBBcnJheS5wcm90b3R5cGUuYWNjZXNzb3IoXCJmaXJzdFwiLCB7XG4gIC8qKiBAdGhpcyBBcnJheSAqL1xuICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpc1swXTsgfSxcbiAgLyoqIEB0aGlzIEFycmF5ICovXG4gIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXNbMF0gPSB2OyB9XG59O1xuXG4vKipcbiAqIEB0eXBlIHtpbXBvcnQoJy4uL3BoaW5hJykuQWNjZXNzb3JFeHRlbmRPYmplY3R9IGxhc3RcbiAqIOacgOW+jOOBruimgee0oOOCkui/lOOBmeOAgeOCguOBl+OBj+OBr+OBneOBk+OBq+OCu+ODg+ODiOOBmeOCi1xuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyID0gWzYsIDUsIDIsIDMsIDEsIDRdO1xuICogICAgIGFyci5sYXN0OyAvLyA9PiA0XG4gKi9cbmNvbnN0IGxhc3QgPSB7XG4vLyBBcnJheS5wcm90b3R5cGUuYWNjZXNzb3IoXCJsYXN0XCIsIHtcbiAgLyoqIEB0aGlzIEFycmF5ICovXG4gIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzW3RoaXMubGVuZ3RoLTFdOyB9LFxuICAvKiogQHRoaXMgQXJyYXkgKi9cbiAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpc1t0aGlzLmxlbmd0aC0xXSA9IHY7IH1cbn07XG5cblxuLyoqXG4gKiBAbWV0aG9kIGF0XG4gKiDmjIflrprjgZfjgZ/jgqTjg7Pjg4fjg4Pjgq/jgrnjga7opoHntKDjgpLov5TjgZfjgb7jgZnvvIjjg6vjg7zjg5fjg7vosqDmlbDjga7mjIflrprlj6/vvInjgIJcbiAqXG4gKiDmt7vlrZfjgYzosqDmlbDjga7loLTlkIjjga/mnKvlsL7jgYvjgonjga7jgqrjg5Xjgrvjg4Pjg4jjgajjgb/jgarjgZfjgb7jgZnjgILmnKvlsL7jga7opoHntKDjgYwgLTEg55Wq55uu44Gr44Gq44KK44G+44GZ44CCICBcbiAqIOa3u+Wtl+OBrue1tuWvvuWApOOBjCBBcnJheS5sZW5ndGgg5Lul5LiK44Gu5aC05ZCI44Gv44Or44O844OX44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBhcnIgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZScsICdmJ107XG4gKiAgICAgYXJyLmF0KDApOyAgLy8gPT4gJ2EnXG4gKiAgICAgYXJyLmF0KDYpOyAgLy8gPT4gJ2EnXG4gKiAgICAgYXJyLmF0KDEzKTsgLy8gPT4gJ2InXG4gKiAgICAgYXJyLmF0KC0xKTsgLy8gPT4gJ2YnXG4gKiAgICAgYXJyLmF0KC04KTsgLy8gPT4gJ2UnXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEBwYXJhbSB7TnVtYmVyfSBpIOa3u+Wtl1xuICogQHJldHVybiB7T2JqZWN0fSDmt7vlrZfjgafmjIflrprjgZXjgozjgZ/opoHntKBcbiAqL1xuZnVuY3Rpb24gYXQoaSkge1xuLy8gQXJyYXkucHJvdG90eXBlLiRtZXRob2QoXCJhdFwiLCBmdW5jdGlvbihpKSB7XG4gIGklPXRoaXMubGVuZ3RoO1xuICBpKz10aGlzLmxlbmd0aDtcbiAgaSU9dGhpcy5sZW5ndGg7XG4gIHJldHVybiB0aGlzW2ldO1xufVxuXG4vKipcbiAqIEBtZXRob2QgZXJhc2VcbiAqIEBjaGFpbmFibGVcbiAqIOaMh+WumuOBl+OBn+OCquODluOCuOOCp+OCr+ODiOOBqOS4gOiHtOOBl+OBn+acgOWIneOBruimgee0oOOCkuWJiumZpOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyMSA9IFsnYScsICdiJywgJ2InLCAnYyddO1xuICogICAgIGFycjIgPSBhcnIxLmVyYXNlKCdiJyk7IC8vID0+IFsnYScsICdiJywgJ2MnXVxuICogICAgIGFycjEgPT09IGFycjI7ICAgICAgICAgIC8vID0+IHRydWVcbiAqXG4gKiBAdGhpcyBBcnJheVxuICogQHBhcmFtIHtPYmplY3R9IGVsbSDliYrpmaTjgZfjgZ/jgYTjgqrjg5bjgrjjgqfjgq/jg4hcbiAqL1xuZnVuY3Rpb24gZXJhc2UoZWxtKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcImVyYXNlXCIsIGZ1bmN0aW9uKGVsbSkge1xuICB2YXIgaW5kZXggID0gdGhpcy5pbmRleE9mKGVsbSk7XG4gIGlmIChpbmRleCA+PSAwKSB7XG4gICAgdGhpcy5zcGxpY2UoaW5kZXgsIDEpO1xuICB9XG4gIHJldHVybiB0aGlzO1xufVxuXG5cbi8qKlxuICogQG1ldGhvZCBjbGVhclxuICogQGNoYWluYWJsZVxuICog6Ieq6Lqr44KS56m644Gu6YWN5YiX44Gr44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBhcnIgPSBbMSwgMiwgWzMsIDRdXTtcbiAqICAgICBhcnIuY2xlYXIoKTsgLy8gPT4gW11cbiAqIFxuICogQHRoaXMgQXJyYXlcbiAqL1xuZnVuY3Rpb24gY2xlYXIoZGVlcCkge1xuLy8gQXJyYXkucHJvdG90eXBlLiRtZXRob2QoXCJjbGVhclwiLCBmdW5jdGlvbigpIHtcbiAgdGhpcy5sZW5ndGggPSAwO1xuICByZXR1cm4gdGhpcztcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGNvbnRhaW5zXG4gKiDmjIflrprjgZfjgZ/opoHntKDjgYzphY3liJfjgavlkKvjgb7jgozjgabjgYTjgovjgYvjgpLjg4Hjgqfjg4Pjgq/jgZfjgb7jgZnjgIJcbiAqXG4gKiDmr5TovIPjgavjga/ljrPlr4bjgarlkIzlgKTvvIjkuInph43jgqTjgrPjg7zjg6vmvJTnrpflrZAgPT09IOOBp+S9v+OCj+OCjOOCi+OBruOBqOWQjOOBmOaWueazle+8ieOCkueUqOOBhOOBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyID0gWzYsIDUsIDIsIDMsIDEsIDRdO1xuICogICAgIGFyci5jb250YWlucygzKTsgICAgIC8vID0+IHRydWVcbiAqICAgICBhcnIuY29udGFpbnMoMywgNCk7ICAvLyA9PiBmYWxzZVxuICogICAgIGFyci5jb250YWlucygzLCAtNCk7IC8vID0+IHRydWVcbiAqICAgICBhcnIuY29udGFpbnMoXCI2XCIpOyAgIC8vID0+IGZhbHNlXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEBwYXJhbSB7T2JqZWN0fSBpdGVtIOODgeOCp+ODg+OCr+OBmeOCi+OCquODluOCuOOCp+OCr+ODiFxuICogQHBhcmFtIHtOdW1iZXJ9IFtmcm9tSW5kZXg9MF0g5qSc57Si44KS5aeL44KB44KL5L2N572u44CC6LKg5pWw44KS5oyH5a6a44GX44Gf5aC05ZCI44Gv5pyr5bC+44GL44KJ44Gu44Kq44OV44K744OD44OI44Go6KaL44Gq44GX44G+44GZ44CCXG4gKiBAcmV0dXJuIHtCb29sZWFufSDjg4Hjgqfjg4Pjgq/jga7ntZDmnpxcbiAqL1xuZnVuY3Rpb24gY29udGFpbnMoaXRlbSwgZnJvbUluZGV4KSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcImNvbnRhaW5zXCIsIGZ1bmN0aW9uKGl0ZW0sIGZyb21JbmRleCkge1xuICByZXR1cm4gdGhpcy5pbmRleE9mKGl0ZW0sIGZyb21JbmRleCkgIT0gLTE7XG59XG5cbi8qKlxuICogQG1ldGhvZCBjbG9uZVxuICog6Ieq6Lqr44Gu44Kz44OU44O844KS55Sf5oiQ44GX44Gm6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBhcnIxID0gWzEsIDIsIFszLCA0XV07XG4gKiAgICAgYXJyMiA9IGFycjEuY2xvbmUoKTsgICAgICAvLyA9PiBbMSwgMiwgWzMsIDRdXVxuICogICAgIGFycjFbMl0gPT09IGFycjJbMl07ICAgICAgLy8gPT4gdHJ1ZVxuICogICAgIGFycjFbMl1bMF0gPSA5O1xuICogICAgIGFycjI7ICAgICAgICAgICAgICAgICAgICAgLy8gPT4gWzEsIDIsIFs5LCA0XV1cbiAqICAgICBhcnIxID0gWzEsIDIsIFszLCA0XV07XG4gKiAgICAgYXJyMiA9IGFycjEuY2xvbmUodHJ1ZSk7ICAvLyA9PiBbMSwgMiwgWzMsIDRdXVxuICogICAgIGFycjFbMl0gPT09IGFycjJbMl07ICAgICAgLy8gPT4gZmFsc2VcbiAqICAgICBhcnIxWzJdWzBdID0gOTtcbiAqICAgICBhcnIyOyAgICAgICAgICAgICAgICAgICAgIC8vID0+IFsxLCAyLCBbMywgNF1dXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gW2RlZXA9ZmFsc2VdIOmFjeWIl+OBruODjeOCueODiOOCkuOBn+OBqeOBo+OBpuikh+ijveOBmeOCi+OBi+OBqeOBhuOBi1xuICogQHJldHVybiB7QXJyYXl9IOaWsOOBl+OBhOmFjeWIl1xuICovXG5mdW5jdGlvbiBjbG9uZShkZWVwKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcImNsb25lXCIsIGZ1bmN0aW9uKGRlZXApIHtcbiAgaWYgKGRlZXAgPT09IHRydWUpIDtcbiAgZWxzZSB7XG4gICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseSh0aGlzKTtcbiAgfVxufVxuXG4vKipcbiAqIEBtZXRob2QgcmFuZ2VcbiAqIEBjaGFpbmFibGVcbiAqIOiHqui6q+OCkuetieW3ruaVsOWIl++8iOS4gOWumumWk+malOOBruaVtOaVsOWApOOBruWIl++8ieOBqOOBl+OBvuOBmeOAglxuICpcbiAqIC0g5byV5pWw44GMMeOBpOOBruWgtOWQiOOAgTDvvZ5lbmTvvIhlbmTlkKvjgb7jgZrvvInjga7mlbTmlbDjga7phY3liJfjgafjgZnjgIIgIFxuICogLSDlvJXmlbDjgYwy44Gk44Gu5aC05ZCI44CBc3RhcnTvvZ5lbmTvvIhlbmTlkKvjgb7jgZrvvInjga7mlbTmlbDjga7phY3liJfjgafjgZnjgIIgIFxuICogLSDlvJXmlbDjgYwz44Gk44Gu5aC05ZCI44CBc3RhcnTvvZ5lbmTvvIhlbmTlkKvjgb7jgZrvvInjgYvjgaQgc3RhcnQgKyBuICogc3RlcCAobuOBr+aVtOaVsCnjgpLmuoDjgZ/jgZnmlbTmlbDjga7phY3liJfjgafjgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIGFyciA9IFtdO1xuICogICAgIGFyci5yYW5nZSg0KTsgICAgICAgIC8vID0+IFswLCAxLCAyLCAzXVxuICogICAgIGFyci5yYW5nZSgyLCA1KTsgICAgIC8vID0+IFsyLCAzLCA0XVxuICogICAgIGFyci5yYW5nZSgyLCAxNCwgNSk7IC8vID0+IFsyLCA3LCAxMl1cbiAqICAgICBhcnIucmFuZ2UoMiwgLTMpOyAgICAvLyA9PiBbMiwgMSwgMCwgLTEsIC0yXVxuICpcbiAqIEB0aGlzIEFycmF5XG4gKiBAcGFyYW0ge051bWJlcn0gc3RhcnQg5pyA5Yid44Gu5YCk77yI44OH44OV44Kp44Or44OI44GvIDDvvIlcbiAqIEBwYXJhbSB7TnVtYmVyfSBlbmQg5pyA5b6M44Gu5YCk77yI55yB55Wl5LiN5Y+v77yJXG4gKiBAcGFyYW0ge051bWJlcn0gW3N0ZXBdIOmWk+malOOAguODh+ODleOCqeODq+ODiOWApOOBrzHjgb7jgZ/jga8tMVxuICovXG5mdW5jdGlvbiByYW5nZShzdGFydCwgZW5kLCBzdGVwKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcInJhbmdlXCIsIGZ1bmN0aW9uKHN0YXJ0LCBlbmQsIHN0ZXApIHtcbiAgY2xlYXIuY2FsbCh0aGlzKTtcbiAgLy8gdGhpcy5jbGVhcigpO1xuICBcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkge1xuICAgIGZvciAodmFyIGk9MDsgaTxzdGFydDsgKytpKSB0aGlzW2ldID0gaTtcbiAgfVxuICBlbHNlIGlmIChzdGFydCA8IGVuZCkge1xuICAgIHN0ZXAgPSBzdGVwIHx8IDE7XG4gICAgaWYgKHN0ZXAgPiAwKSB7XG4gICAgICBmb3IgKHZhciBpPXN0YXJ0LCBpbmRleD0wOyBpPGVuZDsgaSs9c3RlcCwgKytpbmRleCkge1xuICAgICAgICB0aGlzW2luZGV4XSA9IGk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGVsc2Uge1xuICAgIHN0ZXAgPSBzdGVwIHx8IC0xO1xuICAgIGlmIChzdGVwIDwgMCkge1xuICAgICAgZm9yICh2YXIgaT1zdGFydCwgaW5kZXg9MDsgaT5lbmQ7IGkrPXN0ZXAsICsraW5kZXgpIHtcbiAgICAgICAgdGhpc1tpbmRleF0gPSBpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHRoaXM7XG59XG5cblxuLy8gPT09PT09PT09PVxuLy8g5Lul5LiL44Op44Kk44OW44Op44Oq5YaF44Gn44Gv5pyq5L2/55SoXG4vLyA9PT09PT09PT09XG5cblxuLyoqXG4gKiBAbWV0aG9kIGVxdWFsc1xuICog5rih44GV44KM44Gf6YWN5YiX44Go562J44GX44GE44GL44Gp44GG44GL44KS44OB44Kn44OD44Kv44GX44G+44GZ44CCXG4gKlxuICog6KaB57Sg5ZCM5aOr44KSID09PSDjgafmr5TovIPjgZfjgb7jgZnjgILopoHntKDjgavphY3liJfjgYzlkKvjgb7jgozjgabjgYTjgovloLTlkIjjga8ge0BsaW5rICNkZWVwRXF1YWxzfSDjgpLkvb/nlKjjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIGFycjEgPSBbNiwgNSwgMiwgMywgMSwgNF07XG4gKiAgICAgYXJyMS5lcXVhbHMoWzYsIDUsIDIsIDMsIDEsIDRdKTsgICAgICAgLy8gPT4gdHJ1ZVxuICogICAgIGFycjIgPSBbNiwgNSwgMiwgWzMsIDFdLCA0XTtcbiAqICAgICBhcnIyLmVxdWFscyhbNiwgNSwgMiwgWzMsIDFdLCA0XSk7ICAgICAvLyA9PiBmYWxzZVxuICogICAgIGFycjIuZGVlcEVxdWFscyhbNiwgNSwgMiwgWzMsIDFdLCA0XSk7IC8vID0+IHRydWVcbiAqXG4gKiBAdGhpcyBBcnJheVxuICogQHBhcmFtIHtBcnJheX0gYXJyIOavlOi8g+OBmeOCi+WvvuixoeOBrumFjeWIl1xuICogQHJldHVybiB7Qm9vbGVhbn0g44OB44Kn44OD44Kv44Gu57WQ5p6cXG4gKi9cbmZ1bmN0aW9uIGVxdWFscyhhcnIpIHtcbi8vIEFycmF5LnByb3RvdHlwZS4kbWV0aG9kKFwiZXF1YWxzXCIsIGZ1bmN0aW9uKGFycikge1xuICAvLyDplbfjgZXjg4Hjgqfjg4Pjgq9cbiAgaWYgKHRoaXMubGVuZ3RoICE9PSBhcnIubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gIFxuICBmb3IgKHZhciBpPTAsbGVuPXRoaXMubGVuZ3RoOyBpPGxlbjsgKytpKSB7XG4gICAgaWYgKHRoaXNbaV0gIT09IGFycltpXSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEBtZXRob2QgZGVlcEVxdWFsc1xuICog44ON44K544OI44GV44KM44Gm44GE44KL6YWN5YiX44KS5ZCr44KB44CB5rih44GV44KM44Gf6YWN5YiX44Go562J44GX44GE44GL44Gp44GG44GL44KS44OB44Kn44OD44Kv44GX44G+44GZ44CCXG4gKlxuICog4oC7ZXF1YWxzRGVlcCDjgavjgZnjgovjgYvmpJzoqI4uIChKYXZhIOOBp+OBryBkZWVwRXF1YWxzIOOBquOBruOBp+OBqOOCiuOBguOBiOOBmuWQiOOCj+OBm+OBqOOBjylcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIGFyciA9IFs2LCA1LCAyLCBbMywgMV0sIDRdO1xuICogICAgIGFyci5lcXVhbHMoWzYsIDUsIDIsIFszLCAxXSwgNF0pOyAgICAgLy8gPT4gZmFsc2VcbiAqICAgICBhcnIuZGVlcEVxdWFscyhbNiwgNSwgMiwgWzMsIDFdLCA0XSk7IC8vID0+IHRydWVcbiAqXG4gKiBAdGhpcyBBcnJheVxuICogQHBhcmFtIHtBcnJheX0gYXJyIOavlOi8g+OBmeOCi+WvvuixoeOBrumFjeWIl1xuICogQHJldHVybiB7Qm9vbGVhbn0g44OB44Kn44OD44Kv44Gu57WQ5p6cXG4gKi9cbmZ1bmN0aW9uIGRlZXBFcXVhbHMoYXJyKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcImRlZXBFcXVhbHNcIiwgZnVuY3Rpb24oYXJyKSB7XG4gIC8vIOmVt+OBleODgeOCp+ODg+OCr1xuICBpZiAodGhpcy5sZW5ndGggIT09IGFyci5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgXG4gIGZvciAodmFyIGk9MCxsZW49dGhpcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcbiAgICB2YXIgcmVzdWx0ID0gKHRoaXNbaV0uZGVlcEVxdWFscykgPyB0aGlzW2ldLmRlZXBFcXVhbHMoYXJyW2ldKSA6ICh0aGlzW2ldID09PSBhcnJbaV0pO1xuICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEBtZXRob2Qgc3dhcFxuICogQGNoYWluYWJsZVxuICogYSDnlarnm67jga7opoHntKAg44GoIGIg55Wq55uu44Gu6KaB57Sg44KS5YWl44KM5pu/44GI44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBhcnIxID0gWydhJywgJ2InLCAnYycsICdkJ107XG4gKiAgICAgYXJyMiA9IGFycjEuc3dhcCgwLCAzKTsgLy8gPT4gWydkJywgJ2InLCAnYycsICdhJ11cbiAqICAgICBhcnIxID09PSBhcnIyOyAgICAgICAgICAvLyA9PiB0cnVlXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEBwYXJhbSB7TnVtYmVyfSBhICDjgqTjg7Pjg4fjg4Pjgq/jgrlcbiAqIEBwYXJhbSB7TnVtYmVyfSBiICDjgqTjg7Pjg4fjg4Pjgq/jgrlcbiAqL1xuZnVuY3Rpb24gc3dhcChhLCBiKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcInN3YXBcIiwgZnVuY3Rpb24oYSwgYikge1xuICB2YXIgdGVtcCA9IHRoaXNbYV07XG4gIHRoaXNbYV0gPSB0aGlzW2JdO1xuICB0aGlzW2JdID0gdGVtcDtcbiAgXG4gIHJldHVybiB0aGlzO1xufVxuXG4vKipcbiAqIEBtZXRob2QgZXJhc2VBbGxcbiAqIEBjaGFpbmFibGVcbiAqIOaMh+WumuOBl+OBn+OCquODluOCuOOCp+OCr+ODiOOBqOS4gOiHtOOBl+OBn+OBmeOBueOBpuOBruimgee0oOOCkuWJiumZpOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyMSA9IFsnYScsICdiJywgJ2InLCAnYyddO1xuICogICAgIGFycjIgPSBhcnIxLmVyYXNlQWxsKCdiJyk7IC8vID0+IFsnYScsICdjJ11cbiAqICAgICBhcnIxID09PSBhcnIyOyAgICAgICAgICAgICAvLyA9PiB0cnVlXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEBwYXJhbSB7T2JqZWN0fSBlbG0g5YmK6Zmk44GX44Gf44GE44Kq44OW44K444Kn44Kv44OIXG4gKi9cbmZ1bmN0aW9uIGVyYXNlQWxsKGVsbSkge1xuLy8gQXJyYXkucHJvdG90eXBlLiRtZXRob2QoXCJlcmFzZUFsbFwiLCBmdW5jdGlvbihlbG0pIHtcbiAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xuICAgIGlmICh0aGlzW2ldID09IGVsbSkge1xuICAgICAgdGhpcy5zcGxpY2UoaS0tLCAxKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRoaXM7XG59XG5cbi8qKlxuICogQG1ldGhvZCBlcmFzZUlmXG4gKiBAY2hhaW5hYmxlXG4gKiDlkITopoHntKDjgpLlvJXmlbDjgavjgZfjgabplqLmlbDjgpLlrp/ooYzjgZfjgIHjgZ3jga7lgKTjgYznnJ/jgajjgarjgovvvIjvvJ3mnaHku7bjgavjg57jg4Pjg4HjgZnjgovvvInmnIDliJ3jga7opoHntKDjgpLliYrpmaTjgZfjgb7jgZnjgIJcbiAqXG4gKiDjganjga7opoHntKDjgoLjg57jg4Pjg4HjgZfjgarjgZHjgozjgbDkvZXjgoLotbfjgY3jgb7jgZvjgpPjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIGFyciA9IFsnZm9vJywgJ2JhcicsICdob2dlJywgJ2Z1Z2EnXTtcbiAqICAgICBhcnIuZXJhc2VJZiggZnVuY3Rpb24oZWxtKSB7XG4gKiAgICAgICByZXR1cm4gZWxtLmluZGV4T2YoJ28nKSA+PSAwO1xuICogICAgIH0pO1xuICogICAgIC8vID0+IFsnYmFyJywgJ2hvZ2UnLCAnZnVnYSddXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIOWQhOimgee0oOOBq+WvvuOBl+OBpuWun+ihjOOBmeOCi+OCs+ODvOODq+ODkOODg+OCr+mWouaVsFxuICovXG5mdW5jdGlvbiBlcmFzZUlmKGZuKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcImVyYXNlSWZcIiwgZnVuY3Rpb24oZm4pIHtcbiAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xuICAgIGlmICggZm4odGhpc1tpXSwgaSwgdGhpcykgKSB7XG4gICAgICB0aGlzLnNwbGljZShpLCAxKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdGhpcztcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGVyYXNlSWZBbGxcbiAqIEBjaGFpbmFibGVcbiAqIOWQhOimgee0oOOCkuW8leaVsOOBq+OBl+OBpumWouaVsOOCkuWun+ihjOOBl+OAgeOBneOBruWApOOBjOecn+OBqOOBquOCi++8iO+8neadoeS7tuOBq+ODnuODg+ODgeOBmeOCi++8ieOBmeOBueOBpuOBruimgee0oOOCkuWJiumZpOOBl+OBvuOBmeOAglxuICpcbiAqIOOBqeOBruimgee0oOOCguODnuODg+ODgeOBl+OBquOBkeOCjOOBsOS9leOCgui1t+OBjeOBvuOBm+OCk+OAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyID0gWydmb28nLCAnYmFyJywgJ2hvZ2UnLCAnZnVnYSddO1xuICogICAgIGFyci5lcmFzZUlmQWxsKCBmdW5jdGlvbihlbG0pIHtcbiAqICAgICAgIHJldHVybiBlbG0uaW5kZXhPZignbycpID49IDA7XG4gKiAgICAgfSk7XG4gKiAgICAgLy8gPT4gWydiYXInLCAnZnVnYSddXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIOWQhOimgee0oOOBq+WvvuOBl+OBpuWun+ihjOOBmeOCi+OCs+ODvOODq+ODkOODg+OCr+mWouaVsFxuICovXG5mdW5jdGlvbiBlcmFzZUlmQWxsKGZuKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcImVyYXNlSWZBbGxcIiwgZnVuY3Rpb24oZm4pIHtcbiAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xuICAgIGlmICggZm4odGhpc1tpXSwgaSwgdGhpcykgKSB7XG4gICAgICB0aGlzLnNwbGljZShpLS0sIDEpO1xuICAgICAgbGVuLS07XG4gICAgfVxuICB9XG4gIHJldHVybiB0aGlzO1xufVxuXG4vKipcbiAqIEBtZXRob2QgcmFuZG9tXG4gKiDphY3liJfjgYvjgonjg6njg7Pjg4Djg6Djgasx44Gk5Y+W44KK5Ye644GX44Gf6KaB57Sg44KS6L+U44GX44G+44GZ44CCXG4gKlxuICog5Y+W44KK5Ye644GZ56+E5Zuy44KS44Kk44Oz44OH44OD44Kv44K544Gn5oyH5a6a44GZ44KL44GT44Go44KC44Gn44GN44G+44GZ44CCICBcbiAqIHtAbGluayAjcGlja3VwfeOAgXtAbGluayAjbG90fSDjgajlkIzjgZjjgafjgZnjgIIgIFxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyID0gWydmb28nLCAnYmFyJywgJ2hvZ2UnLCAnZnVnYSddO1xuICogICAgIGFyci5yYW5kb20oMiwgMyk7ICAvLyA9PiAnaG9nZScg44G+44Gf44GvICdmdWdhJ1xuICpcbiAqIEB0aGlzIEFycmF5XG4gKiBAcGFyYW0ge051bWJlcn0gW21pbj0wXSDjgqTjg7Pjg4fjg4Pjgq/jgrnjga7kuIvpmZBcbiAqIEBwYXJhbSB7TnVtYmVyfSBbbWF4PemFjeWIl+OBruacgOWkp+OCpOODs+ODh+ODg+OCr+OCuV0g44Kk44Oz44OH44OD44Kv44K544Gu5LiK6ZmQXG4gKiBAcmV0dXJuIHtPYmplY3R9IOODqeODs+ODgOODoOOBqzHjgaTlj5bjgorlh7rjgZfjgZ/opoHntKBcbiAqL1xuZnVuY3Rpb24gcmFuZG9tKG1pbiwgbWF4KSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcInJhbmRvbVwiLCBmdW5jdGlvbihtaW4sIG1heCkge1xuICBtaW4gPSBtaW4gfHwgMDtcbiAgbWF4ID0gbWF4IHx8IHRoaXMubGVuZ3RoLTE7XG4gIHJldHVybiB0aGlzW3JhbmRpbnQobWluLCBtYXgpIF07XG59XG5cbi8qKlxuICogQG1ldGhvZCBwaWNrdXBcbiAqIOmFjeWIl+OBi+OCieODqeODs+ODgOODoOOBpzHjgaTlj5bjgorlh7rjgZfjgZ/opoHntKDjgpLov5TjgZfjgb7jgZnjgIJcbiAqIFxuICoge0BsaW5rICNyYW5kb21944CBe0BsaW5rICNsb3R9IOOBqOWQjOOBmOOBp+OBmeOAglxuICogQGluaGVyaXRkb2MgI3JhbmRvbVxuICogXG4gKiBAdGhpcyB7QXJyYXl9XG4gKiBAcGFyYW0ge251bWJlcn0gbWluXG4gKiBAcGFyYW0ge251bWJlcn0gbWF4XG4gKi9cbmZ1bmN0aW9uIHBpY2t1cChtaW4sIG1heCkge1xuLy8gQXJyYXkucHJvdG90eXBlLiRtZXRob2QoXCJwaWNrdXBcIiwgZnVuY3Rpb24obWluLCBtYXgpIHtcbiAgbWluID0gbWluIHx8IDA7XG4gIG1heCA9IG1heCB8fCB0aGlzLmxlbmd0aC0xO1xuICByZXR1cm4gdGhpc1tyYW5kaW50KG1pbiwgbWF4KSBdO1xufVxuXG4vKipcbiAqIEBtZXRob2QgbG90XG4gKiDphY3liJfjgYvjgonjg6njg7Pjg4Djg6Djgacx44Gk5Y+W44KK5Ye644GX44Gf6KaB57Sg44KS6L+U44GX44G+44GZ44CCXG4gKiBcbiAqIHtAbGluayAjcmFuZG9tfeOAgXtAbGluayAjcGlja3VwfSDjgajlkIzjgZjjgafjgZnjgIJcbiAqIEBpbmhlcml0ZG9jICNyYW5kb21cbiAqIFxuICogQHRoaXMge0FycmF5fVxuICogQHBhcmFtIHtudW1iZXJ9IG1pblxuICogQHBhcmFtIHtudW1iZXJ9IG1heFxuICovXG5mdW5jdGlvbiBsb3QobWluLCBtYXgpIHtcbi8vIEFycmF5LnByb3RvdHlwZS4kbWV0aG9kKFwibG90XCIsIGZ1bmN0aW9uKG1pbiwgbWF4KSB7XG4gIG1pbiA9IG1pbiB8fCAwO1xuICBtYXggPSBtYXggfHwgdGhpcy5sZW5ndGgtMTtcbiAgcmV0dXJuIHRoaXNbcmFuZGludChtaW4sIG1heCkgXTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIHVuaXFcbiAqIOimgee0oOOBrumHjeikh+OCkuWPluOCiumZpOOBhOOBn+mFjeWIl+OCkueUn+aIkOOBl+OBpui/lOOBl+OBvuOBmeOAglxuICpcbiAqIOiHquWIhuiHqui6q+OBr+egtOWjiuOBleOCjOOBvuOBm+OCk+OAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyID0gWzEsIDIsIDMsIDQsIDMsIDJdO1xuICogICAgIGFyci51bmlxKCk7IC8vID0+IFsxLCAyLCAzLCA0XVxuICpcbiAqIEB0aGlzIEFycmF5XG4gKiBAcGFyYW0ge051bWJlcn0gW2RlZXBdIOacquS9v+eUqFxuICogQHJldHVybiB7T2JqZWN0fSDmlrDjgZfjgYTphY3liJdcbiAqL1xuZnVuY3Rpb24gdW5pcShkZWVwKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcInVuaXFcIiwgZnVuY3Rpb24oZGVlcCkge1xuICByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24odmFsdWUsIGluZGV4LCBzZWxmKSB7XG4gICAgcmV0dXJuIHNlbGYuaW5kZXhPZih2YWx1ZSkgPT09IGluZGV4O1xuICB9KTtcbn1cblxuXG4vKipcbiAqIEBtZXRob2QgZmxhdHRlblxuICog6Ieq6Lqr44KS5YaN5biw55qE44Gr5bmz5ruR5YyW44GX44Gf6YWN5YiX44KS55Sf5oiQ44GX44Gm6L+U44GX44G+44GZ44CCXG4gKlxuICogbGV2ZWwg44KS5oyH5a6a44GX44Gq44GR44KM44Gw5rex44GV44Gu6Zqb6ZmQ44Gq44GP5a6M5YWo44Gr5bmz5ruR5YyW44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBhcnIgPSBbMSwgMiwgWzMsIFs0LCA1XV1dO1xuICogICAgIGFyci5mbGF0dGVuKCk7ICAvLyA9PiBbMSwgMiwgMywgNCwgNV1cbiAqICAgICBhcnIuZmxhdHRlbigxKTsgLy8gPT4gWzEsIDIsIDMsIFs0LCA1XV1cbiAqXG4gKiBAdGhpcyBBcnJheTxBcnJheT5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbbGV2ZWw9MF0gIOW5s+a7keWMluOBruWGjeW4sOOBrua3seOBlVxuICogQHJldHVybiB7T2JqZWN0fSDlubPmu5HljJbjgZfjgZ/phY3liJdcbiAqL1xuZnVuY3Rpb24gZmxhdHRlbihsZXZlbCkge1xuLy8gQXJyYXkucHJvdG90eXBlLiRtZXRob2QoXCJmbGF0dGVuXCIsIGZ1bmN0aW9uKGxldmVsKSB7XG4gIHZhciBhcnIgPSBudWxsO1xuXG4gIGlmIChsZXZlbCkge1xuICAgIGFyciA9IHRoaXM7XG4gICAgZm9yICh2YXIgaT0wOyBpPGxldmVsOyArK2kpIHtcbiAgICAgIGFyciA9IEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sIGFycik7XG4gICAgfVxuICB9XG4gIGVsc2Uge1xuICAgIC8vIOWujOWFqOODleODqeODg+ODiFxuICAgIGFyciA9IHRoaXMucmVkdWNlKGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlLCBjdXJlbnRWYWx1ZSkge1xuICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoY3VyZW50VmFsdWUpID9cbiAgICAgICAgLy8gcHJldmlvdXNWYWx1ZS5jb25jYXQoY3VyZW50VmFsdWUuZmxhdHRlbigpKSA6IHByZXZpb3VzVmFsdWUuY29uY2F0KGN1cmVudFZhbHVlKTtcbiAgICAgICAgcHJldmlvdXNWYWx1ZS5jb25jYXQoZmxhdHRlbi5jYWxsKGN1cmVudFZhbHVlKSkgOiBwcmV2aW91c1ZhbHVlLmNvbmNhdChjdXJlbnRWYWx1ZSk7XG4gICAgfSwgW10pO1xuICB9XG5cbiAgcmV0dXJuIGFycjtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGZpbGxcbiAqIEBjaGFpbmFibGVcbiAqIOiHqui6q+OBruS4gOmDqOOBruimgee0oOOCkueJueWumuOBruWApOOBp+Wfi+OCgeOBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyID0gWzEsIDIsIDMsIDQsIDVdO1xuICogICAgIGFyci5maWxsKFwieFwiKTsgICAgICAgLy8gPT4gW1wieFwiLCBcInhcIiwgXCJ4XCIsIFwieFwiLCBcInhcIl1cbiAqICAgICBhcnIuZmlsbChcInhcIiwgMiwgNCk7IC8vID0+IFsxLCAyLCBcInhcIiwgXCJ4XCIsIDVdXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWx1ZSDln4vjgoHjgovlgKRcbiAqIEBwYXJhbSB7TnVtYmVyfSBbc3RhcnQ9MF0g5YCk44KS5Z+L44KB44KL5pyA5Yid44Gu44Kk44Oz44OH44OD44Kv44K5XG4gKiBAcGFyYW0ge051bWJlcn0gW2VuZD3oh6rouqvjga7phY3liJfjga7plbfjgZVdIOWApOOCkuWfi+OCgeOCi+acgOW+jOOBruOCpOODs+ODh+ODg+OCr+OCuSsxXG4gKi9cbmZ1bmN0aW9uIGZpbGwodmFsdWUsIHN0YXJ0LCBlbmQpIHtcbi8vIEFycmF5LnByb3RvdHlwZS4kbWV0aG9kKFwiZmlsbFwiLCBmdW5jdGlvbih2YWx1ZSwgc3RhcnQsIGVuZCkge1xuICBzdGFydCA9IHN0YXJ0IHx8IDA7XG4gIGVuZCAgID0gZW5kICAgfHwgKHRoaXMubGVuZ3RoKTtcbiAgXG4gIGZvciAodmFyIGk9c3RhcnQ7IGk8ZW5kOyArK2kpIHtcbiAgICB0aGlzW2ldID0gdmFsdWU7XG4gIH1cbiAgXG4gIHJldHVybiB0aGlzO1xufVxuXG5cbi8qKlxuICogQG1ldGhvZCBzaHVmZmxlXG4gKiBAY2hhaW5hYmxlXG4gKiDoh6rouqvjga7opoHntKDjgpLjg6njg7Pjg4Djg6Djgavjgrfjg6Pjg4Pjg5Xjg6vjgZfjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIGFyciA9IFsxLCAyLCAzLCA0LCA1XTtcbiAqICAgICBhcnIuc2h1ZmZsZSgpOyAvLyA9PiBbNSwgMSwgNCwgMiwgM10g44Gq44GpXG4gKiBcbiAqIEB0aGlzIEFycmF5XG4gKi9cbmZ1bmN0aW9uIHNodWZmbGUoKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcInNodWZmbGVcIiwgZnVuY3Rpb24oKSB7XG4gIGZvciAodmFyIGk9MCxsZW49dGhpcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcbiAgICB2YXIgaiA9IHJhbmRpbnQoMCwgbGVuLTEpO1xuICAgIFxuICAgIGlmIChpICE9IGopIHtcbiAgICAgIC8vIHRoaXMuc3dhcChpLCBqKTtcbiAgICAgIHN3YXAuY2FsbCh0aGlzLCBpLCBqKTtcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiB0aGlzO1xufVxuXG4vKipcbiAqIEBtZXRob2Qgc3VtXG4gKiDopoHntKDjga7lkIjoqIjlgKTjgpLov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiDopoHntKDjgavmlbDlgKTku6XlpJbjgYzlkKvjgb7jgozjgovloLTlkIjjga7mjJnli5Xjga/kuI3lrprjgafjgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIGFyciA9IFsxLCAyLCAzLCA0LCA1LCA2XTtcbiAqICAgICBhcnIuc3VtKCk7IC8vID0+IDIxXG4gKlxuICogQHRoaXMgQXJyYXlcbiAqIEByZXR1cm4ge051bWJlcn0g5ZCI6KiIXG4gKi9cbmZ1bmN0aW9uIHN1bSgpIHtcbi8vIEFycmF5LnByb3RvdHlwZS4kbWV0aG9kKFwic3VtXCIsIGZ1bmN0aW9uKCkge1xuICB2YXIgc3VtID0gMDtcbiAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xuICAgIHN1bSArPSB0aGlzW2ldO1xuICB9XG4gIHJldHVybiBzdW07XG59XG5cbi8qKlxuICogQG1ldGhvZCBhdmVyYWdlXG4gKiDopoHntKDjga7lubPlnYflgKTjgpLov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiDopoHntKDjgavmlbDlgKTku6XlpJbjgYzlkKvjgb7jgozjgovloLTlkIjjga7mjJnli5Xjga/kuI3lrprjgafjgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIGFyciA9IFsxLCAyLCAzLCA0LCA1LCA2XVxuICogICAgIGFyci5hdmVyYWdlKCk7IC8vID0+IDMuNVxuICpcbiAqIEB0aGlzIEFycmF5XG4gKiBAcmV0dXJuIHtOdW1iZXJ9IOW5s+Wdh+WApFxuICovXG5mdW5jdGlvbiBhdmVyYWdlKCkge1xuLy8gQXJyYXkucHJvdG90eXBlLiRtZXRob2QoXCJhdmVyYWdlXCIsIGZ1bmN0aW9uKCkge1xuICB2YXIgc3VtID0gMDtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoO1xuICBmb3IgKHZhciBpPTA7IGk8bGVuOyArK2kpIHtcbiAgICBzdW0gKz0gdGhpc1tpXTtcbiAgfVxuICByZXR1cm4gc3VtL2xlbjtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGVhY2hcbiAqIEBjaGFpbmFibGVcbiAqIOimgee0oOOCkumghueVquOBq+a4oeOBl+OBquOBjOOCiemWouaVsOOCkue5sOOCiui/lOOBl+Wun+ihjOOBl+OBvuOBmeOAglxuICpcbiAqIOODoeOCveODg+ODieODgeOCp+ODvOODs+OBq+WvvuW/nOOBl+OBpuOBhOOBvuOBmeOBjOOAgeOBk+OBruODoeOCveODg+ODieOBq+OCiOOBo+OBpuiHquWIhuiHqui6q+OBr+WkieWMluOBl+OBvuOBm+OCk+OAglxuICpcbiAqICMjI1JlZmVyZW5jZVxuICogLSBbQXJyYXkucHJvdG90eXBlLmZvckVhY2goKSAtIEphdmFTY3JpcHQgfCBNRE5dKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2phL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L2ZvckVhY2gpXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBhcnIgPSBbMSwgMiwgM107XG4gKiAgICAgYXJyLmVhY2goIGZ1bmN0aW9uKGVsbSkge1xuICogICAgICAgY29uc29sZS5sb2coZWxtICogZWxtKVxuICogICAgIH0pO1xuICogICAgIC8vID0+IDFcbiAqICAgICAvLyAgICA0XG4gKiAgICAgLy8gICAgOVxuICpcbiAqIEB0aGlzIEFycmF5XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayDlkITopoHntKDjgavlr77jgZfjgablrp/ooYzjgZnjgovjgrPjg7zjg6vjg5Djg4Pjgq/plqLmlbBcbiAqIEBwYXJhbSB7T2JqZWN0fSBbc2VsZl0gY2FsbGJhY2sg5YaF44GnIHRoaXMg44Go44GX44Gm5Y+C54Wn44GV44KM44KL5YCkXG4gKi9cbmZ1bmN0aW9uIGVhY2gkMShjYWxsYmFjaywgc2VsZikge1xuICB0aGlzLmZvckVhY2guY2FsbCh0aGlzLCBjYWxsYmFjaywgc2VsZiB8fCB0aGlzKTtcbiAgcmV0dXJuIHRoaXM7XG59XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcImVhY2hcIiwgZnVuY3Rpb24oKSB7XG4vLyAgIHRoaXMuZm9yRWFjaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuLy8gICByZXR1cm4gdGhpcztcbi8vIH1cblxuLy8gLyoqXG4vLyAgKiBAbWV0aG9kIHRvVUxFbGVtZW50XG4vLyAgKiBVTEVsZW1lbnQg44Gr5aSJ5o+b44GX44G+44GZ77yI5pyq5a6f6KOF77yJXG4vLyAgKi9cbi8vIEFycmF5LnByb3RvdHlwZS4kbWV0aG9kKFwidG9VTEVsZW1lbnRcIiwgZnVuY3Rpb24oKXtcbi8vICAgICAvLyBUT0RPOiBcbi8vIH0pO1xuXG4vLyAvKipcbi8vICAqIEBtZXRob2QgdG9PTEVsZW1lbnRcbi8vICAqIE9MRWxlbWVudCDjgavlpInmj5vjgZfjgb7jgZnvvIjmnKrlrp/oo4XvvIlcbi8vICAqL1xuLy8gQXJyYXkucHJvdG90eXBlLiRtZXRob2QoXCJ0b09MRWxlbWVudFwiLCBmdW5jdGlvbigpe1xuLy8gICAgIC8vIFRPRE86XG4vLyB9KTtcblxuLyoqXG4gKiBAbWV0aG9kIG1vc3RcbiAqIOaMh+WumuOBl+OBn+mWouaVsOOBrui/lOOCiuWApOOBjOacgOWwj+OBqOOBquOCi+imgee0oOOBqOacgOWkp+OBqOOBquOCi+imgee0oOOCkuOBvuOBqOOCgeOBpui/lOOBl+OBvuOBmeOAglxuICpcbiAqIOepuuOBrumFjeWIl+OBq+WvvuOBl+OBpuWun+ihjOOBmeOCi+OBqCB7bWF4OiBJbmZpbml0eSwgbWluOiAtSW5maW5pdHl9IOOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgWzUsMSw0LDEsOSwyLC0xMF0ubW9zdCgpOyAvLyA9PiB7bWF4OjksIG1pbjogLTEwfVxuICpcbiAqICAgICBwb2ludHMgPSBbIHt4OjAsIHk6MH0sIHt4OjY0MCwgeTo5NjB9LCB7eDotODAsIHk6MTAwfSBdO1xuICogICAgIHBvaW50cy5tb3N0KGZ1bmN0aW9uKGUpe3JldHVybiBlLng7fSkubWluOyAvLyA9PiBbeDotODAsIHk6MTAwXVxuICogICAgIHBvaW50cy5tb3N0KGZ1bmN0aW9uKGUpe3JldHVybiBlLnk7fSkubWF4OyAvLyA9PiBbeDo2NDAsIHk6OTYwXVxuICogXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBBcnJheU1vc3RSZXR1cm5WYWx1ZSBtYXgg44GoIG1pbiDjgpLjgq3jg7zjgavmjIHjgaTjgqrjg5bjgrjjgqfjgq/jg4hcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBtaW4gLSDplqLmlbDjga7ov5TjgorlgKTjgYzmnIDlsI/jgajjgarjgovopoHntKBcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBtYXggLSDplqLmlbDjga7ov5TjgorlgKTjgYzmnIDlpKfjgajjgarjgovopoHntKBcbiAqXG4gKiBAdGhpcyBBcnJheTxudW1iZXI+XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbZnVuY10g5ZCE6KaB57Sg44Gr5a++44GX44Gm5a6f6KGM44GZ44KL44Kz44O844Or44OQ44OD44Kv6Zai5pWwXG4gKiBAcGFyYW0ge09iamVjdH0gW3NlbGY9dGhpc10g6Zai5pWw5YaF44GnIHRoaXMg44Go44GX44Gm5Y+C54Wn44GV44KM44KL5YCk44CC44OH44OV44Kp44Or44OI44Gv6Ieq5YiG6Ieq6Lqr44CCXG4gKiBAcmV0dXJuIHtBcnJheU1vc3RSZXR1cm5WYWx1ZX1cbiAqL1xuZnVuY3Rpb24gbW9zdChmdW5jLCBzZWxmKSB7XG4vLyBBcnJheS5wcm90b3R5cGUuJG1ldGhvZChcIm1vc3RcIiwgZnVuY3Rpb24oZnVuYywgc2VsZikge1xuICBpZih0aGlzLmxlbmd0aCA8IDEpe1xuICAgIHJldHVybiB7XG4gICAgICBtYXg6IC1JbmZpbml0eSxcbiAgICAgIG1pbjogSW5maW5pdHksXG4gICAgfTtcbiAgfVxuICBpZihmdW5jKXtcbiAgICB2YXIgbWF4VmFsdWUgPSAtSW5maW5pdHk7XG4gICAgdmFyIG1pblZhbHVlID0gSW5maW5pdHk7XG4gICAgdmFyIG1heEluZGV4ID0gMDtcbiAgICB2YXIgbWluSW5kZXggPSAwO1xuICAgIFxuICAgIGlmKHR5cGVvZiBzZWxmID09PSAndW5kZWZpbmVkJyl7c2VsZiA9IHRoaXM7fVxuICAgIFxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICB2YXIgdiA9IGZ1bmMuY2FsbChzZWxmLCB0aGlzW2ldLCBpLCB0aGlzKTtcbiAgICAgIGlmKG1heFZhbHVlIDwgdil7XG4gICAgICAgIG1heFZhbHVlID0gdjtcbiAgICAgICAgbWF4SW5kZXggPSBpO1xuICAgICAgfVxuICAgICAgaWYobWluVmFsdWUgPiB2KXtcbiAgICAgICAgbWluVmFsdWUgPSB2O1xuICAgICAgICBtaW5JbmRleCA9IGk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBtYXg6IHRoaXNbbWF4SW5kZXhdLFxuICAgICAgbWluOiB0aGlzW21pbkluZGV4XSxcbiAgICB9O1xuICB9XG4gIGVsc2Uge1xuICAgIHZhciBtYXggPSAtSW5maW5pdHk7XG4gICAgdmFyIG1pbiA9IEluZmluaXR5O1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLmxlbmd0aDtpIDwgbGVuOyArK2kpIHtcbiAgICAgIGlmKG1heDx0aGlzW2ldKXttYXg9dGhpc1tpXTt9XG4gICAgICBpZihtaW4+dGhpc1tpXSl7bWluPXRoaXNbaV07fVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgbWF4OiBtYXgsXG4gICAgICBtaW46IG1pbixcbiAgICB9O1xuICB9XG4gIFxufSAgXG5cblxuLy8gPT09PT09PT09PVxuLy8g5Lul5LiL44GvZXMyMDE15Lul6ZmN44Gr5a2Y5Zyo44GZ44KL44Gf44KB44CB5L+d55WZXG4vLyA9PT09PT09PT09XG5cblxuLy8gLyoqXG4vLyAgKiBAbWV0aG9kIGZpbmRcbi8vICAqIOWQhOimgee0oOOCkuW8leaVsOOBq+OBl+OBpumWouaVsOOCkuWun+ihjOOBl+OAgeOBneOBruWApOOBjOecn+OBqOOBquOCi++8iO+8neadoeS7tuOBq+ODnuODg+ODgeOBmeOCi++8ieacgOWIneOBruimgee0oOOCkui/lOOBl+OBvuOBmeOAglxuLy8gICpcbi8vICAqIOOBqeOBruimgee0oOOCguODnuODg+ODgeOBl+OBquOBkeOCjOOBsCB1bmRlZmluZWQg44KS6L+U44GX44G+44GZ44CCXG4vLyAgKlxuLy8gICogIyMjIEV4YW1wbGVcbi8vICAqICAgICBhcnIgPSBbJ2ZvbycsICdiYXInLCAnaG9nZScsICdmdWdhJ107XG4vLyAgKiAgICAgYXJyLmZpbmQoIGZ1bmN0aW9uKGVsbSkge1xuLy8gICogICAgICAgcmV0dXJuIGVsbS5pbmRleE9mKCdhJykgPj0gMDtcbi8vICAqICAgICB9KTtcbi8vICAqICAgICAvLyA9PiAnYmFyJ1xuLy8gICpcbi8vICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIOWQhOimgee0oOOBq+WvvuOBl+OBpuWun+ihjOOBmeOCi+OCs+ODvOODq+ODkOODg+OCr+mWouaVsFxuLy8gICogQHBhcmFtIHtPYmplY3R9IFtzZWxmPXRoaXNdIGNhbGxiYWNrIOWGheOBpyB0aGlzIOOBqOOBl+OBpuWPgueFp+OBleOCjOOCi+WApOOAguODh+ODleOCqeODq+ODiOOBr+WRvOOBs+WHuuOBl+aZguOBriB0aGlz44CCXG4vLyAgKiBAcmV0dXJuIHtPYmplY3R9IOadoeS7tuOBq+ODnuODg+ODgeOBl+OBn+acgOWIneOBruimgee0oOOAgeOBvuOBn+OBryB1bmRlZmluZWRcbi8vICAqL1xuLy8gQXJyYXkucHJvdG90eXBlLiRtZXRob2QoXCJmaW5kXCIsIGZ1bmN0aW9uKGZuLCBzZWxmKSB7XG4vLyAgIHZhciB0YXJnZXQgPSBudWxsO1xuXG4vLyAgIHRoaXMuc29tZShmdW5jdGlvbihlbG0sIGkpIHtcbi8vICAgICBpZiAoZm4uY2FsbChzZWxmLCBlbG0sIGksIHRoaXMpKSB7XG4vLyAgICAgICB0YXJnZXQgPSBlbG07XG4vLyAgICAgICByZXR1cm4gdHJ1ZTtcbi8vICAgICB9XG4vLyAgIH0pO1xuXG4vLyAgIHJldHVybiB0YXJnZXQ7XG4vLyB9KTtcblxuLy8gLyoqXG4vLyAgKiBAbWV0aG9kIGZpbmRJbmRleFxuLy8gICog5ZCE6KaB57Sg44KS5byV5pWw44Gr44GX44Gm6Zai5pWw44KS5a6f6KGM44GX44CB44Gd44Gu5YCk44GM55yf44Go44Gq44KL77yI77yd5p2h5Lu244Gr44Oe44OD44OB44GZ44KL77yJ5pyA5Yid44Gu44Kk44Oz44OH44OD44Kv44K544KS6L+U44GX44G+44GZ44CCXG4vLyAgKlxuLy8gICog44Gp44Gu6KaB57Sg44KC44Oe44OD44OB44GX44Gq44GR44KM44GwIC0xIOOCkui/lOOBl+OBvuOBmeOAglxuLy8gICpcbi8vICAqICMjIyBFeGFtcGxlXG4vLyAgKiAgICAgYXJyID0gWydmb28nLCAnYmFyJywgJ2hvZ2UnLCAnZnVnYSddO1xuLy8gICogICAgIGFyci5maW5kSW5kZXgoIGZ1bmN0aW9uKGVsbSkge1xuLy8gICogICAgICAgcmV0dXJuIGVsbS5pbmRleE9mKCdhJykgPj0gMDtcbi8vICAqICAgICB9KTtcbi8vICAqICAgICAvLyA9PiAxXG4vLyAgKlxuLy8gICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sg5ZCE6KaB57Sg44Gr5a++44GX44Gm5a6f6KGM44GZ44KL44Kz44O844Or44OQ44OD44Kv6Zai5pWwXG4vLyAgKiBAcGFyYW0ge09iamVjdH0gW3NlbGY9dGhpc10gY2FsbGJhY2sg5YaF44GnIHRoaXMg44Go44GX44Gm5Y+C54Wn44GV44KM44KL5YCk44CC44OH44OV44Kp44Or44OI44Gv5ZG844Gz5Ye644GX5pmC44GuIHRoaXPjgIJcbi8vICAqIEByZXR1cm4ge09iamVjdH0g5p2h5Lu244Gr44Oe44OD44OB44GX44Gf5pyA5Yid44Gu44Kk44Oz44OH44OD44Kv44K544CB44G+44Gf44GvIC0xXG4vLyAgKi9cbi8vIEFycmF5LnByb3RvdHlwZS4kbWV0aG9kKFwiZmluZEluZGV4XCIsIGZ1bmN0aW9uKGZuLCBzZWxmKSB7XG4vLyAgIHZhciB0YXJnZXQgPSAtMTtcblxuLy8gICB0aGlzLnNvbWUoZnVuY3Rpb24oZWxtLCBpKSB7XG4vLyAgICAgaWYgKGZuLmNhbGwoc2VsZiwgZWxtLCBpLCB0aGlzKSkge1xuLy8gICAgICAgdGFyZ2V0ID0gaTtcbi8vICAgICAgIHJldHVybiB0cnVlO1xuLy8gICAgIH1cbi8vICAgfSk7XG5cbi8vICAgcmV0dXJuIHRhcmdldDtcbi8vIH0pO1xuXG4vKipcbiAqIEBtZXRob2Qgb2ZcbiAqIEBzdGF0aWNcbiAqIEVTNiDmupbmi6Djga4gb2Yg6Zai5pWw44Gn44GZ44CC5Y+v5aSJ6ZW35byV5pWw44KS44Go44Gj44GmIEFycmF5IOOCquODluOCuOOCp+OCr+ODiOOBq+OBl+OBpui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgQXJyYXkub2YoKTsgICAgICAgIC8vID0+IFtdXG4gKiAgICAgQXJyYXkub2YoMSwgMiwgMyk7IC8vID0+IFsxLCAyLCAzXVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50TiDnlJ/miJDjgZnjgovphY3liJfjga7opoHntKBcbiAqIEByZXR1cm4ge0FycmF5fSDnlJ/miJDjgZfjgZ/phY3liJdcbiAqL1xuLy8gQXJyYXkuJG1ldGhvZChcIm9mXCIsIGZ1bmN0aW9uKCkge1xuLy8gICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbi8vIH0pO1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbVxuICogQHN0YXRpY1xuICogRVM2IOa6luaLoOOBriBmcm9tIOmWouaVsOOBp+OBmeOAgmFycmF5LWxpa2Ug44Kq44OW44K444Kn44Kv44OI44GLaXRlcmFibGUg44Kq44OW44K444Kn44Kv44OI44GL44KJ5paw44GX44GE6YWN5YiX44KS55Sf5oiQ44GX44G+44GZ44CCXG4gKlxuICogYXJyYXktbGlrZSDjgqrjg5bjgrjjgqfjgq/jg4jjgajjga/jgIFsZW5ndGgg44OX44Ot44OR44OG44Kj44KS5oyB44Gh44CB5pWw5a2X44Gu5re75a2X44Gn44Ki44Kv44K744K55Y+v6IO944Gq44Kq44OW44K444Kn44Kv44OI44Gu44GT44Go44Gn44GZ44CCXG4gKiDpgJrluLjjga7phY3liJfjga7jgbvjgYvjgIFTdHJpbmfjgIFhcmd1bWVudHPjgIFOb2RlTGlzdCDjgarjganjgoIgYXJyYXktbGlrZSDjgqrjg5bjgrjjgqfjgq/jg4jjgafjgZnjgIJcbiAqXG4gKiBpdGVyYWJsZSDjgqrjg5bjgrjjgqfjgq/jg4jjgajjga/jgIFTeW1ib2wuaXRlcmF0b3Ig44OX44Ot44OR44OG44Kj44KS5oyB44Gk44Kq44OW44K444Kn44Kv44OI44Gu44GT44Go44Gn44GZ44CCXG4gKiDpgJrluLjjga7phY3liJfjga7jgbvjgYvjgIFTdHJpbmfjgIFhcmd1bWVudHPjgIFOb2RlTGlzdCDjgarjganjgoIgaXRlcmFibGUg44Kq44OW44K444Kn44Kv44OI44Gn44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBBcnJheS5mcm9tKFsxLCAyLCAzXSwgZnVuY3Rpb24oZWxtKXsgcmV0dXJuIGVsbSAqIGVsbX0gKTsgLy8gPT4gWzEsIDQsIDldXG4gKiAgICAgQXJyYXkuZnJvbShcImZvb1wiKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gPT4gW1wiZlwiLCBcIm9cIiwgXCJvXCJdXG4gKiAgICAgQXJyYXkuZnJvbSggZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcInNwYW5cIikpICAgICAgICAgICAgLy8gPT4gW0VsZW1lbnQsIEVsZW1lbnQsIEVsZW1lbnQsLi4uXVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBhcnJheUxpa2Ug6YWN5YiX44Gr5aSJ5o+b44GZ44KLIGFycmF5LWxpa2Ug44Kq44OW44K444Kn44Kv44OIXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2tdIGFycmF5TGlrZSDjga7jgZnjgbnjgabjga7opoHntKDjgavlr77jgZfjgablrp/ooYzjgZnjgovjg57jg4Pjg5fplqLmlbBcbiAqIEBwYXJhbSB7T2JqZWN0fSBbY29udGV4dF0gY2FsbGJhY2sg5YaF44GnIHRoaXMg44Go44GX44Gm5Y+C54Wn44GV44KM44KL5YCkXG4gKiBAcmV0dXJuIHtBcnJheX0g55Sf5oiQ44GX44Gf6YWN5YiXXG4gKi9cbi8vIEFycmF5LiRtZXRob2QoXCJmcm9tXCIsIGZ1bmN0aW9uKGFycmF5TGlrZSwgY2FsbGJhY2ssIGNvbnRleHQpIHtcbi8vICAgaWYgKCFPYmplY3QoYXJyYXlMaWtlKS5sZW5ndGgpIHJldHVybiBbXTtcblxuLy8gICB2YXIgcmVzdWx0ID0gW107XG4vLyAgIGlmIChTeW1ib2wgJiYgU3ltYm9sLml0ZXJhdG9yICYmIGFycmF5TGlrZVtTeW1ib2wuaXRlcmF0b3JdKSB7XG4vLyAgICAgICB2YXIgaXRlcmF0b3IgPSBhcnJheUxpa2VbU3ltYm9sLml0ZXJhdG9yXSgpO1xuLy8gICAgICAgd2hpbGUgKHRydWUpIHtcbi8vICAgICAgICAgICB2YXIgaXRlcmF0b3JSZXN1bHQgPSBpdGVyYXRvci5uZXh0KCk7XG4vLyAgICAgICAgICAgaWYgKGl0ZXJhdG9yUmVzdWx0LmRvbmUpIGJyZWFrO1xuXG4vLyAgICAgICAgICAgdmFyIHZhbHVlID0gdHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nID8gY2FsbGJhY2suYmluZChjb250ZXh0IHx8IHRoaXMpKGl0ZXJhdG9yUmVzdWx0LnZhbHVlKSA6IGl0ZXJhdG9yUmVzdWx0LnZhbHVlO1xuLy8gICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbi8vICAgICAgIH1cbi8vICAgICAgIHJldHVybiByZXN1bHQ7XG4vLyAgIH1cblxuLy8gICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJyYXlMaWtlLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4vLyAgICAgICByZXN1bHQucHVzaChhcnJheUxpa2VbaV0pO1xuLy8gICB9XG4vLyAgIHJldHVybiByZXN1bHQubWFwKHR5cGVvZiBjYWxsYmFjayA9PSAnZnVuY3Rpb24nID8gY2FsbGJhY2sgOiBmdW5jdGlvbihpdGVtKSB7XG4vLyAgICAgcmV0dXJuIGl0ZW07XG4vLyAgIH0sIGNvbnRleHQpO1xuLy8gfSk7XG5cbnZhciBhcnJheUV4dGVuc2lvbnMgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgZmlyc3Q6IGZpcnN0LFxuICBsYXN0OiBsYXN0LFxuICBhdDogYXQsXG4gIGVyYXNlOiBlcmFzZSxcbiAgY2xlYXI6IGNsZWFyLFxuICBjb250YWluczogY29udGFpbnMsXG4gIGNsb25lOiBjbG9uZSxcbiAgcmFuZ2U6IHJhbmdlLFxuICBlcXVhbHM6IGVxdWFscyxcbiAgZGVlcEVxdWFsczogZGVlcEVxdWFscyxcbiAgc3dhcDogc3dhcCxcbiAgZXJhc2VBbGw6IGVyYXNlQWxsLFxuICBlcmFzZUlmOiBlcmFzZUlmLFxuICBlcmFzZUlmQWxsOiBlcmFzZUlmQWxsLFxuICByYW5kb206IHJhbmRvbSxcbiAgcGlja3VwOiBwaWNrdXAsXG4gIGxvdDogbG90LFxuICB1bmlxOiB1bmlxLFxuICBmbGF0dGVuOiBmbGF0dGVuLFxuICBmaWxsOiBmaWxsLFxuICBzaHVmZmxlOiBzaHVmZmxlLFxuICBzdW06IHN1bSxcbiAgYXZlcmFnZTogYXZlcmFnZSxcbiAgZWFjaDogZWFjaCQxLFxuICBtb3N0OiBtb3N0XG59KTtcblxuLyoqXG4gKiDjgqLjgq/jgrvjgrXmi6HlvLXnlKjjgqrjg5bjgrjjgqfjgq/jg4hcbiAqIEB0eXBlZGVmIHt7Z2V0OiAoKT0+IGFueSwgc2V0OiAodjphbnkpPT4gdm9pZH19IEFjY2Vzc29yRXh0ZW5kT2JqZWN0XG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBfY3JlYXRvcjogYW55XG4gKiAgIF9oaWVyYXJjaGllczogUGhpbmFDbGFzc1tdXG4gKiAgIGluaXQ6IGZ1bmN0aW9uXG4gKiAgIHN1cGVyQ2xhc3M/OiBhbnlcbiAqICAgc3VwZXJJbml0PzogZnVuY3Rpb25cbiAqICAgc3VwZXJNZXRob2Q/OiAobWV0aG9kTmFtZTogc3RyaW5nLCAuLi5hcmdzOmFueSkgPT4gYW55IC8vIOOCueODvOODkeODvOODoeOCveODg+ODieOBrue1kOaenFxuICogICBjb25zdHJ1Y3Rvcj86IGFueVxuICogICBbazogc3RyaW5nXTogYW55IC8vIOOBneOBruS7luOBruODl+ODreODkeODhuOCo1xuICogfX0gUGhpbmFDbGFzc1Byb3RvdHlwZVxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgcHJvdG90eXBlOiBQaGluYUNsYXNzUHJvdG90eXBlXG4gKiAgIFtrOiBzdHJpbmddOiBhbnkgLy8g44Gd44Gu5LuW44Guc3RhdGlj44OX44Ot44OR44OG44KjXG4gKiB9fSBQaGluYUNsYXNzXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDcmVhdGVDbGFzc1BhcmFtXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9uICYge293bmVyOiBhbnl9fSBwYXJhbXMuaW5pdCDjgq/jg6njgrnliJ3mnJ/ljJbplqLmlbBcbiAqIEBwcm9wZXJ0eSB7UGhpbmFDbGFzc30gW3BhcmFtcy5zdXBlckNsYXNzXSDjgrnjg7zjg5Hjg7zjgq/jg6njgrlcbiAqIEBwcm9wZXJ0eSB7e1trOiBzdHJpbmddOiBBY2Nlc3NvckV4dGVuZE9iamVjdH19IFtwYXJhbXMuX2FjY2Vzc29yXSDjgqLjgq/jgrvjgrXjgpLku5jkuI5cbiAqIEBwcm9wZXJ0eSB7e1trOiBzdHJpbmddOiBhbnl9fSBbcGFyYW1zLl9zdGF0aWNdIHN0YXRpY+ODl+ODreODkeODhuOCo+OCkuS7mOS4jlxuICogQHByb3BlcnR5IHtGdW5jdGlvbn0gW3BhcmFtcy5fZGVmaW5lZF0g5a6a576p5pmC44Gr5a6f6KGM44GX44Gf44GE6Zai5pWwXG4gKi9cblxudmFyIF9jbGFzc0RlZmluZWRDYWxsYmFjayA9IHt9O1xuXG52YXIgcGhpbmEgPSB7XG4gIC8qKlxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gVkVSU0lPTlxuICAgKiBAbWVtYmVyb2YgcGhpbmFcbiAgICogQHN0YXRpY1xuICAgKiBwaGluYS5qcyDjga7jg5Djg7zjgrjjg6fjg7PjgafjgZnjgIJcbiAgICovXG4gIFZFUlNJT046IFwiMC4yLjNcIixcblxuICAvKipcbiAgICogQG1ldGhvZCBpc05vZGVcbiAgICogTm9kZS5qcyDjga4gbW9kdWxlIOOBi+OBqeOBhuOBi+OCkuODgeOCp+ODg+OCr+OBl+OBvuOBmeOAglxuICAgKiBAbWVtYmVyb2YgcGhpbmFcbiAgICogQHN0YXRpY1xuICAgKi9cbiAgaXNOb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCI7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBtZXRob2QgbmFtZXNwYWNlXG4gICAqIOW8leaVsOOBr+mWouaVsOOBp+OAgeOBneOBrumWouaVsOWGheOBp+OBriB0aGlzIOOBryBwaGluYSDjgavjgarjgorjgb7jgZnjgIJcbiAgICogQG1lbWJlcm9mIHBoaW5hXG4gICAqIEBzdGF0aWNcbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4g6Zai5pWwXG4gICAqL1xuICBuYW1lc3BhY2U6IGZ1bmN0aW9uIChmbikge1xuICAgIGZuLmNhbGwodGhpcyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBtZXRob2QgdGVzdFVBXG4gICAqIOW8leaVsOOBriBSZWdFeHAg44Kq44OW44K444Kn44Kv44OI44Go44Om44O844K244O844Ko44O844K444Kn44Oz44OI44KS5q+U6LyD44GX44Gm6L+U44GX44G+44GZ44CCXG4gICAqIEBtZW1iZXJvZiBwaGluYVxuICAgKiBAc3RhdGljXG4gICAqXG4gICAqIEBwYXJhbSB7UmVnRXhwfSByZWdFeHBcbiAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICovXG4gIHRlc3RVQTogZnVuY3Rpb24gKHJlZ0V4cCkge1xuICAgIGlmICghdGhpcy5nbG9iYWwubmF2aWdhdG9yKSByZXR1cm4gZmFsc2U7XG4gICAgdmFyIHVhID0gdGhpcy5nbG9iYWwubmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICByZXR1cm4gcmVnRXhwLnRlc3QodWEpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGlzQW5kcm9pZFxuICAgKiBBbmRyb2lkIOOBi+OBqeOBhuOBi+OCkui/lOOBl+OBvuOBmeOAglxuICAgKiBAbWVtYmVyb2YgcGhpbmFcbiAgICogQHN0YXRpY1xuICAgKlxuICAgKiBAcmV0dXJuIHtCb29sZWFufSBBbmRyb2lkIOOBi+OBqeOBhuOBi1xuICAgKi9cbiAgaXNBbmRyb2lkOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMudGVzdFVBKC9BbmRyb2lkLyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBtZXRob2QgaXNJUGhvbmVcbiAgICogaVBob25lIOOBi+OBqeOBhuOBi+OCkui/lOOBl+OBvuOBmeOAglxuICAgKiBAbWVtYmVyb2YgcGhpbmFcbiAgICogQHN0YXRpY1xuICAgKlxuICAgKiBAcmV0dXJuIHtCb29sZWFufSBpUGhvbmUg44GL44Gp44GG44GLXG4gICAqL1xuICBpc0lQaG9uZTogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLnRlc3RVQSgvaVBob25lLyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBtZXRob2QgaXNJUGFkXG4gICAqIGlQYWQg44GL44Gp44GG44GL44KS6L+U44GX44G+44GZ44CCXG4gICAqIEBtZW1iZXJvZiBwaGluYVxuICAgKiBAc3RhdGljXG4gICAqXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IGlQYWQg44GL44Gp44GG44GLXG4gICAqL1xuICBpc0lQYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy50ZXN0VUEoL2lQYWQvKTtcbiAgfSxcblxuICAvKipcbiAgICogQG1ldGhvZCBpc0lPU1xuICAgKiBpT1Mg44GL44Gp44GG44GL44KS6L+U44GX44G+44GZ44CCXG4gICAqIEBtZW1iZXJvZiBwaGluYVxuICAgKiBAc3RhdGljXG4gICAqXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IGlPUyDjgYvjganjgYbjgYtcbiAgICovXG4gIGlzSU9TOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMudGVzdFVBKC9pUGhvbmV8aVBhZC8pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGlzTW9iaWxlXG4gICAqIOODouODkOOCpOODq+OBi+OBqeOBhuOBi+OCkui/lOOBl+OBvuOBmeOAguWFt+S9k+eahOOBq+OBryBBbmRyb2lkLCBpUGhvbmUsIGlQYWQg44Gu44GE44Ga44KM44GL44Gg44GoIHRydWUg44Gr44Gq44KK44G+44GZ44CCXG4gICAqIEBtZW1iZXJvZiBwaGluYVxuICAgKiBAc3RhdGljXG4gICAqXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IOODouODkOOCpOODq+OBi+OBqeOBhuOBi1xuICAgKi9cbiAgaXNNb2JpbGU6IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy50ZXN0VUEoL2lQaG9uZXxpUGFkfEFuZHJvaWQvKTtcbiAgfSxcblxuICAvKipcbiAgICogQG1ldGhvZCBjcmVhdGVDbGFzc1xuICAgKiDjgq/jg6njgrnjgpLkvZzmiJDjgZnjgovplqLmlbDjgafjgZnjgIJcbiAgICog6Kaq44Kv44Op44K544Gu5oyH5a6a44Gv5paH5a2X5YiX44Gn44KC5Y+v6IO944Gn44GZ44CCXG4gICAqIOS9leOCgue2meaJv+OBl+OBquOBhOWgtOWQiCBzdXBlckNsYXNzIOOBruaMh+WumuOBr+S4jeimgeOBp+OBmeOAguOBvuOBn+OAgeimquOCr+ODqeOCueOCkue2meaJv+OBl+OBpuOBhOOCi+WgtOWQiOOAgeOCs+ODs+OCueODiOODqeOCr+OCv+WGheOBpyB0aGlzLnN1cGVySW5pdCgpIOOCkuWun+ihjOOBl+OBpuimquOCr+ODqeOCueOCkuWIneacn+WMluOBmeOCi+OBk+OBqOOBjOW/hemgiOOBp+OBmeOAglxuICAgKiBAbWVtYmVyb2YgcGhpbmFcbiAgICogQHN0YXRpY1xuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgQ2xhc3MgPSBwaGluYS5jcmVhdGVDbGFzcyh7XG4gICAqICAgc3VwZXJDbGFzczogbmFtZXNwYWNlLlN1cGVyLC8v6Kaq44Kv44Op44K557aZ5om/XG4gICAqXG4gICAqICAgLy/jg6Hjg7Pjg5DlpInmlbBcbiAgICogICBtZW1iZXIxOiAxMDAsXG4gICAqICAgbWVtYmVyMjogJ3Rlc3QnLFxuICAgKiAgIG1lbWJlcjM6IG51bGwsXG4gICAqXG4gICAqICAgLy8g44Kz44Oz44K544OI44Op44Kv44K/XG4gICAqICAgLy8gQ2xhc3MoKeOCkuWRvOOBs+WHuuOBl+OBn+OBqOOBjeWun+ihjOOBleOCjOOCi1xuICAgKiAgIGluaXQ6IGZ1bmN0aW9uKGEsIGIpe1xuICAgKiAgICAgLy/jgrnjg7zjg5Hjg7zjgq/jg6njgrko57aZ5om/44GX44Gf44Kv44Op44K5KeOBrmluaXRcbiAgICogICAgIHRoaXMuc3VwZXJJbml0KGEsIGIpO1xuICAgKiAgICAgdGhpcy5hID0gYTtcbiAgICogICAgIHRoaXMuYiA9IGI7XG4gICAqICAgfSxcbiAgICpcbiAgICogICAvL+ODoeOCveODg+ODiVxuICAgKiAgIG1ldGhvZDE6IGZ1bmN0aW9uKCl7fSxcbiAgICogICBtZXRob2QyOiBmdW5jdGlvbigpe30sXG4gICAqXG4gICAqIH0pO1xuICAgKlxuICAgKiBAcGFyYW0ge0NyZWF0ZUNsYXNzUGFyYW19IHBhcmFtc1xuICAgKiBAcmV0dXJuIHtQaGluYUNsYXNzfSBwaGluYeOCr+ODqeOCuVxuICAgKi9cbiAgY3JlYXRlQ2xhc3M6IGZ1bmN0aW9uIChwYXJhbXMpIHtcblxuICAgIC8qKiBAdHlwZSB7UGhpbmFDbGFzc30gKi9cbiAgICB2YXIgX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGluc3RhbmNlID0gbmV3IF9jbGFzcy5wcm90b3R5cGUuX2NyZWF0b3IoKTtcbiAgICAgIF9jbGFzcy5wcm90b3R5cGUuaW5pdC5hcHBseShpbnN0YW5jZSwgYXJndW1lbnRzKTtcbiAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9O1xuXG4gICAgaWYgKHBhcmFtcy5zdXBlckNsYXNzKSB7XG4gICAgICBfY2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShwYXJhbXMuc3VwZXJDbGFzcy5wcm90b3R5cGUpO1xuICAgICAgcGFyYW1zLmluaXQub3duZXIgPSBfY2xhc3M7XG4gICAgICBfY2xhc3MucHJvdG90eXBlLnN1cGVySW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fX2NvdW50ZXIgPSB0aGlzLl9fY291bnRlciB8fCAwO1xuXG4gICAgICAgIHZhciBzdXBlckNsYXNzID0gdGhpcy5faGllcmFyY2hpZXNbdGhpcy5fX2NvdW50ZXIrK107XG4gICAgICAgIHZhciBzdXBlckluaXQgPSBzdXBlckNsYXNzLnByb3RvdHlwZS5pbml0O1xuICAgICAgICBzdXBlckluaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuICAgICAgICB0aGlzLl9fY291bnRlciA9IDA7XG4gICAgICB9O1xuICAgICAgX2NsYXNzLnByb3RvdHlwZS5zdXBlck1ldGhvZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApO1xuICAgICAgICB2YXIgbmFtZSA9IGFyZ3Muc2hpZnQoKTtcbiAgICAgICAgdGhpcy5fX2NvdW50ZXJzID0gdGhpcy5fX2NvdW50ZXJzIHx8IHt9O1xuICAgICAgICB0aGlzLl9fY291bnRlcnNbbmFtZV0gPSB0aGlzLl9fY291bnRlcnNbbmFtZV0gfHwgMDtcblxuICAgICAgICB2YXIgc3VwZXJDbGFzcyA9IHRoaXMuX2hpZXJhcmNoaWVzW3RoaXMuX19jb3VudGVyc1tuYW1lXSsrXTtcbiAgICAgICAgdmFyIHN1cGVyTWV0aG9kID0gc3VwZXJDbGFzcy5wcm90b3R5cGVbbmFtZV07XG4gICAgICAgIHZhciByc3QgPSBzdXBlck1ldGhvZC5hcHBseSh0aGlzLCBhcmdzKTtcblxuICAgICAgICB0aGlzLl9fY291bnRlcnNbbmFtZV0gPSAwO1xuXG4gICAgICAgIHJldHVybiByc3Q7XG4gICAgICB9O1xuICAgICAgX2NsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IF9jbGFzcztcbiAgICB9XG5cbiAgICAvLyAvL1xuICAgIC8vIHBhcmFtcy5mb3JJbihmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgLy8gICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgLy8gICAgIF9jbGFzcy4kbWV0aG9kKGtleSwgdmFsdWUpO1xuICAgIC8vICAgfVxuICAgIC8vICAgZWxzZSB7XG4gICAgLy8gICAgIF9jbGFzcy5wcm90b3R5cGVba2V5XSA9IHZhbHVlO1xuICAgIC8vICAgfVxuICAgIC8vIH0pO1xuICAgIC8vIOe2meaJv1xuICAgICRleHRlbmQuY2FsbChfY2xhc3MucHJvdG90eXBlLCBwYXJhbXMpO1xuICAgIC8vIF9jbGFzcy5wcm90b3R5cGUuJGV4dGVuZChwYXJhbXMpO1xuXG4gICAgLy8g57aZ5om/55SoXG4gICAgX2NsYXNzLnByb3RvdHlwZS5faGllcmFyY2hpZXMgPSBbXTtcbiAgICB2YXIgX3N1cGVyID0gX2NsYXNzLnByb3RvdHlwZS5zdXBlckNsYXNzO1xuICAgIHdoaWxlIChfc3VwZXIpIHtcbiAgICAgIF9jbGFzcy5wcm90b3R5cGUuX2hpZXJhcmNoaWVzLnB1c2goX3N1cGVyKTtcbiAgICAgIF9zdXBlciA9IF9zdXBlci5wcm90b3R5cGUuc3VwZXJDbGFzcztcbiAgICB9XG5cbiAgICAvLyBhY2Nlc3NvclxuICAgIGlmIChwYXJhbXMuX2FjY2Vzc29yKSB7XG4gICAgICAvLyBwYXJhbXMuX2FjY2Vzc29yLmZvckluKFxuICAgICAgZm9ySW4uY2FsbChcbiAgICAgICAgcGFyYW1zLl9hY2Nlc3NvcixcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAgICAgICAgICogQHBhcmFtIHtBY2Nlc3NvckV4dGVuZE9iamVjdH0gdmFsdWVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgICAgYWNjZXNzb3IuY2FsbChfY2xhc3MucHJvdG90eXBlLCBrZXksIHZhbHVlKTtcbiAgICAgICAgICAvLyBfY2xhc3MucHJvdG90eXBlLmFjY2Vzc29yKGtleSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICApO1xuICAgICAgLy8gX2NsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoX2NsYXNzLnByb3RvdHlwZSwgcGFyYW1zLl9hY2Nlc3Nvcik7XG4gICAgfVxuXG4gICAgX2NsYXNzLnByb3RvdHlwZS5fY3JlYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgX2NsYXNzLnByb3RvdHlwZS5fY3JlYXRvci5wcm90b3R5cGUgPSBfY2xhc3MucHJvdG90eXBlO1xuXG4gICAgLy8gc3RhdGljIHByb3BlcnR5L21ldGhvZFxuICAgIGlmIChwYXJhbXMuX3N0YXRpYykge1xuICAgICAgJGV4dGVuZC5jYWxsKF9jbGFzcywgcGFyYW1zLl9zdGF0aWMpO1xuICAgICAgLy8gX2NsYXNzLiRleHRlbmQocGFyYW1zLl9zdGF0aWMpO1xuICAgIH1cblxuICAgIGlmIChwYXJhbXMuX2RlZmluZWQpIHtcbiAgICAgIHBhcmFtcy5fZGVmaW5lZC5jYWxsKF9jbGFzcywgX2NsYXNzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gX2NsYXNzO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHVzaW5nXG4gICAqIOaWh+Wtl+WIl+OBp+Wumue+qeOBl+OBn+ODkeOCueOCkuS9v+OBo+OBpuOCquODluOCuOOCp+OCr+ODiOOCkuWPluOCiuWHuuOBl+OBvuOBmeOAguODkeOCueOBryAsIC4gLyBcXCA6OiDjgafljLrliIfjgovjgZPjgajjgYzjgafjgY3jgb7jgZnjgIJcbiAgICoge0BsaW5rICNwaGluYS5yZWdpc3Rlcn0g44Gn55m76Yyy44GX44Gf44Kq44OW44K444Kn44Kv44OI44KS5Y+W44KK5Ye644GZ44Go44GN44Gq44Gp44Gr5L2/44GG44Go5L6/5Yip44Gq6Zai5pWw44Gn44GZ44CCXG4gICAqIEBtZW1iZXJvZiBwaGluYVxuICAgKiBAc3RhdGljXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGhvZ2UgPSB7XG4gICAqICAgZm9vOiB7XG4gICAqICAgICBiYXI6IHtcbiAgICogICAgICAgbnVtOiAxMDBcbiAgICogICAgIH1cbiAgICogICB9XG4gICAqIH07XG4gICAqIHZhciBiYXIgPSBwaGluYS51c2luZygnaG9nZS5mb28uYmFyJyk7XG4gICAqIGNvbnNvbGUubG9nKGJhci5udW0pOyAvLyA9PiAxMDBcbiAgICpcbiAgICogQHBhcmFtIHtTdHJpbmd9IHBhdGgg44Kq44OW44K444Kn44Kv44OI44G444Gu44OR44K5XG4gICAqIEByZXR1cm4ge09iamVjdH0g5Y+W44KK5Ye644GX44Gf44Kq44OW44K444Kn44Kv44OIXG4gICAqL1xuICB1c2luZzogZnVuY3Rpb24gKHBhdGgpIHtcbiAgICBpZiAoIXBhdGgpIHtcbiAgICAgIHJldHVybiB0aGlzLmdsb2JhbDtcbiAgICB9XG5cbiAgICB2YXIgcGF0aGVzID0gcGF0aC5zcGxpdCgvWywuXFwvIF18OjovKTtcbiAgICB2YXIgY3VycmVudCA9IHRoaXMuZ2xvYmFsO1xuXG4gICAgcGF0aGVzLmZvckVhY2goZnVuY3Rpb24gKHApIHtcbiAgICAgIGN1cnJlbnQgPSBjdXJyZW50W3BdIHx8IChjdXJyZW50W3BdID0ge30pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGN1cnJlbnQ7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBtZXRob2QgcmVnaXN0ZXJcbiAgICog44OR44K55oyH5a6a44Gn44Kq44OW44K444Kn44Kv44OI44KS55m76Yyy44GZ44KL6Zai5pWw44Gn44GZ44CC44OR44K544GvICwgLiAvIFxcIDo6IOOBp+WMuuWIh+OCi+OBk+OBqOOBjOOBp+OBjeOBvuOBmeOAglxuICAgKiBAbWVtYmVyb2YgcGhpbmFcbiAgICogQHN0YXRpY1xuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBwaGluYS5yZWdpc3RlcignaG9nZS5mb28uYmFyJywge1xuICAgKiAgIG51bTogMTAwLFxuICAgKiB9KTtcbiAgICogY29uc29sZS5sb2coaG9nZS5mb28uYmFyLm51bSk7IC8vID0+IDEwMFxuICAgKlxuICAgKiBAcGFyYW0ge1N0cmluZ30gcGF0aCDnmbvpjLLjgZnjgovjgqrjg5bjgrjjgqfjgq/jg4jjga7jg5HjgrlcbiAgICogQHBhcmFtIHtPYmplY3R9IF9jbGFzcyDnmbvpjLLjgZnjgovjgqrjg5bjgrjjgqfjgq/jg4hcbiAgICogQHJldHVybiB7T2JqZWN0fSDnmbvpjLLjgZfjgZ/jgqrjg5bjgrjjgqfjgq/jg4hcbiAgICovXG4gIHJlZ2lzdGVyOiBmdW5jdGlvbiAocGF0aCwgX2NsYXNzKSB7XG4gICAgdmFyIHBhdGhlcyA9IHBhdGguc3BsaXQoL1ssLlxcLyBdfDo6Lyk7XG4gICAgLy8gdmFyIGNsYXNzTmFtZSA9IHBhdGhlcy5sYXN0O1xuICAgIHZhciBjbGFzc05hbWUgPSBsYXN0LmdldC5jYWxsKHBhdGhlcyk7XG4gICAgLy8gRklYTUU6IOOBk+OBk+OCkuebtOOBleOBquOBhOOBqOODlOODquOCquODieWMuuWIh+OCiuS7peWkluOBr+eEoeWKue+8n1xuICAgIHZhciBwYXJlbnRQYXRoID0gcGF0aC5zdWJzdHJpbmcoMCwgcGF0aC5sYXN0SW5kZXhPZihcIi5cIikpO1xuICAgIHZhciBwYXJlbnQgPSB0aGlzLnVzaW5nKHBhcmVudFBhdGgpO1xuXG4gICAgcGFyZW50W2NsYXNzTmFtZV0gPSBfY2xhc3M7XG5cbiAgICByZXR1cm4gX2NsYXNzO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGRlZmluZVxuICAgKiDjgq/jg6njgrnjgpLlrprnvqnjgZnjgovplqLmlbDjgafjgZnjgILkvb/jgYTmlrnjga8ge0BsaW5rICNjcmVhdGVDbGFzc30g44Go44G744Go44KT44Gp5ZCM44GY44Gn44GZ44CCXG4gICAqIOOBn+OBoOOBl+OAgeW8leaVsOOBrzLjgaTjgYLjgorjgIHnrKzkuIDlvJXmlbDjga/lrprnvqnjgZnjgovjgq/jg6njgrnjga7jg5HjgrnjgpLmloflrZfliJfjgafmuKHjgZfjgb7jgZnjgILnrKzkuozlvJXmlbDjga7jgqrjg5bjgrjjgqfjgq/jg4jjga8ge0BsaW5rICNjcmVhdGVDbGFzc30g44Gu5byV5pWw44Go5ZCM44GY44KI44GG44Gr44GX44G+44GZ44CCXG4gICAqIHtAbGluayAjY3JlYXRlQ2xhc3N9IOOBqOmBleOBhOOAgeWkieaVsOOBq+S7o+WFpeOBmeOCi+W/heimgeOBjOOBquOBj+OAgeODkeOCueaMh+WumuOBp+OCr+ODqeOCueOCkuWumue+qeOBp+OBjeOBvuOBmeOAglxuICAgKiDlhoXpg6jnmoTjgavjga8ge0BsaW5rICNyZWdpc3Rlcn0sIHtAbGluayAjdXNpbmd9IOOCkuS9v+eUqOOBl+OBpuOBhOOCi+OBn+OCgeOAgeODkeOCueOBryAsIC4gLyBcXCA6OiDjgafljLrliIfjgovjgZPjgajjgYzjgafjgY3jgb7jgZnjgIJcbiAgICogQG1lbWJlcm9mIHBoaW5hXG4gICAqIEBzdGF0aWNcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogcGhpbmEuZGVmaW5lKCduYW1lc3BhY2UuQ2xhc3MnLCB7XG4gICAqICAgc3VwZXJDbGFzczogJ25hbWVzcGFjZS5TdXBlcicsLy/opqrjgq/jg6njgrnntpnmib9cbiAgICpcbiAgICogICAvL+ODoeODs+ODkOWkieaVsFxuICAgKiAgIG1lbWJlcjE6IDEwMCxcbiAgICogICBtZW1iZXIyOiAndGVzdCcsXG4gICAqICAgbWVtYmVyMzogbnVsbCxcbiAgICpcbiAgICogICAvL+OCs+ODs+OCueODiOODqeOCr+OCv1xuICAgKiAgIC8vQ2xhc3MoKeOCkuWRvOOBs+WHuuOBl+OBn+OBqOOBjeWun+ihjOOBleOCjOOCi1xuICAgKiAgIGluaXQ6IGZ1bmN0aW9uKGEsIGIpe1xuICAgKiAgICAgLy/jgrnjg7zjg5Hjg7zjgq/jg6njgrko57aZ5om/44GX44Gf44Kv44Op44K5KeOBrmluaXRcbiAgICogICAgIHRoaXMuc3VwZXJJbml0KGEsIGIpO1xuICAgKiAgICAgdGhpcy5hID0gYTtcbiAgICogICAgIHRoaXMuYiA9IGI7XG4gICAqICAgfSxcbiAgICpcbiAgICogICAvL+ODoeOCveODg+ODiVxuICAgKiAgIG1ldGhvZDE6IGZ1bmN0aW9uKCl7fSxcbiAgICogICBtZXRob2QyOiBmdW5jdGlvbigpe30sXG4gICAqIH0pO1xuICAgKlxuICAgKiBAcGFyYW0ge1N0cmluZ30gcGF0aCDjg5HjgrlcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9uICYge293bmVyOiBhbnl9fSBwYXJhbXMuaW5pdCDjgq/jg6njgrnliJ3mnJ/ljJbplqLmlbBcbiAgICogQHBhcmFtIHtzdHJpbmcgfCBQaGluYUNsYXNzfSBbcGFyYW1zLnN1cGVyQ2xhc3NdIOOCueODvOODkeODvOOCr+ODqeOCuVxuICAgKiBAcGFyYW0ge3tbazogc3RyaW5nXTogQWNjZXNzb3JFeHRlbmRPYmplY3R9fSBbcGFyYW1zLl9hY2Nlc3Nvcl0g44Ki44Kv44K744K144KS5LuY5LiOXG4gICAqIEBwYXJhbSB7e1trOiBzdHJpbmddOiBhbnl9fSBbcGFyYW1zLl9zdGF0aWNdIHN0YXRpY+ODl+ODreODkeODhuOCo+OCkuS7mOS4jlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcGFyYW1zLl9kZWZpbmVkXSDlrprnvqnmmYLjgavlrp/ooYzjgZfjgZ/jgYTplqLmlbBcbiAgICogQHJldHVybiB7UGhpbmFDbGFzc30g5a6a576p44GX44Gf44Kv44Op44K5XG4gICAqL1xuICBkZWZpbmU6IGZ1bmN0aW9uIChwYXRoLCBwYXJhbXMpIHtcbiAgICBpZiAocGFyYW1zLnN1cGVyQ2xhc3MpIHtcbiAgICAgIGlmICh0eXBlb2YgcGFyYW1zLnN1cGVyQ2xhc3MgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIF9zdXBlckNsYXNzID0gdGhpcy51c2luZyhwYXJhbXMuc3VwZXJDbGFzcyk7XG4gICAgICAgIGlmICh0eXBlb2YgX3N1cGVyQ2xhc3MgIT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgaWYgKCFfY2xhc3NEZWZpbmVkQ2FsbGJhY2tbcGFyYW1zLnN1cGVyQ2xhc3NdKSB7XG4gICAgICAgICAgICBfY2xhc3NEZWZpbmVkQ2FsbGJhY2tbcGFyYW1zLnN1cGVyQ2xhc3NdID0gW107XG4gICAgICAgICAgfVxuICAgICAgICAgIF9jbGFzc0RlZmluZWRDYWxsYmFja1twYXJhbXMuc3VwZXJDbGFzc10ucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmRlZmluZShwYXRoLCBwYXJhbXMpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBhcmFtcy5zdXBlckNsYXNzID0gX3N1cGVyQ2xhc3M7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmFtcy5zdXBlckNsYXNzID0gcGFyYW1zLnN1cGVyQ2xhc3M7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIF9jbGFzcyA9IHRoaXMuY3JlYXRlQ2xhc3MoLyoqIEB0eXBlIENyZWF0ZUNsYXNzUGFyYW0gKi8gKHBhcmFtcykpO1xuICAgIC8vIF9jbGFzcy5wcm90b3R5cGUuYWNjZXNzb3IoJ2NsYXNzTmFtZScsIHtcbiAgICBhY2Nlc3Nvci5jYWxsKF9jbGFzcy5wcm90b3R5cGUsIFwiY2xhc3NOYW1lXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcGF0aDtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyKHBhdGgsIF9jbGFzcyk7XG5cbiAgICBpZiAoX2NsYXNzRGVmaW5lZENhbGxiYWNrW3BhdGhdKSB7XG4gICAgICBfY2xhc3NEZWZpbmVkQ2FsbGJhY2tbcGF0aF0uZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH0pO1xuICAgICAgX2NsYXNzRGVmaW5lZENhbGxiYWNrW3BhdGhdID0gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gX2NsYXNzO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGdsb2JhbGl6ZVxuICAgKiBwaGluYS5qcyDjgYznlKjmhI/jgZfjgabjgYTjgovlhajjgabjga7jgq/jg6njgrnjgpLjgrDjg63jg7zjg5Djg6vjgavlsZXplovjgZfjgb7jgZnjgILvvIjlhbfkvZPnmoTjgavjga8gcGhpbmEg44GM5oyB44Gk44Kq44OW44K444Kn44Kv44OI44GM5LiA6YCa44KK44Kw44Ot44O844OQ44Or44Gr5bGV6ZaL44GV44KM44G+44GZ44CC77yJXG4gICAqIOOBk+OBrumWouaVsOOCkuWun+ihjOOBmeOCi+OBk+OBqOOBp+OAgeOBhOOBoeOBhOOBoSBnbG9iYWwg44GL44KJ44Gf44Gp44Gj44Gm44GE44GL44Gq44GP44Gm44KCIHBoaW5hLmpzIOOBrueUqOaEj+OBl+OBpuOBhOOCi+OCr+ODqeOCueOCkuOCr+ODqeOCueWQjeOBoOOBkeOBp+WRvOOBs+WHuuOBmeOBk+OBqOOBjOOBp+OBjeOBvuOBmeOAglxuICAgKiBAbWVtYmVyb2YgcGhpbmFcbiAgICogQHN0YXRpY1xuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgc3ByaXRlMSA9IHBoaW5hLmRpc3BsYXkuU3ByaXRlKFwicGl5b1wiKTsgXG4gICAqIHBoaW5hLmdsb2JhbGl6ZSgpO1xuICAgKiB2YXIgc3ByaXRlMiA9IFNwcml0ZShcInBpeW9cIik7IC8vIHNwcml0ZTHjgajnrYnkvqFcbiAgICpcbiAgICovXG4gIGdsb2JhbGl6ZTogZnVuY3Rpb24gKCkge1xuICAgIC8vIHBoaW5hLmZvckluKFxuICAgIGZvckluLmNhbGwodGhpcywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcblxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIikgcmV0dXJuO1xuXG4gICAgICAvLyB2YWx1ZS5mb3JJbihmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICBmb3JJbi5jYWxsKHZhbHVlLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICAvLyBpZiAocGhpbmEuZ2xvYmFsW2tleV0pIHtcbiAgICAgICAgLy8gICBjb25zb2xlLmxvZyhucywga2V5KTtcbiAgICAgICAgLy8gICBwaGluYS5nbG9iYWxbJ18nICsga2V5XSA9IHZhbHVlO1xuICAgICAgICAvLyB9XG4gICAgICAgIC8vIGVsc2Uge1xuICAgICAgICAvLyAgIHBoaW5hLmdsb2JhbFtrZXldID0gdmFsdWU7XG4gICAgICAgIC8vIH1cbiAgICAgICAgdGhpcy5nbG9iYWxba2V5XSA9IHZhbHVlO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqIEBwcml2YXRlICovXG4gIF9tYWluTGlzdGVuZXJzOiBbXSxcbiAgLyoqIEBwcml2YXRlICovXG4gIF9tYWluTG9hZGVkOiBmYWxzZSxcblxuICAvKipcbiAgICogQG1ldGhvZCBtYWluXG4gICAqIHBoaW5hLmpzIOOBp+ODl+ODreOCsOODqeODn+ODs+OCsOOBmeOCi+mam+OAgeODoeOCpOODs+OBruWHpueQhuOCkuiomOi/sOOBmeOCi+OBn+OCgeOBrumWouaVsOOBp+OBmeOAglxuICAgKiDln7rmnKznmoTjgasgcGhpbmEuanMg44Gn44Gu44OX44Ot44Kw44Op44Of44Oz44Kw44Gn44Gv44GT44Gu5Lit44Gr44OX44Ot44Kw44Op44Og44KS5pu444GE44Gm44GE44GP44GT44Go44Gr44Gq44KK44G+44GZ44CCXG4gICAqIEBtZW1iZXJvZiBwaGluYVxuICAgKiBAc3RhdGljXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHBoaW5hLm1haW4oZnVuY3Rpb24oKSB7XG4gICAqICAgLy/jgZPjgZPjgavjg6HjgqTjg7Pjga7lh6bnkIbjgpLmm7jjgY9cbiAgICogfSk7XG4gICAqXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMg44Oh44Kk44Oz44Gu5Yem55CGXG4gICAqL1xuICBtYWluOiBmdW5jdGlvbiAoZnVuYykge1xuICAgIGlmICh0aGlzLl9tYWluTG9hZGVkKSB7XG4gICAgICBmdW5jKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX21haW5MaXN0ZW5lcnMucHVzaChmdW5jKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBtZW1iZXJvZiBwaGluYVxuICAgKiBOb2RlLmpzIOOBquOCiSBnbG9iYWzjgIEg44OW44Op44Km44K244Gq44KJIHdpbmRvdyDjgpLov5TjgZfjgb7jgZnjgIJcbiAgICog44Ky44OD44K/44O844Gu44G/5a6a576p44GV44KM44Gm44GE44G+44GZ44CCXG4gICAqL1xuICBnZXQgZ2xvYmFsKCkge1xuICAgIHJldHVybiBHTE9CQUw7XG4gIH0sXG59O1xuXG52YXIgR0xPQkFMID0gcGhpbmEuaXNOb2RlKCkgPyBnbG9iYWwgOiB3aW5kb3c7XG5cbnZhciBkb2MgPSBwaGluYS5nbG9iYWwuZG9jdW1lbnQ7XG5pZiAocGhpbmEuZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIgJiYgZG9jICYmIGRvYy5yZWFkeVN0YXRlICE9PSBcImNvbXBsZXRlXCIpIHtcbiAgcGhpbmEuZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcnVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGxpc3RlbmVycyA9IGNsb25lLmNhbGwocGhpbmEuX21haW5MaXN0ZW5lcnMpO1xuICAgICAgLy8gdmFyIGxpc3RlbmVycyA9IHBoaW5hLl9tYWluTGlzdGVuZXJzLmNsb25lKCk7XG4gICAgICBjbGVhci5jYWxsKHBoaW5hLl9tYWluTGlzdGVuZXJzKTtcbiAgICAgIC8vIHBoaW5hLl9tYWluTGlzdGVuZXJzLmNsZWFyKCk7XG4gICAgICBsaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAoZnVuYykge1xuICAgICAgICAvLyBsaXN0ZW5lcnMuZWFjaChmdW5jdGlvbihmdW5jKSB7XG4gICAgICAgIGZ1bmMoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBtYWluIOWGheOBpyBtYWluIOOCkui/veWKoOOBl+OBpuOBhOOCi+WgtOWQiOOBjOOBguOCi+OBruOBp+OBneOBruODgeOCp+ODg+OCr1xuICAgICAgaWYgKHBoaW5hLl9tYWluTGlzdGVuZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcnVuKCk7XG4gICAgICAgIC8vIHJ1bigwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBoaW5hLl9tYWluTG9hZGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8vIOOBoeOCh+OBo+OBqOmBheW7tuOBleOBm+OCiyjnlLvpnaLjgrXjgqTjgrrllY/poYwpXG4gICAgc2V0VGltZW91dChydW4pO1xuICB9KTtcbn0gZWxzZSB7XG4gIHBoaW5hLl9tYWluTG9hZGVkID0gdHJ1ZTtcbn1cblxuLyoqXG4gKiBBcnJheeOCr+ODqeOCueOBrnN0YXRpY+aLoeW8tVxuICovXG5cbi8qKlxuICogQG1ldGhvZCByYW5nZVxuICogQHN0YXRpY1xuICog44Kk44Oz44K544K/44Oz44K544Oh44K944OD44OJ44GuIHtAbGluayAjcmFuZ2V9IOOBqOWQjOOBmOOBp+OBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgQXJyYXkucmFuZ2UoMiwgMTQsIDUpOyAvLyA9PiBbMiwgNywgMTJdXG4gKi9cbmZ1bmN0aW9uIHJhbmdlJDEoc3RhcnQsIGVuZCwgc3RlcCkge1xuICByZXR1cm4gcmFuZ2UuYXBwbHkoW10sIGFyZ3VtZW50cyk7XG59XG4vLyBBcnJheS4kbWV0aG9kKFwicmFuZ2VcIiwgZnVuY3Rpb24oc3RhcnQsIGVuZCwgc3RlcCkge1xuLy8gICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnJhbmdlLmFwcGx5KFtdLCBhcmd1bWVudHMpO1xuLy8gfSk7XG5cbnZhciBhcnJheVN0YXRpY0V4dGVuc2lvbnMgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgcmFuZ2U6IHJhbmdlJDFcbn0pO1xuXG4vKipcbiAqIEBjbGFzcyBnbG9iYWwuTnVtYmVyXG4gKiAjIOaLoeW8teOBl+OBnyBOdW1iZXIg44Kv44Op44K5XG4gKiDmlbDlgKTjgpLmibHjgYYgTnVtYmVyIOOCr+ODqeOCueOCkuaLoeW8teOBl+OBpuOBhOOBvuOBmeOAglxuICovXG5cbi8qKlxuICogQG1ldGhvZCB0aW1lc1xuICogMCDjgYvjgonoh6rliIboh6rouqvjga7mlbAtMeOBvuOBp+OAgeOCq+OCpuODs+OCv+OCkuOCpOODs+OCr+ODquODoeODs+ODiOOBl+OBquOBjOOCiemWouaVsOOCkue5sOOCiui/lOOBl+Wun+ihjOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyID0gW107XG4gKiAgICAgKDUpLnRpbWVzKGZ1bmN0aW9uKGkpe1xuICogICAgICAgYXJyLnB1c2goaSk7XG4gKiAgICAgfSk7IC8vID0+IFswLCAxLCAyLCAzLCA0XVxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4g44Kz44O844Or44OQ44OD44Kv6Zai5pWwXG4gKiBAcGFyYW0ge09iamVjdH0gW3NlbGY9dGhpc10g6Zai5pWw5YaF44GnIHRoaXMg44Go44GX44Gm5Y+C54Wn44GV44KM44KL5YCk44CC44OH44OV44Kp44Or44OI44Gv6Ieq5YiG6Ieq6Lqr44CCXG4gKi9cbmZ1bmN0aW9uIHRpbWVzKGZuLCBzZWxmKSB7XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJ0aW1lc1wiLCAgZnVuY3Rpb24oZm4sIHNlbGYpIHtcbiAgc2VsZiA9IHNlbGYgfHwgdGhpcztcbiAgZm9yICh2YXIgaT0wOyBpPHRoaXM7ICsraSkge1xuICAgIGZuLmNhbGwoc2VsZiwgaSwgdGhpcyk7XG4gIH1cbiAgcmV0dXJuIHRoaXM7XG59XG5cbi8qKlxuICogQG1ldGhvZCBzdGVwXG4gKiDoh6rliIboh6rouqvjga7lgKTjgYvjgonmjIflrprjgZfjgZ/mlbDjgb7jgafjgIHjgqvjgqbjg7Pjgr/jgpLlopfliIbjgZXjgZvjgarjgYzjgonplqLmlbDjgpLnubDjgorov5TjgZflrp/ooYzjgZfjgb7jgZnjgIJcbiAqXG4gKiDkuIrpmZDlgKTjgoTlopfliIblgKTjga8gZmxvYXQg5Z6L44KS5oyH5a6a44GZ44KL44GT44Go44GM44Gn44GN44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICB2YXIgYXJyID0gW107XG4gKiAgICAgKDIuNCkuc3RlcCg1LjMsIDAuOCwgZnVuY3Rpb24obikge1xuICogICAgICAgYXJyLnB1c2gobik7XG4gKiAgICAgIH0pOyAvLyA9PiBbMi40LCAzLjIsIDQuMCwgNC44XVxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHBhcmFtIHtOdW1iZXJ9IGxpbWl0IOOCq+OCpuODs+OCv+OBruS4iumZkOWApFxuICogQHBhcmFtIHtOdW1iZXJ9IHN0ZXAg44Kr44Km44Oz44K/44KS5aKX5YiG44GZ44KL6YePXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiDjgrPjg7zjg6vjg5Djg4Pjgq/plqLmlbDjgILlvJXmlbDjgavjgqvjgqbjg7Pjgr/jgYzmuKHjgZXjgozjgovjgIJcbiAqIEBwYXJhbSB7T2JqZWN0fSBbc2VsZj10aGlzXSDplqLmlbDlhoXjgacgdGhpcyDjgajjgZfjgablj4LnhafjgZXjgozjgovlgKTjgILjg4fjg5Xjgqnjg6vjg4jjga/oh6rliIboh6rouqvjgIJcbiAqL1xuZnVuY3Rpb24gc3RlcChsaW1pdCwgc3RlcCwgZm4sIHNlbGYpIHtcbi8vIE51bWJlci5wcm90b3R5cGUuJG1ldGhvZChcInN0ZXBcIiwgIGZ1bmN0aW9uKGxpbWl0LCBzdGVwLCBmbiwgc2VsZikge1xuICBzZWxmID0gc2VsZiB8fCB0aGlzO1xuICBmb3IgKHZhciBpPSt0aGlzOyBpPD1saW1pdDsgaSs9c3RlcCkge1xuICAgIGZuLmNhbGwoc2VsZiwgaSwgdGhpcyk7XG4gIH1cbiAgcmV0dXJuIHRoaXM7XG59XG5cblxuLy8gPT09PT09PT09PVxuLy8g5Lul5LiL44Op44Kk44OW44Op44Oq5YaF44Gn44Gv5pyq5L2/55SoXG4vLyA9PT09PT09PT09XG5cbi8qKlxuICogQG1ldGhvZCByb3VuZFxuICog5oyH5a6a44GX44Gf5bCP5pWw44Gu5L2N44KS5Zub5o2o5LqU5YWl44GX44Gf5YCk44KS6L+U44GX44G+44GZ44CCXG4gKlxuICog6LKg44Gu5YCk44KS5oyH5a6a44GZ44KL44Go5pW05pWw6YOo44Gu5L2N44KS5Zub5o2o5LqU5YWl44Gn44GN44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoMTMuODcpLnJvdW5kKCk7IC8vID0+IDE0XG4gKiAgICAgKC0xLjg3KS5yb3VuZCgpOyAvLyA9PiAtMlxuICogICAgICgtMS4yNykucm91bmQoKTsgLy8gPT4gLTFcbiAqICAgICBcbiAqICAgICAoMi4zNDUpLnJvdW5kKCk7IC8vID0+IDJcbiAqICAgICAoMi4zNDUpLnJvdW5kKDEpOyAvLyA9PiAyLjNcbiAqICAgICAoMi4zNDUpLnJvdW5kKDIpOyAvLyA9PiAyLjM1XG4gKlxuICogICAgICgxMjM0NS42Nykucm91bmQoLTMpOyAvLyA9PiAxMjAwMFxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHBhcmFtIHtOdW1iZXJ9IFtmaWd1cmU9MF0g5Zub5o2o5LqU5YWl44GZ44KL5L2NXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IOWwj+aVsOesrCBmaWd1cmUg5L2N44Gn5Zub5o2o5LqU5YWl44GX44Gf5YCkXG4gKi9cbmZ1bmN0aW9uIHJvdW5kKGZpZ3VyZSkge1xuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwicm91bmRcIiwgZnVuY3Rpb24oZmlndXJlKSB7XG4gIGZpZ3VyZSA9IGZpZ3VyZSB8fCAwO1xuICB2YXIgYmFzZSA9IE1hdGgucG93KDEwLCBmaWd1cmUpO1xuICB2YXIgdGVtcCA9IHRoaXMgKiBiYXNlO1xuICB0ZW1wID0gTWF0aC5yb3VuZCh0ZW1wKTtcbiAgcmV0dXJuIHRlbXAvYmFzZTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGNlaWxcbiAqIOaMh+WumuOBl+OBn+Wwj+aVsOOBruS9jeOCkuWIh+OCiuS4iuOBkuOBn+WApOOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqIOiyoOOBruWApOOCkuaMh+WumuOBmeOCi+OBqOaVtOaVsOmDqOOBruS9jeOCkuWIh+OCiuS4iuOBkuOCieOCjOOBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKC0xLjI3KS5jZWlsKCk7IC8vID0+IC0xXG4gKiAgICAgKC0xLjg3KS5jZWlsKCk7IC8vID0+IC0xXG4gKiAgICAgXG4gKiAgICAgKDIuMzQ1KS5jZWlsKCk7IC8vID0+IDNcbiAqICAgICAoMi4zNDUpLmNlaWwoMSk7IC8vID0+IDIuNFxuICogICAgICgyLjM0NSkuY2VpbCgyKTsgLy8gPT4gMi4zNVxuICpcbiAqICAgICAoMTIzNDUuNjcpLmNlaWwoLTMpOyAvLyA9PiAxMzAwMFxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHBhcmFtIHtOdW1iZXJ9IFtmaWd1cmU9MF0g5YiH44KK5LiK44GS44KL5L2NXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IOWwj+aVsOesrCBmaWd1cmUg5L2N44Gn5YiH44KK5LiK44GS44Gf5YCkXG4gKi9cbmZ1bmN0aW9uIGNlaWwoZmlndXJlKSB7XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJjZWlsXCIsICBmdW5jdGlvbihmaWd1cmUpIHtcbiAgZmlndXJlID0gZmlndXJlIHx8IDA7XG4gIHZhciBiYXNlID0gTWF0aC5wb3coMTAsIGZpZ3VyZSk7XG4gIHZhciB0ZW1wID0gdGhpcyAqIGJhc2U7XG4gIHRlbXAgPSBNYXRoLmNlaWwodGVtcCk7XG4gIHJldHVybiB0ZW1wL2Jhc2U7XG59XG5cbi8qKlxuICogQG1ldGhvZCBmbG9vclxuICog5oyH5a6a44GX44Gf5bCP5pWw44Gu5L2N44KS5YiH44KK5LiL44GS44Gf5YCk44KS6L+U44GX44G+44GZ44CCXG4gKlxuICog6LKg44Gu5YCk44KS5oyH5a6a44GZ44KL44Go5pW05pWw6YOo44Gu5L2N44KS5YiH44KK5LiL44GS44KJ44KM44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoLTEuMjcpLmZsb29yKCk7IC8vID0+IC0yXG4gKiAgICAgKC0xLjg3KS5mbG9vcigpOyAvLyA9PiAtMlxuICogICAgIFxuICogICAgICgyLjM0NSkuZmxvb3IoKTsgLy8gPT4gMlxuICogICAgICgyLjM0NSkuZmxvb3IoMSk7IC8vID0+IDIuM1xuICogICAgICgyLjM0NSkuZmxvb3IoMik7IC8vID0+IDIuMzRcbiAqXG4gKiAgICAgKDEyMzQ1LjY3KS5mbG9vcigtMyk7IC8vID0+IDEyMDAwXG4gKlxuICogQHRoaXMgTnVtYmVyXG4gKiBAcGFyYW0ge051bWJlcn0gW2ZpZ3VyZT0wXSDliIfjgorkuIvjgZLjgovkvY1cbiAqIEByZXR1cm4ge051bWJlcn0g5bCP5pWw56ysIGZpZ3VyZSDkvY3jgafliIfjgorkuIvjgZLjgZ/lgKRcbiAqL1xuZnVuY3Rpb24gZmxvb3IoZmlndXJlKSB7XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJmbG9vclwiLCAgZnVuY3Rpb24oZmlndXJlKSB7XG4gIGZpZ3VyZSA9IGZpZ3VyZSB8fCAwO1xuICB2YXIgYmFzZSA9IE1hdGgucG93KDEwLCBmaWd1cmUpO1xuICB2YXIgdGVtcCA9IHRoaXMgKiBiYXNlO1xuICB0ZW1wID0gTWF0aC5mbG9vcih0ZW1wKTtcbiAgXG4gIC8vIH5+dGhpc1xuICAvLyB0aGlzfDBcbiAgXG4gIHJldHVybiB0ZW1wL2Jhc2U7XG59XG5cbi8qKlxuICogQG1ldGhvZCB0b0ludFxuICog5pWw5YCk44KS5pW05pWw44Gr5aSJ5o+b44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoNDIuMTk1KS50b0ludCgpOyAvLyA9PiA0MlxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHJldHVybiB7TnVtYmVyfSDmlbTmlbDlgKRcbiAqL1xuZnVuY3Rpb24gdG9JbnQoKSB7XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJ0b0ludFwiLCAgZnVuY3Rpb24oKSB7XG4gIHJldHVybiAodGhpcyB8IDApO1xufVxuXG4vKipcbiAqIEBtZXRob2QgdG9IZXhcbiAqIOaVsOWApOOCkjE26YCy5pWw6KGo6KiY44Gr44GX44Gf5paH5a2X5YiX44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoMjYpLnRvSGV4KCk7IC8vID0+IFwiMWFcIlxuICogICAgICgtMjYpLnRvSGV4KCk7IC8vID0+IFwiLTFhXCJcbiAqICAgICAoMjYuMjUpLnRvSGV4KCk7IC8vID0+IFwiMWEuNFwiXG4gKlxuICogQHRoaXMgTnVtYmVyXG4gKiBAcmV0dXJuIHtTdHJpbmd9IDE26YCy5pWw6KGo6KiY44Gu5paH5a2X5YiXXG4gKi9cbmZ1bmN0aW9uIHRvSGV4KCkge1xuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwidG9IZXhcIiwgIGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy50b1N0cmluZygxNik7XG59XG5cbi8qKlxuICogQG1ldGhvZCB0b0JpblxuICog5pWw5YCk44KSMumAsuaVsOihqOiomOOBq+OBl+OBn+aWh+Wtl+WIl+OCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKDYpLnRvQmluKCk7IC8vID0+IFwiMTEwXCJcbiAqICAgICAoLTYpLnRvQmluKCk7IC8vID0+IFwiLTExMFwiXG4gKiAgICAgKDB4QTMpLnRvQmluKCk7IC8vID0+IFwiMTAxMDAwMTFcIlxuICogICAgICg2LjI1KS50b0hleCgpOyAvLyA9PiBcIjExMC4wMVwiXG4gKlxuICogQHRoaXMgTnVtYmVyXG4gKiBAcmV0dXJuIHtTdHJpbmd9IDLpgLLmlbDooajoqJjjga7mloflrZfliJdcbiAqL1xuZnVuY3Rpb24gdG9CaW4oKSB7XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJ0b0JpblwiLCAgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnRvU3RyaW5nKDIpO1xufVxuXG5cbi8qKlxuICogQG1ldGhvZCB0b1Vuc2lnbmVkXG4gKiDmlbDlgKTjgpIgdW5zaWduZWQgaW50IOWei+OBq+WkieaPm+OBl+OBvuOBmeOAglxuICpcbiAqIOaVsOWApOOCkuespuWPt+eEoeOBl+aVtOaVsOOBqOOBl+OBpuipleS+oeOBl+OBn+WApOOCkui/lOOBl+OBvuOBmeOAgiAgXG4gKiBKYXZhc2NyaXB044Gu44OT44OD44OI5ryU566X44Gn44Gv5pWw5YCk44KS56ym5Y+35LuY44GN44GuMzJiaXTmlbTmlbDjgajjgZfjgabmibHjgYbjgZ/jgoHjgIFSR0JBIOOCklxuICog5pW05pWw5YCk44Gn6KGo54++44GX44Gm5ryU566X44GZ44KL5aC05ZCI44CB5pyf5b6F6YCa44KK44Gu57WQ5p6c44GM5b6X44KJ44KM44Gq44GE5aC05ZCI44GM44GC44KK44G+44GZ44CCXG4gKiDjgZ3jgZPjgafmnKzplqLmlbDjgacgdW5zaWduZWQgaW50IOWei+OBq+WkieaPm+OBmeOCi+OBk+OBqOOBp+acn+W+hemAmuOCiuOBruWApOOCkuW+l+OCi+OBk+OBqOOBjOOBp+OBjeOBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgcmdiYSA9IDB4ZmVmZmZmZmYgJiAweGZmMDAwMDAwOyAvLyA9PiAtMzM1NTQ0MzJcbiAqICAgICByZ2JhLnRvSGV4KCk7IC8vID0+IFwiLTIwMDAwMDBcIlxuICogICAgIHJnYmEudG9VbnNpZ25lZCgpLnRvSGV4KCk7IC8vID0+IFwiZmUwMDAwMDBcIlxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHJldHVybiB7TnVtYmVyfSB1bnNpZ25lZCBpbnQg5Z6L44Gr5aSJ5o+b44GX44Gf5YCkXG4gKi9cbmZ1bmN0aW9uIHRvVW5zaWduZWQoKSB7XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJ0b1Vuc2lnbmVkXCIsICBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMgPj4+IDA7XG59XG5cbi8qKlxuICogQG1ldGhvZCBwYWRkaW5nXG4gKiDmjIflrprjgZfjgZ/moYHjgavjgarjgovjgojjgYbjgavmloflrZfjgpLln4vjgoHjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgICgxMjMpLnBhZGRpbmcoNSk7IC8vID0+IFwiMDAxMjNcIlxuICogICAgICgxMjMpLnBhZGRpbmcoNSwgXCJfXCIpOyAvLyA9PiBcIl9fMTIzXCJcbiAqICAgICAoLTEyKS5wYWRkaW5nKDUpOyAvLyA9PiBcIi0wMDEyXCJcbiAqXG4gKiBAdGhpcyBOdW1iZXJcbiAqIEBwYXJhbSB7TnVtYmVyfSBuIOahgeaVsFxuICogQHBhcmFtIHtTdHJpbmd9IFtjaD1cIjBcIl0g5Z+L44KB44KL5paH5a2XXG4gKiBAcmV0dXJuIHtTdHJpbmd9IOahgeaVsOOCkuaPg+OBiOOBn+aWh+Wtl+WIl1xuICovXG5mdW5jdGlvbiBwYWRkaW5nJDEobiwgY2gpIHtcbi8vIE51bWJlci5wcm90b3R5cGUuJG1ldGhvZChcInBhZGRpbmdcIiwgIGZ1bmN0aW9uKG4sIGNoKSB7XG4gIHZhciBzdHIgPSB0aGlzKycnO1xuICBuICA9IG4tc3RyLmxlbmd0aDtcbiAgY2ggPSAoY2ggfHwgJzAnKVswXTtcbiAgXG4gIHdoaWxlKG4tLSA+IDApIHsgc3RyID0gY2ggKyBzdHI7IH1cbiAgXG4gIGlmIChzdHIuaW5kZXhPZihcIi1cIikgPj0gMCkge1xuICAgIHN0ciA9IFwiLVwiICsgc3RyLnJlcGxhY2UoXCItXCIsIFwiXCIpO1xuICB9XG5cbiAgcmV0dXJuIHN0cjtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIHVwdG9cbiAqIOiHquWIhuiHqui6q+OBruaVsOOBi+OCieaMh+WumuOBl+OBn+aVsOOBvuOBp+OAgeOCq+OCpuODs+OCv+OCkuOCpOODs+OCr+ODquODoeODs+ODiOOBl+OBquOBjOOCiemWouaVsOOCkue5sOOCiui/lOOBl+Wun+ihjOOBl+OBvuOBmeOAglxuICpcbiAqIOaMh+WumuOBl+OBn+aVsOOBjOiHquWIhuiHqui6q+OBruaVsOOCiOOCiuWwj+OBleOBhOWgtOWQiOOBr+mWouaVsOOBr+Wun+ihjOOBleOCjOOBvuOBm+OCk+OAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgYXJyID0gW107XG4gKiAgICAgKDYpLnVwdG8oOCwgZnVuY3Rpb24oaSl7XG4gKiAgICAgICBhcnIucHVzaChpKTtcbiAqICAgICB9KTtcbiAqICAgICBhcnI7IC8vID0+IFs2LCA3LCA4XVxuICpcbiAqICAgICAoMykudXB0bygwLCBmdW5jdGlvbihpKXtcbiAqICAgICAgIGFyci5wdXNoKGkpO1xuICogICAgIH0pO1xuICogICAgIGFycjsgLy8gPT4gWzYsIDcsIDhdXG4gKlxuICogQHRoaXMgTnVtYmVyXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiDjgrPjg7zjg6vjg5Djg4Pjgq/plqLmlbDjgILlvJXmlbDjgavjgqvjgqbjg7Pjgr/jgYzmuKHjgZXjgozjgovjgIJcbiAqIEBwYXJhbSB7T2JqZWN0fSBbc2VsZj10aGlzXSDplqLmlbDlhoXjgacgdGhpcyDjgajjgZfjgablj4LnhafjgZXjgozjgovlgKTjgILjg4fjg5Xjgqnjg6vjg4jjga/oh6rliIboh6rouqvjgIJcbiAqL1xuZnVuY3Rpb24gdXB0byh0LCBmbiwgc2VsZikge1xuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwidXB0b1wiLCAgZnVuY3Rpb24odCwgZm4sIHNlbGYpIHtcbiAgc2VsZiA9IHNlbGYgfHwgdGhpcztcbiAgZm9yICh2YXIgaT0rdGhpczsgaTw9dDsgKytpKSB7XG4gICAgZm4uY2FsbChzZWxmLCBpLCB0aGlzKTtcbiAgfVxuICByZXR1cm4gdGhpcztcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGRvd250b1xuICog6Ieq5YiG6Ieq6Lqr44Gu5pWw44GL44KJ5oyH5a6a44GX44Gf5pWw44G+44Gn44CB44Kr44Km44Oz44K/44KS44OH44Kv44Oq44Oh44Oz44OI44GX44Gq44GM44KJ6Zai5pWw44KS57mw44KK6L+U44GX5a6f6KGM44GX44G+44GZ44CCXG4gKlxuICog5oyH5a6a44GX44Gf5pWw44GM6Ieq5YiG6Ieq6Lqr44Gu5pWw44KI44KK5aSn44GN44GE5aC05ZCI44Gv6Zai5pWw44Gv5a6f6KGM44GV44KM44G+44Gb44KT44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBhcnIgPSBbXTtcbiAqICAgICAoNykuZG93bnRvKDQsIGZ1bmN0aW9uKGkpe1xuICogICAgICAgYXJyLnB1c2goaSk7XG4gKiAgICAgfSk7IC8vID0+IFs3LCA2LCA1LCA0XVxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4g44Kz44O844Or44OQ44OD44Kv6Zai5pWw44CC5byV5pWw44Gr44Kr44Km44Oz44K/44GM5rih44GV44KM44KL44CCXG4gKiBAcGFyYW0ge09iamVjdH0gW3NlbGY9dGhpc10g6Zai5pWw5YaF44GnIHRoaXMg44Go44GX44Gm5Y+C54Wn44GV44KM44KL5YCk44CC44OH44OV44Kp44Or44OI44Gv6Ieq5YiG6Ieq6Lqr44CCXG4gKi9cbmZ1bmN0aW9uIGRvd250byh0LCBmbiwgc2VsZikge1xuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwiZG93bnRvXCIsICBmdW5jdGlvbih0LCBmbiwgc2VsZikge1xuICBzZWxmID0gc2VsZiB8fCB0aGlzO1xuICBmb3IgKHZhciBpPSt0aGlzOyBpPj10OyAtLWkpIHtcbiAgICBmbi5jYWxsKHNlbGYsIGksIHRoaXMpO1xuICB9XG4gIHJldHVybiB0aGlzO1xufVxuXG5cbi8qKlxuICogQG1ldGhvZCBtYXBcbiAqIDDjgYvjgonoh6rliIboh6rouqvjga7lgKQtMeOBvuOBp+OCq+OCpuODs+OCv+OCkuOCpOODs+OCr+ODquODoeODs+ODiOOBleOBm+OBquOBjOOCieOCs+ODvOODq+ODkOODg+OCr+mWouaVsOOCkue5sOOCiui/lOOBl+Wun+ihjOOBl+OAgVxuICog44Gd44Gu6L+U44KK5YCk44KS6KaB57Sg44Go44GZ44KL6YWN5YiX44KS55Sf5oiQ44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoNSkubWFwKGZ1bmN0aW9uKGkpIHtcbiAqICAgICAgIHJldHVybiBpKmk7XG4gKiAgICAgfSk7IC8vID0+IFswLCAxLCA0LCA5LCAxNl1cbiAqXG4gKiBAdGhpcyBOdW1iZXJcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIOOCs+ODvOODq+ODkOODg+OCr+mWouaVsOOAguW8leaVsOOBq+OCq+OCpuODs+OCv+OBjOa4oeOBleOCjOOCi+OAglxuICogQHBhcmFtIHtPYmplY3R9IFtzZWxmPXRoaXNdIOmWouaVsOWGheOBpyB0aGlzIOOBqOOBl+OBpuWPgueFp+OBleOCjOOCi+WApOOAguODh+ODleOCqeODq+ODiOOBr+iHquWIhuiHqui6q+OAglxuICogQHJldHVybiB7QXJyYXl9IOeUn+aIkOOBl+OBn+mFjeWIl1xuICovXG5mdW5jdGlvbiBtYXAoZm4sIHNlbGYpIHtcbi8vIE51bWJlci5wcm90b3R5cGUuJG1ldGhvZChcIm1hcFwiLCAgZnVuY3Rpb24oZm4sIHNlbGYpIHtcbiAgc2VsZiA9IHNlbGYgfHwgdGhpcztcblxuICB2YXIgcmVzdWx0cyA9IFtdO1xuICBmb3IgKHZhciBpPTA7IGk8dGhpczsgKytpKSB7XG4gICAgdmFyIHIgPSBmbi5jYWxsKHNlbGYsIGkpO1xuICAgIHJlc3VsdHMucHVzaChyKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cztcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGFic1xuICog57W25a++5YCk44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoLTUpLmFicygpOyAvLyA9PiA1XG4gKiAgICAgKCs1KS5hYnMoKTsgLy8gPT4gNVxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHJldHVybiB7TnVtYmVyfSDntbblr77lgKRcbiAqL1xuZnVuY3Rpb24gYWJzKCkgeyByZXR1cm4gTWF0aC5hYnModGhpcykgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwiYWJzXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gTWF0aC5hYnModGhpcykgfSk7XG5cbi8qKlxuICogQG1ldGhvZCBhY29zXG4gKiDjgqLjg7zjgq/jgrPjgrXjgqTjg7PvvIjjg6njgrjjgqLjg7PljZjkvY3vvInjgpLov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgICgwKS5hc2luKCk7IC8vID0+IDBcbiAqICAgICAoMSkuYXNpbigpOyAvLyA9PiAxLjU3MDc5NjMyNjc5NDg5NjZcbiAqXG4gKiBAdGhpcyBOdW1iZXJcbiAqIEByZXR1cm4ge051bWJlcn0g44Ki44O844Kv44Kz44K144Kk44OzXG4gKi9cbmZ1bmN0aW9uIGFjb3MoKSB7IHJldHVybiBNYXRoLmFjb3ModGhpcykgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwiYWNvc1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIE1hdGguYWNvcyh0aGlzKSB9KTtcblxuLyoqXG4gKiBAbWV0aG9kIGFzaW5cbiAqIOOCouODvOOCr+OCteOCpOODs++8iOODqeOCuOOCouODs+WNmOS9je+8ieOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKDEpLmFjb3MoKTsgLy8gPT4gMFxuICogICAgICgtMSkuYWNvcygpOyAvLyA9PiAzLjE0MTU5MjY1MzU4OTc5M1xuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHJldHVybiB7TnVtYmVyfSDjgqLjg7zjgq/jgrXjgqTjg7NcbiAqL1xuZnVuY3Rpb24gYXNpbigpIHsgcmV0dXJuIE1hdGguYXNpbih0aGlzKSB9XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJhc2luXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gTWF0aC5hc2luKHRoaXMpIH0pO1xuXG4vKipcbiAqIEBtZXRob2QgYXRhblxuICog44Ki44O844Kv44K/44Oz44K444Kn44Oz44OI77yI44Op44K444Ki44Oz5Y2Y5L2N77yJ44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoMCkuYXRhbigpOyAvLyA9PiAwXG4gKiAgICAgKDEpLmF0YW4oKTsgLy8gPT4gMC43ODUzOTgxNjMzOTc0NDgzXG4gKlxuICogQHRoaXMgTnVtYmVyXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IOOCouODvOOCr+OCv+ODs+OCuOOCp+ODs+ODiFxuICovXG5mdW5jdGlvbiBhdGFuKCkgeyByZXR1cm4gTWF0aC5hdGFuKHRoaXMpIH1cbi8vIE51bWJlci5wcm90b3R5cGUuJG1ldGhvZChcImF0YW5cIiwgZnVuY3Rpb24oKSB7IHJldHVybiBNYXRoLmF0YW4odGhpcykgfSk7XG5cbi8qKlxuICogQG1ldGhvZCBjb3NcbiAqIOOCs+OCteOCpOODs++8iOODqeOCuOOCouODs+WNmOS9je+8ieOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKE1hdGguUEkvMykuY29zKCk7IC8vID0+IDAuNVxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHJldHVybiB7TnVtYmVyfSDjgrPjgrXjgqTjg7NcbiAqL1xuZnVuY3Rpb24gY29zKCkgeyByZXR1cm4gTWF0aC5jb3ModGhpcykgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwiY29zXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gTWF0aC5jb3ModGhpcykgfSk7XG5cbi8qKlxuICogQG1ldGhvZCBleHBcbiAqIGU8c3VwPnRoaXM8L3N1cD4g44KS6L+U44GX44G+44GZ44CC44GT44GT44GnIGUg44Gv6Ieq54S25a++5pWw44Gu5bqV44Gn44GC44KL44ON44Kk44OU44Ki5pWw77yI44Kq44Kk44Op44O85pWw77yJ44Gn44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoMikuZXhwKCk7IC8vID0+IGU8c3VwPjI8L3N1cD5cbiAqICAgICAoMCkuZXhwKCk7IC8vID0+IDFcbiAqXG4gKiBAdGhpcyBOdW1iZXJcbiAqIEByZXR1cm4ge051bWJlcn0gZTxzdXA+eDwvc3VwPlxuICovXG5mdW5jdGlvbiBleHAoKSB7IHJldHVybiBNYXRoLmV4cCh0aGlzKSB9XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJleHBcIiwgZnVuY3Rpb24oKSB7IHJldHVybiBNYXRoLmV4cCh0aGlzKSB9KTtcblxuLyoqXG4gKiBAbWV0aG9kIGxvZ1xuICog6Ieq54S25a++5pWw44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoTWF0aC5FICogTWF0aC5FICogTWF0aC5FKS5sb2coKTsgLy8gPT4gM1xuICogICAgICgxKS5sb2coKTsgLy8gPT4gMFxuICogICAgICgwKS5sb2coKTsgLy8gPT4gLUluZmluaXR5XG4gKlxuICogQHRoaXMgTnVtYmVyXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IOiHqueEtuWvvuaVsFxuICovXG5mdW5jdGlvbiBsb2coKSB7IHJldHVybiBNYXRoLmxvZyh0aGlzKSB9XG4vLyBOdW1iZXIucHJvdG90eXBlLiRtZXRob2QoXCJsb2dcIiwgZnVuY3Rpb24oKSB7IHJldHVybiBNYXRoLmxvZyh0aGlzKSB9KTtcblxuLyoqXG4gKiBAbWV0aG9kIG1heFxuICog6Ieq5YiG6Ieq6Lqr44Go5byV5pWw44Gu5YCk44KS5q+U44G544CB5aSn44GN44GE5pa544Gu5YCk44KS6L+U44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoMTUpLm1heCgxMCk7IC8vID0+IDE1XG4gKiAgICAgKDE1KS5tYXgoOTApOyAvLyA9PiA5MFxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHBhcmFtIHtOdW1iZXJ9IHZhbHVlIOavlOi8g+OBmeOCi+WApFxuICogQHJldHVybiB7TnVtYmVyfSDmnIDlpKflgKRcbiAqL1xuZnVuY3Rpb24gbWF4KHZhbHVlKSB7IHJldHVybiBNYXRoLm1heCh0aGlzLCB2YWx1ZSkgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwibWF4XCIsIGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiBNYXRoLm1heCh0aGlzLCB2YWx1ZSkgfSk7XG5cbi8qKlxuICogQG1ldGhvZCBtaW5cbiAqIOiHquWIhuiHqui6q+OBqOW8leaVsOOBruWApOOCkuavlOOBueOAgeWwj+OBleOBhOaWueOBruWApOOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKDE1KS5taW4oMTApOyAvLyA9PiAxMFxuICogICAgICgxNSkubWluKDkwKTsgLy8gPT4gMTVcbiAqXG4gKiBAdGhpcyBOdW1iZXJcbiAqIEBwYXJhbSB7TnVtYmVyfSB2YWx1ZSDmr5TovIPjgZnjgovlgKRcbiAqIEByZXR1cm4ge051bWJlcn0g5pyA5bCP5YCkXG4gKi9cbmZ1bmN0aW9uIG1pbih2YWx1ZSkgeyByZXR1cm4gTWF0aC5taW4odGhpcywgdmFsdWUpIH1cbi8vIE51bWJlci5wcm90b3R5cGUuJG1ldGhvZChcIm1pblwiLCBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gTWF0aC5taW4odGhpcywgdmFsdWUpIH0pO1xuXG4vKipcbiAqIEBtZXRob2QgY2xhbXBcbiAqIOaMh+WumuOBl+OBn+evhOWbsuOBq+WPjuOCgeOBn+WApOOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKDIwMCkuY2xhbXAoMCwgNjQwKTsgLy8gPT4gMjAwXG4gKiAgICAgKC0xNSkuY2xhbXAoMCwgNjQwKTsgLy8gPT4gMFxuICogICAgICg5OTkpLmNsYW1wKDAsIDY0MCk7IC8vID0+IDY0MFxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHBhcmFtIHtOdW1iZXJ9IG1pbiDnr4Tlm7Ljga7kuIvpmZBcbiAqIEBwYXJhbSB7TnVtYmVyfSBtYXgg56+E5Zuy44Gu5LiK6ZmQXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IOevhOWbsuWGheOBq+WPjuOCgeOBn+WApFxuICovXG5mdW5jdGlvbiBjbGFtcCQxKG1pbiwgbWF4KSB7IHJldHVybiBjbGFtcCh0aGlzLCBtaW4sIG1heCkgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwiY2xhbXBcIiwgZnVuY3Rpb24obWluLCBtYXgpIHsgcmV0dXJuIE1hdGguY2xhbXAodGhpcywgbWluLCBtYXgpIH0pO1xuXG4vKipcbiAqIEBtZXRob2QgcG93XG4gKiDoh6rliIboh6rouqvjgpIgZXhwb25lbnQg5LmX44GX44Gf5YCk44CB44Gk44G+44KKIHRoaXM8c3VwPmV4cG9uZW50PC9zdXA+IOOBruWApOOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKDMpLnBvdygyKTsgLy8gPT4gOVxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHBhcmFtIHtOdW1iZXJ9IGV4cG9uZW50IOe0r+S5l+OBmeOCi+aMh+aVsFxuICogQHJldHVybiB7TnVtYmVyfSDntK/kuZfjgZfjgZ/ntZDmnpzjga7lgKRcbiAqL1xuZnVuY3Rpb24gcG93KGV4cG9uZW50KSB7IHJldHVybiBNYXRoLnBvdyh0aGlzLCBleHBvbmVudCkgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwicG93XCIsIGZ1bmN0aW9uKGV4cG9uZW50KSB7IHJldHVybiBNYXRoLnBvdyh0aGlzLCBleHBvbmVudCkgfSk7XG5cbi8qKlxuICogQG1ldGhvZCBzaW5cbiAqIOOCteOCpOODs++8iOODqeOCuOOCouODs+WNmOS9je+8ieOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKE1hdGguUEkvNCkuc2luKCk7IC8vID0+IDAuNzA3MTA2NzgxMTg2NTQ3NlxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHJldHVybiB7TnVtYmVyfSDjgrXjgqTjg7NcbiAqL1xuZnVuY3Rpb24gc2luKCkgeyByZXR1cm4gTWF0aC5zaW4odGhpcykgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwic2luXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gTWF0aC5zaW4odGhpcykgfSk7XG5cbi8qKlxuICogQG1ldGhvZCBzcXJ0XG4gKiDlubPmlrnmoLnjgpLov5TjgZfjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgICg0OSkuc3FydCgpOyAvLyA9PiA3XG4gKlxuICogQHRoaXMgTnVtYmVyXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IOW5s+aWueaguVxuICovXG5mdW5jdGlvbiBzcXJ0KCkgeyByZXR1cm4gTWF0aC5zcXJ0KHRoaXMpIH1cbi8vIE51bWJlci5wcm90b3R5cGUuJG1ldGhvZChcInNxcnRcIiwgZnVuY3Rpb24oKSB7IHJldHVybiBNYXRoLnNxcnQodGhpcykgfSk7XG5cbi8qKlxuICogQG1ldGhvZCB0YW5cbiAqIOOCv+ODs+OCuOOCp+ODs+ODiO+8iOODqeOCuOOCouODs+WNmOS9je+8ieOCkui/lOOBl+OBvuOBmeOAglxuICpcbiAqICMjIyBFeGFtcGxlXG4gKiAgICAgKE1hdGguUEkvNCkudGFuKCk7IC8vID0+IDEuMFxuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHJldHVybiB7TnVtYmVyfSDjgr/jg7Pjgrjjgqfjg7Pjg4hcbiAqL1xuZnVuY3Rpb24gdGFuKCkgeyByZXR1cm4gTWF0aC50YW4odGhpcykgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwidGFuXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gTWF0aC50YW4odGhpcykgfSk7XG5cbi8qKlxuICogQG1ldGhvZCB0b0RlZ3JlZVxuICog44Op44K444Ki44Oz44KS5bqm44Gr5aSJ5o+b44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICBNYXRoLnJhZFRvRGVnKE1hdGguUEkvNCk7IC8vID0+IDQ1XG4gKlxuICogQHRoaXMgTnVtYmVyXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IOW6plxuICovXG5mdW5jdGlvbiB0b0RlZ3JlZSgpIHsgcmV0dXJuICh0aGlzICogUkFEX1RPX0RFRyk7IH1cbi8vIE51bWJlci5wcm90b3R5cGUuJG1ldGhvZChcInRvRGVncmVlXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gKHRoaXMqTWF0aC5SQURfVE9fREVHKTsgfSk7XG5cbi8qKlxuICogQG1ldGhvZCB0b1JhZGlhblxuICog5bqm44KS44Op44K444Ki44Oz44Gr5aSJ5o+b44GX44G+44GZ44CCXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqICAgICAoMTgwKS50b1JhZGlhbigpOyAvLyA9PiAzLjE0MTU5MjY1MzU4OTc5M1xuICpcbiAqIEB0aGlzIE51bWJlclxuICogQHJldHVybiB7TnVtYmVyfSDjg6njgrjjgqLjg7NcbiAqL1xuZnVuY3Rpb24gdG9SYWRpYW4oKSB7IHJldHVybiB0aGlzICogREVHX1RPX1JBRDsgfVxuLy8gTnVtYmVyLnByb3RvdHlwZS4kbWV0aG9kKFwidG9SYWRpYW5cIiwgZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzKk1hdGguREVHX1RPX1JBRDsgfSk7XG5cbnZhciBudW1iZXJFeHRlbnNpb25zID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIHRpbWVzOiB0aW1lcyxcbiAgc3RlcDogc3RlcCxcbiAgcm91bmQ6IHJvdW5kLFxuICBjZWlsOiBjZWlsLFxuICBmbG9vcjogZmxvb3IsXG4gIHRvSW50OiB0b0ludCxcbiAgdG9IZXg6IHRvSGV4LFxuICB0b0JpbjogdG9CaW4sXG4gIHRvVW5zaWduZWQ6IHRvVW5zaWduZWQsXG4gIHBhZGRpbmc6IHBhZGRpbmckMSxcbiAgdXB0bzogdXB0byxcbiAgZG93bnRvOiBkb3dudG8sXG4gIG1hcDogbWFwLFxuICBhYnM6IGFicyxcbiAgYWNvczogYWNvcyxcbiAgYXNpbjogYXNpbixcbiAgYXRhbjogYXRhbixcbiAgY29zOiBjb3MsXG4gIGV4cDogZXhwLFxuICBsb2c6IGxvZyxcbiAgbWF4OiBtYXgsXG4gIG1pbjogbWluLFxuICBjbGFtcDogY2xhbXAkMSxcbiAgcG93OiBwb3csXG4gIHNpbjogc2luLFxuICBzcXJ0OiBzcXJ0LFxuICB0YW46IHRhbixcbiAgdG9EZWdyZWU6IHRvRGVncmVlLFxuICB0b1JhZGlhbjogdG9SYWRpYW5cbn0pO1xuXG4vKipcbiAqIEBjbGFzcyBnbG9iYWwuRGF0ZVxuICogIyDmi6HlvLXjgZfjgZ8gRGF0ZSDjgq/jg6njgrlcbiAqIOaXpeS7mOOCkuaJseOBhiBEYXRlIOOCr+ODqeOCueOCkuaLoeW8teOBl+OBpuOBhOOBvuOBmeOAglxuICovXG5cbnZhciBNT05USCA9IFtcbiAgJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXG5dO1xuXG52YXIgV0VFSyA9IFtcbiAgJ1N1bmRheScsICdNb25kYXknLCAnVHVlc2RheScsICdXZWRuZXNkYXknLCAnVGh1cnNkYXknLCAnRnJpZGF5JywgJ1NhdHVyZGF5J1xuXTtcblxuLyoqXG4gKiBAbWV0aG9kIGZvcm1hdFxuICog5oyH5a6a44GX44Gf44OV44Kp44O844Oe44OD44OI44Gr5b6T44Gj44Gm5pel5LuY44KS5paH5a2X5YiX5YyW44GX44G+44GZ44CCXG4gKlxuICogPHRhYmxlIGJvcmRlcj1cIjFcIj5cbiAqICAgPHRyPjx0ZD7lpInmj5vmjIflrprmloflrZfliJc8L3RkPjx0ZD7mhI/lkbM8L3RkPjwvdHI+XG4gKiAgIDx0cj48dGQ+eXl5eTwvdGQ+PHRkPuilv+aapuW5tO+8iDTmoYHvvIk8L3RkPjwvdHI+XG4gKiAgIDx0cj48dGQ+eXk8L3RkPjx0ZD7opb/mmqblubTvvIgy5qGB77yJPC90ZD48L3RyPlxuICogICA8dHI+PHRkPnk8L3RkPjx0ZD7opb/mmqblubQ8L3RkPjwvdHI+XG4gKiAgIDx0cj48dGQ+TU1NTTwvdGQ+PHRkPuaciO+8iOiLseiqnuWQje+8iTwvdGQ+PC90cj5cbiAqICAgPHRyPjx0ZD5NTU08L3RkPjx0ZD7mnIjvvIjoi7Hoqp7nnIHnlaXlkI3vvIk8L3RkPjwvdHI+XG4gKiAgIDx0cj48dGQ+TU08L3RkPjx0ZD7mnIjvvIgy5qGB5pWw5a2X77yJPC90ZD48L3RyPlxuICogICA8dHI+PHRkPk08L3RkPjx0ZD7mnIg8L3RkPjwvdHI+XG4gKiAgIDx0cj48dGQ+ZGQ8L3RkPjx0ZD7ml6XvvIgy5qGB77yJPC90ZD48L3RyPlxuICogICA8dHI+PHRkPmQ8L3RkPjx0ZD7ml6U8L3RkPjwvdHI+XG4gKiAgIDx0cj48dGQ+RUVFRTwvdGQ+PHRkPuabnOaXpe+8iOiLseiqnuWQje+8iTwvdGQ+PC90cj5cbiAqICAgPHRyPjx0ZD5FRUU8L3RkPjx0ZD7mm5zml6XvvIjoi7Hoqp7nnIHnlaXlkI3vvIk8L3RkPjwvdHI+XG4gKiAgIDx0cj48dGQ+SEg8L3RkPjx0ZD7mmYLvvIgyNOaZgumWk+ihqOiomOODuzLmoYHvvIk8L3RkPjwvdHI+XG4gKiAgIDx0cj48dGQ+SDwvdGQ+PHRkPuaZgu+8iDI05pmC6ZaT6KGo6KiY77yJPC90ZD48L3RyPlxuICogICA8dHI+PHRkPm1tPC90ZD48dGQ+5YiG77yIMuahge+8iTwvdGQ+PC90cj5cbiAqICAgPHRyPjx0ZD5tPC90ZD48dGQ+5YiGPC90ZD48L3RyPlxuICogICA8dHI+PHRkPnNzPC90ZD48dGQ+56eS77yIMuahge+8iTwvdGQ+PC90cj5cbiAqICAgPHRyPjx0ZD5zPC90ZD48dGQ+56eSPC90ZD48L3RyPlxuICogPC90YWJsZT5cbiAqIOahgeaVsOOBjOaMh+WumuOBleOCjOOBpuOBhOOCi+OCguOBruOBrzDjg5Hjg4fjgqPjg7PjgrDjgZXjgozjgb7jgZnjgIJcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIChuZXcgRGF0ZSgpKS5mb3JtYXQoXCJ5eXl5LU1NLWRkKEVFRSlcIik7IC8vID0+IFwiMjAxNi0wNC0wNShUdWUpXCIg44Gq44GpXG4gKlxuICogQHRoaXMgRGF0ZVxuICogQHBhcmFtIHtTdHJpbmd9IHBhdHRlcm4g44OV44Kp44O844Oe44OD44OI5paH5a2X5YiXXG4gKiBAcmV0dXJuIHtTdHJpbmd9IOODleOCqeODvOODnuODg+ODiOaWh+Wtl+WIl+OBq+W+k+OBo+OBpueUn+aIkOOBleOCjOOBn+aWh+Wtl+WIl1xuICovXG5mdW5jdGlvbiBmb3JtYXQkMShwYXR0ZXJuKSB7XG4vLyBEYXRlLnByb3RvdHlwZS4kbWV0aG9kKCdmb3JtYXQnLCBmdW5jdGlvbihwYXR0ZXJuKSB7XG4gIHZhciB5ZWFyICAgID0gdGhpcy5nZXRGdWxsWWVhcigpO1xuICB2YXIgbW9udGggICA9IHRoaXMuZ2V0TW9udGgoKTtcbiAgdmFyIGRhdGUgICAgPSB0aGlzLmdldERhdGUoKTtcbiAgdmFyIGRheSAgICAgPSB0aGlzLmdldERheSgpO1xuICB2YXIgaG91cnMgICA9IHRoaXMuZ2V0SG91cnMoKTtcbiAgdmFyIG1pbnV0ZXMgPSB0aGlzLmdldE1pbnV0ZXMoKTtcbiAgdmFyIHNlY29uZHMgPSB0aGlzLmdldFNlY29uZHMoKTtcbiAgdmFyIG1pbGxzZWNvbmRzID0gdGhpcy5nZXRNaWxsaXNlY29uZHMoKTtcbiAgXG4gIHZhciBwYXR0ZXJucyA9IHtcbiAgICAneXl5eSc6IHBhZGRpbmcuY2FsbChTdHJpbmcoeWVhciksIDQsICcwJyksXG4gICAgLy8gJ3l5eXknOiBTdHJpbmcoeWVhcikucGFkZGluZyg0LCAnMCcpLFxuICAgICd5eSc6IHllYXIudG9TdHJpbmcoKS5zdWJzdHIoMiwgMiksXG4gICAgJ3knOiB5ZWFyLFxuXG4gICAgJ01NTU0nOiBNT05USFttb250aF0sXG4gICAgJ01NTSc6IE1PTlRIW21vbnRoXS5zdWJzdHIoMCwgMyksXG4gICAgJ01NJzogcGFkZGluZy5jYWxsKFN0cmluZyhtb250aCsxKSwgMiwgJzAnKSxcbiAgICAvLyAnTU0nOiBTdHJpbmcobW9udGgrMSkucGFkZGluZygyLCAnMCcpLFxuICAgICdNJzogKG1vbnRoKzEpLFxuXG4gICAgJ2RkJzogcGFkZGluZy5jYWxsKFN0cmluZyhkYXRlKSwgMiwgJzAnKSxcbiAgICAvLyAnZGQnOiBTdHJpbmcoZGF0ZSkucGFkZGluZygyLCAnMCcpLFxuICAgICdkJzogZGF0ZSxcblxuICAgICdFRUVFJzogV0VFS1tkYXldLFxuICAgICdFRUUnOiBXRUVLW2RheV0uc3Vic3RyKDAsIDMpLFxuXG4gICAgJ0hIJzogcGFkZGluZy5jYWxsKFN0cmluZyhob3VycyksIDIsICcwJyksXG4gICAgLy8gJ0hIJzogU3RyaW5nKGhvdXJzKS5wYWRkaW5nKDIsICcwJyksXG4gICAgJ0gnOiBob3VycyxcblxuICAgICdtbSc6IHBhZGRpbmcuY2FsbChTdHJpbmcobWludXRlcyksIDIsICcwJyksXG4gICAgLy8gJ21tJzogU3RyaW5nKG1pbnV0ZXMpLnBhZGRpbmcoMiwgJzAnKSxcbiAgICAnbSc6IG1pbnV0ZXMsXG5cbiAgICAnc3MnOiBwYWRkaW5nLmNhbGwoU3RyaW5nKHNlY29uZHMpLCAyLCAnMCcpLFxuICAgIC8vICdzcyc6IFN0cmluZyhzZWNvbmRzKS5wYWRkaW5nKDIsICcwJyksXG4gICAgJ3MnOiBzZWNvbmRzLFxuICAgIFxuICAgIC8vIC8vIGRhdGVcbiAgICAvLyAnZCc6IFN0cmluZygnMDAnICsgZGF0ZSkuc2xpY2UoLTIpLFxuICAgIC8vICdEJzogV0VFS1tkYXldLnN1YnN0cigwLCAzKSxcbiAgICAvLyAnaic6IGRhdGUsXG4gICAgLy8gJ2wnOiBXRUVLW2RheV0sXG4gICAgXG4gICAgLy8gLy8gbW9udGhcbiAgICAvLyAnbSc6IFN0cmluZygnMDAnICsgKG1vbnRoKzEpKS5zbGljZSgtMiksXG4gICAgLy8gJ00nOiBNT05USFttb250aF0uc3Vic3RyKDAsIDMpLFxuICAgIC8vICduJzogKG1vbnRoKzEpLFxuICAgIC8vICdGJzogTU9OVEhbbW9udGhdLFxuICAgIFxuICAgIC8vIC8vIHllYXJcbiAgICAvLyAneSc6IHllYXIudG9TdHJpbmcoKS5zdWJzdHIoMiwgMiksXG4gICAgLy8gJ1knOiB5ZWFyLFxuICAgIFxuICAgIC8vIC8vIHRpbWVcbiAgICAvLyAnRyc6IGhvdXJzLFxuICAgIC8vICdIJzogU3RyaW5nKCcwMCcgKyBob3Vycykuc2xpY2UoLTIpLFxuICAgIC8vICdpJzogU3RyaW5nKCcwMCcgKyBtaW51dGVzKS5zbGljZSgtMiksXG4gICAgLy8gJ3MnOiBTdHJpbmcoJzAwJyArIHNlY29uZHMpLnNsaWNlKC0yKSxcbiAgICAvLyAnUyc6IFN0cmluZygnMDAwJyArIG1pbGxzZWNvbmRzKS5zbGljZSgtMyksXG4gIH07XG5cbiAgdmFyIHJlZ3N0ciA9ICcoJyArIE9iamVjdC5rZXlzKHBhdHRlcm5zKS5qb2luKCd8JykgKyAnKSc7XG4gIHZhciByZSA9IG5ldyBSZWdFeHAocmVnc3RyLCAnZycpO1xuXG4gIHJldHVybiBwYXR0ZXJuLnJlcGxhY2UocmUsIGZ1bmN0aW9uKHN0cikge1xuICAgIHJldHVybiBwYXR0ZXJuc1tzdHJdO1xuICB9KTtcbn1cblxudmFyIGRhdGVFeHRlbnNpb25zID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIGZvcm1hdDogZm9ybWF0JDFcbn0pO1xuXG4vKipcbiAqIEBjbGFzcyBnbG9iYWwuRGF0ZVxuICogRGF0ZeOCr+ODqeOCueOBrnN0YXRpY+aLoeW8tVxuICovXG5cbi8qKlxuICogQG1ldGhvZCBjYWxjdWxhdGVBZ2VcbiAqIEBzdGF0aWNcbiAqIOaMh+WumuOBl+OBn+iqleeUn+aXpeOBi+OCieOAgeePvuWcqOOBvuOBn+OBr+aMh+WumuOBl+OBn+aXpeS7mOOBq+OBiuOBkeOCi+W5tOm9ouOCkuioiOeul+OBl+OBvuOBmeOAglxuICpcbiAqICMjI1JlZmVyZW5jZVxuICogLSBbSmF2YXNjcmlwdOOBp+iqleeUn+aXpeOBi+OCieePvuWcqOOBruW5tOm9ouOCkueul+WHul0oaHR0cDovL3FpaXRhLmNvbS9uMGJpc3VrZS9pdGVtcy9kZDUzN2JkNGNiZTlhYjUwMWNlOClcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIERhdGUuY2FsY3VsYXRlQWdlKFwiMTk5MC0wMS0xN1wiKTsgLy8gPT4gMjYg44Gq44GpXG4gKlxuICogQHBhcmFtIHtTdHJpbmd8RGF0ZX0gYmlydGhkYXkg6KqV55Sf5pelXG4gKiBAcGFyYW0ge1N0cmluZ3xEYXRlfSBbd2hlbj3mnKzml6VdIOWfuua6luOBruaXpeS7mFxuICogQHJldHVybiB7TnVtYmVyfSDlubTpvaJcbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlQWdlKGJpcnRoZGF5LCB3aGVuKSB7XG4vLyBEYXRlLiRtZXRob2QoJ2NhbGN1bGF0ZUFnZScsIGZ1bmN0aW9uKGJpcnRoZGF5LCB3aGVuKSB7XG4gIC8vIGJpcnRoZGF5XG4gIGlmICh0eXBlb2YgYmlydGhkYXkgPT09ICdzdHJpbmcnKSB7XG4gICAgYmlydGhkYXkgPSBuZXcgRGF0ZShiaXJ0aGRheSk7XG4gIH1cbiAgLy8gd2hlblxuICBpZiAoIXdoZW4pIHtcbiAgICB3aGVuID0gbmV3IERhdGUoKTtcbiAgfVxuICBlbHNlIGlmICh0eXBlb2Ygd2hlbiA9PT0gJ3N0cmluZycpIHtcbiAgICB3aGVuID0gbmV3IERhdGUod2hlbik7XG4gIH1cblxuICB2YXIgYm4gPSBuZXcgRGF0ZShiaXJ0aGRheS5nZXRUaW1lKCkpLnNldEZ1bGxZZWFyKDI1Nik7XG4gIHZhciB3biA9IG5ldyBEYXRlKHdoZW4uZ2V0VGltZSgpKS5zZXRGdWxsWWVhcigyNTYpO1xuICB2YXIgc3RlcCA9ICh3biA8IGJuKSA/IDEgOiAwO1xuXG4gIHJldHVybiAod2hlbi5nZXRGdWxsWWVhcigpIC0gYmlydGhkYXkuZ2V0RnVsbFllYXIoKSkgLSBzdGVwO1xufVxuXG52YXIgZGF0ZVN0YXRpY0V4dGVuc2lvbnMgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgY2FsY3VsYXRlQWdlOiBjYWxjdWxhdGVBZ2Vcbn0pO1xuXG4vKipcbiAqIE1vdXNlRXZlbnQvVG91Y2jmi6HlvLVcbiAqIOODnuOCpuOCueOBrljluqfmqJkuXG4gKi9cbnZhciBwb2ludFggPSB7XG4gIC8qKiBAdGhpcyB7TW91c2VFdmVudHxUb3VjaH0gKi9cbiAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5jbGllbnRYIC0gLyoqIEB0eXBlIHtIVE1MRWxlbWVudH0gKi8odGhpcy50YXJnZXQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XG4gIH1cbn07XG5cbi8qKlxuICogTW91c2VFdmVudC9Ub3VjaOaLoeW8tVxuICog44Oe44Km44K544GuWeW6p+aomS5cbiAqL1xudmFyIHBvaW50WSA9IHtcbiAgLyoqIEB0aGlzIHtNb3VzZUV2ZW50fFRvdWNofSAqL1xuICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmNsaWVudFkgLSAvKiogQHR5cGUge0hUTUxFbGVtZW50fSAqLyh0aGlzLnRhcmdldCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICB9XG59O1xuXG4vKipcbiAqIFRvdWNoRXZlbnTmi6HlvLVcbiAqIOOCv+ODg+ODgeOCpOODmeODs+ODiOOBrljluqfmqJkuXG4gKi9cbnZhciB0b3VjaFBvaW50WCA9IHtcbiAgLyoqIEB0aGlzIHtUb3VjaEV2ZW50fSAqL1xuICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnRvdWNoZXNbMF0uY2xpZW50WCAtIC8qKiBAdHlwZSB7SFRNTEVsZW1lbnR9ICovKHRoaXMudGFyZ2V0KS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xuICAgIC8vIHJldHVybiB0aGlzLnRvdWNoZXNbMF0ucGFnZVggLSB0aGlzLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0IC0gdG0uZ2xvYmFsLnNjcm9sbFg7XG4gIH1cbn07XG5cbi8qKlxuICogVG91Y2hFdmVudOaLoeW8tVxuICog44K/44OD44OB44Kk44OZ44Oz44OI44GuWeW6p+aomS5cbiAqL1xudmFyIHRvdWNoUG9pbnRZID0ge1xuICAvKiogQHRoaXMge1RvdWNoRXZlbnR9ICovXG4gIGdldDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMudG91Y2hlc1swXS5jbGllbnRZIC0gLyoqIEB0eXBlIHtIVE1MRWxlbWVudH0gKi8odGhpcy50YXJnZXQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcbiAgICAvLyByZXR1cm4gdGhpcy50b3VjaGVzWzBdLnBhZ2VZIC0gdGhpcy50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIC0gdG0uZ2xvYmFsLnNjcm9sbFk7XG4gIH1cbn07XG5cbi8qKlxuICogZ2xvYmFsLkV2ZW50XG4gKiDml6LlrZjjga5FdmVudOOCquODluOCuOOCp+OCr+ODiOaLoeW8tVxuICovXG5cbi8qKlxuICogQG1ldGhvZCBzdG9wXG4gKiDjgqTjg5njg7Pjg4jjga7jg4fjg5Xjgqnjg6vjg4jlh6bnkIYgJiDkvJ3pgZTjgpLmraLjgoHjgotcbiAqL1xuZnVuY3Rpb24gc3RvcCgpIHtcbiAgLy8g44Kk44OZ44Oz44OI44Kt44Oj44Oz44K744OrXG4gIHRoaXMucHJldmVudERlZmF1bHQoKTtcbiAgLy8g44Kk44OZ44Oz44OI5Lyd6YGU44KS5q2i44KB44KLXG4gIHRoaXMuc3RvcFByb3BhZ2F0aW9uKCk7XG59XG5cblxuLy8gOyhmdW5jdGlvbigpIHtcblxuICAvLyBpZiAoIXBoaW5hLmdsb2JhbC5FdmVudCkgcmV0dXJuIDtcblxuICAvKipcbiAgICogQGNsYXNzIGdsb2JhbC5FdmVudFxuICAgKiDml6LlrZjjga5FdmVudOOCquODluOCuOOCp+OCr+ODiOaLoeW8tVxuICAgKi9cbiAgICBcbiAgLy8gLyoqXG4gIC8vICAqIEBtZXRob2Qgc3RvcFxuICAvLyAgKiDjgqTjg5njg7Pjg4jjga7jg4fjg5Xjgqnjg6vjg4jlh6bnkIYgJiDkvJ3pgZTjgpLmraLjgoHjgotcbiAgLy8gICovXG4gIC8vIEV2ZW50LnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgLy8g44Kk44OZ44Oz44OI44Kt44Oj44Oz44K744OrXG4gIC8vICAgdGhpcy5wcmV2ZW50RGVmYXVsdCgpO1xuICAvLyAgIC8vIOOCpOODmeODs+ODiOS8nemBlOOCkuatouOCgeOCi1xuICAvLyAgIHRoaXMuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIC8vIH07XG5cbi8vIH0pKCk7XG5cblxuLy8gKGZ1bmN0aW9uKCkge1xuXG4vLyAgIGlmICghcGhpbmEuZ2xvYmFsLk1vdXNlRXZlbnQpIHJldHVybiA7XG5cbi8vICAgLyoqXG4vLyAgICAqIEBjbGFzcyBnbG9iYWwuTW91c2VFdmVudFxuLy8gICAgKiBNb3VzZUV2ZW50IOOCr+ODqeOCuVxuLy8gICAgKi9cbiAgXG4vLyAgIC8qKlxuLy8gICAgKiBAbWV0aG9kICAgIHBvaW50WFxuLy8gICAgKiDjg57jgqbjgrnjga5Y5bqn5qiZLlxuLy8gICAgKi9cbi8vICAgTW91c2VFdmVudC5wcm90b3R5cGUuZ2V0dGVyKFwicG9pbnRYXCIsIGZ1bmN0aW9uKCkge1xuLy8gICAgIHJldHVybiB0aGlzLmNsaWVudFggLSB0aGlzLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xuLy8gICAgIC8vIHJldHVybiB0aGlzLnBhZ2VYIC0gdGhpcy50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCAtIHdpbmRvdy5zY3JvbGxYO1xuLy8gICB9KTtcbiAgXG4vLyAgIC8qKlxuLy8gICAgKiBAbWV0aG9kICAgIHBvaW50WVxuLy8gICAgKiDjg57jgqbjgrnjga5Z5bqn5qiZLlxuLy8gICAgKi9cbi8vICAgTW91c2VFdmVudC5wcm90b3R5cGUuZ2V0dGVyKFwicG9pbnRZXCIsIGZ1bmN0aW9uKCkge1xuLy8gICAgIHJldHVybiB0aGlzLmNsaWVudFkgLSB0aGlzLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG4vLyAgICAgLy8gcmV0dXJuIHRoaXMucGFnZVkgLSB0aGlzLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSB3aW5kb3cuc2Nyb2xsWTtcbi8vICAgfSk7XG4gICAgXG4vLyB9KSgpO1xuXG5cbi8vIChmdW5jdGlvbigpIHtcbiAgICBcbi8vICAgaWYgKCFwaGluYS5nbG9iYWwuVG91Y2hFdmVudCkgcmV0dXJuIDtcbiAgXG4gIFxuLy8gICAvKipcbi8vICAgICogQGNsYXNzIGdsb2JhbC5Ub3VjaEV2ZW50XG4vLyAgICAqIFRvdWNoRXZlbnQg44Kv44Op44K5XG4vLyAgICAqL1xuICBcbi8vICAgLyoqXG4vLyAgICAqIEBtZXRob2QgICAgcG9pbnRYXG4vLyAgICAqIOOCv+ODg+ODgeOCpOODmeODs+ODiC5cbi8vICAgICovXG4vLyAgIFRvdWNoRXZlbnQucHJvdG90eXBlLmdldHRlcihcInBvaW50WFwiLCBmdW5jdGlvbigpIHtcbi8vICAgICAgIHJldHVybiB0aGlzLnRvdWNoZXNbMF0uY2xpZW50WCAtIHRoaXMudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XG4vLyAgICAgICAvLyByZXR1cm4gdGhpcy50b3VjaGVzWzBdLnBhZ2VYIC0gdGhpcy50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCAtIHRtLmdsb2JhbC5zY3JvbGxYO1xuLy8gICB9KTtcbiAgXG4vLyAgIC8qKlxuLy8gICAgKiBAbWV0aG9kICAgIHBvaW50WVxuLy8gICAgKiDjgr/jg4Pjg4HjgqTjg5njg7Pjg4guXG4vLyAgICAqL1xuLy8gICBUb3VjaEV2ZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJwb2ludFlcIiwgZnVuY3Rpb24oKSB7XG4vLyAgICAgICByZXR1cm4gdGhpcy50b3VjaGVzWzBdLmNsaWVudFkgLSB0aGlzLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG4vLyAgICAgICAvLyByZXR1cm4gdGhpcy50b3VjaGVzWzBdLnBhZ2VZIC0gdGhpcy50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIC0gdG0uZ2xvYmFsLnNjcm9sbFk7XG4vLyAgIH0pOyAgXG4gICAgXG4vLyB9KSgpO1xuXG5cbi8vIChmdW5jdGlvbigpIHtcbiAgICBcbi8vICAgaWYgKCFwaGluYS5nbG9iYWwuVG91Y2gpIHJldHVybiA7XG4gIFxuLy8gICAvKipcbi8vICAgICogQGNsYXNzIGdsb2JhbC5Ub3VjaFxuLy8gICAgKiBUb3VjaEV2ZW50IOOCr+ODqeOCuVxuLy8gICAgKi9cbiAgXG4vLyAgIC8qKlxuLy8gICAgKiBAbWV0aG9kICAgIHBvaW50WFxuLy8gICAgKiDjgr/jg4Pjg4HjgqTjg5njg7Pjg4guXG4vLyAgICAqL1xuLy8gICBUb3VjaC5wcm90b3R5cGUuZ2V0dGVyKFwicG9pbnRYXCIsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgcmV0dXJuIHRoaXMuY2xpZW50WCAtIHRoaXMudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XG4vLyAgIH0pO1xuXG4vLyAgIC8qKlxuLy8gICAgKiBAbWV0aG9kICAgIHBvaW50WVxuLy8gICAgKiDjgr/jg4Pjg4HjgqTjg5njg7Pjg4guXG4vLyAgICAqL1xuLy8gICBUb3VjaC5wcm90b3R5cGUuZ2V0dGVyKFwicG9pbnRZXCIsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgcmV0dXJuIHRoaXMuY2xpZW50WSAtIHRoaXMudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcbi8vICAgfSk7XG4gICAgXG4vLyB9KSgpO1xuXG4vKiogQHR5cGVkZWYge1wiT2JqZWN0XCJ8XCJBcnJheVwifFwiQXJyYXlTdGF0aWNcInxcIk1hdGhcInxcIlN0cmluZ1wifFwiTnVtYmVyXCJ8XCJEYXRlXCJ8XCJEYXRlU3RhdGljXCJ9IEV4dGVuZGFibGVPYmplY3RUeXBlICovXG4vKiogQHR5cGVkZWYge3sgW2tleSBpbiBFeHRlbmRhYmxlT2JqZWN0VHlwZV06IGFueSB9IH0gT2JqZWN0VHlwZU1hcEZvckV4dGVuc2lvbiAqL1xuLyoqIEB0eXBlZGVmIHt7IFtrZXkgaW4gRXh0ZW5kYWJsZU9iamVjdFR5cGVdOiBGdW5jdGlvbiB8IGltcG9ydCgnLi9waGluYScpLkFjY2Vzc29yRXh0ZW5kT2JqZWN0IHwgbnVtYmVyIHwgc3RyaW5nIH19IEV4dGVuc2lvbk1ldGhvZE1hcCAqL1xuXG4vKipcbiAqIOOCq+OCueOCv+ODoOODoeOCveODg+ODieOCkuWumue+qVxuICogQHBhcmFtIHthbnl9IG9ialxuICogQHBhcmFtIHtzdHJpbmd9IG1ldGhvZE5hbWVcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGZ1bmNcbiAqL1xuZnVuY3Rpb24gX2RlZmluZU1ldGhvZChvYmosIG1ldGhvZE5hbWUsIGZ1bmMpIHtcbiAgcmV0dXJuICRtZXRob2QuY2FsbChvYmosIG1ldGhvZE5hbWUsIGZ1bmMpO1xuICAvLyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBtZXRob2ROYW1lLCB7XG4gIC8vICAgdmFsdWU6IGZ1bmMsXG4gIC8vICAgZW51bWVyYWJsZTogZmFsc2UsXG4gIC8vICAgd3JpdGFibGU6IHRydWVcbiAgLy8gfSlcbn1cblxuLyoqXG4gKiDjgqvjgrnjgr/jg6DjgqLjgq/jgrvjgrXjgpLlrprnvqlcbiAqIEBwYXJhbSB7YW55fSBvYmpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhY2Nlc3Nvck5hbWVcbiAqIEBwYXJhbSB7aW1wb3J0KCcuL3BoaW5hJykuQWNjZXNzb3JFeHRlbmRPYmplY3R9IGV4dGVuZE9ialxuICovXG5mdW5jdGlvbiBfZGVmaW5lQWNjZXNzb3Iob2JqLCBhY2Nlc3Nvck5hbWUsIGV4dGVuZE9iaikge1xuICByZXR1cm4gYWNjZXNzb3IuY2FsbChvYmosIGFjY2Vzc29yTmFtZSwgZXh0ZW5kT2JqKTtcbn1cblxuLyoqXG4gKiDmsY7nlKjjgqrjg5bjgrjjgqfjgq/jg4jmi6HlvLXplqLmlbBcbiAqIEBwYXJhbSB7YW55fSB0YXJnZXRPYmog5a++6LGh44OT44Or44OI44Kk44Oz44Kq44OW44K444Kn44Kv44OIIGV4KSBBcnJheS5wcm90b3R5cGVcbiAqIEBwYXJhbSB7RXh0ZW5zaW9uTWV0aG9kTWFwfSBleHRlbnNpb25NYXBcbiAqL1xuZnVuY3Rpb24gX2V4dGVuZCh0YXJnZXRPYmosIGV4dGVuc2lvbk1hcCkge1xuICBPYmplY3Qua2V5cyhleHRlbnNpb25NYXApLmZvckVhY2goKGtleSkgPT4ge1xuICAgIHZhciB2YWx1ZSA9IGV4dGVuc2lvbk1hcFtrZXldO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgX2RlZmluZU1ldGhvZCh0YXJnZXRPYmosIGtleSwgdmFsdWUpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmICh2YWx1ZS5nZXQgfHwgdmFsdWUuc2V0KSkge1xuICAgICAgX2RlZmluZUFjY2Vzc29yKHRhcmdldE9iaiwga2V5LCB2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOOBneOBruS7lnN0YXRpY+WApOOAgU1hdGguREVHX1RPX1JBROOBquOBqVxuICAgICAgdGFyZ2V0T2JqW2tleV0gPSB2YWx1ZTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOOCquODluOCuOOCp+OCr+ODiOWQjeensCA8LT4g5a6f6Zqb44Gu44Kq44OW44K444Kn44Kv44OIXG4gKiBAdHlwZSB7T2JqZWN0VHlwZU1hcEZvckV4dGVuc2lvbn1cbiAqL1xudmFyIEV4dGVuZGFibGVPYmplY3RUeXBlTWFwID0ge1xuICBPYmplY3Q6IE9iamVjdC5wcm90b3R5cGUsXG4gIEFycmF5OiBBcnJheS5wcm90b3R5cGUsXG4gIEFycmF5U3RhdGljOiBBcnJheSxcbiAgTWF0aDogTWF0aCwgLy8gTWF0aOOBr1N0YXRpY+OBruOBv1xuICBTdHJpbmc6IFN0cmluZy5wcm90b3R5cGUsXG4gIE51bWJlcjogTnVtYmVyLnByb3RvdHlwZSxcbiAgRGF0ZTogRGF0ZS5wcm90b3R5cGUsXG4gIERhdGVTdGF0aWM6IERhdGUsXG59O1xuXG4vKipcbiAqIOOCquODluOCuOOCp+OCr+ODiOWQjeensCA8LT4g5ouh5by144Oh44K944OD44OJ44Oe44OD44OXXG4gKiBAdHlwZSB7T2JqZWN0VHlwZU1hcEZvckV4dGVuc2lvbn1cbiAqICovXG52YXIgRXh0ZW5zaW9uVHlwZU1hcCA9IHtcbiAgT2JqZWN0OiBvYmplY3RFeHRlbnNpb25zLFxuICBBcnJheTogYXJyYXlFeHRlbnNpb25zLFxuICBBcnJheVN0YXRpYzogYXJyYXlTdGF0aWNFeHRlbnNpb25zLFxuICBNYXRoOiBtYXRoRXh0ZW5zaW9ucyxcbiAgU3RyaW5nOiBzdHJpbmdFeHRlbnNpb25zLFxuICBOdW1iZXI6IG51bWJlckV4dGVuc2lvbnMsXG4gIERhdGU6IGRhdGVFeHRlbnNpb25zLFxuICBEYXRlU3RhdGljOiBkYXRlU3RhdGljRXh0ZW5zaW9ucyxcbn07XG5cbi8qKlxuICogT2JqZWN044Gq44Gp44Gu5qiZ5rqW57WE44G/6L6844G/44Kq44OW44K444Kn44Kv44OI44Gu5ouh5by144KS6KGM44GGXG4gKiAtIOW8leaVsOeEoeaMh+WumuOBp+OBr+WFqOOBpuOBruaLoeW8teOCkuihjOOBhlxuICogLSDmi6HlvLXjgZfjgZ/jgYTjgqrjg5bjgrjjgqfjgq/jg4jjgIHjg6Hjgr3jg4Pjg4njgpLmloflrZfliJfjgafmjIflrprjgZnjgovjgZPjgajjgoLlj6/og71cbiAqXG4gKiBAZXhhbXBsZVxuICogLy8g5YWo5ouh5by177yI5b6T5p2l44GucGhpbmEuanPjga7nirbmhYvvvIlcbiAqIGV4dGVuZEJ1aWx0SW5PYmplY3QoKTtcbiAqXG4gKiAvLyBOdW1iZXLjgqrjg5bjgrjjgqfjgq/jg4jjga7kuIDpg6jjg6Hjgr3jg4Pjg4njgaDjgZHmi6HlvLVcbiAqIGV4dGVuZEJ1aWx0SW5PYmplY3QoXCJOdW1iZXJcIiwgW1wiY2xhbXBcIiwgXCJ1cHRvXCJdKTtcbiAqXG4gKiBAcGFyYW0ge0V4dGVuZGFibGVPYmplY3RUeXBlfSBbb2JqZWN0VHlwZV0gXCJBcnJheVwi44Gq44Gp44Gu5a++6LGh44Kq44OW44K444Kn44Kv44OI5paH5a2X5YiXXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBbbWV0aG9kTmFtZUxpc3RdIOODoeOCveODg+ODieWQjeaWh+Wtl+WIl1xuICogQHJldHVybnMge3ZvaWR9XG4gKi9cbmZ1bmN0aW9uIGV4dGVuZEJ1aWx0SW5PYmplY3Qob2JqZWN0VHlwZSwgbWV0aG9kTmFtZUxpc3QpIHtcbiAgaWYgKCFvYmplY3RUeXBlKSB7XG4gICAgLy8g5ouh5by15YWo44Gm44KS5LiA5ous44Gn6KGM44GGXG4gICAgT2JqZWN0LmtleXMoRXh0ZW5kYWJsZU9iamVjdFR5cGVNYXApLmZvckVhY2goKG9ialR5cGUpID0+IHtcbiAgICAgIF9leHRlbmQoRXh0ZW5kYWJsZU9iamVjdFR5cGVNYXBbb2JqVHlwZV0sIEV4dGVuc2lvblR5cGVNYXBbb2JqVHlwZV0pO1xuICAgIH0pO1xuICAgIC8vIF9leHRlbmQoT2JqZWN0LnByb3RvdHlwZSwgb2JqZWN0RXh0ZW5zaW9ucyk7XG4gICAgLy8gX2V4dGVuZChBcnJheS5wcm90b3R5cGUsIGFycmF5RXh0ZW5zaW9ucyk7XG4gICAgLy8gX2V4dGVuZChBcnJheSwgYXJyYXlTdGF0aWNFeHRlbnNpb25zKTtcbiAgICAvLyBfZXh0ZW5kKFN0cmluZy5wcm90b3R5cGUsIHN0cmluZ0V4dGVuc2lvbnMpO1xuICAgIC8vIF9leHRlbmQoTnVtYmVyLnByb3RvdHlwZSwgbnVtYmVyRXh0ZW5zaW9ucyk7XG4gICAgLy8gX2V4dGVuZChNYXRoLCBtYXRoRXh0ZW5zaW9ucyk7XG4gICAgLy8gX2V4dGVuZChEYXRlLnByb3RvdHlwZSwgZGF0ZUV4dGVuc2lvbnMpO1xuICAgIC8vIF9leHRlbmQoRGF0ZSwgZGF0ZVN0YXRpY0V4dGVuc2lvbnMpO1xuICB9IGVsc2Uge1xuICAgIC8vIOWAi+WIpeaLoeW8tVxuICAgIHZhciB0YXJnZXRPYmplY3QgPSBFeHRlbmRhYmxlT2JqZWN0VHlwZU1hcFtvYmplY3RUeXBlXTtcbiAgICBpZiAoIXRhcmdldE9iamVjdCkge1xuICAgICAgLy8gYCR7b2JqZWN0VHlwZX3jga/mi6HlvLXlj6/og73lr77osaHjgafjga/jgYLjgorjgb7jgZvjgpNgXG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChtZXRob2ROYW1lTGlzdCkge1xuICAgICAgY29uc3QgZXh0cyA9IEV4dGVuc2lvblR5cGVNYXBbb2JqZWN0VHlwZV07XG5cbiAgICAgIC8qKiBAdHlwZSBFeHRlbnNpb25NZXRob2RNYXAgKi9cbiAgICAgIGNvbnN0IG1ldGhvZE1hcCA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICBtZXRob2ROYW1lTGlzdC5mb3JFYWNoKChtZXRob2ROYW1lKSA9PiB7XG4gICAgICAgIGlmICghZXh0c1ttZXRob2ROYW1lXSkge1xuICAgICAgICAgIC8vIFRPRE86IG5vIG1ldGhvZCBlcnJvclxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBtZXRob2RNYXBbbWV0aG9kTmFtZV0gPSBleHRzW21ldGhvZE5hbWVdO1xuICAgICAgfSk7XG5cbiAgICAgIF9leHRlbmQodGFyZ2V0T2JqZWN0LCBtZXRob2RNYXApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyB0YXJnZXRPYmplY3Tjga7mi6HlvLXlhajjgabjgpLooYzjgYZcbiAgICAgIGNvbnN0IGV4dHMgPSBFeHRlbnNpb25UeXBlTWFwW29iamVjdFR5cGVdO1xuICAgICAgX2V4dGVuZCh0YXJnZXRPYmplY3QsIGV4dHMpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIGRvbS9FdmVudCDkuIDmi6zmi6HlvLXnlKjjg6Hjgr3jg4Pjg4lcbiAqL1xuZnVuY3Rpb24gZXh0ZW5kRXZlbnRPYmplY3QoKSB7XG4gIGNvbnN0IGdldHRlciQxID0gZ2V0dGVyO1xuXG4gIFtNb3VzZUV2ZW50LCBUb3VjaF0uZm9yRWFjaCgoZXZlbnRPYmplY3QpID0+IHtcbiAgICBnZXR0ZXIkMS5jYWxsKGV2ZW50T2JqZWN0LnByb3RvdHlwZSwgXCJwb2ludFhcIiwgcG9pbnRYLmdldCk7XG4gICAgZ2V0dGVyJDEuY2FsbChldmVudE9iamVjdC5wcm90b3R5cGUsIFwicG9pbnRZXCIsIHBvaW50WS5nZXQpO1xuICB9KTtcblxuICBnZXR0ZXIkMS5jYWxsKFRvdWNoRXZlbnQucHJvdG90eXBlLCBcInBvaW50WFwiLCB0b3VjaFBvaW50WC5nZXQpO1xuICBnZXR0ZXIkMS5jYWxsKFRvdWNoRXZlbnQucHJvdG90eXBlLCBcInBvaW50WVwiLCB0b3VjaFBvaW50WS5nZXQpO1xuXG4gIF9kZWZpbmVNZXRob2QoRXZlbnQucHJvdG90eXBlLCBcInN0b3BcIiwgc3RvcCk7XG59XG5cbi8qKlxuICog44Kr44K544K/44Og44Kk44OZ44Oz44OI44Gu5Z+65pys44OR44Op44Oh44O844K/ICBcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEJhc2ljRXZlbnRPYmplY3RcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB0eXBlIOOCpOODmeODs+ODiOWQjVxuICogQHByb3BlcnR5IHthbnl9IFt0YXJnZXRdIOOCpOODmeODs+ODiOWvvuixoVxuICovXG5cbi8qKlxuICog44Kk44OZ44Oz44OI44Oq44K544OK44Go44Gq44KL6Zai5pWwICBcbiAqIHRoaXPjga7lj4Lnhafjga/lkbzjgbPlh7rjgZfjgZ/jgqrjg5bjgrjjgqfjgq/jg4joh6rouqvjgajjgarjgotcbiAqIEBjYWxsYmFjayBQaGluYUV2ZW50SGFuZGxlclxuICogQHBhcmFtIHtCYXNpY0V2ZW50T2JqZWN0ICYge1trZXk6c3RyaW5nXTphbnl9fSBldmVudCBCYXNpY0V2ZW50T2JqZWN044Gr5Yqg44GI44CB6Ieq6Lqr44Gn5LuY44GR5Yqg44GI44Gf44OH44O844K/44KS44OR44Op44Oh44O844K/44Go44GX44Gm5rih44GZ44GT44Go44GM44Gn44GN44KLXG4gKiBAdHlwZWRlZiB7UGhpbmFFdmVudEhhbmRsZXJ9IFBoaW5hRXZlbnRMaXN0ZW5lclxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLnV0aWwuRXZlbnREaXNwYXRjaGVyXG4gKiBcbiAqICMg44Kk44OZ44Oz44OI44KS5omx44GG44Gf44KB44Gu44Kv44Op44K5XG4gKiDjgqTjg5njg7Pjg4jjgpLmibHjgYbjgZ/jgoHjga7jg6Hjgr3jg4Pjg4njgoTjg5fjg63jg5Hjg4bjgqPjgpLlrprnvqnjgZfjgabjgYTjgovjgq/jg6njgrnjgafjgZnjgIJcbiAqIHBoaW5hLmpzIOOBjOaPkOS+m+OBmeOCi+OCr+ODqeOCueOBruWkmuOBj+OBr+OBk+OBriBFdmVudERpc3BhdGNoZXIg44Kv44Op44K544Gu44K144OW44Kv44Op44K544Go44Gq44Gj44Gm44GE44KL44Gf44KB44CBXG4gKiDjgbvjgajjgpPjganjga7jgq/jg6njgrnjgaflrrnmmJPjgavjgqTjg5njg7Pjg4jjgpLmibHjgYbjgZPjgajjgYzjgafjgY3jgb7jgZnjgIJcbiAqXG4gKiDlvZPjgq/jg6njgrnjgatgb25ob2dlYOOBruOCiOOBhuOBq2Bvbn5g44Go44GE44GG5ZCN5YmN44Gn44Oh44K944OD44OJ44KS5a6a576p44GZ44KL44GT44Go44GnXG4gKiDjgqTjg5njg7Pjg4jjg6rjgrnjg4rjgpLoqK3lrprjgZnjgovjgZPjgajjgoLjgafjgY3jgovjgYzjgIHjgYLjgb7jgormjqjlpajjgZXjgozjgarjgYTjgIJcbiAqIOWRvOOBs+WHuuOBleOCjOOCi+mghuW6j+OBr+OAgeOBvuOBmm9ufumWouaVsOOBjOWRvOOBs+WHuuOBleOCjOOAgeOBneOBruW+jCBgb25g44Oh44K944OD44OJIOOBp+eZu+mMsuOBl+OBn+mghueVquOAglxuICogXG4gKiBAbWVtYmVyb2YgcGhpbmFcbiAqL1xuY2xhc3MgRXZlbnREaXNwYXRjaGVyIHtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHt7W2s6IHN0cmluZ106IFBoaW5hRXZlbnRIYW5kbGVyW119fVxuICAgICAqL1xuICAgIHRoaXMuX2xpc3RlbmVycyA9IHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIOOCpOODmeODs+ODiOODquOCueODiuOCkueZu+mMsuOBl+OBvuOBmeOAglxuICAgKiDnmbvpjLLjgZfjgZ/jgqTjg5njg7Pjg4jjg6rjgrnjg4rjga97QGxpbmsgI2ZsYXJlfSDjgoQge0BsaW5rICNmaXJlfeOCklxuICAgKiDku4vjgZfjgablrp/ooYzvvIjnmbrngavvvInjgZnjgovjgZPjgajjgYzjgafjgY3jgb7jgZnjgIJcbiAgICpcbiAgICog77yR44Gk44Gu44Kk44OZ44Oz44OI44Gr5a++44GZ44KL44Kk44OZ44Oz44OI44Oq44K544OK44Gv44GE44GP44Gk44Gn44KC55m76Yyy44GZ44KL44GT44Go44GM44Gn44GN44G+44GZ44CCXG4gICAqXG4gICAqIOOBhOOBj+OBpOOBi+OBruOCteODluOCr+ODqeOCueOBq+OBpOOBhOOBpuOBr+ODqeOCpOODluODqeODquOBjOeJueWumuadoeS7tuS4i+OBp+eZuueBq+OBmeOCi+OCpOODmeODs+ODiOOBjOOBguOCiuOBvuOBmeOAglxuICAgKiDkvovjgYjjgbAge0BsaW5rICNPYmplY3QyRH0g44Kv44Op44K544KS57aZ5om/44GX44Gf44Kv44Op44K544Gn44Gv44Om44O844K244O844Kk44Oz44K/44Op44Kv44K344On44Oz44Gr5a++44GX44GmXG4gICAqIFwicG9pbnRzdGFydFwi44Gq44Gp44Gu44Kk44OZ44Oz44OI44GM55m654Gr44GV44KM44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGNvbnN0IG15T2JqID0gbmV3IEV2ZW50RGlzcGF0Y2hlcigpO1xuICAgKiBteU9iai5vbihcIm15ZXZlbnRcIiwgKCk9PiB7XG4gICAqICAgY29uc29sZS5sb2coXCJFdmVudCAxXCIpO1xuICAgKiB9KTtcbiAgICogbXlPYmoub24oXCJteWV2ZW50XCIsICgpPT4ge1xuICAgKiAgIGNvbnNvbGUubG9nKFwiRXZlbnQgMlwiKTtcbiAgICogfSk7XG4gICAqIC8vIOOCpOODmeODs+ODiOeZuueBq1xuICAgKiBteU9iai5mbGFyZShcIm15ZXZlbnRcIik7IC8vIFwiRXZlbnQgMVwiIFwiRXZlbnQgMlwiXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiAvLyB0aGlz44Gv44Ki44Kv44OG44Kj44OW44GqU2NlbmXjgq/jg6njgrnjga7jgqTjg7Pjgrnjgr/jg7PjgrlcbiAgICogY29uc3Qgc2hhcGUgPSBuZXcgQ2lyY2xlU2hhcGUoKVxuICAgKiAgIC5hZGRDaGlsZFRvKHRoaXMpXG4gICAqICAgLnNldEludGVyYWN0aXZlKHRydWUpIC8vIGludGVyYWN0aXZl44OX44Ot44OR44OG44Kj44KSdHJ1ZeOBq+OBmeOCi1xuICAgKiAgIC5zZXRQb3NpdGlvbig1MCwgNTApO1xuICAgKiBzaGFwZS5vbihcInBvaW50c3RhcnRcIiwgZnVuY3Rpb24oZSkge1xuICAgKiAgIGNvbnNvbGUubG9nKFwiUG9pbnRlZCBzaGFwZVwiKTtcbiAgICogfSk7XG4gICAqXG4gICAqIEBjaGFpbmFibGVcbiAgICogXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOOCpOODmeODs+ODiOOBrueorumhnlxuICAgKiBAcGFyYW0ge1BoaW5hRXZlbnRIYW5kbGVyfSBsaXN0ZW5lciDjgqTjg5njg7Pjg4jjg6rjgrnjg4rjgajjgarjgovplqLmlbBcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBvbih0eXBlLCBsaXN0ZW5lcikge1xuICAgIGlmICh0aGlzLl9saXN0ZW5lcnNbdHlwZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5fbGlzdGVuZXJzW3R5cGVdID0gW107XG4gICAgfVxuXG4gICAgdGhpcy5fbGlzdGVuZXJzW3R5cGVdLnB1c2gobGlzdGVuZXIpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCpOODmeODs+ODiOODquOCueODiuOCkuWJiumZpOOBl+OBvuOBmeOAglxuICAgKiBcbiAgICog44GC44KL56iu6aGe44Gu44Kk44OZ44Oz44OI44Gr5a++44GZ44KL44Kk44OZ44Oz44OI44Oq44K544OK44KS44GZ44G544Gm5YmK6Zmk44GZ44KL44Gr44GvIHtAbGluayAjY2xlYXJFdmVudExpc3RlbmVyfSDjgpLkvb/nlKjjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAgICogXG4gICAqIEBleGFtcGxlXG4gICAqIGNvbnN0IG15T2JqID0gbmV3IEV2ZW50RGlzcGF0Y2hlcigpO1xuICAgKiBjb25zdCBldmVudEhhbmRsZXIgPSAoKT0+IHtcbiAgICogICBjb25zb2xlLmxvZyhcIkV2ZW50IGZpcmVkIVwiKTtcbiAgICogfSlcbiAgICogbXlPYmoub24oXCJteWV2ZW50XCIsIGV2ZW50SGFuZGxlcik7XG4gICAqIFxuICAgKiAvLyDjgqTjg5njg7Pjg4jnmbrngatcbiAgICogbXlPYmouZmxhcmUoXCJteWV2ZW50XCIpOyAvLyBcIkV2ZW50IGZpcmVkIVwiXG4gICAqIFxuICAgKiAvLyDjgqTjg5njg7Pjg4jliYrpmaRcbiAgICogbXlPYmoub2ZmKFwibXlldmVudFwiLCBldmVudEhhbmRsZXIpO1xuICAgKiBcbiAgICogQGNoYWluYWJsZVxuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg44Kk44OZ44Oz44OI44Gu56iu6aGeXG4gICAqIEBwYXJhbSB7UGhpbmFFdmVudEhhbmRsZXJ9IGxpc3RlbmVyIOOCpOODmeODs+ODiOODquOCueODiumWouaVsFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIG9mZih0eXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnNbdHlwZV07XG4gICAgdmFyIGluZGV4ID0gbGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgIGlmIChpbmRleCAhPSAtMSkge1xuICAgICAgbGlzdGVuZXJzLnNwbGljZShpbmRleCwxKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Kk44OZ44Oz44OI44OR44Op44Oh44O844K/44Kq44OW44K444Kn44Kv44OI44KS5oyH5a6a44GX44Gm44Kk44OZ44Oz44OI44KS55m654Gr44GX44G+44GZ44CCXG4gICAqIHtAbGluayAjZmxhcmV9IOOBruWGhemDqOWHpueQhuOBp+S9v+eUqOOAgeWNmOeLrOOBp+S9v+eUqOOBmeOCi+OBk+OBqOOBr+eogFxuICAgKiBcbiAgICogQGV4YW1wbGVcbiAgICogY29uc3QgbXlPYmogPSBuZXcgRXZlbnREaXNwYXRjaGVyKCk7XG4gICAqIGNvbnN0IGZpcmVQYXJhbSA9IHt0eXBlOiBcIm15ZXZlbnRcIn1cbiAgICogbXlPYmoub24oXCJteWV2ZW50XCIsIChlKT0+IHtcbiAgICogICBjb25zb2xlLmxvZyhlKTsgLy8ge3R5cGU6IFwibXlldmVudFwiLCB0YXJnZXQ6IG15T2JqfVxuICAgKiAgIGNvbnNvbGUubG9nKGUgPT09IGZpcmVQYXJhbSk7IC8vIC0+IHRydWVcbiAgICogfSk7XG4gICAqIFxuICAgKiBteU9iai5maXJlKGZpcmVQYXJhbSlcbiAgICogXG4gICAqIEBjaGFpbmFibGVcbiAgICpcbiAgICogQHBhcmFtIHtCYXNpY0V2ZW50T2JqZWN0fSBlIOOCpOODmeODs+ODiOODkeODqeODoeODvOOCv+OCquODluOCuOOCp+OCr+ODiFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gICBmaXJlKGUpIHtcbiAgICBlLnRhcmdldCA9IHRoaXM7XG4gICAgdmFyIG9sZEV2ZW50TmFtZSA9ICdvbicgKyBlLnR5cGU7XG4gICAgaWYgKHRoaXNbb2xkRXZlbnROYW1lXSkgdGhpc1tvbGRFdmVudE5hbWVdKGUpO1xuXG4gICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyc1tlLnR5cGVdO1xuICAgIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAgIC8vIHZhciB0ZW1wID0gbGlzdGVuZXJzLmNsb25lKCk7XG4gICAgICB2YXIgdGVtcCA9IGxpc3RlbmVycy5zbGljZSgwKTtcbiAgICAgIGZvciAodmFyIGk9MCxsZW49dGVtcC5sZW5ndGg7IGk8bGVuOyArK2kpIHtcbiAgICAgICAgICB0ZW1wW2ldLmNhbGwodGhpcywgZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Kk44OZ44Oz44OI5ZCN44KS5oyH5a6a44GX44Gm44Kr44K544K/44Og44Kk44OZ44Oz44OI44KS55m654Gr44GX44G+44GZ44CCXG4gICAqXG4gICAqIHBhcmFtIOW8leaVsOOCkuaMh+WumuOBmeOCi+OBk+OBqOOBq+OCiOOCiuOCq+OCueOCv+ODoOOCpOODmeODs+ODiOOBq+S7u+aEj+OBruODl+ODreODkeODhuOCo+OCkuioreWumuOBmeOCi+OBk+OBqOOBjOOBp+OBjeOBvuOBmeOAglxuICAgKiDjgZPjgozjgavjgojjgorjgIHlkbzjgbPlh7rjgZflhYPjgYzjgqTjg5njg7Pjg4jjg6rjgrnjg4rjgavku7vmhI/jga7lgKTjgpLmuKHjgZnjgZPjgajjgYzjgafjgY3jgb7jgZnjgIJcbiAgICog77yI44Gf44Gg44GXIHRhcmdldCDjg5fjg63jg5Hjg4bjgqPjgavjga/lv4XjgZroh6rliIboh6rouqvjgYzmoLzntI3jgZXjgozjgb7jgZnjgILvvIlcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogY29uc3QgbXlPYmogPSBuZXcgRXZlbnREaXNwYXRjaGVyKCk7XG4gICAqIG15T2JqLm9uKFwibXlldmVudFwiLCAoZSk9PiB7XG4gICAqICAgY29uc29sZS5sb2coZSk7IC8vIHt0eXBlOiBcIm15ZXZlbnRcIiwgdGFyZ2V0OiBteU9iaiwgZm9vOiBcImZvb1wifVxuICAgKiB9KTtcbiAgICogXG4gICAqIG15T2JqLmZsYXJlKFwibXlldmVudFwiLCB7Zm9vOiBcImZvb1wifSk7XG4gICAqIFxuICAgKiBAY2hhaW5hYmxlXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOOCq+OCueOCv+ODoOOCpOODmeODs+ODiOOBruWQjeWJjVxuICAgKiBAcGFyYW0ge2FueX0gW3BhcmFtXSDjgqvjgrnjgr/jg6DjgqTjg5njg7Pjg4jjgavjg5fjg63jg5Hjg4bjgqPjgpLoqK3lrprjgZnjgovjgZ/jgoHjga7jgqrjg5bjgrjjgqfjgq/jg4hcbiAgICogQHJldHVybnMge3RoaXN9XG4gICovXG4gIGZsYXJlKHR5cGUsIHBhcmFtKSB7XG4gICAgdmFyIGUgPSB7dHlwZTp0eXBlfTtcbiAgICBpZiAocGFyYW0pIHtcbiAgICAgIGZvckluLmNhbGwocGFyYW0sIGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgICAvLyBwYXJhbS5mb3JJbihmdW5jdGlvbihrZXksIHZhbCkge1xuICAgICAgICBlW2tleV0gPSB2YWw7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5maXJlKGUpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog5LiA5bqm44Gg44GR5a6f6KGM44GV44KM44KL44Kk44OZ44Oz44OI44Oq44K544OK44KS55m76Yyy44GX44G+44GZ44CCXG4gICAqIOaMh+WumuOBl+OBn+OCpOODmeODs+ODiOODquOCueODiuOBjOS4gOW6puWun+ihjOOBleOCjOOCi+OBqOOAgeOBneOBruOCpOODmeODs+ODiOODquOCueODiuOBr+WJiumZpOOBleOCjOOBvuOBmeOAglxuICAgKiDjgZ3jgozku6XlpJbjga7mjJnli5Xjga8ge0BsaW5rICNvbn0g44Go5ZCM44GY44Gn44GZ44CCXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiBjb25zdCBteU9iaiA9IG5ldyBFdmVudERpc3BhdGNoZXIoKTtcbiAgICogbXlPYmoub25lKFwiZmlyZW9uY2VcIiwgKGUpPT4ge1xuICAgKiAgIGNvbnNvbGUubG9nKFwiRXZlbnQgZmlyZWQhXCIpO1xuICAgKiB9KTtcbiAgICogXG4gICAqIG15T2JqLmZsYXJlKFwiZmlyZW9uY2VcIik7IC8vIFwiRXZlbnQgZmlyZWQhXCJcbiAgICogbXlPYmouZmxhcmUoXCJmaXJlb25jZVwiKTsgLy8g44Kk44OZ44Oz44OI44Oq44K544OK44Gv5YmK6Zmk44GV44KM44Gm44GE44KL44Gf44KB44CB5L2V44KC6LW344GN44G+44Gb44KTXG4gICAqIFxuICAgKiBAY2hhaW5hYmxlXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOOCpOODmeODs+ODiOOBrueorumhnlxuICAgKiBAcGFyYW0ge1BoaW5hRXZlbnRIYW5kbGVyfSBsaXN0ZW5lciDjgqTjg5njg7Pjg4jjg6rjgrnjg4rjgajjgarjgovplqLmlbBcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBvbmUodHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB2YXIgZnVuYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlc3VsdCA9IGxpc3RlbmVyLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7XG4gICAgICBzZWxmLm9mZih0eXBlLCBmdW5jKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHRoaXMub24odHlwZSwgZnVuYyk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjgqTjg5njg7Pjg4jjg6rjgrnjg4rjgYznmbvpjLLjgZXjgozjgabjgYTjgovjgYvjganjgYbjgYvjgpLoqr/jgbnjgb7jgZnjgIJcbiAgICogXG4gICAqIOaMh+WumuOBl+OBn+OCpOODmeODs+ODiOOBrueorumhnuOBq+WvvuOBmeOCi+OCpOODmeODs+ODiOODquOCueODiuOBjOeZu+mMsuOBleOCjOOBpuOBhOOCi+WgtOWQiOOBryB0cnVl44CBXG4gICAqIOOBneOBhuOBp+OBquOBhOWgtOWQiOOBryBmYWxzZSDjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogY29uc3QgbXlPYmogPSBuZXcgRXZlbnREaXNwYXRjaGVyKCk7XG4gICAqIG15T2JqLm9uKFwibXlldmVudFwiLCAoZSk9PiB7XG4gICAqICAgY29uc29sZS5sb2coXCJFdmVudCBmaXJlZCFcIik7XG4gICAqIH0pO1xuICAgKiBcbiAgICogbXlPYmouaGFzKFwibXlldmVudFwiKTsgLy8gdHJ1ZVxuICAgKiBteU9iai5oYXMoXCJvdGhlcmV2ZW50XCIpOyAvLyBmYWxzZVxuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg44Kk44OZ44Oz44OI44Gu56iu6aGeXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IOaMh+WumuOBl+OBn+OCpOODmeODs+ODiOOBruOCpOODmeODs+ODiOODquOCueODiuOBjOeZu+mMsuOBleOCjOOBpuOBhOOCi+OBi+OBqeOBhuOBi1xuICAgKi9cbiAgaGFzKHR5cGUpIHtcbiAgICByZXR1cm4gKHRoaXMuX2xpc3RlbmVyc1t0eXBlXSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuX2xpc3RlbmVyc1t0eXBlXS5sZW5ndGggIT09IDApIHx8ICEhdGhpc1snb24nICsgdHlwZV07XG4gIH1cblxuICAvKipcbiAgICog44GC44KL56iu6aGe44Gu44Kk44OZ44Oz44OI44Gr5a++44GZ44KL44Kk44OZ44Oz44OI44Oq44K544OK44KS44GZ44G544Gm5YmK6Zmk44GX44G+44GZ44CCXG4gICAqXG4gICAqIOeJueWumuOBruOCpOODmeODs+ODiOODquOCueODiuOBruOBv+OCkuWJiumZpOOBmeOCi+OBq+OBryB7QGxpbmsgI29mZn0g44KS5L2/55So44GX44Gm44GP44Gg44GV44GE44CCXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiBjb25zdCBteU9iaiA9IG5ldyBFdmVudERpc3BhdGNoZXIoKTtcbiAgICogbXlPYmoub24oXCJteWV2ZW50XCIsIChlKT0+IHtcbiAgICogICBjb25zb2xlLmxvZyhcIkV2ZW50IGZpcmVkIVwiKTtcbiAgICogfSk7XG4gICAqIFxuICAgKiBteU9iai5jbGVhckV2ZW50TGlzdGVuZXIoXCJteWV2ZW50XCIpO1xuICAgKiBteU9iai5mbGFyZShcIm15ZXZlbnRcIik7IC8vIOOCpOODmeODs+ODiOODquOCueODiuOBr+WJiumZpOOBleOCjOOBpuOBhOOCi+OBn+OCgeOAgeS9leOCgui1t+OBjeOBvuOBm+OCk1xuICAgKiBcbiAgICogQGNoYWluYWJsZVxuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg44Kk44OZ44Oz44OI44Gu56iu6aGeXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgY2xlYXJFdmVudExpc3RlbmVyKHR5cGUpIHtcbiAgICB2YXIgb2xkRXZlbnROYW1lID0gJ29uJyArIHR5cGU7XG4gICAgaWYgKHRoaXNbb2xkRXZlbnROYW1lXSkgZGVsZXRlIHRoaXNbb2xkRXZlbnROYW1lXTtcbiAgICB0aGlzLl9saXN0ZW5lcnNbdHlwZV0gPSBbXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxufVxuXG4vKipcbiAqIOW+k+adpeOBrmNsZWFy44Oh44K944OD44OJ44KC6L+95Yqg5a6a576pXG4gKiDjgrXjg5bjgq/jg6njgrnvvIhUd2VlbmVy44Kv44Op44K5562J77yJ44GnY2xlYXLjgYzjgqrjg7zjg5Djg7zjg6njgqTjg4njgZXjgozjgovloLTlkIjjgIFjbGVhckxpc3RlbmVyc+OCkuS9v+eUqOOBmeOCi1xuICovXG4kbWV0aG9kLmNhbGwoRXZlbnREaXNwYXRjaGVyLnByb3RvdHlwZSwgXCJjbGVhclwiLCBmdW5jdGlvbih0eXBlKSB7XG4gIC8vIGRlcHJlY2F0ZWTjg6Hjg4Pjgrvjg7zjgrjooajnpLrvvJ9cbiAgcmV0dXJuIHRoaXMuY2xlYXJFdmVudExpc3RlbmVyKHR5cGUpO1xufSk7XG5cbi8qKlxuICogQG1ldGhvZCBhZGRFdmVudExpc3RlbmVyXG4gKiB7QGxpbmsgI29ufSDjga7jgqjjgqTjg6rjgqLjgrnjgafjgZnjgIJcbiAqL1xuLyoqXG4gKiBAbWV0aG9kIHJlbW92ZUV2ZW50TGlzdGVuZXJcbiAqIHtAbGluayAjb2ZmfSDjga7jgqjjgqTjg6rjgqLjgrnjgafjgZnjgIJcbiAqL1xuLyoqXG4gKiBAbWV0aG9kIGNsZWFyRXZlbnRMaXN0ZW5lclxuICoge0BsaW5rICNjbGVhcn0g44Gu44Ko44Kk44Oq44Ki44K544Gn44GZ44CCXG4gKi9cbi8qKlxuICogQG1ldGhvZCBoYXNFdmVudExpc3RlbmVyXG4gKiB7QGxpbmsgI2hhc30g44Gu44Ko44Kk44Oq44Ki44K544Gn44GZ44CCXG4gKi9cbi8qKlxuICogQG1ldGhvZCBkaXNwYXRjaEV2ZW50XG4gKiB7QGxpbmsgI2ZpcmV9IOOBruOCqOOCpOODquOCouOCueOBp+OBmeOAglxuICovXG4vKipcbiAqIEBtZXRob2QgZGlzcGF0Y2hFdmVudEJ5VHlwZVxuICoge0BsaW5rICNmbGFyZX0g44Gu44Ko44Kk44Oq44Ki44K544Gn44GZ44CCXG4gKi9cbmNvbnN0IG1ldGhvZE1hcCA9IHtcbiAgYWRkRXZlbnRMaXN0ZW5lcjogJ29uJyxcbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogJ29mZicsXG4gIGhhc0V2ZW50TGlzdGVuZXI6ICdoYXMnLFxuICBkaXNwYXRjaEV2ZW50OiAnZmlyZScsXG4gIGRpc3BhdGNoRXZlbnRCeVR5cGU6ICdmbGFyZScsXG59O1xuLy8gbWV0aG9kTWFwLmZvckluKGZ1bmN0aW9uKG9sZCwgbmFtZSkge1xuZm9ySW4uY2FsbChtZXRob2RNYXAsIGZ1bmN0aW9uKG9sZCwgbmFtZSkge1xuICAvLyBFdmVudERpc3BhdGNoZXIucHJvdG90eXBlLiRtZXRob2Qob2xkLCBwaGluYS51dGlsLkV2ZW50RGlzcGF0Y2hlci5wcm90b3R5cGVbbmFtZV0pO1xuICAkbWV0aG9kLmNhbGwoRXZlbnREaXNwYXRjaGVyLnByb3RvdHlwZSwgb2xkLCBFdmVudERpc3BhdGNoZXIucHJvdG90eXBlW25hbWVdKTtcbn0pO1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS51dGlsLkZsb3dcbiAqIHRpY2sgbWFuYWdlbWVudCBjbGFzc1xuICogX2V4dGVuZHMgcGhpbmEudXRpbC5FdmVudERpc3BhdGNoZXJcbiAqL1xuY2xhc3MgRmxvdyBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge3sgKHJlc29sdmU6IEZ1bmN0aW9uLCByZWplY3Q6IEZ1bmN0aW9uKTogdm9pZDsgfX0gZnVuY1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFt3YWl0XVxuICAgKi9cbiAgY29uc3RydWN0b3IoZnVuYywgd2FpdCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvKiogQHR5cGUge1wicGVuZGluZ1wiIHwgXCJyZXNvbHZlZFwiIHwgXCJyZWplY3RlZFwifSAqL1xuICAgIHRoaXMuc3RhdHVzID0gJ3BlbmRpbmcnO1xuXG4gICAgLyoqIEB0eXBlIHthbnl9ICovXG4gICAgdGhpcy5yZXN1bHRWYWx1ZSA9IG51bGw7XG5cbiAgICAvKiogQHR5cGUge0Z1bmN0aW9uW119ICovXG4gICAgdGhpcy5fcXVldWUgPSBbXTtcblxuICAgIHRoaXMuZnVuYyA9IGZ1bmM7XG5cbiAgICBpZiAod2FpdCAhPT0gdHJ1ZSkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdmFyIHJlc29sdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZi5yZXNvbHZlLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7XG4gICAgICAgIHNlbGYuc3RhdHVzID0gJ3Jlc29sdmVkJztcbiAgICAgIH07XG4gICAgICB2YXIgcmVqZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGYucmVqZWN0LmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7XG4gICAgICAgIHNlbGYuc3RhdHVzID0gJ3JlamVjdGVkJztcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuZnVuYyhyZXNvbHZlLCByZWplY3QpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZSDjgYrjgZ3jgonjgY9cbiAgICog5oiQ5YqfXG4gICAqL1xuICByZXNvbHZlKGFyZykge1xuICAgIHRoaXMucmVzdWx0VmFsdWUgPSBhcmc7XG5cbiAgICAvLyDjgq3jg6Xjg7zjgavnqY3jgb7jgozjgZ/plqLmlbDjgpLlrp/ooYxcbiAgICB0aGlzLl9xdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpIHtcbiAgICAgIGZ1bmModGhpcy5yZXN1bHRWYWx1ZSk7XG4gICAgfSwgdGhpcyk7XG4gICAgLy8gdGhpcy5fcXVldWUuY2xlYXIoKTtcbiAgICBjbGVhci5jYWxsKHRoaXMuX3F1ZXVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZSDjgYrjgZ3jgonjgY9cbiAgICog5aSx5pWXXG4gICAqL1xuICByZWplY3QoKSB7XG5cbiAgfVxuXG4gIC8qKlxuICAgKiDpnZ7lkIzmnJ/ntYLkuobmmYLjga7lh6bnkIbjgpLnmbvpjLJcbiAgICogQHBhcmFtIHt7KHJlc3VsdDogYW55KTogYW55fX0gZnVuY1xuICAgKiBAcmV0dXJucyB7Rmxvd31cbiAgICovXG4gIHRoZW4oZnVuYykge1xuICAgIC8vIOaIkOWKn+OCueODhuODvOOCv+OCueOBoOOBo+OBn+WgtOWQiOOBr+WNs+Wun+ihjFxuICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gJ3Jlc29sdmVkJykge1xuICAgICAgdmFyIHZhbHVlID0gZnVuYyh0aGlzLnJlc3VsdFZhbHVlKTtcbiAgICAgIHJldHVybiBGbG93LnJlc29sdmUodmFsdWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHZhciBmbG93ID0gbmV3IEZsb3coZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9LCB0cnVlKTtcblxuICAgICAgdGhpcy5fcXVldWUucHVzaChmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgdmFyIHJlc3VsdFZhbHVlID0gZnVuYyhhcmcpO1xuXG4gICAgICAgIGlmIChyZXN1bHRWYWx1ZSBpbnN0YW5jZW9mIEZsb3cpIHtcbiAgICAgICAgICByZXN1bHRWYWx1ZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICBmbG93LnJlc29sdmUodmFsdWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGZsb3cucmVzb2x2ZShyZXN1bHRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZmxvdztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtGbG93IHwgYW55fSB2YWx1ZVxuICAgKiBAcmV0dXJucyB7Rmxvd31cbiAgICovXG4gIHN0YXRpYyByZXNvbHZlKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRmxvdykge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHZhciBmbG93ID0gbmV3IEZsb3coZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZsb3c7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7Rmxvd1tdfSBmbG93c1xuICAgKiBAcmV0dXJucyB7Rmxvd31cbiAgICovXG4gIHN0YXRpYyBhbGwoZmxvd3MpIHtcbiAgICByZXR1cm4gbmV3IEZsb3coZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgdmFyIGNvdW50ID0gMDtcblxuICAgICAgdmFyIGFyZ3MgPSBbXTtcblxuICAgICAgZmxvd3MuZm9yRWFjaChmdW5jdGlvbihmbG93KSB7XG4gICAgICAgIGZsb3cudGhlbihmdW5jdGlvbihkKSB7XG4gICAgICAgICAgKytjb3VudDtcbiAgICAgICAgICBhcmdzLnB1c2goZCk7XG5cbiAgICAgICAgICBpZiAoY291bnQgPj0gZmxvd3MubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXNvbHZlKGFyZ3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG59XG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLnV0aWwuVGlja2VyXG4gKiB0aWNrIG1hbmFnZW1lbnQgY2xhc3NcbiAqIF9leHRlbmRzIHBoaW5hLnV0aWwuRXZlbnREaXNwYXRjaGVyXG4gKi9cbmNsYXNzIFRpY2tlciBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7XG5cbiAgLy8gLyoqIOe1jOmBjuODleODrOODvOODoOaVsCAqL1xuICAvLyBmcmFtZSA9IG51bGxcblxuICAvLyAvKiogMeODleODrOODvOODoOOBrue1jOmBjuaZgumWkyAqL1xuICAvLyBkZWx0YVRpbWUgPSBudWxsXG4gIFxuICAvLyAvKiog5YWo5L2T44Gu57WM6YGO5pmC6ZaTICovXG4gIC8vIGVsYXBzZWRUaW1lID0gbnVsbFxuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5fZnBzO1xuXG4gICAgdGhpcy5mcHMgPSAzMDtcbiAgICB0aGlzLmZyYW1lID0gMDtcbiAgICB0aGlzLmRlbHRhVGltZSA9IDA7XG4gICAgdGhpcy5lbGFwc2VkVGltZSA9IDA7XG4gICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xuICAgIHRoaXMucnVubmVyID0gVGlja2VyLnJ1bm5lcjtcbiAgfVxuXG4gIC8qKlxuICAgKiDjg4bjgqPjg4Pjgq/lh6bnkIbmr47jgavlrp/ooYzjgZXjgozjgovjgqTjg5njg7Pjg4jjg4/jg7Pjg4njg6njgpLoqK3lrppcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuL2V2ZW50ZGlzcGF0Y2hlclwiKS5QaGluYUV2ZW50TGlzdGVuZXJ9IGZ1bmMgXG4gICAqL1xuICB0aWNrKGZ1bmMpIHtcbiAgICB0aGlzLm9uKCd0aWNrJywgZnVuYyk7XG4gIH1cblxuICAvKipcbiAgICog44Kk44OZ44Oz44OI44OP44Oz44OJ44Op44KS6Kej6ZmkXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi9ldmVudGRpc3BhdGNoZXJcIikuUGhpbmFFdmVudExpc3RlbmVyfSBmdW5jIFxuICAgKi9cbiAgdW50aWNrKGZ1bmMpIHtcbiAgICB0aGlzLm9mZigndGljaycsIGZ1bmMpO1xuICB9XG5cbiAgLyoqXG4gICAqIOe1jOmBjuaZgumWk+OCkuioiOa4rOODu+iomOmMsuOBl+OBquOBjOOCieODhuOCo+ODg+OCr+WHpueQhu+8iOOCouODl+ODquabtOaWsOWHpueQhu+8ieOCkuihjOOBhlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSDmrKHjga7mm7TmlrDlh6bnkIbjgb7jgafjga7lvoXjgaHmmYLplpNcbiAgICovXG4gIHJ1bigpIHtcbiAgICB2YXIgbm93ID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcbiAgICAvLyAx44OV44Os44O844Og44Gr5o6b44GL44Gj44Gf5pmC6ZaTXG4gICAgdGhpcy5kZWx0YVRpbWUgPSBub3cgLSB0aGlzLmN1cnJlbnRUaW1lO1xuICAgIC8vIOWFqOS9k+OBrue1jOmBjuaZgumWk1xuICAgIHRoaXMuZWxhcHNlZFRpbWUgPSBub3cgLSB0aGlzLnN0YXJ0VGltZTtcblxuICAgIHZhciBzdGFydCA9IHRoaXMuY3VycmVudFRpbWUgPSBub3c7XG4gICAgdGhpcy5mbGFyZSgndGljaycpO1xuICAgIHZhciBlbmQgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xuXG4gICAgLy8g44OV44Os44O844Og44KS5pu05pawXG4gICAgdGhpcy5mcmFtZSArPSAxO1xuXG4gICAgLy8gY2FsY3VsYXRlIGVsYXBzZWQgdGltZVxuICAgIHZhciBlbGFwc2VkID0gZW5kLXN0YXJ0O1xuXG4gICAgLy8gY2FsY3VsYXRlIG5leHQgd2FpdGluZyB0aW1lXG4gICAgdmFyIGRlbGF5ID0gTWF0aC5tYXgodGhpcy5mcmFtZVRpbWUtZWxhcHNlZCwgMCk7XG5cbiAgICByZXR1cm4gZGVsYXk7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xuICAgIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5jdXJyZW50VGltZSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XG4gICAgdmFyIGZuID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoc2VsZi5pc1BsYXlpbmcpIHtcbiAgICAgICAgdmFyIGRlbGF5ID0gc2VsZi5ydW4oKTtcbiAgICAgICAgc2VsZi5ydW5uZXIoZm4sIGRlbGF5KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZuKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHJlc3VtZSgpIHtcbiAgICAvLyBUT0RPOiBcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHJld2luZCgpIHtcbiAgICAvLyBUT0RPOiBcbiAgfVxuXG4gIGdldCBmcHMoKSB7IHJldHVybiB0aGlzLl9mcHM7IH1cbiAgc2V0IGZwcyh2KSB7XG4gICAgdGhpcy5fZnBzID0gdjtcbiAgICB0aGlzLmZyYW1lVGltZSA9IDEwMDAvdGhpcy5fZnBzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7VGltZXJIYW5kbGVyfSBydW5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGRlbGF5XG4gICAqL1xuICBzdGF0aWMgcnVubmVyKHJ1biwgZGVsYXkpIHtcbiAgICBzZXRUaW1lb3V0KHJ1biwgZGVsYXkpO1xuICB9XG4gIFxufVxuXG4vKipcbiAqIEBjbGFzcyBwaGluYS51dGlsLlJhbmRvbVxuICogIyDkubHmlbDjgpLmibHjgYbjgZ/jgoHjga7jgq/jg6njgrlcbiAqIOS5seaVsOOCkuaJseOBhuOBn+OCgeOBruODoeOCveODg+ODieOChOODl+ODreODkeODhuOCo+OCkuWumue+qeOBl+OBpuOBhOOCi+OCr+ODqeOCueOBp+OBmeOAglxuICovXG5jbGFzcyBSYW5kb20ge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICog44Kz44Oz44K544OI44Op44Kv44K/44Gn44GZ44CC5byV5pWw44GnIHtAbGluayAjc2VlZH0g44KS6Kit5a6a44Gn44GN44G+44GZ44CCXG4gICAqIFxuICAgKiBAcGFyYW0ge051bWJlcn0gW3NlZWQgPSAoRGF0ZS5ub3coKSkgfHwgMV0g44K344O844OJXG4gICAqL1xuICBjb25zdHJ1Y3RvcihzZWVkKSB7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMuX3NlZWQ7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkge051bWJlcn0gW3NlZWQgPSAxXVxuICAgICAqIOS5seaVsOOBruOCt+ODvOODieOBp+OBmeOAglxuICAgICAqL1xuICAgIHRoaXMuc2VlZCA9IHNlZWQgfHwgKERhdGUubm93KCkpIHx8IDE7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByYW5kb21cbiAgICogMH4x44Gu5Lmx5pWw44KS6L+U44GX44G+44GZ44CC5a6f6KGM44GZ44KL44GoIHtAbGluayAjc2VlZH0g44Gv5aSJ44KP44Gj44Gm44GX44G+44GE44G+44GZ44CCXG4gICAqIFxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IDB+MSDjga7kubHmlbBcbiAgICovXG4gIHJhbmRvbSgpIHtcbiAgICB2YXIgc2VlZCA9IHRoaXMuc2VlZDtcbiAgICBzZWVkID0gc2VlZCBeIChzZWVkIDw8IDEzKTtcbiAgICBzZWVkID0gc2VlZCBeIChzZWVkID4+PiAxNyk7XG4gICAgc2VlZCA9IChzZWVkIF4gKHNlZWQgPDwgNSkpO1xuXG4gICAgdGhpcy5zZWVkID0gc2VlZDtcblxuICAgIHJldHVybiAoc2VlZCA+Pj4gMCkgLyBSYW5kb20uTUFYO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgcmFuZGludFxuICAgKiDmjIflrprjgZXjgozjgZ/nr4Tlm7LlhoXjgafjg6njg7Pjg4Djg6DjgarmlbTmlbDlgKTjgpLov5TjgZfjgb7jgZnjgILlrp/ooYzjgZnjgovjgagge0BsaW5rICNzZWVkfSDjga/lpInjgo/jgaPjgabjgZfjgb7jgYTjgb7jgZnjgIJcbiAgICogXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBtaW4g56+E5Zuy44Gu5pyA5bCP5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBtYXgg56+E5Zuy44Gu5pyA5aSn5YCkXG4gICAqIEByZXR1cm4ge051bWJlcn0g44Op44Oz44OA44Og44Gq5pW05pWw5YCkXG4gICAqL1xuICByYW5kaW50KG1pbiwgbWF4KSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoIHRoaXMucmFuZG9tKCkqKG1heC1taW4rMSkgKSArIG1pbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHJhbmRmbG9hdFxuICAgKiDmjIflrprjgZXjgozjgZ/nr4Tlm7LlhoXjgafjg6njg7Pjg4Djg6DjgarmlbDlgKTjgpLov5TjgZfjgb7jgZnjgILlrp/ooYzjgZnjgovjgagge0BsaW5rICNzZWVkfSDjga/lpInjgo/jgaPjgabjgZfjgb7jgYTjgb7jgZnjgIJcbiAgICogXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBtaW4g56+E5Zuy44Gu5pyA5bCP5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBtYXgg56+E5Zuy44Gu5pyA5aSn5YCkXG4gICAqIEByZXR1cm4ge051bWJlcn0g44Op44Oz44OA44Og44Gq5pWw5YCkXG4gICAqL1xuICByYW5kZmxvYXQobWluLCBtYXgpIHtcbiAgICByZXR1cm4gdGhpcy5yYW5kb20oKSoobWF4LW1pbikrbWluO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgcmFuZGJvb2xcbiAgICog44Op44Oz44OA44Og44Gq55yf5YG95YCk44KS6L+U44GX44G+44GZ44CC5byV5pWw44Gn55m+5YiG546H44KS5oyH5a6a44Gn44GN44G+44GZ44CC5a6f6KGM44GZ44KL44GoIHtAbGluayAjc2VlZH0g44Gv5aSJ44KP44Gj44Gm44GX44G+44GE44G+44GZ44CCXG4gICAqIFxuICAgKiBAcGFyYW0ge051bWJlcn0gW3BlcmNlbnQgPSA1MF0g55yf44Gr44Gq44KL55m+5YiG546HXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IOODqeODs+ODgOODoOOBquecn+WBveWApFxuICAgKi9cbiAgcmFuZGJvb2wocGVyY2VudCkge1xuICAgIHJldHVybiB0aGlzLnJhbmRvbSgpIDwgKHBlcmNlbnQgPT09IHVuZGVmaW5lZCA/IDUwIDogcGVyY2VudCkgLyAxMDA7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByYW5kYXJyYXlcbiAgICog5Lu75oSP44Gu56+E5Zuy44Gn44Op44Oz44OA44Og44Gq5pW05pWw5YCk44KS5qC857SN44GX44Gf5Lu75oSP44Gu6ZW344GV44Gu6YWN5YiX44KS6L+U44GX44G+44GZ44CC5a6f6KGM44GZ44KL44GoIHtAbGluayAjc2VlZH0g44Gv5aSJ44KP44Gj44Gm44GX44G+44GE44G+44GZ44CCXG4gICAqIFxuICAgKiBAcGFyYW0ge051bWJlcn0gW2xlbiA9IDEwMF0g6YWN5YiX44Gu6ZW344GVXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbWluID0gMF0g56+E5Zuy44Gu5pyA5bCP5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbWF4ID0gMTAwXSDnr4Tlm7Ljga7mnIDlpKflgKRcbiAgICogQHJldHVybiB7TnVtYmVyfSDjg6njg7Pjg4Djg6DjgarmlbTmlbDlgKTjga7lhaXjgaPjgZ/phY3liJdcbiAgICovXG4gIHJhbmRhcnJheShsZW4sIG1pbiwgbWF4KSB7XG4gICAgbGVuID0gbGVuIHx8IDEwMDtcbiAgICBtaW4gPSBtaW4gfHwgMDtcbiAgICBtYXggPSBtYXggfHwgMTAwO1xuXG4gICAgcmV0dXJuIG1hcC5jYWxsKGxlbiwgZnVuY3Rpb24oKSB7XG4gICAgLy8gcmV0dXJuIChsZW4pLm1hcChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnJhbmRpbnQobWluLCBtYXgpO1xuICAgIH0sIHRoaXMpO1xuICB9XG5cbiAgZ2V0IHNlZWQoKSB7IHJldHVybiB0aGlzLl9zZWVkOyB9XG4gIHNldCBzZWVkKHYpIHsgdGhpcy5fc2VlZCA9ICh2ID4+PiAwKSB8fCAxOyB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgZ2V0U2VlZCBcbiAgICoge0BsaW5rICNzZWVkfSDjga7lgKTjgpLlj5blvpfjgZfjgb7jgZnjgIJcbiAgICogXG4gICAqIEByZXR1cm4ge051bWJlcn0g44K344O844OJXG4gICAqIEBzdGF0aWNcbiAgICovXG4gIHN0YXRpYyBnZXRTZWVkKCkge1xuICAgIHJldHVybiB0aGlzLnNlZWQ7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBzZXRTZWVkXG4gICAqIHtAbGluayAjc2VlZH0g44Gu5YCk44KS44K744OD44OI44GX44G+44GZ44CCXG4gICAqIFxuICAgKiBAcGFyYW0ge051bWJlcn0gW3NlZWQgPSAxXSDjgrfjg7zjg4lcbiAgICogQHN0YXRpY1xuICAgKiBAY2hhaW5hYmxlXG4gICAqL1xuICBzdGF0aWMgc2V0U2VlZChzZWVkKSB7XG4gICAgdGhpcy5zZWVkID0gKHNlZWQgPj4+IDApIHx8IDE7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByYW5kb21cbiAgICogMH4x44Gu5Lmx5pWw44KS6L+U44GX44G+44GZ44CC5a6f6KGM44GZ44KL44GoIHtAbGluayAjc2VlZH0g44Gv5aSJ44KP44Gj44Gm44GX44G+44GE44G+44GZ44CCXG4gICAqIOOCpOODs+OCueOCv+ODs+OCueODoeOCveODg+ODieOBriB7QGxpbmsgI3JhbmRvbX0g44Go5ZCM44GY44Gn44GZ44CCXG4gICAqIFxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IDB+MSDjga7kubHmlbBcbiAgICogQHN0YXRpY1xuICAgKi9cbiAgc3RhdGljIHJhbmRvbSgpIHtcbiAgICB0aGlzLnNlZWQgPSB0aGlzLnhvcjMyKHRoaXMuc2VlZCk7XG4gICAgcmV0dXJuICh0aGlzLnNlZWQgPj4+IDApIC8gdGhpcy5NQVg7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByYW5kaW50XG4gICAqIOaMh+WumuOBleOCjOOBn+evhOWbsuWGheOBp+ODqeODs+ODgOODoOOBquaVtOaVsOWApOOCkui/lOOBl+OBvuOBmeOAguWun+ihjOOBmeOCi+OBqCB7QGxpbmsgI3NlZWR9IOOBr+WkieOCj+OBo+OBpuOBl+OBvuOBhOOBvuOBmeOAglxuICAgKiDjgqTjg7Pjgrnjgr/jg7Pjgrnjg6Hjgr3jg4Pjg4njga4ge0BsaW5rICNyYW5kaW50fSDjgajlkIzjgZjjgafjgZnjgIJcbiAgICogXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBtaW4g56+E5Zuy44Gu5pyA5bCP5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBtYXgg56+E5Zuy44Gu5pyA5aSn5YCkXG4gICAqIEByZXR1cm4ge051bWJlcn0g44Op44Oz44OA44Og44Gq5pW05pWw5YCkXG4gICAqIEBzdGF0aWNcbiAgICovXG4gIHN0YXRpYyByYW5kaW50KG1pbiwgbWF4KSB7XG4gICAgcmV0dXJuIHBoaW5hLmdsb2JhbC5NYXRoLmZsb29yKCB0aGlzLnJhbmRvbSgpKihtYXgtbWluKzEpICkgKyBtaW47XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByYW5kZmxvYXRcbiAgICog5oyH5a6a44GV44KM44Gf56+E5Zuy5YaF44Gn44Op44Oz44OA44Og44Gq5pWw5YCk44KS6L+U44GX44G+44GZ44CC5a6f6KGM44GZ44KL44GoIHtAbGluayAjc2VlZH0g44Gv5aSJ44KP44Gj44Gm44GX44G+44GE44G+44GZ44CCXG4gICAqIOOCpOODs+OCueOCv+ODs+OCueODoeOCveODg+ODieOBriB7QGxpbmsgI3JhbmRmbG9hdH0g44Go5ZCM44GY44Gn44GZ44CCXG4gICAqIFxuICAgKiBAcGFyYW0ge051bWJlcn0gbWluIOevhOWbsuOBruacgOWwj+WApFxuICAgKiBAcGFyYW0ge051bWJlcn0gbWF4IOevhOWbsuOBruacgOWkp+WApFxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IOODqeODs+ODgOODoOOBquaVsOWApFxuICAgKiBAc3RhdGljXG4gICAqL1xuICBzdGF0aWMgcmFuZGZsb2F0KG1pbiwgbWF4KSB7XG4gICAgcmV0dXJuIHRoaXMucmFuZG9tKCkqKG1heC1taW4pK21pbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHJhbmRib29sXG4gICAqIOODqeODs+ODgOODoOOBquecn+WBveWApOOCkui/lOOBl+OBvuOBmeOAguW8leaVsOOBp+eZvuWIhueOh+OCkuaMh+WumuOBp+OBjeOBvuOBmeOAguWun+ihjOOBmeOCi+OBqCB7QGxpbmsgI3NlZWR9IOOBr+WkieOCj+OBo+OBpuOBl+OBvuOBhOOBvuOBmeOAglxuICAgKiDjgqTjg7Pjgrnjgr/jg7Pjgrnjg6Hjgr3jg4Pjg4njga4ge0BsaW5rICNyYW5kYm9vbH0g44Go5ZCM44GY44Gn44GZ44CCXG4gICAqIFxuICAgKiBAcGFyYW0ge051bWJlcn0gW3BlcmNlbnQgPSA1MF0g55yf44Gr44Gq44KL55m+5YiG546HXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IOODqeODs+ODgOODoOOBquecn+WBveWApFxuICAgKiBAc3RhdGljXG4gICAqL1xuICBzdGF0aWMgcmFuZGJvb2wocGVyY2VudCkge1xuICAgIHJldHVybiB0aGlzLnJhbmRpbnQoMCwgOTkpIDwgKHBlcmNlbnQgfHwgNTApO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgcmFuZGFycmF5XG4gICAqIOS7u+aEj+OBruevhOWbsuOBp+ODqeODs+ODgOODoOOBquaVtOaVsOWApOOCkuagvOe0jeOBl+OBn+S7u+aEj+OBrumVt+OBleOBrumFjeWIl+OCkui/lOOBl+OBvuOBmeOAguWun+ihjOOBmeOCi+OBqCB7QGxpbmsgI3NlZWR9IOOBr+WkieOCj+OBo+OBpuOBl+OBvuOBhOOBvuOBmeOAglxuICAgKiDjgqTjg7Pjgrnjgr/jg7Pjgrnjg6Hjgr3jg4Pjg4njga4ge0BsaW5rICNyYW5kYXJyYXl9IOOBqOWQjOOBmOOBp+OBmeOAglxuICAgKiBcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtsZW4gPSAxMDBdIOmFjeWIl+OBrumVt+OBlVxuICAgKiBAcGFyYW0ge051bWJlcn0gW21pbiA9IDBdIOevhOWbsuOBruacgOWwj+WApFxuICAgKiBAcGFyYW0ge051bWJlcn0gW21heCA9IDEwMF0g56+E5Zuy44Gu5pyA5aSn5YCkXG4gICAqIEByZXR1cm4ge051bWJlcn0g44Op44Oz44OA44Og44Gq5pW05pWw5YCk44Gu5YWl44Gj44Gf6YWN5YiXXG4gICAqIEBzdGF0aWNcbiAgICovXG4gIHN0YXRpYyByYW5kYXJyYXkobGVuLCBtaW4sIG1heCkge1xuICAgIGxlbiA9IGxlbiB8fCAxMDA7XG4gICAgbWluID0gbWluIHx8IDA7XG4gICAgbWF4ID0gbWF4IHx8IDEwMDtcblxuICAgIHJldHVybiBtYXAuY2FsbChsZW4sIGZ1bmN0aW9uKCkge1xuICAgIC8vIHJldHVybiAobGVuKS5tYXAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5yYW5kaW50KG1pbiwgbWF4KTtcbiAgICB9LCB0aGlzKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIEBtZXRob2QgeG9yMzJcbiAgICogeG9yc2hpZnQg44KS55So44GE44Gm55aR5Ly85Lmx5pWw5YiX44KS55Sf5oiQ44GX44G+44GZ44CCXG4gICAqIFxuICAgKiBAcGFyYW0ge051bWJlcn0gc2VlZFxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IOeWkeS8vOS5seaVsOWIl1xuICAgKiBAc3RhdGljXG4gICAqL1xuICBzdGF0aWMgeG9yMzIoc2VlZCkge1xuICAgIHNlZWQgPSBzZWVkIF4gKHNlZWQgPDwgMTMpO1xuICAgIHNlZWQgPSBzZWVkIF4gKHNlZWQgPj4+IDE3KTtcbiAgICBzZWVkID0gKHNlZWQgXiAoc2VlZCA8PCA1KSk7XG5cbiAgICByZXR1cm4gc2VlZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHV1aWRcbiAgICogdXVpZCDjgpLnlJ/miJDjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAgICogXG4gICAqIEByZXR1cm4ge1N0cmluZ30gdXVpZFxuICAgKiBAc3RhdGljXG4gICAqL1xuICAvL2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTA1MDM0L2NyZWF0ZS1ndWlkLXV1aWQtaW4tamF2YXNjcmlwdFxuICBzdGF0aWMgdXVpZCgpIHtcbiAgICB2YXIgZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIGlmKHBoaW5hLmdsb2JhbC5wZXJmb3JtYW5jZSAmJiB0eXBlb2YgcGhpbmEuZ2xvYmFsLnBlcmZvcm1hbmNlLm5vdyA9PT0gJ2Z1bmN0aW9uJyl7XG4gICAgICBkICs9IHBlcmZvcm1hbmNlLm5vdygpOyAvL3VzZSBoaWdoLXByZWNpc2lvbiB0aW1lciBpZiBhdmFpbGFibGVcbiAgICB9XG4gICAgdmFyIHV1aWQgPSAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uKGMpIHtcbiAgICAgIHZhciByID0gKGQgKyBNYXRoLnJhbmRvbSgpKjE2KSUxNiB8IDA7XG4gICAgICBkID0gTWF0aC5mbG9vcihkLzE2KTtcbiAgICAgIHJldHVybiAoYz09J3gnID8gciA6IChyJjB4M3wweDgpKS50b1N0cmluZygxNik7XG4gICAgfSk7XG4gICAgcmV0dXJuIHV1aWQ7XG4gIH1cblxufVxuXG4vKipcbiAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBNQVhcbiAqIOWGhemDqOeahOOBq+S9v+eUqOOBleOCjOOCi+WumuaVsOOBp+OBmeOAglxuICogXG4gKiBAc3RhdGljXG4gKi9cblJhbmRvbS5NQVggPSA0Mjk0OTY3Mjk1O1xuXG4vKipcbiAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBbc2VlZCA9IChEYXRlLm5vdygpKV0g44K344O844OJXG4gKiBzdGF0aWMg44Oh44K944OD44OJ44Gu5Lmx5pWw44Gu44K344O844OJ44Gn44GZ44CCXG4gKiBcbiAqIEBzdGF0aWNcbiAqL1xuUmFuZG9tLnNlZWQgPSAoRGF0ZS5ub3coKSk7XG5cblxuLy8gcHJvdG90eXBl5ouh5by144Gv44GX44Gq44GEXG4vLyBNYXRoLiRtZXRob2QoXCJyYW5kaW50XCIsIGZ1bmN0aW9uKG1pbiwgbWF4KSB7XG4vLyAgIHJldHVybiBwaGluYS51dGlsLlJhbmRvbS5yYW5kaW50KG1pbiwgbWF4KTtcbi8vIH0pO1xuXG4vLyBNYXRoLiRtZXRob2QoXCJyYW5kZmxvYXRcIiwgZnVuY3Rpb24obWluLCBtYXgpIHtcbi8vICAgcmV0dXJuIHBoaW5hLnV0aWwuUmFuZG9tLnJhbmRmbG9hdChtaW4sIG1heCk7XG4vLyB9KTtcblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEudXRpbC5TdXBwb3J0XG4gKiBcbiAqL1xuY2xhc3MgU3VwcG9ydCB7fVN1cHBvcnQuY2FudmFzID0gISFwaGluYS5nbG9iYWwuQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xuU3VwcG9ydC53ZWJHTCA9IChmdW5jdGlvbigpIHtcbiAgcmV0dXJuICEhcGhpbmEuZ2xvYmFsLkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCAmJiAhIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpLmdldENvbnRleHQoJ3dlYmdsJyk7XG59KSgpO1xuU3VwcG9ydC53ZWJBdWRpbyA9ICEhcGhpbmEuZ2xvYmFsLkF1ZGlvQ29udGV4dCB8fCAhIXBoaW5hLmdsb2JhbFsnd2Via2l0QXVkaW9Db250ZXh0J10gfHwgISFwaGluYS5nbG9iYWxbJ21vekF1ZGlvQ29udGV4dCddO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgd2lkdGg/OiBudW1iZXI7XG4gKiAgY29sdW1ucz86IG51bWJlcjtcbiAqICBsb29wPzogYm9vbGVhbjtcbiAqICBvZmZzZXQ/OiBudW1iZXI7XG4gKiB9fSBHcmlkT3B0aW9uc1xuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLnV0aWwuR3JpZFxuICovXG5jbGFzcyBHcmlkIHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7R3JpZE9wdGlvbnMgfCBudW1iZXJ9IF9vcHRpb25zT3JXaWR0aFxuICAgKiBAcGFyYW0ge251bWJlcn0gW19jb2xdXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW19sb29wXVxuICAgKiBAcGFyYW0ge251bWJlcn0gW19vZmZzZXRdXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihfb3B0aW9uc09yV2lkdGgsIF9jb2wsIF9sb29wLCBfb2Zmc2V0KSB7XG4gICAgdmFyIHdpZHRoLCBjb2x1bW5zLCBsb29wLCBvZmZzZXQ7XG4gICAgaWYgKHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdvYmplY3QnKSB7XG4gICAgICAvKiogQHR5cGUge0dyaWRPcHRpb25zfSAqL1xuICAgICAgdmFyIHBhcmFtID0gYXJndW1lbnRzWzBdO1xuICAgICAgd2lkdGggPSBwYXJhbS53aWR0aCB8fCA2NDA7XG4gICAgICBjb2x1bW5zID0gcGFyYW0uY29sdW1ucyB8fCAxMjtcbiAgICAgIGxvb3AgPSBwYXJhbS5sb29wIHx8IGZhbHNlO1xuICAgICAgb2Zmc2V0ID0gcGFyYW0ub2Zmc2V0IHx8IDA7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgd2lkdGggICA9IGFyZ3VtZW50c1swXSB8fCA2NDA7XG4gICAgICBjb2x1bW5zID0gYXJndW1lbnRzWzFdIHx8IDEyO1xuICAgICAgbG9vcCAgICA9IGFyZ3VtZW50c1syXSB8fCBmYWxzZTtcbiAgICAgIG9mZnNldCA9IGFyZ3VtZW50c1szXSB8fCAwO1xuICAgIH1cblxuICAgIC8qKiBAdHlwZSB7bnVtYmVyfSDluYUgKi9cbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG5cbiAgICAvKiogQHR5cGUge251bWJlcn0g5YiX5pWwICovXG4gICAgdGhpcy5jb2x1bW5zID0gY29sdW1ucztcblxuICAgIC8qKiBAdHlwZSB7Ym9vbGVhbn0gc3BhbuaMh+WumuaZguOBq+ODq+ODvOODl+OBmeOCi+OBi+OBqeOBhuOBiyAqL1xuICAgIHRoaXMubG9vcCA9IGxvb3A7XG5cbiAgICAvKiogQHR5cGUge251bWJlcn0g44Kq44OV44K744OD44OI5YCkICovXG4gICAgdGhpcy5vZmZzZXQgPSBvZmZzZXQ7XG5cbiAgICAvKiogQHR5cGUge251bWJlcn0g44Kw44Oq44OD44OJ5Y2Y5L2N5YCkICovXG4gICAgdGhpcy51bml0V2lkdGggPSB0aGlzLndpZHRoL3RoaXMuY29sdW1ucztcbiAgfVxuXG4gIC8qKlxuICAgKiDjgrnjg5Hjg7PmjIflrprjgaflgKTjgpLlj5blvpco6LKg5pWw44KCb2spXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cbiAgc3BhbihpbmRleCkge1xuICAgIGlmICh0aGlzLmxvb3ApIHtcbiAgICAgIGluZGV4ICs9IHRoaXMuY29sdW1ucztcbiAgICAgIGluZGV4ICU9IHRoaXMuY29sdW1ucztcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudW5pdFdpZHRoICogaW5kZXggKyB0aGlzLm9mZnNldDtcbiAgfVxuXG4gIC8qKlxuICAgKiDjgrDjg6rjg4Pjg4nljZjkvY3jgpLov5TjgZlcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG4gIHVuaXQoKSB7XG4gICAgcmV0dXJuIHRoaXMudW5pdFdpZHRoO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbb2Zmc2V0XSDkuK3lv4PjgYvjgonjga7jgZrjgozjgpLljZjkvY3mlbDjgafmjIflrppcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG4gIGNlbnRlcihvZmZzZXQpIHtcbiAgICB2YXIgaW5kZXggPSBvZmZzZXQgfHwgMDtcbiAgICByZXR1cm4gKHRoaXMud2lkdGgvMikgKyAodGhpcy51bml0V2lkdGggKiBpbmRleCk7XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHtrZXlvZiBUd2Vlbi5FQVNJTkd9IFR3ZWVuRWFzaW5nVHlwZSDjgqTjg7zjgrjjg7PjgrDjga7nqK7poZ7jgpLooajjgZnmloflrZfliJdcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS51dGlsLlR3ZWVuXG4gKiBfZXh0ZW5kcyBwaGluYS51dGlsLkV2ZW50RGlzcGF0Y2hlclxuICogXG4gKi9cbmNsYXNzIFR3ZWVuIGV4dGVuZHMgRXZlbnREaXNwYXRjaGVyIHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKiB0d2Vlbue1jOmBjuaZgumWk1xuICAgICAqL1xuICAgIHRoaXMudGltZSA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtmdW5jdGlvbnxzdHJpbmd9XG4gICAgICog5YaF6YOo44Kk44O844K444Oz44Kw6Zai5pWwXG4gICAgICogZWFzaW5n44Ki44Kv44K744K144KS5LuL44GX44Gm5L2/55SoICBcbiAgICAgKiBzZXR0ZXLjgYxzdHJpbmflnovjgpLlj5fjgZHku5jjgZHjgovjga7jgavlr77jgZfjgIFcbiAgICAgKiBnZXR0ZXLjga9mdW5jdGlvbuWei+OCkui/lOOBmeOBn+OCgeOAgeOBqOOCiuOBguOBiOOBmuWFseeUqOS9k+OBqOOBmeOCi1xuICAgICAqL1xuICAgIHRoaXMuX2Vhc2luZztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2FueX0gdGFyZ2V0XG4gICAqIEBwYXJhbSB7eyBbazogc3RyaW5nXTogYW55OyB9fSBiZWdpblByb3BzXG4gICAqIEBwYXJhbSB7eyBbazogc3RyaW5nXTogYW55OyB9fSBmaW5pc2hQcm9wc1xuICAgKiBAcGFyYW0ge251bWJlcn0gZHVyYXRpb25cbiAgICogQHBhcmFtIHtUd2VlbkVhc2luZ1R5cGV9IGVhc2luZ1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGZyb21Ubyh0YXJnZXQsIGJlZ2luUHJvcHMsIGZpbmlzaFByb3BzLCBkdXJhdGlvbiwgZWFzaW5nKSB7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5iZWdpblByb3BzID0gYmVnaW5Qcm9wcztcbiAgICB0aGlzLmZpbmlzaFByb3BzID0gZmluaXNoUHJvcHM7XG4gICAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDEwMDA7XG4gICAgdGhpcy5lYXNpbmcgPSBlYXNpbmc7XG5cbiAgICAvLyBzZXR1cFxuICAgIHRoaXMuY2hhbmdlUHJvcHMgPSB7fTtcbiAgICBmb3IgKHZhciBrZXkgaW4gYmVnaW5Qcm9wcykge1xuICAgICAgICB0aGlzLmNoYW5nZVByb3BzW2tleV0gPSBmaW5pc2hQcm9wc1trZXldIC0gYmVnaW5Qcm9wc1trZXldO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7YW55fSB0YXJnZXRcbiAgICogQHBhcmFtIHt7IFtrOiBzdHJpbmddOiBhbnk7IH19IGZpbmlzaFByb3BzXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkdXJhdGlvblxuICAgKiBAcGFyYW0ge1R3ZWVuRWFzaW5nVHlwZX0gZWFzaW5nXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgdG8odGFyZ2V0LCBmaW5pc2hQcm9wcywgZHVyYXRpb24sIGVhc2luZykge1xuICAgIHZhciBiZWdpblByb3BzID0ge307XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gZmluaXNoUHJvcHMpIHtcbiAgICAgIGJlZ2luUHJvcHNba2V5XSA9IHRhcmdldFtrZXldO1xuICAgIH1cblxuICAgIHRoaXMuZnJvbVRvKHRhcmdldCwgYmVnaW5Qcm9wcywgZmluaXNoUHJvcHMsIGR1cmF0aW9uLCBlYXNpbmcpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHthbnl9IHRhcmdldFxuICAgKiBAcGFyYW0ge3sgW2s6IHN0cmluZ106IGFueTsgfX0gYmVnaW5Qcm9wc1xuICAgKiBAcGFyYW0ge251bWJlcn0gZHVyYXRpb25cbiAgICogQHBhcmFtIHtUd2VlbkVhc2luZ1R5cGV9IGVhc2luZ1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGZyb20odGFyZ2V0LCBiZWdpblByb3BzLCBkdXJhdGlvbiwgZWFzaW5nKSB7XG4gICAgICB2YXIgZmluaXNoUHJvcHMgPSB7fTtcblxuICAgICAgZm9yICh2YXIga2V5IGluIGJlZ2luUHJvcHMpIHtcbiAgICAgICAgZmluaXNoUHJvcHNba2V5XSA9IHRhcmdldFtrZXldO1xuICAgICAgICB0YXJnZXRba2V5XSA9IGJlZ2luUHJvcHNba2V5XTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5mcm9tVG8odGFyZ2V0LCBiZWdpblByb3BzLCBmaW5pc2hQcm9wcywgZHVyYXRpb24sIGVhc2luZyk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7YW55fSB0YXJnZXRcbiAgICogQHBhcmFtIHt7IFtrOiBzdHJpbmddOiBhbnk7IH19IHByb3BzXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkdXJhdGlvblxuICAgKiBAcGFyYW0ge1R3ZWVuRWFzaW5nVHlwZX0gZWFzaW5nXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgYnkodGFyZ2V0LCBwcm9wcywgZHVyYXRpb24sIGVhc2luZykge1xuICAgIHZhciBiZWdpblByb3BzID0ge307XG4gICAgdmFyIGZpbmlzaFByb3BzID0ge307XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gcHJvcHMpIHtcbiAgICAgIGJlZ2luUHJvcHNba2V5XSA9IHRhcmdldFtrZXldO1xuICAgICAgZmluaXNoUHJvcHNba2V5XSA9IHRhcmdldFtrZXldICsgcHJvcHNba2V5XTtcbiAgICB9XG5cbiAgICB0aGlzLmZyb21Ubyh0YXJnZXQsIGJlZ2luUHJvcHMsIGZpbmlzaFByb3BzLCBkdXJhdGlvbiwgZWFzaW5nKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE9cbiAgICovXG4gIHlveW8oKSB7XG4gICAgdmFyIHRlbXAgPSB0aGlzLmJlZ2luUHJvcHM7XG4gICAgdGhpcy5iZWdpblByb3BzID0gdGhpcy5maW5pc2hQcm9wcztcbiAgICB0aGlzLmZpbmlzaFByb3BzID0gdGVtcDtcbiAgICAvLyB0aGlzLmNoYW5nZVByb3BzLmZvckluKGZ1bmN0aW9uKGtleSwgdmFsdWUsIGluZGV4KSB7XG4gICAgZm9ySW4uY2FsbCh0aGlzLmNoYW5nZVByb3BzLCBmdW5jdGlvbihrZXksIHZhbHVlLCBfaW5kZXgpIHtcbiAgICAgIHRoaXMuY2hhbmdlUHJvcHNba2V5XSA9IC12YWx1ZTtcbiAgICAgIHRoaXMudGFyZ2V0W2tleV0gPSB0aGlzLmJlZ2luUHJvcHNba2V5XTtcbiAgICB9LCB0aGlzKTtcbiAgICAvLyBUT0RPOiBlYXNpbmcg44KC5Y+N6Lui44GV44Gb44KLXG4gICAgLy8gdGhpcy5lYXNpbmcgPSBlYXNpbmc7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog5oyH5a6a5YCk5YiG44CB5pmC6ZaT44KS6YCy44KB44KLXG4gICAqIEBhbGlhcyBmb3J3YXJkXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lXG4gICAqL1xuICBnYWluKHRpbWUpIHtcbiAgICB0aGlzLnNlZWsodGhpcy50aW1lICsgdGltZSk7XG4gIH1cblxuICAvKipcbiAgICog5oyH5a6a5YCk5YiG44CB5pmC6ZaT44KS6YCy44KB44KLXG4gICAqIEBhbGlhcyBnYWluXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lXG4gICAqL1xuICBmb3J3YXJkKHRpbWUpIHtcbiAgICB0aGlzLnNlZWsodGhpcy50aW1lICsgdGltZSk7XG4gIH1cblxuICAvKipcbiAgICog5oyH5a6a5YCk5YiG44CB5pmC6ZaT44KS5oi744GZXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lXG4gICAqL1xuICBiYWNrd2FyZCh0aW1lKSB7XG4gICAgdGhpcy5zZWVrKHRoaXMudGltZSAtIHRpbWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaZgumWk+OBq+W/nOOBmOOBpuODkeODqeODoeODvOOCv+OCkuabtOaWsFxuICAgKiBAcGFyYW0ge251bWJlcn0gdGltZVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNlZWsodGltZSkge1xuICAgIC8vIHRoaXMudGltZSA9IE1hdGguY2xhbXAodGltZSwgMCwgdGhpcy5kdXJhdGlvbik7XG4gICAgdGhpcy50aW1lID0gY2xhbXAodGltZSwgMCwgdGhpcy5kdXJhdGlvbik7XG5cbiAgICAvLyB0aGlzLmJlZ2luUHJvcHMuZm9ySW4oXG4gICAgZm9ySW4uY2FsbCh0aGlzLmJlZ2luUHJvcHMsIFxuICAgIC8qKiBAdGhpcyBUd2VlbiAqL1xuICAgIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgIHZhciB2ID0gLyoqIEB0eXBlIGZ1bmN0aW9uICovKHRoaXMuZWFzaW5nKSh0aGlzLnRpbWUsIHZhbHVlLCB0aGlzLmNoYW5nZVByb3BzW2tleV0sIHRoaXMuZHVyYXRpb24pO1xuICAgICAgdGhpcy50YXJnZXRba2V5XSA9IHY7XG4gICAgfSwgdGhpcyk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGdldCBlYXNpbmcoKSB7IHJldHVybiB0aGlzLl9lYXNpbmc7IH1cbiAgc2V0IGVhc2luZyh2KSB7XG4gICAgdGhpcy5fZWFzaW5nID0gVHdlZW4uRUFTSU5HWy8qKkB0eXBlIHtzdHJpbmd9Ki8odildIHx8IFR3ZWVuLkVBU0lORy5kZWZhdWx0O1xuICB9XG5cbn1cblxuLyoqXG4gKiBAc3RhdGljXG4gKiDjgqTjg7zjgrjjg7PjgrBcbiAqICMjIyBSZWZlcmVuY2VcbiAqIC0gPGh0dHA6Ly9jb2RlcmVwb3Mub3JnL3NoYXJlL3dpa2kvSlNUd2VlbmVyPlxuICogLSA8aHR0cDovL2NvZGVyZXBvcy5vcmcvc2hhcmUvYnJvd3Nlci9sYW5nL2phdmFzY3JpcHQvanN0d2VlbmVyL3RydW5rL3NyYy9KU1R3ZWVuZXIuanM+XG4gKiAtIDxodHRwOi8vZ3NnZC5jby51ay9zYW5kYm94L2pxdWVyeS9lYXNpbmcvanF1ZXJ5LmVhc2luZy4xLjMuanM+XG4gKiAtIDxodHRwOi8vaG9zdGVkLnplaC5jb20uYnIvdHdlZW5lci9kb2NzL2VuLXVzL21pc2MvdHJhbnNpdGlvbnMuaHRtbD5cbiAqL1xuVHdlZW4uRUFTSU5HID0ge1xuXG4gIC8qKiBkZWZhdWx0ICovXG4gIFwiZGVmYXVsdFwiOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgcmV0dXJuIGMqdC9kICsgYjtcbiAgfSxcbiAgLyoqIGxpbmVhciAqL1xuICBsaW5lYXI6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gYyp0L2QgKyBiO1xuICB9LFxuICAvKiogc3dpbmcgKi9cbiAgc3dpbmc6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gLWMgKih0Lz1kKSoodC0yKSArIGI7XG4gIH0sXG4gIC8qKiBlYXNlSW5RdWFkICovXG4gIGVhc2VJblF1YWQ6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gYyoodC89ZCkqdCArIGI7XG4gIH0sXG4gIC8qKiBlYXNlT3V0UXVhZCAqL1xuICBlYXNlT3V0UXVhZDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIHJldHVybiAtYyAqKHQvPWQpKih0LTIpICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VJbk91dFF1YWQgKi9cbiAgZWFzZUluT3V0UXVhZDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIGlmKCh0Lz1kLzIpIDwgMSkgcmV0dXJuIGMvMip0KnQgKyBiO1xuICAgIHJldHVybiAtYy8yICooKC0tdCkqKHQtMikgLSAxKSArIGI7XG4gIH0sXG4gIC8qKiBkZWZlSW5DdWJpYyAqL1xuICBlYXNlSW5DdWJpYzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIHJldHVybiBjKih0Lz1kKSp0KnQgKyBiO1xuICB9LFxuICAvKiogZWFzZU91dEN1YmljICovXG4gIGVhc2VPdXRDdWJpYzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIHJldHVybiBjKigodD10L2QtMSkqdCp0ICsgMSkgKyBiO1xuICB9LFxuICAvKiogZWFzZUluT3V0Q3ViaWMgKi9cbiAgZWFzZUluT3V0Q3ViaWM6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICBpZigodC89ZC8yKSA8IDEpIHJldHVybiBjLzIqdCp0KnQgKyBiO1xuICAgIHJldHVybiBjLzIqKCh0LT0yKSp0KnQgKyAyKSArIGI7XG4gIH0sXG4gIC8qKiBlYXNlT3V0SW5DdWJpYyAqL1xuICBlYXNlT3V0SW5DdWJpYzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIGlmKHQgPCBkLzIpIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZU91dEN1YmljKHQqMiwgYiwgYy8yLCBkKTtcbiAgICByZXR1cm4gVHdlZW4uRUFTSU5HLmVhc2VJbkN1YmljKCh0KjIpLWQsIGIrYy8yLCBjLzIsIGQpO1xuICB9LFxuICAvKiogZWFzZUluUXVhcnQgKi9cbiAgZWFzZUluUXVhcnQ6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gYyoodC89ZCkqdCp0KnQgKyBiO1xuICB9LFxuICAvKiogZWFzZU91dFF1YXJ0ICovXG4gIGVhc2VPdXRRdWFydDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIHJldHVybiAtYyAqKCh0PXQvZC0xKSp0KnQqdCAtIDEpICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VJbk91dFF1YXJ0ICovXG4gIGVhc2VJbk91dFF1YXJ0OiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgaWYoKHQvPWQvMikgPCAxKSByZXR1cm4gYy8yKnQqdCp0KnQgKyBiO1xuICAgIHJldHVybiAtYy8yICooKHQtPTIpKnQqdCp0IC0gMikgKyBiO1xuICB9LFxuICAvKiogZWFzZU91dEluUXVhcnQgKi9cbiAgZWFzZU91dEluUXVhcnQ6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICBpZih0IDwgZC8yKSByZXR1cm4gVHdlZW4uRUFTSU5HLmVhc2VPdXRRdWFydCh0KjIsIGIsIGMvMiwgZCk7XG4gICAgcmV0dXJuIFR3ZWVuLkVBU0lORy5lYXNlSW5RdWFydCgodCoyKS1kLCBiK2MvMiwgYy8yLCBkKTtcbiAgfSxcbiAgLyoqIGVhc2VJblF1aW50ICovXG4gIGVhc2VJblF1aW50OiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgcmV0dXJuIGMqKHQvPWQpKnQqdCp0KnQgKyBiO1xuICB9LFxuICAvKiogZWFzZU91dFF1aW50ICovXG4gIGVhc2VPdXRRdWludDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIHJldHVybiBjKigodD10L2QtMSkqdCp0KnQqdCArIDEpICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VJbk91dFF1aW50ICovXG4gIGVhc2VJbk91dFF1aW50OiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgaWYoKHQvPWQvMikgPCAxKSByZXR1cm4gYy8yKnQqdCp0KnQqdCArIGI7XG4gICAgcmV0dXJuIGMvMiooKHQtPTIpKnQqdCp0KnQgKyAyKSArIGI7XG4gIH0sXG4gIC8qKiBlYXNlT3V0SW5RdWludCAqL1xuICBlYXNlT3V0SW5RdWludDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIGlmKHQgPCBkLzIpIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZU91dFF1aW50KHQqMiwgYiwgYy8yLCBkKTtcbiAgICByZXR1cm4gVHdlZW4uRUFTSU5HLmVhc2VJblF1aW50KCh0KjIpLWQsIGIrYy8yLCBjLzIsIGQpO1xuICB9LFxuICAvKiogZWFzZUluU2luZSAqL1xuICBlYXNlSW5TaW5lOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgcmV0dXJuIC1jICogTWF0aC5jb3ModC9kICooTWF0aC5QSS8yKSkgKyBjICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VPdXRTaW5lICovXG4gIGVhc2VPdXRTaW5lOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgcmV0dXJuIGMgKiBNYXRoLnNpbih0L2QgKihNYXRoLlBJLzIpKSArIGI7XG4gIH0sXG4gIC8qKiBlYXNlSW5PdXRTaW5lICovXG4gIGVhc2VJbk91dFNpbmU6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gLWMvMiAqKE1hdGguY29zKE1hdGguUEkqdC9kKSAtIDEpICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VPdXRJblNpbmUgKi9cbiAgZWFzZU91dEluU2luZTogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIGlmKHQgPCBkLzIpIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZU91dFNpbmUodCoyLCBiLCBjLzIsIGQpO1xuICAgIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZUluU2luZSgodCoyKS1kLCBiK2MvMiwgYy8yLCBkKTtcbiAgfSxcbiAgLyoqIGVhc2VJbkV4cG8gKi9cbiAgZWFzZUluRXhwbzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIHJldHVybiAodD09MCkgPyBiIDogYyAqIE1hdGgucG93KDIsIDEwICoodC9kIC0gMSkpICsgYiAtIGMgKiAwLjAwMTtcbiAgfSxcbiAgLyoqIGVhc2VPdXRFeHBvICovXG4gIGVhc2VPdXRFeHBvOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgcmV0dXJuICh0PT1kKSA/IGIrYyA6IGMgKiAxLjAwMSAqKC1NYXRoLnBvdygyLCAtMTAgKiB0L2QpICsgMSkgKyBiO1xuICB9LFxuICAvKiogZWFzZUluT3V0RXhwbyAqL1xuICBlYXNlSW5PdXRFeHBvOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgaWYodD09MCkgcmV0dXJuIGI7XG4gICAgaWYodD09ZCkgcmV0dXJuIGIrYztcbiAgICBpZigodC89ZC8yKSA8IDEpIHJldHVybiBjLzIgKiBNYXRoLnBvdygyLCAxMCAqKHQgLSAxKSkgKyBiIC0gYyAqIDAuMDAwNTtcbiAgICByZXR1cm4gYy8yICogMS4wMDA1ICooLU1hdGgucG93KDIsIC0xMCAqIC0tdCkgKyAyKSArIGI7XG4gIH0sXG4gIC8qKiBlYXNlT3V0SW5FeHBvICovXG4gIGVhc2VPdXRJbkV4cG86IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICBpZih0IDwgZC8yKSByZXR1cm4gVHdlZW4uRUFTSU5HLmVhc2VPdXRFeHBvKHQqMiwgYiwgYy8yLCBkKTtcbiAgICByZXR1cm4gVHdlZW4uRUFTSU5HLmVhc2VJbkV4cG8oKHQqMiktZCwgYitjLzIsIGMvMiwgZCk7XG4gIH0sXG4gIC8qKiBlYXNlSW5DaXJjICovXG4gIGVhc2VJbkNpcmM6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gLWMgKihNYXRoLnNxcnQoMSAtKHQvPWQpKnQpIC0gMSkgKyBiO1xuICB9LFxuICAvKiogZWFzZU91dENpcmMgKi9cbiAgZWFzZU91dENpcmM6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gYyAqIE1hdGguc3FydCgxIC0odD10L2QtMSkqdCkgKyBiO1xuICB9LFxuICAvKiogZWFzZUluT3V0Q2lyYyAqL1xuICBlYXNlSW5PdXRDaXJjOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgaWYoKHQvPWQvMikgPCAxKSByZXR1cm4gLWMvMiAqKE1hdGguc3FydCgxIC0gdCp0KSAtIDEpICsgYjtcbiAgICByZXR1cm4gYy8yICooTWF0aC5zcXJ0KDEgLSh0LT0yKSp0KSArIDEpICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VPdXRJbkNpcmMgKi9cbiAgZWFzZU91dEluQ2lyYzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIGlmKHQgPCBkLzIpIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZU91dENpcmModCoyLCBiLCBjLzIsIGQpO1xuICAgIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZUluQ2lyYygodCoyKS1kLCBiK2MvMiwgYy8yLCBkKTtcbiAgfSxcbiAgLyoqIGVhc2VJbkVsYXN0aWMgKi9cbiAgZWFzZUluRWxhc3RpYzogZnVuY3Rpb24odCwgYiwgYywgZCwgYSwgcCkge1xuICAgIHZhciBzO1xuICAgIGlmKHQ9PTApIHJldHVybiBiOyAgaWYoKHQvPWQpPT0xKSByZXR1cm4gYitjOyAgaWYoIXApIHA9ZCouMztcbiAgICBpZighYSB8fCBhIDwgTWF0aC5hYnMoYykpIHsgYT1jOyBzPXAvNDsgfSBlbHNlIHMgPSBwLygyKk1hdGguUEkpICogTWF0aC5hc2luKGMvYSk7XG4gICAgcmV0dXJuIC0oYSpNYXRoLnBvdygyLDEwKih0LT0xKSkgKiBNYXRoLnNpbigodCpkLXMpKigyKk1hdGguUEkpL3AgKSkgKyBiO1xuICB9LFxuICAvKiogZWFzZU91dEVsYXN0aWMgKi9cbiAgZWFzZU91dEVsYXN0aWM6IGZ1bmN0aW9uKHQsIGIsIGMsIGQsIGEsIHApIHtcbiAgICB2YXIgcztcbiAgICBpZih0PT0wKSByZXR1cm4gYjsgIGlmKCh0Lz1kKT09MSkgcmV0dXJuIGIrYzsgIGlmKCFwKSBwPWQqLjM7XG4gICAgaWYoIWEgfHwgYSA8IE1hdGguYWJzKGMpKSB7IGE9Yzsgcz1wLzQ7IH0gZWxzZSBzID0gcC8oMipNYXRoLlBJKSAqIE1hdGguYXNpbihjL2EpO1xuICAgIHJldHVybihhKk1hdGgucG93KDIsLTEwKnQpICogTWF0aC5zaW4oKHQqZC1zKSooMipNYXRoLlBJKS9wICkgKyBjICsgYik7XG4gIH0sXG4gIC8qKiBlYXNlSW5PdXRFbGFzdGljICovXG4gIGVhc2VJbk91dEVsYXN0aWM6IGZ1bmN0aW9uKHQsIGIsIGMsIGQsIGEsIHApIHtcbiAgICB2YXIgcztcbiAgICBpZih0PT0wKSByZXR1cm4gYjsgIGlmKCh0Lz1kLzIpPT0yKSByZXR1cm4gYitjOyAgaWYoIXApIHA9ZCooLjMqMS41KTtcbiAgICBpZighYSB8fCBhIDwgTWF0aC5hYnMoYykpIHsgYT1jOyBzPXAvNDsgfSAgICAgICBlbHNlIHMgPSBwLygyKk1hdGguUEkpICogTWF0aC5hc2luKGMvYSk7XG4gICAgaWYodCA8IDEpIHJldHVybiAtLjUqKGEqTWF0aC5wb3coMiwxMCoodC09MSkpICogTWF0aC5zaW4oKHQqZC1zKSooMipNYXRoLlBJKS9wICkpICsgYjtcbiAgICByZXR1cm4gYSpNYXRoLnBvdygyLC0xMCoodC09MSkpICogTWF0aC5zaW4oKHQqZC1zKSooMipNYXRoLlBJKS9wICkqLjUgKyBjICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VPdXRJbkVsYXN0aWMgKi9cbiAgZWFzZU91dEluRWxhc3RpYzogZnVuY3Rpb24odCwgYiwgYywgZCwgYSwgcCkge1xuICAgIGlmKHQgPCBkLzIpIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZU91dEVsYXN0aWModCoyLCBiLCBjLzIsIGQsIGEsIHApO1xuICAgIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZUluRWxhc3RpYygodCoyKS1kLCBiK2MvMiwgYy8yLCBkLCBhLCBwKTtcbiAgfSxcbiAgLyoqIGVhc2VJbkJhY2sgKi9cbiAgZWFzZUluQmFjazogZnVuY3Rpb24odCwgYiwgYywgZCwgcykge1xuICAgIGlmKHMgPT0gdW5kZWZpbmVkKSBzID0gMS43MDE1ODtcbiAgICByZXR1cm4gYyoodC89ZCkqdCooKHMrMSkqdCAtIHMpICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VPdXRCYWNrICovXG4gIGVhc2VPdXRCYWNrOiBmdW5jdGlvbih0LCBiLCBjLCBkLCBzKSB7XG4gICAgaWYocyA9PSB1bmRlZmluZWQpIHMgPSAxLjcwMTU4O1xuICAgIHJldHVybiBjKigodD10L2QtMSkqdCooKHMrMSkqdCArIHMpICsgMSkgKyBiO1xuICB9LFxuICAvKiogZWFzZUluT3V0QmFjayAqL1xuICBlYXNlSW5PdXRCYWNrOiBmdW5jdGlvbih0LCBiLCBjLCBkLCBzKSB7XG4gICAgaWYocyA9PSB1bmRlZmluZWQpIHMgPSAxLjcwMTU4O1xuICAgIGlmKCh0Lz1kLzIpIDwgMSkgcmV0dXJuIGMvMioodCp0KigoKHMqPSgxLjUyNSkpKzEpKnQgLSBzKSkgKyBiO1xuICAgIHJldHVybiBjLzIqKCh0LT0yKSp0KigoKHMqPSgxLjUyNSkpKzEpKnQgKyBzKSArIDIpICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VPdXRJbkJhY2sgKi9cbiAgZWFzZU91dEluQmFjazogZnVuY3Rpb24odCwgYiwgYywgZCwgcykge1xuICAgIGlmKHQgPCBkLzIpIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZU91dEJhY2sodCoyLCBiLCBjLzIsIGQsIHMpO1xuICAgIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZUluQmFjaygodCoyKS1kLCBiK2MvMiwgYy8yLCBkLCBzKTtcbiAgfSxcbiAgLyoqIGVhc2VJbkJvdW5jZSAqL1xuICBlYXNlSW5Cb3VuY2U6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gYyAtIFR3ZWVuLkVBU0lORy5lYXNlT3V0Qm91bmNlKGQtdCwgMCwgYywgZCkgKyBiO1xuICB9LFxuICAvKiogZWFzZU91dEJvdW5jZSAqL1xuICBlYXNlT3V0Qm91bmNlOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgaWYoKHQvPWQpIDwoMS8yLjc1KSkge1xuICAgICAgcmV0dXJuIGMqKDcuNTYyNSp0KnQpICsgYjtcbiAgICB9IGVsc2UgaWYodCA8KDIvMi43NSkpIHtcbiAgICAgIHJldHVybiBjKig3LjU2MjUqKHQtPSgxLjUvMi43NSkpKnQgKyAuNzUpICsgYjtcbiAgICB9IGVsc2UgaWYodCA8KDIuNS8yLjc1KSkge1xuICAgICAgcmV0dXJuIGMqKDcuNTYyNSoodC09KDIuMjUvMi43NSkpKnQgKyAuOTM3NSkgKyBiO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYyooNy41NjI1Kih0LT0oMi42MjUvMi43NSkpKnQgKyAuOTg0Mzc1KSArIGI7XG4gICAgfVxuICB9LFxuICAvKiogZWFzZUluT3V0Qm91bmNlICovXG4gIGVhc2VJbk91dEJvdW5jZTogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgIGlmKHQgPCBkLzIpIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZUluQm91bmNlKHQqMiwgMCwgYywgZCkgKiAuNSArIGI7XG4gICAgZWxzZSByZXR1cm4gVHdlZW4uRUFTSU5HLmVhc2VPdXRCb3VuY2UodCoyLWQsIDAsIGMsIGQpICogLjUgKyBjKi41ICsgYjtcbiAgfSxcbiAgLyoqIGVhc2VPdXRJbkJvdW5jZSAqL1xuICBlYXNlT3V0SW5Cb3VuY2U6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICBpZih0IDwgZC8yKSByZXR1cm4gVHdlZW4uRUFTSU5HLmVhc2VPdXRCb3VuY2UodCoyLCBiLCBjLzIsIGQpO1xuICAgIHJldHVybiBUd2Vlbi5FQVNJTkcuZWFzZUluQm91bmNlKCh0KjIpLWQsIGIrYy8yLCBjLzIsIGQpO1xuICB9XG5cbn07XG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLnV0aWwuUXVlcnlTdHJpbmdcbiAqIFxuICovXG5jbGFzcyBRdWVyeVN0cmluZyB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbdGV4dF0g54Sh5oyH5a6a44Gu44Go44GN44Gv54++5Zyo44Oa44O844K444GuVVJM44KS5a++6LGh44Go44GZ44KLXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbc2VwPVwiJlwiXSDjgrvjg5Hjg6zjg7zjgr9cbiAgICogQHBhcmFtIHtzdHJpbmd9IFtlcT1cIj1cIl0gXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzRGVjb2RlXSBkZWNvZGVVUklDb21wb25lbnTjgavjgojjgovjg4fjgrPjg7zjg4njgpLooYzjgYbjgYvjganjgYbjgYtcbiAgICogQHJldHVybnMge09iamVjdH1cbiAgICovXG4gIHN0YXRpYyBwYXJzZSh0ZXh0LCBzZXAsIGVxLCBpc0RlY29kZSkge1xuICAgIHRleHQgPSB0ZXh0IHx8IGxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSk7XG4gICAgc2VwID0gc2VwIHx8ICcmJztcbiAgICBlcSA9IGVxIHx8ICc9JztcbiAgICB2YXIgZGVjb2RlID0gKGlzRGVjb2RlKSA/IGRlY29kZVVSSUNvbXBvbmVudCA6IGZ1bmN0aW9uKGEpIHsgcmV0dXJuIGE7IH07XG4gICAgcmV0dXJuIHRleHQuc3BsaXQoc2VwKS5yZWR1Y2UoZnVuY3Rpb24ob2JqLCB2KSB7XG4gICAgICB2YXIgcGFpciA9IHYuc3BsaXQoZXEpO1xuICAgICAgb2JqW3BhaXJbMF1dID0gZGVjb2RlKHBhaXJbMV0pO1xuICAgICAgcmV0dXJuIG9iajtcbiAgICB9LCB7fSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtPYmplY3R9IHZhbHVlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbc2VwPVwiJlwiXVxuICAgKiBAcGFyYW0ge3N0cmluZ30gW2VxPVwiPVwiXVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc0VuY29kZV0gZW5jb2RlVVJJQ29tcG9uZW5044Gr44KI44KL44Ko44Oz44Kz44O844OJ44KS6KGM44GG44GL44Gp44GG44GLXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBzdGF0aWMgc3RyaW5naWZ5KHZhbHVlLCBzZXAsIGVxLCBpc0VuY29kZSkge1xuICAgIHNlcCA9IHNlcCB8fCAnJic7XG4gICAgZXEgPSBlcSB8fCAnPSc7XG4gICAgdmFyIGVuY29kZSA9IChpc0VuY29kZSkgPyBlbmNvZGVVUklDb21wb25lbnQgOiBmdW5jdGlvbihhKSB7IHJldHVybiBhOyB9O1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh2YWx1ZSkubWFwKGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIGtleSArIGVxICsgZW5jb2RlKHZhbHVlW2tleV0pO1xuICAgIH0pLmpvaW4oc2VwKTtcbiAgfVxuICBcbn1cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEudXRpbC5Db2xvclxuICog44Kr44Op44O844Kv44Op44K5XG4gKi9cbmNsYXNzIENvbG9yIHtcblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IF9yXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBfZ1xuICAgKiBAcGFyYW0ge251bWJlcn0gX2JcbiAgICogQHBhcmFtIHtudW1iZXJ9IF9hXG4gICAqL1xuICBjb25zdHJ1Y3RvcihfciwgX2csIF9iLCBfYSkge1xuICAgIC8qKiBAdHlwZSB7bnVtYmVyfSBS5YCkICovXG4gICAgdGhpcy5yID0gMjU1O1xuXG4gICAgLyoqIEB0eXBlIHtudW1iZXJ9IEflgKQgKi9cbiAgICB0aGlzLmcgPSAyNTU7XG5cbiAgICAvKiogQHR5cGUge251bWJlcn0gQuWApCAqL1xuICAgIHRoaXMuYiA9IDI1NTtcblxuICAgIC8qKiBAdHlwZSB7bnVtYmVyfSBB5YCkICovXG4gICAgdGhpcy5hID0gMS4wO1xuXG4gICAgdGhpcy5zZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDjgrvjg4Pjgr/jg7wuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSByXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBnXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBiXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBhXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0KHIsIGcsIGIsIGEpIHtcbiAgICB0aGlzLnIgPSByO1xuICAgIHRoaXMuZyA9IGc7XG4gICAgdGhpcy5iID0gYjtcbiAgICB0aGlzLmEgPSAoYSAhPT0gdW5kZWZpbmVkKSA/IGEgOiAxLjA7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog5pWw5YCk44Gr44KI44KL44K744OD44K/44O8LlxuICAgKiBAcGFyYW0ge251bWJlcn0gclxuICAgKiBAcGFyYW0ge251bWJlcn0gZ1xuICAgKiBAcGFyYW0ge251bWJlcn0gYlxuICAgKiBAcGFyYW0ge251bWJlcn0gYVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldEZyb21OdW1iZXIociwgZywgYiwgYSkge1xuICAgIHRoaXMuciA9IHI7XG4gICAgdGhpcy5nID0gZztcbiAgICB0aGlzLmIgPSBiO1xuICAgIHRoaXMuYSA9IChhICE9PSB1bmRlZmluZWQpID8gYSA6IDEuMDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDphY3liJfjgavjgojjgovjgrvjg4Pjgr/jg7xcbiAgICogQHBhcmFtIHtudW1iZXJbXX0gYXJyXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0RnJvbUFycmF5KGFycikge1xuICAgIHJldHVybiB0aGlzLnNldC5hcHBseSh0aGlzLCBhcnIpO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCquODluOCuOOCp+OCr+ODiOOBq+OCiOOCi+OCu+ODg+OCv+ODvFxuICAgKiBAcGFyYW0ge3sgcjogbnVtYmVyOyBnOiBudW1iZXI7IGI6IG51bWJlcjsgYTogbnVtYmVyOyB9fSBvYmpcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRGcm9tT2JqZWN0KG9iaikge1xuICAgIHJldHVybiB0aGlzLnNldChvYmouciwgb2JqLmcsIG9iai5iLCBvYmouYSk7XG4gIH1cblxuICAvKipcbiAgICog5paH5a2X5YiX44Gr44KI44KL44K744OD44K/44O8XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRGcm9tU3RyaW5nKHN0cikge1xuICAgIHZhciBjb2xvciA9IENvbG9yLnN0cmluZ1RvTnVtYmVyKHN0cik7XG4gICAgcmV0dXJuIHRoaXMuc2V0KGNvbG9yWzBdLCBjb2xvclsxXSwgY29sb3JbMl0sIGNvbG9yWzNdKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDos6LjgYTjgrvjg4Pjgr/jg7xcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRTbWFydCgpIHtcbiAgICB2YXIgYXJnID0gYXJndW1lbnRzWzBdO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDMpIHtcbiAgICAgIHRoaXMuc2V0KGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0sIGFyZ3VtZW50c1szXSk7XG4gICAgfSBlbHNlIGlmIChhcmcgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgdGhpcy5zZXRGcm9tQXJyYXkoYXJnKTtcbiAgICB9IGVsc2UgaWYgKGFyZyBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgdGhpcy5zZXRGcm9tT2JqZWN0KGFyZyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YoYXJnKSA9PSBcInN0cmluZ1wiKSB7XG4gICAgICB0aGlzLnNldEZyb21TdHJpbmcoYXJnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQ1NTIOeUqCAxNumAsuaVsOaWh+Wtl+WIl+OBq+WkieaPm1xuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKi9cbiAgdG9TdHlsZUFzSGV4KCkge1xuICAgIHJldHVybiBmb3JtYXQuY2FsbChcIiN7MH17MX17Mn1cIixcbiAgICAvLyByZXR1cm4gXCIjezB9ezF9ezJ9XCIuZm9ybWF0KFxuICAgICAgcGFkZGluZy5jYWxsKHRoaXMuci50b1N0cmluZygxNiksIDIsICcwJyksXG4gICAgICBwYWRkaW5nLmNhbGwodGhpcy5nLnRvU3RyaW5nKDE2KSwgMiwgJzAnKSxcbiAgICAgIHBhZGRpbmcuY2FsbCh0aGlzLmIudG9TdHJpbmcoMTYpLCAyLCAnMCcpXG4gICAgICAvLyB0aGlzLnIudG9TdHJpbmcoMTYpLnBhZGRpbmcoMiwgJzAnKSxcbiAgICAgIC8vIHRoaXMuZy50b1N0cmluZygxNikucGFkZGluZygyLCAnMCcpLFxuICAgICAgLy8gdGhpcy5iLnRvU3RyaW5nKDE2KS5wYWRkaW5nKDIsICcwJylcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENTUyDnlKggUkdC5paH5a2X5YiX44Gr5aSJ5o+bXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICB0b1N0eWxlQXNSR0IoKSB7XG4gICAgcmV0dXJuIGZvcm1hdC5jYWxsKFwicmdiKHtyfSx7Z30se2J9KVwiLCB7XG4gICAgLy8gcmV0dXJuIFwicmdiKHtyfSx7Z30se2J9KVwiLmZvcm1hdCh7XG4gICAgICByOiB+fnRoaXMucixcbiAgICAgIGc6IH5+dGhpcy5nLFxuICAgICAgYjogfn50aGlzLmJcbiAgICB9KTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIENTUyDnlKggUkdCQeaWh+Wtl+WIl+OBq+WkieaPm1xuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKi9cbiAgdG9TdHlsZUFzUkdCQSgpIHtcbiAgICByZXR1cm4gZm9ybWF0LmNhbGwoXCJyZ2JhKHtyfSx7Z30se2J9LHthfSlcIiwge1xuICAgIC8vIHJldHVybiBcInJnYmEoe3J9LHtnfSx7Yn0se2F9KVwiLmZvcm1hdCh7XG4gICAgICByOiB+fnRoaXMucixcbiAgICAgIGc6IH5+dGhpcy5nLFxuICAgICAgYjogfn50aGlzLmIsXG4gICAgICBhOiB0aGlzLmFcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDU1Mg55SoIFJHQkEg5paH5a2X5YiX44Gr5aSJ5o+bXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICB0b1N0eWxlKCkge1xuICAgIHJldHVybiBmb3JtYXQuY2FsbChcInJnYmEoe3J9LHtnfSx7Yn0se2F9KVwiLCB7XG4gICAgLy8gcmV0dXJuIFwicmdiYSh7cn0se2d9LHtifSx7YX0pXCIuZm9ybWF0KHtcbiAgICAgIHI6IH5+dGhpcy5yLFxuICAgICAgZzogfn50aGlzLmcsXG4gICAgICBiOiB+fnRoaXMuYixcbiAgICAgIGE6IHRoaXMuYVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlciBwaGluYS51dGlsLkNvbG9yXG4gICAqIEBtZXRob2Qgc3RyVG9OdW1cbiAgICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICAgKiBAcmV0dXJucyB7bnVtYmVyW119XG4gICAqL1xuICBzdGF0aWMgc3RyVG9OdW0oc3RyKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaW5nVG9OdW1iZXIoc3RyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyXG4gICAqIEByZXR1cm5zIHtudW1iZXJbXX1cbiAgICovXG4gIHN0YXRpYyBzdHJpbmdUb051bWJlcihzdHIpIHtcbiAgICB2YXIgdmFsdWUgPSBudWxsO1xuICAgIHZhciB0eXBlID0gbnVsbDtcblxuICAgIGlmIChzdHJbMF0gPT09ICcjJykge1xuICAgICAgdHlwZSA9IChzdHIubGVuZ3RoID09IDQpID8gXCJoZXgxMTFcIiA6IFwiaGV4MjIyXCI7XG4gICAgfSBlbHNlIGlmIChzdHJbMF0gPT09ICdyJyAmJiBzdHJbMV0gPT09ICdnJyAmJiBzdHJbMl0gPT09ICdiJykge1xuICAgICAgdHlwZSA9IChzdHJbM10gPT0gJ2EnKSA/IFwicmdiYVwiIDogXCJyZ2JcIjtcbiAgICB9IGVsc2UgaWYgKHN0clswXSA9PT0gJ2gnICYmIHN0clsxXSA9PT0gJ3MnICYmIHN0clsyXSA9PT0gJ2wnKSB7XG4gICAgICB0eXBlID0gKHN0clszXSA9PSAnYScpID8gXCJoc2xhXCIgOiBcImhzbFwiO1xuICAgIH1cblxuICAgIGlmICh0eXBlKSB7XG4gICAgICB2YXIgbWF0Y2hfc2V0ID0gTUFUQ0hfU0VUX0xJU1RbdHlwZV07XG4gICAgICB2YXIgbSA9IHN0ci5tYXRjaChtYXRjaF9zZXQucmVnKTtcbiAgICAgIHZhbHVlID0gbWF0Y2hfc2V0LmV4ZWMobSk7XG4gICAgfSBlbHNlIGlmIChDb2xvci5DT0xPUl9MSVNUW3N0cl0pIHtcbiAgICAgIHZhbHVlID0gQ29sb3IuQ09MT1JfTElTVFtzdHJdO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZXRob2RcbiAgICogaHNsIOOCkiByZ2Ig44Gr5aSJ5o+bXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gaFxuICAgKiBAcGFyYW0ge251bWJlcn0gc1xuICAgKiBAcGFyYW0ge251bWJlcn0gbFxuICAgKiBAcmV0dXJucyB7bnVtYmVyW119IHJnYuaVsOWApOmFjeWIl1xuICAgKi9cbiAgc3RhdGljIEhTTHRvUkdCKGgsIHMsIGwpIHtcbiAgICB2YXIgciwgZywgYjtcblxuICAgIGggJT0gMzYwO1xuICAgIGggKz0gMzYwO1xuICAgIGggJT0gMzYwO1xuICAgIHMgKj0gMC4wMTtcbiAgICBsICo9IDAuMDE7XG5cbiAgICBpZiAocyA9PT0gMCkge1xuICAgICAgbCA9IE1hdGgucm91bmQobCAqIDI1NSk7XG4gICAgICByZXR1cm4gW2wsIGwsIGxdO1xuICAgIH1cbiAgICB2YXIgbTIgPSAobCA8IDAuNSkgPyBsICogKDEgKyBzKSA6IGwgKyBzIC0gbCAqIHM7XG4gICAgdmFyIG0xID0gbCAqIDIgLSBtMjtcblxuICAgIC8vIHJlZFxuICAgIHZhciB0ZW1wID0gKGggKyAxMjApICUgMzYwO1xuICAgIGlmICh0ZW1wIDwgNjApIHtcbiAgICAgIHIgPSBtMSArIChtMiAtIG0xKSAqIHRlbXAgLyA2MDtcbiAgICB9IGVsc2UgaWYgKHRlbXAgPCAxODApIHtcbiAgICAgIHIgPSBtMjtcbiAgICB9IGVsc2Uge1xuICAgICAgciA9IG0xO1xuICAgIH1cblxuICAgIC8vIGdyZWVuXG4gICAgdGVtcCA9IGg7XG4gICAgaWYgKHRlbXAgPCA2MCkge1xuICAgICAgZyA9IG0xICsgKG0yIC0gbTEpICogdGVtcCAvIDYwO1xuICAgIH0gZWxzZSBpZiAodGVtcCA8IDE4MCkge1xuICAgICAgZyA9IG0yO1xuICAgIH0gZWxzZSBpZiAodGVtcCA8IDI0MCkge1xuICAgICAgZyA9IG0xICsgKG0yIC0gbTEpICogKDI0MCAtIHRlbXApIC8gNjA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGcgPSBtMTtcbiAgICB9XG5cbiAgICAvLyBibHVlXG4gICAgdGVtcCA9ICgoaCAtIDEyMCkgKyAzNjApICUgMzYwO1xuICAgIGlmICh0ZW1wIDwgNjApIHtcbiAgICAgIGIgPSBtMSArIChtMiAtIG0xKSAqIHRlbXAgLyA2MDtcbiAgICB9IGVsc2UgaWYgKHRlbXAgPCAxODApIHtcbiAgICAgIGIgPSBtMjtcbiAgICB9IGVsc2UgaWYgKHRlbXAgPCAyNDApIHtcbiAgICAgIGIgPSBtMSArIChtMiAtIG0xKSAqICgyNDAgLSB0ZW1wKSAvIDYwO1xuICAgIH0gZWxzZSB7XG4gICAgICBiID0gbTE7XG4gICAgfVxuXG4gICAgcmV0dXJuIFtcbiAgICAgIE1hdGguZmxvb3IociAqIDI1NSksXG4gICAgICBNYXRoLmZsb29yKGcgKiAyNTUpLFxuICAgICAgTWF0aC5mbG9vcihiICogMjU1KVxuICAgIF07XG4gIH1cblxuICAvKipcbiAgICogQHN0YXRpY1xuICAgKiBAbWV0aG9kXG4gICAqIGhzbGEg44KSIHJnYmEg44Gr5aSJ5o+bXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gaFxuICAgKiBAcGFyYW0ge251bWJlcn0gc1xuICAgKiBAcGFyYW0ge251bWJlcn0gbFxuICAgKiBAcGFyYW0ge251bWJlcn0gYVxuICAgKiBAcmV0dXJucyB7bnVtYmVyW119IHJnYmHmlbDlgKTphY3liJdcbiAgICovXG4gIHN0YXRpYyBIU0xBdG9SR0JBKGgsIHMsIGwsIGEpIHtcbiAgICB2YXIgdGVtcCA9IENvbG9yLkhTTHRvUkdCKGgsIHMsIGwpO1xuICAgIHRlbXBbM10gPSBhO1xuICAgIHJldHVybiB0ZW1wO1xuICB9XG5cbiAgLyoqXG4gICAqIEBzdGF0aWNcbiAgICogQG1ldGhvZFxuICAgKiByZ2Ig5YCk44GL44KJQ1NTIGNvbG9y44OH44O844K/5Z6L5rqW5oug44Gu5paH5a2X5YiX44KS55Sf5oiQXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gclxuICAgKiBAcGFyYW0ge251bWJlcn0gZ1xuICAgKiBAcGFyYW0ge251bWJlcn0gYlxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKi9cbiAgc3RhdGljIGNyZWF0ZVN0eWxlUkdCKHIsIGcsIGIpIHtcbiAgICByZXR1cm4gXCJyZ2JhKFwiICsgciArIFwiLFwiICsgZyArIFwiLFwiICsgYiArIFwiKVwiO1xuICB9XG5cbiAgLyoqXG4gICAqIEBzdGF0aWNcbiAgICogQG1ldGhvZFxuICAgKiByZ2JhIOWApOOBi+OCiUNTUyBjb2xvcuODh+ODvOOCv+Wei+a6luaLoOOBruaWh+Wtl+WIl+OCkueUn+aIkFxuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGdcbiAgICogQHBhcmFtIHtudW1iZXJ9IGJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGFcbiAgICogQHJldHVybnMge3N0cmluZ31cbiAgICovXG4gIHN0YXRpYyBjcmVhdGVTdHlsZVJHQkEociwgZywgYiwgYSkge1xuICAgIHJldHVybiBcInJnYmEoXCIgKyByICsgXCIsXCIgKyBnICsgXCIsXCIgKyBiICsgXCIsXCIgKyBhICsgXCIpXCI7XG4gIH1cblxuICAvKipcbiAgICogQHN0YXRpY1xuICAgKiBAbWV0aG9kXG4gICAqIGhzbCDlgKTjgYvjgolDU1MgY29sb3Ljg4fjg7zjgr/lnovmupbmi6Djga7mloflrZfliJfjgpLnlJ/miJBcbiAgICogXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBoXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBzdGF0aWMgY3JlYXRlU3R5bGVIU0woaCwgcywgbCkge1xuICAgIHJldHVybiBcImhzbChcIiArIGggKyBcIixcIiArIHMgKyBcIiUsXCIgKyBsICsgXCIlKVwiO1xuICB9XG5cbiAgLyoqXG4gICAqIEBzdGF0aWNcbiAgICogQG1ldGhvZFxuICAgKiBoc2xhIOWApOOBi+OCiUNTUyBjb2xvcuODh+ODvOOCv+Wei+a6luaLoOOBruaWh+Wtl+WIl+OCkueUn+aIkFxuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ9IGhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNcbiAgICogQHBhcmFtIHtudW1iZXJ9IGxcbiAgICogQHBhcmFtIHtudW1iZXJ9IGFcbiAgICogQHJldHVybnMge3N0cmluZ31cbiAgICovXG4gIHN0YXRpYyBjcmVhdGVTdHlsZUhTTEEoaCwgcywgbCwgYSkge1xuICAgIHJldHVybiBcImhzbGEoXCIgKyBoICsgXCIsXCIgKyBzICsgXCIlLFwiICsgbCArIFwiJSxcIiArIGEgKyBcIilcIjtcbiAgfVxuXG59XG5cbi8qKlxuICogQHN0YXRpY1xuICogQGVudW0ge251bWJlcltdfVxuICog44Kr44Op44O844Oq44K544OIXG4gKi9cbkNvbG9yLkNPTE9SX0xJU1QgPSB7XG4gIC8qKiBAcHJvcGVydHkgYmxhY2sgKi9cbiAgXCJibGFja1wiOiBbMHgwMCwgMHgwMCwgMHgwMF0sXG4gIC8qKiBAcHJvcGVydHkgc2lsdmVyICovXG4gIFwic2lsdmVyXCI6IFsweGMwLCAweGMwLCAweGMwXSxcbiAgLyoqIEBwcm9wZXJ0eSBncmF5ICovXG4gIFwiZ3JheVwiOiBbMHg4MCwgMHg4MCwgMHg4MF0sXG4gIC8qKiBAcHJvcGVydHkgd2hpdGUgKi9cbiAgXCJ3aGl0ZVwiOiBbMHhmZiwgMHhmZiwgMHhmZl0sXG4gIC8qKiBAcHJvcGVydHkgbWFyb29uICovXG4gIFwibWFyb29uXCI6IFsweDgwLCAweDAwLCAweDAwXSxcbiAgLyoqIEBwcm9wZXJ0eSByZWQgKi9cbiAgXCJyZWRcIjogWzB4ZmYsIDB4MDAsIDB4MDBdLFxuICAvKiogQHByb3BlcnR5IHB1cnBsZSAqL1xuICBcInB1cnBsZVwiOiBbMHg4MCwgMHgwMCwgMHg4MF0sXG4gIC8qKiBAcHJvcGVydHkgZnVjaHNpYSAqL1xuICBcImZ1Y2hzaWFcIjogWzB4ZmYsIDB4MDAsIDB4ZmZdLFxuICAvKiogQHByb3BlcnR5IGdyZWVuICovXG4gIFwiZ3JlZW5cIjogWzB4MDAsIDB4ODAsIDB4MDBdLFxuICAvKiogQHByb3BlcnR5IGxpbWUgKi9cbiAgXCJsaW1lXCI6IFsweDAwLCAweGZmLCAweDAwXSxcbiAgLyoqIEBwcm9wZXJ0eSBvbGl2ZSAqL1xuICBcIm9saXZlXCI6IFsweDgwLCAweDgwLCAweDAwXSxcbiAgLyoqIEBwcm9wZXJ0eSB5ZWxsb3cgKi9cbiAgXCJ5ZWxsb3dcIjogWzB4ZmYsIDB4ZmYsIDB4MDBdLFxuICAvKiogQHByb3BlcnR5IG5hdnkgKi9cbiAgXCJuYXZ5XCI6IFsweDAwLCAweDAwLCAweDgwXSxcbiAgLyoqIEBwcm9wZXJ0eSBibHVlICovXG4gIFwiYmx1ZVwiOiBbMHgwMCwgMHgwMCwgMHhmZl0sXG4gIC8qKiBAcHJvcGVydHkgdGVhbCAqL1xuICBcInRlYWxcIjogWzB4MDAsIDB4ODAsIDB4ODBdLFxuICAvKiogQHByb3BlcnR5IGFxdWEgKi9cbiAgXCJhcXVhXCI6IFsweDAwLCAweGZmLCAweGZmXSxcbn07XG5cbi8qKlxuICog6Imy5paH5a2X5YiX44KSbnVtYmVy5Z6L6YWN5YiX44Gr5aSJ5o+b44GZ44KL44Gf44KB44Gu5q2j6KaP6KGo54++44Go6Zai5pWw44Gu44K744OD44OIXG4gKiBAZW51bSB7e3JlZzogUmVnRXhwLCBleGVjOiAobTpudW1iZXJbXSk9PiBudW1iZXJbXX19XG4gKi9cbnZhciBNQVRDSF9TRVRfTElTVCA9IHtcbiAgXCJoZXgxMTFcIjoge1xuICAgIHJlZzogL14jKFxcd3sxfSkoXFx3ezF9KShcXHd7MX0pJC8sXG4gICAgZXhlYzogZnVuY3Rpb24obSkge1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgcGFyc2VJbnQobVsxXSArIG1bMV0sIDE2KSxcbiAgICAgICAgcGFyc2VJbnQobVsyXSArIG1bMl0sIDE2KSxcbiAgICAgICAgcGFyc2VJbnQobVszXSArIG1bM10sIDE2KVxuICAgICAgXTtcbiAgICB9XG4gIH0sXG4gIFwiaGV4MjIyXCI6IHtcbiAgICByZWc6IC9eIyhcXHd7Mn0pKFxcd3syfSkoXFx3ezJ9KSQvLFxuICAgIGV4ZWM6IGZ1bmN0aW9uKG0pIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIHBhcnNlSW50KG1bMV0sIDE2KSxcbiAgICAgICAgcGFyc2VJbnQobVsyXSwgMTYpLFxuICAgICAgICBwYXJzZUludChtWzNdLCAxNilcbiAgICAgIF07XG4gICAgfVxuICB9LFxuICBcInJnYlwiOiB7XG4gICAgcmVnOiAvXnJnYlxcKChcXGR7MSwzfSksXFxzKihcXGR7MSwzfSksXFxzKihcXGR7MSwzfSlcXCkkLyxcbiAgICBleGVjOiBmdW5jdGlvbihtKSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICBwYXJzZUludChtWzFdKSxcbiAgICAgICAgcGFyc2VJbnQobVsyXSksXG4gICAgICAgIHBhcnNlSW50KG1bM10pXG4gICAgICBdO1xuICAgIH1cbiAgfSxcbiAgXCJyZ2JhXCI6IHtcbiAgICByZWc6IC9ecmdiYVxcKChcXGR7MSwzfSksXFxzKihcXGR7MSwzfSksXFxzKihcXGR7MSwzfSksXFxzKihcXGR7MX0oXFwuezF9XFxkKyk/KVxcKSQvLFxuICAgIGV4ZWM6IGZ1bmN0aW9uKG0pIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIHBhcnNlSW50KG1bMV0pLFxuICAgICAgICBwYXJzZUludChtWzJdKSxcbiAgICAgICAgcGFyc2VJbnQobVszXSksXG4gICAgICAgIHBhcnNlRmxvYXQobVs0XSlcbiAgICAgIF07XG4gICAgfVxuICB9LFxuICBcImhzbFwiOiB7XG4gICAgcmVnOiAvXmhzbFxcKChcXGR7MSwzfSksXFxzKihcXGR7MSwzfSklLFxccyooXFxkezEsM30pJVxcKSQvLFxuICAgIGV4ZWM6IGZ1bmN0aW9uKG0pIHtcbiAgICAgIHJldHVybiBDb2xvci5IU0x0b1JHQihtWzFdLCBtWzJdLCBtWzNdKTtcbiAgICB9XG4gIH0sXG4gIFwiaHNsYVwiOiB7XG4gICAgcmVnOiAvXnJnYmFcXCgoXFxkezEsM30pLFxccyooXFxkezEsM30pLFxccyooXFxkezEsM30pLFxccyooXFxkezF9KFxcLnsxfVxcZCspPylcXCkkLyxcbiAgICBleGVjOiBmdW5jdGlvbihtKSB7XG4gICAgICByZXR1cm4gQ29sb3IuSFNMQXRvUkdCQShtWzFdLCBtWzJdLCBtWzNdLCBtWzRdKTtcbiAgICB9XG4gIH1cbn07XG5cbi8vIOebo+imluOCquODluOCuOOCp+OCr+ODiFxuLy8gcmVnaXN0ZXIg44GnIGtleSDjgpLnmbvpjLIgKOODh+ODleOCqeODq+ODiOWApOOCguS4gOe3kuOBq++8nylcbi8vIGV2ZW50IGRpc3BhdGNoZXIg44KS57aZ5om/XG4vLyBldmVudCBkaXNwYXRjaGVyIOOBo+OBpiB1dGlsIOOBmOOCg+OBre+8n1xuLy8gcmVnaXN0ZXIg44Gn55m76Yyy44GX44Gf5YCk44KS5aSJ5pu044GX44Gf44KJIGNoYW5nZSDjgqTjg5njg7Pjg4jjgYzotbDjgotcblxuXG4vLyDlkI3liY3lgJnoo5xcbi8vICBtaWRkbGVtYW4o5Luy56uL5Lq6KVxuXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLnV0aWwuQ2hhbmdlRGlzcGF0Y2hlclxuICogX2V4dGVuZHMgcGhpbmEudXRpbC5FdmVudERpc3BhdGNoZXJcbiAqL1xuY2xhc3MgQ2hhbmdlRGlzcGF0Y2hlciBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMuX29ic2VydmUgPSB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAgICogQHBhcmFtIHthbnl9IGRlZmF1bHRWYWx1ZVxuICAgKi9cbiAgcmVnaXN0ZXIoa2V5LCBkZWZhdWx0VmFsdWUpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgdmFyIG9iaiA9IGFyZ3VtZW50c1swXTtcbiAgICAgIGZvckluLmNhbGwob2JqLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICAvLyBvYmouZm9ySW4oZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLnJlZ2lzdGVyKGtleSwgdmFsdWUpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdmFyIHRlbXBLZXkgPSAnX18nICsga2V5O1xuICAgICAgdGhpc1t0ZW1wS2V5XSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgIGFjY2Vzc29yLmNhbGwodGhpcywga2V5LCB7XG4gICAgICAvLyB0aGlzLmFjY2Vzc29yKGtleSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzW3RlbXBLZXldO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICB0aGlzW3RlbXBLZXldID0gdjtcbiAgICAgICAgICBpZiAodGhpcy5fb2JzZXJ2ZSkge1xuICAgICAgICAgICAgdGhpcy5mbGFyZSgnY2hhbmdlJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgb2JzZXJ2ZSgpIHtcbiAgICB0aGlzLl9vYnNlcnZlID0gdHJ1ZTtcbiAgfVxuICB1bm9ic2VydmUoKSB7XG4gICAgdGhpcy5fb2JzZXJ2ZSA9IGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQWpheFJlcXVlc3RPcHRpb25zIEFqYXjjgq/jg6njgrnliJ3mnJ/ljJbjgqrjg5fjgrfjg6fjg7NcbiAqIEBwcm9wZXJ0eSB7J0dFVCd8J1BPU1QnfCdQVVQnfCdERUxFVEUnfSB0eXBlIFxuICogQHByb3BlcnR5IHtzdHJpbmd9IHVybCBcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbY29udGVudFR5cGVdIFxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtyZXNwb25zZVR5cGVdIFxuICogQHByb3BlcnR5IHthbnl9IFtkYXRhXSDmnKrkvb/nlKjvvJ9cbiAqL1xuXG4gLyoqXG4gKiBAY2xhc3MgcGhpbmEudXRpbC5BamF4XG4gKiBcbiAqL1xuY2xhc3MgQWpheCB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7QWpheFJlcXVlc3RPcHRpb25zfSBvcHRpb25zXG4gICAqL1xuICBzdGF0aWMgcmVxdWVzdChvcHRpb25zKSB7XG4gICAgdmFyIGRhdGEgPSAkc2FmZS5jYWxsKHt9LCBvcHRpb25zLCBBamF4LmRlZmF1bHRzKTtcbiAgICAvLyB2YXIgZGF0YSA9ICh7fSkuJHNhZmUob3B0aW9ucywgdGhpcy5kZWZhdWx0cyk7XG5cbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgdmFyIGZsb3cgPSBuZXcgRmxvdyhmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgIGlmIChbMjAwLCAyMDEsIDBdLmluZGV4T2YoeGhyLnN0YXR1cykgIT09IC0xKSB7XG4gICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB4aHIub3BlbihkYXRhLnR5cGUsIGRhdGEudXJsKTtcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSBkYXRhLnJlc3BvbnNlVHlwZTtcbiAgICAgIHhoci5zZW5kKG51bGwpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGZsb3c7XG4gIH1cbiAgc3RhdGljIGdldCh1cmwpIHtcbiAgICByZXR1cm4gQWpheC5yZXF1ZXN0KHtcbiAgICAgIHR5cGU6ICdHRVQnLFxuICAgICAgdXJsOiB1cmwsXG4gICAgfSk7XG4gIH1cbiAgc3RhdGljIHBvc3QodXJsKSB7XG4gICAgcmV0dXJuIEFqYXgucmVxdWVzdCh7XG4gICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICB1cmw6IHVybCxcbiAgICB9KTtcbiAgfVxuICBzdGF0aWMgcHV0KHVybCkge1xuICAgIHJldHVybiBBamF4LnJlcXVlc3Qoe1xuICAgICAgdHlwZTogJ1BVVCcsXG4gICAgICB1cmw6IHVybCxcbiAgICB9KTtcbiAgfVxuICBzdGF0aWMgZGVsKHVybCkge1xuICAgIHJldHVybiBBamF4LnJlcXVlc3Qoe1xuICAgICAgdHlwZTogJ0RFTEVURScsXG4gICAgICB1cmw6IHVybCxcbiAgICB9KTtcbiAgfVxuXG59XG5cbi8qKiBcbiAqIEBzdGF0aWNcbiAqIEB0eXBlIHtBamF4UmVxdWVzdE9wdGlvbnN9XG4gKi9cbkFqYXguZGVmYXVsdHMgPSB7XG4gIHR5cGU6ICdHRVQnLFxuICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXG4gIHJlc3BvbnNlVHlwZTogJ2pzb24nLFxuICBkYXRhOiBudWxsLFxuICB1cmw6ICcnLFxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBQcmltaXRpdmVWZWN0b3IyIHgseeODl+ODreODkeODhuOCo+OBruOBv+OBruWOn+Wni+eahOOBqlZlY3RvcjJcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB4XG4gKiBAcHJvcGVydHkge251bWJlcn0geVxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmdlb20uVmVjdG9yMlxuICogQGV4dGVuZHMgUHJpbWl0aXZlVmVjdG9yMlxuICogIyAy5qyh5YWD44OZ44Kv44OI44Or44Kv44Op44K5XG4gKiAy5qyh5YWD44Gu44OZ44Kv44OI44Or44KE5bqn5qiZ44KS6KGo44GZ44Kv44Op44K544Gn44GZ44CCXG4gKiBcbiAqIEBleGFtcGxlXG4gKiB2ID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDQpO1xuICpcbiAqL1xuY2xhc3MgVmVjdG9yMiB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbeD0wXSDjg5njgq/jg4jjg6vjga4geCDluqfmqJlcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFt5PTBdIOODmeOCr+ODiOODq+OBriB5IOW6p+aomVxuICAgKi9cbiAgY29uc3RydWN0b3IoeD0wLCB5PTApIHtcblxuICAgIC8qKlxuICAgICAqIHjluqfmqJlcbiAgICAgKiBAdHlwZSB7TnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMueCA9IHg7XG5cbiAgICAvKipcbiAgICAgKiB55bqn5qiZXG4gICAgICogQHR5cGUge051bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLnkgPSB5O1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgY2xvbmVcbiAgICogdGhpcyDjga7jgrPjg5Tjg7zjgpLnlJ/miJDjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdiA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCA0KTtcbiAgICogdjIgPSB2LmNsb25lKCk7XG4gICAqIHYyLnggPT0gdi54OyAvLyA9PiB0cnVlXG4gICAqXG4gICAqIEByZXR1cm5zIHtWZWN0b3IyfSDnlJ/miJDjgZfjgZ/jg5njgq/jg4jjg6tcbiAgICovXG4gIGNsb25lKCkge1xuICAgIHJldHVybiBuZXcgVmVjdG9yMih0aGlzLngsIHRoaXMueSk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBlcXVhbHNcbiAgICogdGhpcyDjga7lkITopoHntKDjgYzjgZnjgbnjgaYgb3RoZXIg44Go562J44GX44GE44GL44Gp44GG44GL44KS6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDQpO1xuICAgKiB2MiA9IHBoaW5hLmdlb20uVmVjdG9yMig1LCA2KTtcbiAgICogdjEuZXF1YWxzKHYyKTsgLy8gPT4gZmFsc2VcbiAgICpcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSB2IOavlOi8g+OBmeOCi+WvvuixoeOBruODmeOCr+ODiOODq1xuICAgKiBAcmV0dXJuIHtCb29sZWFufSDnrYnjgZfjgYTjgYvjganjgYbjgYtcbiAgICovXG4gIGVxdWFscyh2KSB7XG4gICAgcmV0dXJuICh0aGlzLnggPT09IHYueCAmJiB0aGlzLnkgPT09IHYueSk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBzZXRcbiAgICogdGhpcyDjga7lkITopoHntKDjga7lgKTjgpLlho3oqK3lrprjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdiA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCA0KTtcbiAgICogdi5zZXQoNSwgNik7XG4gICAqXG4gICAqIEBjaGFpbmFibGVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHgg44OZ44Kv44OI44Or44GuIHgg5bqn5qiZXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB5IOODmeOCr+ODiOODq+OBriB5IOW6p+aomVxuICAgKi9cbiAgc2V0KHgsIHkpIHtcbiAgICB0aGlzLnggPSB4O1xuICAgIHRoaXMueSA9IHk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBhZGRcbiAgICogQGNoYWluYWJsZVxuICAgKiB0aGlzIOOBqyBvdGhlciDjgpLliqDjgYjjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgNCk7XG4gICAqIHYyID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDUsIDYpO1xuICAgKiB2MS5hZGQodjIpOyAvLyA9PiBwaGluYS5nZW9tLlZlY3Rvcig4LCAxMClcbiAgICpcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSB2IOODmeOCr+ODiOODq1xuICAgKi9cbiAgYWRkKHYpIHtcbiAgICB0aGlzLnggKz0gdi54O1xuICAgIHRoaXMueSArPSB2Lnk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBzdWJcbiAgICogQGNoYWluYWJsZVxuICAgKiB0aGlzIOOBi+OCiSBvdGhlciDjgpLmuJvjgZjjgb7jgZnjgIJcbiAgICpcbiAgICog44OZ44Kv44OI44Or44GM5bqn5qiZ44KS6KGo44GZ5aC05ZCI44Gv44CB5oyH5a6a44GX44Gf5bqn5qiZ44GL44KJ6Ieq5YiG6Ieq6Lqr44G444Go5ZCR44GL44GG44OZ44Kv44OI44Or44GM5b6X44KJ44KM44G+44GZ44CCXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCA0KTtcbiAgICogdjIgPSBwaGluYS5nZW9tLlZlY3RvcjIoMSwgNSk7XG4gICAqIHYxLnN1Yih2Mik7IC8vID0+IHBoaW5hLmdlb20uVmVjdG9yKDIsIC0xKVxuICAgKlxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IHYg44OZ44Kv44OI44OrXG4gICAqL1xuICBzdWIodikge1xuICAgIHRoaXMueCAtPSB2Lng7XG4gICAgdGhpcy55IC09IHYueTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIG11bFxuICAgKiBAY2hhaW5hYmxlXG4gICAqIHRoaXMg44Gu5ZCE6KaB57Sg44Gr5pWw5YCkIG4g44KS5LmX44GY44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDQpO1xuICAgKiB2MS5tdWwoMykgLy8gPT4gcGhpbmEuZ2VvbS5WZWN0b3IoOSwgMTIpXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBuIOS5l+OBmOOCi+WApFxuICAgKi9cbiAgbXVsKG4pIHtcbiAgICB0aGlzLnggKj0gbjtcbiAgICB0aGlzLnkgKj0gbjtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGRpdlxuICAgKiBAY2hhaW5hYmxlXG4gICAqIHRoaXMg44Gu5ZCE6KaB57Sg44KS5pWw5YCkIG4g44Gn5Ymy44KK44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDgsIDE2KTtcbiAgICogdjEuZGl2KDIpIC8vID0+IHBoaW5hLmdlb20uVmVjdG9yKDQsIDgpXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBuIOWJsuOCi+WApFxuICAgKi9cbiAgZGl2KG4pIHtcbiAgICAvL2NvbnNvbGUuYXNzZXJ0KG4gIT0gMCwgXCIwIGRpdmlzaW9uISFcIik7XG4gICAgbiA9IG4gfHwgMC4wMTtcbiAgICB0aGlzLnggLz0gbjtcbiAgICB0aGlzLnkgLz0gbjtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgICogQG1ldGhvZCBuZWdhdGVcbiAgICogQGNoYWluYWJsZVxuICAgKiB0aGlzIOOBruWQhOimgee0oOOBruato+iyoOOCkuWPjei7ouOBl+OBvuOBmeOAglxuICAgKlxuICAgKiB0aGlzIOOBqOWQjOOBmOWkp+OBjeOBleOBp+aWueWQkeOBjOmAhuOBruODmeOCr+ODiOODq+OBjOW+l+OCieOCjOOBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCAtNCk7XG4gICAqIHYxLm5lZ2F0ZSgpIC8vID0+IHBoaW5hLmdlb20uVmVjdG9yKC0zLCA0KVxuICAgKlxuICAgKi9cbiAgbmVnYXRlKCkge1xuICAgIHRoaXMueCA9IC10aGlzLng7XG4gICAgdGhpcy55ID0gLXRoaXMueTtcbiAgICBcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGRvdFxuICAgKiBvdGhlciDjgajjga7lhoXnqY3jgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICog5oqV5b2x44OZ44Kv44OI44Or44KS5rGC44KB44Gf44KK44CB6aGe5Ly85bqm44Gu6KiI566X44Gr5Yip55So44GZ44KL44GT44Go44GM44Gn44GN44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDQpO1xuICAgKiB2MiA9IHBoaW5hLmdlb20uVmVjdG9yMigtMiwgMik7XG4gICAqIHYxLmRvdCh2MikgLy8gPT4gMlxuICAgKlxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IHYg44OZ44Kv44OI44OrXG4gICAqIEByZXR1cm4ge051bWJlcn0g5YaF56mNXG4gICAqL1xuICBkb3Qodikge1xuICAgIHJldHVybiB0aGlzLnggKiB2LnggKyB0aGlzLnkgKiB2Lnk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBjcm9zc1xuICAgKiBvdGhlciDjgajjga7lpJbnqY3vvIjjgq/jg63jgrnnqY3vvInjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogMuasoeWFg+ODmeOCr+ODiOODq+OBp+OBruWkluepjeOBr+ODmeOCr+ODiOODq+OBp+OBquOBj+aVsOWApOOCkui/lOOBmeOBk+OBqOOBq+azqOaEj+OBl+OBpuOBj+OBoOOBleOBhOOAglxuICAgKiBvdGhlciDjgojjgoogdGhpcyDmmYLoqIjlm57jgorjgavjgYLjgovjgajjgY3jga/mraPjga7lgKTjgavjgarjgorjgIHlj43mmYLoqIjlm57jgorjgavjgYLjgovjgajjgY3jga/osqDjga7lgKTjgavjgarjgorjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgNCk7XG4gICAqIHYyID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDEpO1xuICAgKiB2MS5jcm9zcyh2MikgLy8gPT4gLThcbiAgICpcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSB2IOODmeOCr+ODiOODq1xuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IOWkluepjVxuICAgKi9cbiAgY3Jvc3Modikge1xuICAgIHJldHVybiAodGhpcy54KnYueSkgLSAodGhpcy55KnYueCk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBsZW5ndGhcbiAgICogdGhpcyDjga7lpKfjgY3jgZXjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogKG1lbW8pIG1hZ25pdHVkZSDjgaPjgablkI3liY3jga7mlrnjgYzoia/jgYTjgYvjgoIuIOaknOiojuS4rS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgNCk7XG4gICAqIHYxLmxlbmd0aCgpOyAvLyA9PiA1XG4gICAqXG4gICAqIEByZXR1cm4ge051bWJlcn0g44OZ44Kv44OI44Or44Gu5aSn44GN44GVXG4gICAqL1xuICBsZW5ndGgoKSB7XG4gICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLngqdGhpcy54ICsgdGhpcy55KnRoaXMueSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBAbWV0aG9kIGxlbmd0aFNxdWFyZWRcbiAgICogdGhpcyDjga7lpKfjgY3jgZXjga7oh6rkuZfjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQyMg44Gu5ZCN5YmN44KS5byV55So77yIb3IgbGVuZ3RoU3F1YXJlIG9yIGxlbmd0aFNxcnTvvIlcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgNCk7XG4gICAqIHYxLmxlbmd0aFNxdWFyZWQoKTsgLy8gPT4gMjVcbiAgICpcbiAgICogQHJldHVybiB7TnVtYmVyfSDjg5njgq/jg4jjg6vjga7lpKfjgY3jgZXjga7oh6rkuZdcbiAgICovXG4gIGxlbmd0aFNxdWFyZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMueCp0aGlzLnggKyB0aGlzLnkqdGhpcy55O1xuICB9XG4gIFxuICAvKipcbiAgICogQG1ldGhvZCBkaXN0YW5jZVxuICAgKiB0aGlzIOOBqCBvdGhlciDjgpLluqfmqJnjgajjgb/jgarjgZfjgZ/jgajjgY3jga4y54K56ZaT44Gu6Led6Zui44KS6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDEsIDIpO1xuICAgKiB2MiA9IHBoaW5hLmdlb20uVmVjdG9yMig0LCA2KTtcbiAgICogdjEuZGlzdGFuY2UodjIpOyAvLyA9PiA1XG4gICAqXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gdiDluqfmqJnjgpLooajjgZnjg5njgq/jg4jjg6tcbiAgICogQHJldHVybiB7TnVtYmVyfSAy54K56ZaT44Gu6Led6ZuiXG4gICAqL1xuICBkaXN0YW5jZSh2KSB7XG4gICAgcmV0dXJuIE1hdGguc3FydCggTWF0aC5wb3codGhpcy54LXYueCwgMikgKyBNYXRoLnBvdyh0aGlzLnktdi55LCAyKSApO1xuICB9XG4gIFxuICAvKipcbiAgICogQG1ldGhvZCBkaXN0YW5jZVNxdWFyZWRcbiAgICogdGhpcyDjgaggb3RoZXIg44KS5bqn5qiZ44Go44G/44Gq44GX44Gf44Go44GN44GuMueCuemWk+OBrui3nembouOBruiHquS5l+OCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigxLCAyKTtcbiAgICogdjIgPSBwaGluYS5nZW9tLlZlY3RvcjIoNCwgNik7XG4gICAqIHYxLmRpc3RhbmNlU3F1YXJlZCh2Mik7IC8vID0+IDI1XG4gICAqXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gdiDluqfmqJnjgpLooajjgZnjg5njgq/jg4jjg6tcbiAgICogQHJldHVybiB7TnVtYmVyfSAy54K56ZaT44Gu6Led6Zui44Gu6Ieq5LmXXG4gICAqL1xuICBkaXN0YW5jZVNxdWFyZWQodikge1xuICAgIHJldHVybiBNYXRoLnBvdyh0aGlzLngtdi54LCAyKSArIE1hdGgucG93KHRoaXMueS12LnksIDIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgcmFuZG9tXG4gICAqIEBjaGFpbmFibGVcbiAgICog6Ieq6Lqr44KS6KeS5bqm44GMIG1pbiDjgYvjgokgbWF4IOOBruevhOWbsu+8iOW6puWNmOS9je+8ieOBp+Wkp+OBjeOBleOBjCBsZW4g44Gu44Op44Oz44OA44Og44Gq44OZ44Kv44OI44Or44Gr5aSJ5o+b44GX44Gm6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMigpLnJhbmRvbSg5MCwgMTgwLCAxKTsgLy8gPT4gcGhpbmEuZ2VvbS5WZWN0b3IyKC0wLjUsIDAuODY2KSDjgarjgalcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFttaW49MF0g6KeS5bqm77yI5bqm5Y2Y5L2N77yJ44Gu5LiL6ZmQ5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbWF4PTM2MF0g6KeS5bqm77yI5bqm5Y2Y5L2N77yJ44Gu5LiK6ZmQ5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbGVuPTFdIOWkp+OBjeOBlVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHJhbmRvbShtaW4sIG1heCwgbGVuKSB7XG4gICAgdmFyIGRlZ3JlZSA9IFJhbmRvbS5yYW5kZmxvYXQobWluIHx8IDAsIG1heCB8fCAzNjApO1xuICAgIHZhciByYWQgPSBkZWdyZWUqREVHX1RPX1JBRDtcbiAgICB2YXIgbGVuID0gbGVuIHx8IDE7XG5cbiAgICB0aGlzLnggPSBNYXRoLmNvcyhyYWQpKmxlbjtcbiAgICB0aGlzLnkgPSBNYXRoLnNpbihyYWQpKmxlbjtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICogQG1ldGhvZCBub3JtYWxpemVcbiAgICogQGNoYWluYWJsZVxuICAgKiB0aGlzIOOCkuato+imj+WMluOBl+OBvuOBmeOAguOBmeOBquOCj+OBoeOAgXRoaXMg44Go5ZCM44GY5pa55ZCR44Gn5aSn44GN44GV44GMMeOBruODmeOCr+ODiOODq+OCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCA0KTtcbiAgICogdjEubm9ybWFsaXplKCk7IC8vID0+IHBoaW5hLmdlb20uVmVjdG9yMigwLjYsIDAuOClcbiAgICpcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBub3JtYWxpemUoKSB7XG4gICAgdGhpcy5kaXYodGhpcy5sZW5ndGgoKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCB0b1N0cmluZ1xuICAgKiB0aGlzIOOCkiBKU09OIOW9ouW8j+OBp+ihqOePvuOBl+OBn+aWh+Wtl+WIl+OCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCA0KTtcbiAgICogdjEudG9TdHJpbmcoKTsgLy8gPT4gXCJ7eDozLCB5OjR9XCJcbiAgICpcbiAgICogQHJldHVybiB7U3RyaW5nfSBKU09OIOaWh+Wtl+WIl1xuICAgKi9cbiAgdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIGZvcm1hdC5jYWxsKFwie3g6e3h9LCB5Ont5fX1cIiwgdGhpcyk7XG4gICAgLy8gcmV0dXJuIFwie3g6e3h9LCB5Ont5fX1cIi5mb3JtYXQodGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBnZXREaXJlY3Rpb25cbiAgICogdGhpcyDjga7jgYrjgYrjgojjgZ3jga7mlrnlkJHjgpLnpLrjgZfjgZ/mloflrZfliJfjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgNCk7XG4gICAqIHYxLmdldERpcmVjdGlvbigpOyAvLyA9PiBcInVwXCJcbiAgICpcbiAgICogQHJldHVybiB7U3RyaW5nfSDmlrnlkJHjgpLooajjgZnmloflrZfliJfvvIhcInVwXCIsIFwicmlnaHRcIiwgXCJkb3duXCIsIFwibGVmdFwi77yJXG4gICAqL1xuICBnZXREaXJlY3Rpb24oKSB7XG4gICAgdmFyIGFuZ2xlID0gdGhpcy50b0RlZ3JlZSgpO1xuICAgIGlmIChhbmdsZSA8IDQ1KSB7XG4gICAgICByZXR1cm4gXCJyaWdodFwiO1xuICAgIH0gZWxzZSBpZiAoYW5nbGUgPCAxMzUpIHtcbiAgICAgIHJldHVybiBcImRvd25cIjtcbiAgICB9IGVsc2UgaWYgKGFuZ2xlIDwgMjI1KSB7XG4gICAgICByZXR1cm4gXCJsZWZ0XCJcbiAgICB9IGVsc2UgaWYgKGFuZ2xlIDwgMzE1KSB7XG4gICAgICByZXR1cm4gXCJ1cFwiO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gXCJyaWdodFwiO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHRvQW5nbGVcbiAgICogdGhpcyDjgaggeCDou7jjgajjga7op5LluqbvvIjjg6njgrjjgqLjg7PljZjkvY3vvInjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoLTIsIDApO1xuICAgKiB2MS50b0FuZ2xlKCk7IC8vID0+IDMuMTQxNTlcbiAgICpcbiAgICogQHJldHVybiB7TnVtYmVyfSDjg5njgq/jg4jjg6vjga7op5LluqbvvIjjg6njgrjjgqLjg7PljZjkvY3vvIlcbiAgICovXG4gIHRvQW5nbGUoKSB7XG4gICAgdmFyIHJhZCA9IE1hdGguYXRhbjIodGhpcy55LCB0aGlzLngpO1xuICAgIHJldHVybiAocmFkICsgTWF0aC5QSSoyKSUoTWF0aC5QSSoyKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEBtZXRob2QgZnJvbUFuZ2xlXG4gICAqIEBjaGFpbmFibGVcbiAgICog6KeS5bqm77yI44Op44K444Ki44Oz5Y2Y5L2N77yJ44Go5aSn44GN44GV44KS5oyH5a6a44GX44Gm44OZ44Kv44OI44Or44KS6Kit5a6a44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMigpLmZyb21BbmdsZShNYXRoLlBJLzQsIDIpOyAvLyA9PiBwaGluYS5nZW9tLlZlY3RvcjIoMS40MTQyLCAxLjQxNDIpXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSByYWQg6KeS5bqm77yI44Op44K444Ki44Oz5Y2Y5L2N77yJXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbGVuPTFdIOWkp+OBjeOBlVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGZyb21BbmdsZShyYWQsIGxlbikge1xuICAgIGxlbiA9IGxlbiB8fCAxO1xuICAgIHRoaXMueCA9IE1hdGguY29zKHJhZCkqbGVuO1xuICAgIHRoaXMueSA9IE1hdGguc2luKHJhZCkqbGVuO1xuICAgIFxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgdG9EZWdyZWVcbiAgICogdGhpcyDjgaggeCDou7jjgajjga7op5LluqbvvIjluqbljZjkvY3vvInjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoLTIsIDIpO1xuICAgKiB2MS50b0FuZ2xlKCk7IC8vID0+IDEzNVxuICAgKlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IOODmeOCr+ODiOODq+OBruinkuW6pu+8iOW6puWNmOS9je+8iVxuICAgKi9cbiAgdG9EZWdyZWUoKSB7XG4gICAgcmV0dXJuIHRvRGVncmVlLmNhbGwodGhpcy50b0FuZ2xlKCkpO1xuICAgIC8vIHJldHVybiB0aGlzLnRvQW5nbGUoKS50b0RlZ3JlZSgpO1xuICB9XG4gIFxuICAvKipcbiAgICogQG1ldGhvZCBmcm9tRGVncmVlXG4gICAqIEBjaGFpbmFibGVcbiAgICog6KeS5bqm77yI5bqm5Y2Y5L2N77yJ44Go5aSn44GN44GV44KS5oyH5a6a44GX44Gm44OZ44Kv44OI44Or44KS6Kit5a6a44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMigpLmZyb21EZWdyZWUoNjAsIDIpOyAvLyA9PiBwaGluYS5nZW9tLlZlY3RvcjIoMSwgMS43MzIpXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBkZWcg6KeS5bqm77yI5bqm5Y2Y5L2N77yJXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbGVuPTFdIOWkp+OBjeOBlVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGZyb21EZWdyZWUoZGVnLCBsZW4pIHtcbiAgICAvLyByZXR1cm4gdGhpcy5mcm9tQW5nbGUoZGVnLnRvUmFkaWFuKCksIGxlbik7XG4gICAgcmV0dXJuIHRoaXMuZnJvbUFuZ2xlKHRvUmFkaWFuLmNhbGwoZGVnKSwgbGVuKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHJvdGF0ZVxuICAgKiBAY2hhaW5hYmxlXG4gICAqIHRoaXMg44KS5Zue6Lui44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDEpO1xuICAgKiB2MS5yb3RhdGUoTWF0aC5QSS8yKTsgLy8gPT4gcGhpbmEuZ2VvbS5WZWN0b3IyKC0xLCAzKTtcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHJhZCDop5LluqbvvIjjg6njgrjjgqLjg7PljZjkvY3vvIlcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSBbY2VudGVyPVZlY3RvcjIoMCwgMCldIOWbnui7ouOBruS4reW/g+W6p+aomVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHJvdGF0ZShyYWQsIGNlbnRlcikge1xuICAgIGNlbnRlciA9IGNlbnRlciB8fCBuZXcgVmVjdG9yMigwLCAwKTtcblxuICAgIHZhciB4MSA9IHRoaXMueCAtIGNlbnRlci54O1xuICAgIHZhciB5MSA9IHRoaXMueSAtIGNlbnRlci55O1xuICAgIHZhciB4MiA9IHgxICogTWF0aC5jb3MocmFkKSAtIHkxICogTWF0aC5zaW4ocmFkKTtcbiAgICB2YXIgeTIgPSB4MSAqIE1hdGguc2luKHJhZCkgKyB5MSAqIE1hdGguY29zKHJhZCk7XG4gICAgdGhpcy5zZXQoIGNlbnRlci54ICsgeDIsIGNlbnRlci55ICsgeTIgKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgbWluXG4gICAqIEBzdGF0aWNcbiAgICogdjEg44GoIHYyIOOBruWQhOimgee0oOOBq+WvvuOBl+OAgeOCiOOCiuWwj+OBleOBhOaWueOCkuimgee0oOOBqOOBmeOCi+aWsOOBl+OBhOODmeOCr+ODiOODq+OCkueUn+aIkOOBl+OBpui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCAxKTtcbiAgICogdjIgPSBwaGluYS5nZW9tLlZlY3RvcjIoLTMsIDIpO1xuICAgKiBwaGluYS5nZW9tLlZlY3RvcjIubWluKHYxLCB2Mik7IC8vIHBoaW5hLmdlb20uVmVjdG9yMigtMywgMSk7XG4gICAqXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gYSDjg5njgq/jg4jjg6tcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSBiIOODmeOCr+ODiOODq1xuICAgKiBAcmV0dXJuIHtWZWN0b3IyfSDnlJ/miJDjgZfjgZ/jg5njgq/jg4jjg6tcbiAgICovXG4gIHN0YXRpYyBtaW4oYSwgYikge1xuICAgIHJldHVybiBuZXcgVmVjdG9yMihcbiAgICAgIChhLnggPCBiLngpID8gYS54IDogYi54LFxuICAgICAgKGEueSA8IGIueSkgPyBhLnkgOiBiLnlcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgbWF4XG4gICAqIEBzdGF0aWNcbiAgICogMuasoeWFg+ODmeOCr+ODiOODqyB2MSDjgaggdjIg44Gu5ZCE6KaB57Sg44Gr5a++44GX44CB44KI44KK5aSn44GN44GE5pa544KS6KaB57Sg44Go44GZ44KL5paw44GX44GE44OZ44Kv44OI44Or44KS55Sf5oiQ44GX44Gm6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDEpO1xuICAgKiB2MiA9IHBoaW5hLmdlb20uVmVjdG9yMigtMywgMik7XG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMi5tYXgodjEsIHYyKTsgLy8gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDIpO1xuICAgKlxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IGEg44OZ44Kv44OI44OrXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gYiDjg5njgq/jg4jjg6tcbiAgICogQHJldHVybiB7VmVjdG9yMn0g55Sf5oiQ44GX44Gf44OZ44Kv44OI44OrXG4gICAqL1xuICBzdGF0aWMgbWF4KGEsIGIpIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjIoXG4gICAgICAoYS54ID4gYi54KSA/IGEueCA6IGIueCxcbiAgICAgIChhLnkgPiBiLnkpID8gYS55IDogYi55XG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGFkZFxuICAgKiBAc3RhdGljXG4gICAqIHYxIOOBqyB2MiDjgpLliqDnrpfjgZfjgZ/mlrDjgZfjgYTjg5njgq/jg4jjg6vjgpLnlJ/miJDjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgMSk7XG4gICAqIHYyID0gcGhpbmEuZ2VvbS5WZWN0b3IyKC0zLCAyKTtcbiAgICogcGhpbmEuZ2VvbS5WZWN0b3IyLmFkZCh2MSwgdjIpOyAvLyBwaGluYS5nZW9tLlZlY3RvcjIoMCwgMyk7XG4gICAqXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gbGhzIOODmeOCr+ODiOODq1xuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IHJocyDjg5njgq/jg4jjg6tcbiAgICogQHJldHVybiB7VmVjdG9yMn0g5Yqg566X44GX44Gf57WQ5p6cXG4gICAqL1xuICBzdGF0aWMgYWRkKGxocywgcmhzKSB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKGxocy54K3Jocy54LCBsaHMueStyaHMueSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBAbWV0aG9kIHN1YlxuICAgKiBAc3RhdGljXG4gICAqIDLmrKHlhYPjg5njgq/jg4jjg6sgdjEg44GL44KJIHYyIOOCkua4m+OBmOOBn+aWsOOBl+OBhOODmeOCr+ODiOODq+OCkueUn+aIkOOBl+OBpui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiDjg5njgq/jg4jjg6vjgYzluqfmqJnjgpLooajjgZnloLTlkIjjgIEy44Gk55uu44Gu5bqn5qiZ44GL44KJMeOBpOebruOBruW6p+aomeOBuOOBqOWQkeOBi+OBhuODmeOCr+ODiOODq+OBjOW+l+OCieOCjOOBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCAxKTtcbiAgICogdjIgPSBwaGluYS5nZW9tLlZlY3RvcjIoLTMsIDIpO1xuICAgKiBwaGluYS5nZW9tLlZlY3RvcjIuc3ViKHYxLCB2Mik7IC8vIHBoaW5hLmdlb20uVmVjdG9yMig2LCAtMSk7XG4gICAqXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gbGhzIOODmeOCr+ODiOODq1xuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IHJocyDjg5njgq/jg4jjg6tcbiAgICogQHJldHVybiB7VmVjdG9yMn0g5rib566X44GX44Gf57WQ5p6cXG4gICAqL1xuICBzdGF0aWMgc3ViKGxocywgcmhzKSB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKGxocy54LXJocy54LCBsaHMueS1yaHMueSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBAbWV0aG9kIG11bFxuICAgKiBAc3RhdGljXG4gICAqIDLmrKHlhYPjg5njgq/jg4jjg6sgdiDjga7lkITopoHntKDjgasgbiDjgpLkuZfjgZjjgZ/mlrDjgZfjgYTjg5njgq/jg4jjg6vjgpLnlJ/miJDjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgMSk7XG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMi5tdWwodjEsIDIpOyAvLyBwaGluYS5nZW9tLlZlY3RvcjIoNiwgMilcbiAgICpcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSB2IOODmeOCr+ODiOODq1xuICAgKiBAcGFyYW0ge051bWJlcn0gbiDkuZfjgZjjgovlgKRcbiAgICogQHJldHVybiB7VmVjdG9yMn0g5LmX566X44GX44Gf57WQ5p6cXG4gICAqL1xuICBzdGF0aWMgbXVsKHYsIG4pIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjIodi54Km4sIHYueSpuKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEBtZXRob2QgZGl2XG4gICAqIEBzdGF0aWNcbiAgICogMuasoeWFg+ODmeOCr+ODiOODqyB2IOOBruWQhOimgee0oOOCkiBuIOOBp+WJsuOBo+OBn+aWsOOBl+OBhOODmeOCr+ODiOODq+OCkueUn+aIkOOBl+OBpui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCAxKTtcbiAgICogcGhpbmEuZ2VvbS5WZWN0b3IyLmRpdih2MSwgMik7IC8vIHBoaW5hLmdlb20uVmVjdG9yMigxLjUsIDAuNSlcbiAgICpcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSB2IOODmeOCr+ODiOODq1xuICAgKiBAcGFyYW0ge051bWJlcn0gbiDlibLjgovlgKRcbiAgICogQHJldHVybiB7VmVjdG9yMn0g6Zmk566X44GX44Gf57WQ5p6cXG4gICAqL1xuICBzdGF0aWMgZGl2KHYsIG4pIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjIodi54L24sIHYueS9uKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEBtZXRob2QgbmVnYXRlXG4gICAqIEBzdGF0aWNcbiAgICogMuasoeWFg+ODmeOCr+ODiOODqyB2IOOCkuWPjei7ouOBl+OBn+aWsOOBl+OBhOODmeOCr+ODiOODq+OCkueUn+aIkOOBl+OBpui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCAxKTtcbiAgICogcGhpbmEuZ2VvbS5WZWN0b3IyLm5lZ2F0ZSgpOyAvLyBwaGluYS5nZW9tLlZlY3RvcjIoLTMsIC0xKVxuICAgKlxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IHYg44OZ44Kv44OI44OrXG4gICAqIEByZXR1cm4ge1ZlY3RvcjJ9IOWPjei7ouOBl+OBn+ODmeOCr+ODiOODq1xuICAgKi9cbiAgc3RhdGljIG5lZ2F0ZSh2KSB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKC12LngsIC12LnkpO1xuICB9XG4gIFxuICAvKipcbiAgICogQG1ldGhvZCBkb3RcbiAgICogQHN0YXRpY1xuICAgKiAy5qyh5YWD44OZ44Kv44OI44OrIHYxIOOBqCB2MiDjga7lhoXnqY3jgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgNCk7XG4gICAqIHYyID0gcGhpbmEuZ2VvbS5WZWN0b3IyKC0yLCAyKTtcbiAgICogcGhpbmEuZ2VvbS5WZWN0b3IyLmRvdCh2MSwgdjIpIC8vID0+IDJcbiAgICpcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSBsaHMg44OZ44Kv44OI44OrXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gcmhzIOODmeOCr+ODiOODq1xuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IOWGheepjVxuICAgKi9cbiAgc3RhdGljIGRvdChsaHMsIHJocykge1xuICAgIHJldHVybiBsaHMueCAqIHJocy54ICsgbGhzLnkgKiByaHMueTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEBtZXRob2QgY3Jvc3NcbiAgICogQHN0YXRpY1xuICAgKiAy5qyh5YWD44OZ44Kv44OI44OrIHYxIOOBqCB2MiDjga7lpJbnqY3vvIjjgq/jg63jgrnnqY3vvInjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogMuasoeWFg+ODmeOCr+ODiOODq+OBp+OBruWkluepjeOBr+ODmeOCr+ODiOODq+OBp+OBquOBj+aVsOWApOOCkui/lOOBmeOBk+OBqOOBq+azqOaEj+OBl+OBpuOBj+OBoOOBleOBhOOAglxuICAgKiAx44Gk55uu44Gu44OZ44Kv44OI44Or44GMMuOBpOebruOBruODmeOCr+ODiOODq+OCiOOCiuaZguioiOWbnuOCiuOBq+OBguOCi+OBqOOBjeOBr+ato+OBruWApOOBq+OBquOCiuOAgeWPjeaZguioiOWbnuOCiuOBq+OBguOCi+OBqOOBjeOBr+iyoOOBruWApOOBq+OBquOCiuOBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCA0KTtcbiAgICogdjIgPSBwaGluYS5nZW9tLlZlY3RvcjIoMywgMSk7XG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMi5jcm9zcyh2MSwgdjIpOyAvLyA9PiAtOFxuICAgKlxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IGxocyDjg5njgq/jg4jjg6tcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSByaHMg44OZ44Kv44OI44OrXG4gICAqIEByZXR1cm4ge051bWJlcn0g5aSW56mNXG4gICAqL1xuICBzdGF0aWMgY3Jvc3MobGhzLCByaHMpIHtcbiAgICByZXR1cm4gKGxocy54KnJocy55KSAtIChsaHMueSpyaHMueCk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBAbWV0aG9kIGRpc3RhbmNlXG4gICAqIEBzdGF0aWNcbiAgICogdjEg44GoIHYyIOOCkuW6p+aomeOBqOOBv+OBquOBl+OBn+OBqOOBjeOBrjLngrnplpPjga7ot53pm6LjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdjEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMSwgMik7XG4gICAqIHYyID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDQsIDYpO1xuICAgKiBwaGluYS5nZW9tLlZlY3RvcjIuZGlzdGFuY2UodjEsIHYyKTsgLy8gPT4gNVxuICAgKlxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IGxocyDluqfmqJnjgpLooajjgZnjg5njgq/jg4jjg6tcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSByaHMg5bqn5qiZ44KS6KGo44GZ44OZ44Kv44OI44OrXG4gICAqIEByZXR1cm4ge051bWJlcn0gMueCuemWk+OBrui3nembolxuICAgKi9cbiAgc3RhdGljIGRpc3RhbmNlKGxocywgcmhzKSB7XG4gICAgcmV0dXJuIE1hdGguc3FydCggTWF0aC5wb3cobGhzLngtcmhzLngsIDIpICsgTWF0aC5wb3cobGhzLnktcmhzLnksIDIpICk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBkaXN0YW5jZVNxdWFyZWRcbiAgICogQHN0YXRpY1xuICAgKiB2MSDjgaggdjIg44KS5bqn5qiZ44Go44G/44Gq44GX44Gf44Go44GN44GuMueCuemWk+OBrui3nembouOBruiHquS5l+OCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigxLCAyKTtcbiAgICogdjIgPSBwaGluYS5nZW9tLlZlY3RvcjIoNCwgNik7XG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMi5kaXN0YW5jZVNxdWFyZWQodjEsIHYyKTsgLy8gPT4gMjVcbiAgICpcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSBsaHMg5bqn5qiZ44KS6KGo44GZ44OZ44Kv44OI44OrXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gcmhzIOW6p+aomeOCkuihqOOBmeODmeOCr+ODiOODq1xuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IDLngrnplpPjga7ot53pm6Ljga7oh6rkuZdcbiAgICovXG4gIHN0YXRpYyBkaXN0YW5jZVNxdWFyZWQobGhzLCByaHMpIHtcbiAgICByZXR1cm4gTWF0aC5wb3cobGhzLngtcmhzLngsIDIpICsgTWF0aC5wb3cobGhzLnktcmhzLnksIDIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgbWFuaGF0dGFuRGlzdGFuY2VcbiAgICogQHN0YXRpY1xuICAgKiB2MSDjgaggdjIg44KS5bqn5qiZ44Go44G/44Gq44GX44Gf44Go44GN44GuMueCuemWk+OBruODnuODs+ODj+ODg+OCv+ODs+i3nembou+8iOi7uOOBq+W5s+ihjOOBq+mAsuOCgOOBqOOBjeOBruacgOefrei3nembou+8ieOCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigxLCAyKTtcbiAgICogdjIgPSBwaGluYS5nZW9tLlZlY3RvcjIoNCwgNik7XG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMi5tYW5oYXR0YW5EaXN0YW5jZSh2MSwgdjIpOyAvLyA9PiA3XG4gICAqXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gbGhzIOW6p+aomeOCkuihqOOBmeODmeOCr+ODiOODq1xuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IHJocyDluqfmqJnjgpLooajjgZnjg5njgq/jg4jjg6tcbiAgICogQHJldHVybiB7TnVtYmVyfSAy54K56ZaT44Gu44Oe44Oz44OP44OD44K/44Oz6Led6ZuiXG4gICAqL1xuICBzdGF0aWMgbWFuaGF0dGFuRGlzdGFuY2UobGhzLCByaHMpIHtcbiAgICByZXR1cm4gTWF0aC5hYnMobGhzLngtcmhzLngpICsgTWF0aC5hYnMobGhzLnktcmhzLnkpO1xuICB9XG4gIFxuICAvKipcbiAgICogQG1ldGhvZCBub3JtYWxcbiAgICogQHN0YXRpY1xuICAgKiB2MSDjgaggdjIg44KS5bqn5qiZ44Go44G/44Gq44GX44Gf44Go44GN44Gu44CBdjIg44GL44KJIHYxIOOBq+WQkeOBi+OBhuODmeOCr+ODiOODq+OBq+WvvuOBmeOCi+azlee3muODmeOCr+ODiOODq+OCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMigxLCAyKTtcbiAgICogdjIgPSBwaGluYS5nZW9tLlZlY3RvcjIoNCwgNik7XG4gICAqIHBoaW5hLmdlb20uVmVjdG9yMi5ub3JtYWwodjEsIHYyKTsgLy8gPT4gcGhpbmEuZ2VvbS5WZWN0b3IyKDQsIC0zKVxuICAgKlxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IGEg5bqn5qiZ44KS6KGo44GZ44OZ44Kv44OI44OrXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gYiDluqfmqJnjgpLooajjgZnjg5njgq/jg4jjg6tcbiAgICogQHJldHVybiB7VmVjdG9yMn0g5rOV57ea44OZ44Kv44OI44OrXG4gICAqL1xuICBzdGF0aWMgbm9ybWFsKGEsIGIpIHtcbiAgICB2YXIgdGVtcCA9IFZlY3RvcjIuc3ViKGEsIGIpO1xuXG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKC10ZW1wLnksIHRlbXAueCk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByZWZsZWN0XG4gICAqIEBzdGF0aWNcbiAgICogMuasoeWFg+ODmeOCr+ODiOODqyB2IOOCkuWjgeOBuOOBruWFpeWwhOODmeOCr+ODiOODq+OBqOOBl+OBpuOAgeWjgeOBq+WPjeWwhOOBl+OBn+mam+OBruODmeOCr+ODiOODq++8iOWPjeWwhOODmeOCr+ODiOODq++8ieOCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiDlo4Hjga7lkJHjgY3jga/ms5Xnt5rjg5njgq/jg4jjg6sgbm9ybWFsIOOBq+OCiOOBo+OBpuihqOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2MSA9IHBoaW5hLmdlb20uVmVjdG9yMig0LCAzKTtcbiAgICogbm9ybWFsID0gcGhpbmEuZ2VvbS5WZWN0b3IyKC0xLCAxKTtcbiAgICogcGhpbmEuZ2VvbS5WZWN0b3IyLnJlZmxlY3QodjEsIG5vcm1hbCk7IC8vID0+IHBoaW5hLmdlb20uVmVjdG9yMigyLCA1KVxuICAgKlxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IHYg5YWl5bCE44OZ44Kv44OI44OrXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gbm9ybWFsIOWjgeOBruazlee3muODmeOCr+ODiOODq1xuICAgKiBAcmV0dXJuIHtWZWN0b3IyfSDlj43lsITjg5njgq/jg4jjg6tcbiAgICovXG4gIHN0YXRpYyByZWZsZWN0KHYsIG5vcm1hbCkge1xuICAgIHZhciBsZW4gPSBWZWN0b3IyLmRvdCh2LCBub3JtYWwpO1xuICAgIHZhciB0ZW1wPSBWZWN0b3IyLm11bChub3JtYWwsIDIqbGVuKTtcbiAgICBcbiAgICByZXR1cm4gVmVjdG9yMi5zdWIodiwgdGVtcCk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBAbWV0aG9kIHdhbGxcbiAgICogQHN0YXRpY1xuICAgKiAy5qyh5YWD44OZ44Kv44OI44OrIHYg44KS5aOB44G444Gu5YWl5bCE44OZ44Kv44OI44Or44Go44GX44Gm44CB5aOB44Gr5rK/44Gj44Gf44OZ44Kv44OI44Or77yI5aOB44Ga44KK44Kv44OI44Or77yJ44KS6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqIOWjgeOBruWQkeOBjeOBr+azlee3muODmeOCr+ODiOODqyBub3JtYWwg44Gr44KI44Gj44Gm6KGo44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDQsIDMpO1xuICAgKiBub3JtYWwgPSBwaGluYS5nZW9tLlZlY3RvcjIoLTEsIDEpO1xuICAgKiBwaGluYS5nZW9tLlZlY3RvcjIud2FsbCh2MSwgbm9ybWFsKTsgLy8gPT4gcGhpbmEuZ2VvbS5WZWN0b3IyKDMsIDQpXG4gICAqXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gdiDlhaXlsITjg5njgq/jg4jjg6tcbiAgICogQHBhcmFtIHtQcmltaXRpdmVWZWN0b3IyfSBub3JtYWwg5aOB44Gu5rOV57ea44OZ44Kv44OI44OrXG4gICAqIEByZXR1cm4ge1ZlY3RvcjJ9IOWjgeOBmuOCiuODmeOCr+ODiOODq1xuICAgKi9cbiAgc3RhdGljIHdhbGwodiwgbm9ybWFsKSB7XG4gICAgdmFyIGxlbiA9IFZlY3RvcjIuZG90KHYsIG5vcm1hbCk7XG4gICAgdmFyIHRlbXA9IFZlY3RvcjIubXVsKG5vcm1hbCwgbGVuKTtcbiAgICBcbiAgICByZXR1cm4gVmVjdG9yMi5zdWIodiwgdGVtcCk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBAbWV0aG9kIGxlcnBcbiAgICogQHN0YXRpY1xuICAgKiB2MSDjgaggdjIg44KS5aqS5LuL5aSJ5pWwIHQg44Gn57ea5b2i6KOc6ZaT44GX44G+44GZ44CCXG4gICAqIHQ9MC41IOOBpyB2MSDjgaggdjIg44Gu5Lit6ZaT44OZ44Kv44OI44Or44KS5rGC44KB44KL44GT44Go44GM44Gn44GN44G+44GZ44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHYxID0gcGhpbmEuZ2VvbS5WZWN0b3IyKDEsIDIpO1xuICAgKiB2MiA9IHBoaW5hLmdlb20uVmVjdG9yMig0LCA2KTtcbiAgICogcGhpbmEuZ2VvbS5WZWN0b3IyLmxlcnAodjEsIHYyLCAwLjUpOyAvLyA9PiAoMi41LCA0KVxuICAgKiBwaGluYS5nZW9tLlZlY3RvcjIubGVycCh2MSwgdjIsIDApOyAvLyA9PiAoMSwgMilcbiAgICogcGhpbmEuZ2VvbS5WZWN0b3IyLmxlcnAodjEsIHYyLCAxKTsgLy8gPT4gKDQsIDYpXG4gICAqIFxuICAgKiBAcGFyYW0ge1ByaW1pdGl2ZVZlY3RvcjJ9IGEg44OZ44Kv44OI44OrXG4gICAqIEBwYXJhbSB7UHJpbWl0aXZlVmVjdG9yMn0gYiDjg5njgq/jg4jjg6tcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHQg5aqS5LuL5aSJ5pWwXG4gICAqIEByZXR1cm4ge1ZlY3RvcjJ9IOe3muW9ouijnOmWk+OBrue1kOaenFxuICAgKi9cbiAgc3RhdGljIGxlcnAoYSwgYiwgdCkge1xuICAgIHJldHVybiBuZXcgVmVjdG9yMihcbiAgICAgIGEueCArIChiLngtYS54KSp0LFxuICAgICAgYS55ICsgKGIueS1hLnkpKnRcbiAgICApO1xuICB9XG4gIFxuICAvKipcbiAgICogQG1ldGhvZCBzbGVycFxuICAgKiBAc3RhdGljXG4gICAqIEB0b2RvXG4gICAqIOijnOmWk++8iOacquWun+ijhe+8iVxuICAgKi9cbiAgc3RhdGljIHNsZXJwKGxocywgcmhzLCB0KSB7XG4gICAgICAvLyBUT0RPOlxuICAgICAgLy8gY29zLi4uXG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByYW5kb21cbiAgICogQHN0YXRpY1xuICAgKiDop5LluqbjgYwgbWluIOOBi+OCiSBtYXgg44Gu56+E5Zuy77yI5bqm5Y2Y5L2N77yJ44Gn5aSn44GN44GV44GMIGxlbiDjga7jg6njg7Pjg4Djg6Djgarjg5njgq/jg4jjg6vjgpLnlJ/miJDjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogcGhpbmEuZ2VvbS5WZWN0b3IyLnJhbmRvbSg5MCwgMTgwLCAxKTsgLy8gPT4gcGhpbmEuZ2VvbS5WZWN0b3IyKC0wLjUsIDAuODY2KSDjgarjgalcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFttaW49MF0g6KeS5bqm77yI5bqm5Y2Y5L2N77yJ44Gu5LiL6ZmQ5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbWF4PTM2MF0g6KeS5bqm77yI5bqm5Y2Y5L2N77yJ44Gu5LiK6ZmQ5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbGVuPTFdIOWkp+OBjeOBlVxuICAgKiBAcmV0dXJuIHtWZWN0b3IyfSDnlJ/miJDjgZfjgZ/jg5njgq/jg4jjg6tcbiAgICovXG4gIHN0YXRpYyByYW5kb20obWluLCBtYXgsIGxlbikge1xuICAgIHJldHVybiBuZXcgVmVjdG9yMigpLnJhbmRvbShtaW4sIG1heCkubXVsKGxlbnx8MSk7XG4gIH1cblxuICAvKipcbiAgICogQHByb3BlcnR5IHtWZWN0b3IyfSBaRVJPIOOCvOODreODmeOCr+ODiOODq1xuICAgKi9cbiAgc3RhdGljIGdldCBaRVJPKCkgeyByZXR1cm4gWkVSTzsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge1ZlY3RvcjJ9IExFRlQg5bem5pa55ZCR44Gu5Y2Y5L2N44OZ44Kv44OI44OrXG4gICAqL1xuICBzdGF0aWMgZ2V0IExFRlQoKSB7IHJldHVybiBMRUZUOyB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSB7VmVjdG9yMn0gUklHSFQg5Y+z5pa55ZCR44Gu5Y2Y5L2N44OZ44Kv44OI44OrXG4gICAqL1xuICBzdGF0aWMgZ2V0IFJJR0hUKCkgeyByZXR1cm4gUklHSFQ7IH1cblxuICAvKipcbiAgICogQHByb3BlcnR5IHtWZWN0b3IyfSBVUCDkuIrmlrnlkJHjga7ljZjkvY3jg5njgq/jg4jjg6tcbiAgICovXG4gIHN0YXRpYyBnZXQgVVAoKSB7IHJldHVybiBVUDsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge1ZlY3RvcjJ9IERPV04g5LiL5pa55ZCR44Gu5Y2Y5L2N44OZ44Kv44OI44OrXG4gICAqL1xuICBzdGF0aWMgZ2V0IERPV04oKSB7IHJldHVybiBET1dOOyB9XG59XG5cbnZhciBaRVJPID0gbmV3IFZlY3RvcjIoMCwgMCk7XG52YXIgTEVGVCA9IG5ldyBWZWN0b3IyKC0xLCAwKTtcbnZhciBSSUdIVCA9IG5ldyBWZWN0b3IyKDEsIDApO1xudmFyIFVQID0gbmV3IFZlY3RvcjIoMCwgLTEpO1xudmFyIERPV04gPSBuZXcgVmVjdG9yMigwLCAxKTtcblxuLy8gaW1wb3J0IHsgUmVjdCB9IGZyb20gXCIuL3JlY3RcIjtcblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZ2VvbS5DaXJjbGVcbiAqICMg5YaG6aCY5Z+f44KS6KGo44GZ44Kv44Op44K5XG4gKiDjgq3jg6Pjg7Pjg5DjgrnkuIrjga7lhobpoJjln5/jgpLmibHjgYbjgq/jg6njgrnjgafjgZnjgIJcbiAqIFxuICovXG5jbGFzcyBDaXJjbGUge1xuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge051bWJlcn0geFxuICAgKiDlhobjga7kuK3lv4Pjga4geCDluqfmqJlcbiAgICovXG4gIC8vIHg6IDAsXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge051bWJlcn0geVxuICAgKiDlhobjga7kuK3lv4Pjga4geSDluqfmqJlcbiAgICovXG4gIC8vIHk6IDAsXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge051bWJlcn0gcmFkaXVzXG4gICAqIOWGhuOBruWNiuW+hFxuICAgKi9cbiAgLy8gcmFkaXVzOiAzMixcblxuICAvKipcbiAgICogQG1ldGhvZCBpbml0XG4gICAqIOWGhumgmOWfn+OBruOCs+ODs+OCueODiOODqeOCr+OCv+OBp+OBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgY2lyY2xlID0gcGhpbmEuZ2VvbS5DaXJjbGUoMzIsIDY0LCAxMjgpO1xuICAgKlxuICAgKiBAcGFyYW0ge051bWJlcn0geCDlhobjga7kuK3lv4Pjga4geCDluqfmqJlcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHkg5YaG44Gu5Lit5b+D44GuIHkg5bqn5qiZXG4gICAqIEBwYXJhbSB7TnVtYmVyfSByYWRpdXMg5Y2K5b6EXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih4LCB5LCByYWRpdXMpIHtcbiAgICB0aGlzLnggPSAwO1xuICAgIHRoaXMueSA9IDA7XG4gICAgdGhpcy5yYWRpdXMgPSAzMjtcbiAgICB0aGlzLnNldCh4LCB5LCByYWRpdXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2Qgc2V0XG4gICAqIEBjaGFpbmFibGVcbiAgICogdGhpcyDjga7lkITlgKTjgpLlho3oqK3lrprjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIGNpcmNsZSA9IHBoaW5hLmdlb20uQ2lyY2xlKDMyLCA2NCwgMTI4KTtcbiAgICogICAgIGNpcmNsZS5zZXQoMTAwLCAyMDAsIDMyKTtcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHgg5YaG44KS5Zuy44GG55+p5b2i44Gu5bem5LiK6aCC54K544GuIHgg5bqn5qiZXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB5IOWGhuOCkuWbsuOBhuefqeW9ouOBruW3puS4iumggueCueOBriB4IOW6p+aomVxuICAgKiBAcGFyYW0ge051bWJlcn0gcmFkaXVzIOWNiuW+hFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldCh4LCB5LCByYWRpdXMpIHtcbiAgICB0aGlzLnggPSB4O1xuICAgIHRoaXMueSA9IHk7XG4gICAgdGhpcy5yYWRpdXMgPSByYWRpdXM7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIG1vdmVUb1xuICAgKiBAY2hhaW5hYmxlXG4gICAqIOWGhumgmOWfn+OCkuW6p+aomSAoeCwgeSkg44Gr56e75YuV44GX44G+44GZ44CCKHgsIHkpIOOBr+WGhuOBruS4reW/g+OCkuihqOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgY2lyY2xlID0gcGhpbmEuZ2VvbS5DaXJjbGUoMzAwLCAzMDAsIDQwKTtcbiAgICogICAgIGNpcmNsZS5sZWZ0OyAvLyA9PiAyNjBcbiAgICogICAgIGNpcmNsZS5tb3ZlVG8oMTAwLCAxMDApO1xuICAgKiAgICAgY2lyY2xlLmxlZnQ7IC8vID0+IDYwXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB4IOenu+WLleWFiOOBriB4IOW6p+aomVxuICAgKiBAcGFyYW0ge051bWJlcn0geSDnp7vli5XlhYjjga4geSDluqfmqJlcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBtb3ZlVG8oeCwgeSkge1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIG1vdmVCeVxuICAgKiBAY2hhaW5hYmxlXG4gICAqIOWGhumgmOWfn+OCkiAoeCwgeSkg44Gg44GR56e75YuV44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICBjaXJjbGUgPSBwaGluYS5nZW9tLkNpcmNsZSgzMDAsIDMwMCwgNDApO1xuICAgKiAgICAgY2lyY2xlLmxlZnQ7IC8vID0+IDI2MFxuICAgKiAgICAgY2lyY2xlLm1vdmVCeSgxMDAsIDEwMCk7XG4gICAqICAgICBjaXJjbGUubGVmdDsgLy8gPT4gNDYwXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB4IOenu+WLlemHj+OBriB4IOW6p+aomVxuICAgKiBAcGFyYW0ge051bWJlcn0geSDnp7vli5Xph4/jga4geSDluqfmqJlcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBtb3ZlQnkoeCwgeSkge1xuICAgIHRoaXMueCArPSB4O1xuICAgIHRoaXMueSArPSB5O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgY29udGFpbnNcbiAgICog5bqn5qiZICh4LCB5KSDjgYzlhobpoJjln5/jga7kuK3jgavlkKvjgb7jgozjgovjgYvjganjgYbjgYvjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIGNpcmNsZSA9IHBoaW5hLmdlb20uQ2lyY2xlKDMwMCwgMzAwLCAxMDApO1xuICAgKiAgICAgY2lyY2xlLmNvbnRhaW5zKDM1MCwgMzUwKTsgLy8gPT4gIHRydWVcbiAgICogICAgIGNpcmNsZS5jb250YWlucygzNTAsIDQwMCk7IC8vID0+IGZhbHNlXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB4IOWIpOWumuOBmeOCi+WvvuixoeOBriB4IOW6p+aomVxuICAgKiBAcGFyYW0ge051bWJlcn0geSDliKTlrprjgZnjgovlr77osaHjga4geSDluqfmqJlcbiAgICogQHJldHVybiB7Qm9vbGVhbn0g5oyH5a6a44GX44Gf5bqn5qiZ44GM5YaG6aCY5Z+f44Gu5Lit44Gr5ZCr44G+44KM44KL44GL44Gp44GG44GLXG4gICAqL1xuICBjb250YWlucyh4LCB5KSB7XG4gICAgdmFyIGxlblggPSB0aGlzLngteDtcbiAgICB2YXIgbGVuWSA9IHRoaXMueS15O1xuICAgIHZhciBsZW5TcXVhcmVkID0gKGxlblgqbGVuWCkrKGxlblkqbGVuWSk7XG5cbiAgICByZXR1cm4gbGVuU3F1YXJlZCA8PSB0aGlzLnJhZGl1cyp0aGlzLnJhZGl1cztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGNsb25lXG4gICAqIHRoaXMg44Gu44Kz44OU44O844KS55Sf5oiQ44GX44Gm6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICBjaXJjbGUgPSBwaGluYS5nZW9tLkNpcmNsZSg1MCwgMTAwLCA0MCk7XG4gICAqICAgICBjaXJjbGUyID0gY2lyY2xlLmNsb25lKCk7XG4gICAqICAgICBjaXJjbGUyLnggPT0gY2lyY2xlLng7IC8vID0+IHRydWVcbiAgICpcbiAgICogQHJldHVybiB7Q2lyY2xlfSDnlJ/miJDjgZfjgZ/lhobpoJjln59cbiAgICovXG4gIGNsb25lKCkge1xuICAgIHJldHVybiBuZXcgQ2lyY2xlKHRoaXMueCwgdGhpcy55LCB0aGlzLnJhZGl1cyk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCB0b1JlY3RcbiAgICog5YaG44Gr5aSW5o6l44GZ44KL5q2j5pa55b2i44KS6KGo44GZ55+p5b2i6aCY5Z+f44KS55Sf5oiQ44GX44Gm6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICBjaXJjbGUgPSBwaGluYS5nZW9tLkNpcmNsZSg1MCwgMTAwLCA0MCk7XG4gICAqICAgICByZWN0ID0gY2lyY2xlLnRvUmVjdCgpO1xuICAgKiAgICAgcmVjdC54OyAvLyA9PiAxMFxuICAgKiAgICAgcmVjdC55OyAvLyA9PiA2MFxuICAgKiAgICAgcmVjdC53aWR0aDsgLy8gPT4gODBcbiAgICogXG4gICAqIEByZXR1cm4ge09iamVjdH0g55Sf5oiQ44GX44Gf55+p5b2i6aCY5Z+fXG4gICAqL1xuICB0b1JlY3QoKSB7XG4gICAgLy8g5b6q55Kw5Y+C54Wn5Zue6YG/44Gu44Gf44KB44CBUmVjdOWBtOOBp+Wumue+qVxuICAgIC8vIHZhciBzaXplID0gdGhpcy5zaXplO1xuICAgIC8vIHJldHVybiBuZXcgUmVjdCh0aGlzLnggLSB0aGlzLnJhZGl1cywgdGhpcy55IC0gdGhpcy5yYWRpdXMsIHNpemUsIHNpemUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgdG9BcnJheVxuICAgKiB0aGlzIOOBruWQhOWApOOCkuimgee0oOOBqOOBmeOCi+mFjeWIl+OCkueUn+aIkOOBl+OBpui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgY2lyY2xlID0gcGhpbmEuZ2VvbS5DaXJjbGUoNTAsIDEwMCwgNDApO1xuICAgKiAgICAgcmVjdC50b0FycmF5KCk7IC8vID0+IFs1MCwgMTAwLCA0MF1cbiAgICpcbiAgICogQHJldHVybiB7TnVtYmVyW119IOeUn+aIkOOBl+OBn+mFjeWIl1xuICAgKi9cbiAgdG9BcnJheSgpIHtcbiAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnJhZGl1c107XG4gIH1cblxuICAvKipcbiAgICogQHByb3BlcnR5IHtOdW1iZXJ9IGxlZnRcbiAgICog44Kt44Oj44Oz44OQ44K55bem56uv44GL44KJ5YaG44Gu5bem56uv44G+44Gn44Gu6Led6ZuiXG4gICAqXG4gICAqIOePvuaZgueCueOBp+OBr+iqreOBv+WPluOCiuWwgueUqOOBp+OBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgY2lyY2xlID0gcGhpbmEuZ2VvbS5DaXJjbGUoMjAwLCAzMDAsIDEwMCk7XG4gICAqICAgICBjaXJjbGUubGVmdDsgLy8gPT4gMTAwXG4gICAqICAgICBjaXJjbGUudG9wOyAvLyA9PiAyMDBcbiAgICogICAgIGNpcmNsZS5yaWdodDsgLy8gPT4gMzAwXG4gICAqICAgICBjaXJjbGUuYm90dG9tOyAvLyA9PiA0MDBcbiAgICovXG4gIGdldCBsZWZ0KCkgICB7IHJldHVybiB0aGlzLnggLSB0aGlzLnJhZGl1czsgfVxuICBzZXQgbGVmdCh2KSAge1xuICAgIC8vIFRPRE86IFxuICB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSB0b3BcbiAgICog44Kt44Oj44Oz44OQ44K55LiK56uv44GL44KJ5YaG44Gu5LiK56uv44G+44Gn44Gu6Led6ZuiXG4gICAqXG4gICAqIOePvuaZgueCueOBp+OBr+iqreOBv+WPluOCiuWwgueUqOOBp+OBmeOAglxuICAgKi9cbiAgZ2V0IHRvcCgpICAgeyByZXR1cm4gdGhpcy55IC0gdGhpcy5yYWRpdXM7IH1cbiAgc2V0IHRvcCh2KSAge1xuICAgIC8vIFRPRE86IFxuICB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSByaWdodFxuICAgKiDjgq3jg6Pjg7Pjg5Djgrnlj7Pnq6/jgYvjgonlhobjga7lj7Pnq6/jgb7jgafjga7ot53pm6JcbiAgICpcbiAgICog54++5pmC54K544Gn44Gv6Kqt44G/5Y+W44KK5bCC55So44Gn44GZ44CCXG4gICAqL1xuICBnZXQgcmlnaHQoKSAgIHsgcmV0dXJuIHRoaXMueCArIHRoaXMucmFkaXVzOyB9XG4gIHNldCByaWdodCh2KSAge1xuICAgIC8vIFRPRE86IFxuICB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBib3R0b21cbiAgICog44Kt44Oj44Oz44OQ44K55LiL56uv44GL44KJ5YaG44Gu5LiL56uv44G+44Gn44Gu6Led6ZuiXG4gICAqXG4gICAqIOePvuaZgueCueOBp+OBr+iqreOBv+WPluOCiuWwgueUqOOBp+OBmeOAglxuICAgKi9cbiAgZ2V0IGJvdHRvbSgpICAgeyByZXR1cm4gdGhpcy55ICsgdGhpcy5yYWRpdXM7IH1cbiAgc2V0IGJvdHRvbSh2KSAge1xuICAgIC8vIFRPRE86IFxuICB9XG4gICAgXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge051bWJlcn0gc2l6ZVxuICAgKiDlhobjga7nm7TlvoRcbiAgICpcbiAgICog54++5pmC54K544Gn44Gv6Kqt44G/5Y+W44KK5bCC55So44Gn44GZ44CCXG4gICAqL1xuICBnZXQgc2l6ZSgpICAgeyByZXR1cm4gdGhpcy5yYWRpdXMqMjsgfVxuICBzZXQgc2l6ZSh2KSAge1xuICAgIC8vIFRPRE86IOaknOiojuS4rVxuICB9XG59XG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmdlb20uUmVjdFxuICogIyDnn6nlvaLpoJjln5/jgpLooajjgZnjgq/jg6njgrlcbiAqIOOCreODo+ODs+ODkOOCueS4iuOBruefqeW9oumgmOWfn+OCkuaJseOBhuOCr+ODqeOCueOBp+OBmeOAglxuICogXG4gKiAjIyMgRXhhbXBsZVxuICogICAgIHJlY3QgPSBwaGluYS5nZW9tLlJlY3QoOCwgMTYsIDMyLCA2NCk7XG4gKi9cbmNsYXNzIFJlY3Qge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge051bWJlcn0gW3hdIOefqeW9ouOBruW3puS4iumggueCueOBriB4IOW6p+aomVxuICAgKiBAcGFyYW0ge051bWJlcn0gW3ldIOefqeW9ouOBruW3puS4iumggueCueOBriB5IOW6p+aomVxuICAgKiBAcGFyYW0ge051bWJlcn0gW3dpZHRoXSDluYVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtoZWlnaHRdIOmrmOOBlVxuICAgKi9cbiAgY29uc3RydWN0b3IoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSB4XG4gICAgICog55+p5b2i44Gu5bem5LiK6aCC54K544GuIHgg5bqn5qiZXG4gICAgICovXG4gICAgdGhpcy54ID0gMDtcbiAgICBcbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkge051bWJlcn0geVxuICAgICAqIOefqeW9ouOBruW3puS4iumggueCueOBriB5IOW6p+aomVxuICAgICAqL1xuICAgIHRoaXMueSA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkge051bWJlcn0gd2lkdGhcbiAgICAgKiDnn6nlvaLjga7luYVcbiAgICAgKi9cbiAgICB0aGlzLndpZHRoID0gMzI7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkge051bWJlcn0gaGlnaHRcbiAgICAgKiDnn6nlvaLjga7pq5jjgZVcbiAgICAgKi9cbiAgICB0aGlzLmhlaWdodCA9IDMyO1xuXG4gICAgdGhpcy5zZXQoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBzZXRcbiAgICogQGNoYWluYWJsZVxuICAgKiB0aGlzIOOBruWQhOWApOOCkuWGjeioreWumuOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgcmVjdCA9IHBoaW5hLmdlb20uUmVjdCg4LCAxNiwgMzIsIDY0KTtcbiAgICogICAgIHJlY3Quc2V0KDAsIDE2LCAzMiwgNjQpO1xuICAgKlxuICAgKiBAcGFyYW0ge051bWJlcn0geCDnn6nlvaLjga7lt6bkuIrpoILngrnjga4geCDluqfmqJlcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHkg55+p5b2i44Gu5bem5LiK6aCC54K544GuIHkg5bqn5qiZXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB3aWR0aCDluYVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGhlaWdodCDpq5jjgZVcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXQoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIG1vdmVUb1xuICAgKiBAY2hhaW5hYmxlXG4gICAqIOefqeW9oumgmOWfn+OCkuW6p+aomSAoeCwgeSkg44Gr56e75YuV44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICByZWN0ID0gcGhpbmEuZ2VvbS5SZWN0KDgsIDE2LCAzMiwgNjQpO1xuICAgKiAgICAgcmVjdC5jZW50ZXJYOyAvLyA9PiAyNFxuICAgKiAgICAgcmVjdC5tb3ZlVG8oMCwgMCk7XG4gICAqICAgICByZWN0LmNlbnRlclg7IC8vID0+IDE2XG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB4IOenu+WLleWFiOOBriB4IOW6p+aomVxuICAgKiBAcGFyYW0ge051bWJlcn0geSDnp7vli5XlhYjjga4geSDluqfmqJlcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBtb3ZlVG8oeCwgeSkge1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIG1vdmVCeVxuICAgKiBAY2hhaW5hYmxlXG4gICAqIOefqeW9oumgmOWfn+OCkiAoeCwgeSkg44Gg44GR56e75YuV44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICByZWN0ID0gcGhpbmEuZ2VvbS5SZWN0KDgsIDE2LCAzMiwgNjQpO1xuICAgKiAgICAgcmVjdC5tb3ZlQnkoMTAsIC0xMCk7XG4gICAqICAgICByZWN0Lng7IC8vID0+IDE4XG4gICAqICAgICByZWN0Lnk7IC8vID0+IDZcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHgg56e75YuV6YeP44GuIHgg5bqn5qiZXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB5IOenu+WLlemHj+OBriB5IOW6p+aomVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIG1vdmVCeSh4LCB5KSB7XG4gICAgdGhpcy54ICs9IHg7XG4gICAgdGhpcy55ICs9IHk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBzZXRTaXpzZVxuICAgKiBAY2hhaW5hYmxlXG4gICAqIOefqeW9oumgmOWfn+OBruW5heOBqOmrmOOBleOCkuWkieabtOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgcmVjdCA9IHBoaW5hLmdlb20uUmVjdCg4LCAxNiwgMzIsIDY0KTtcbiAgICogICAgIHJlY3Quc2V0U2l6ZSgxMCwgMjApO1xuICAgKiAgICAgcmVjdC53aWR0aDsgLy8gPT4gMTBcbiAgICogICAgIHJlY3QuaGVpZ2h0OyAvLyA9PiAyMFxuICAgKlxuICAgKiBAcGFyYW0ge051bWJlcn0gdyDluYVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGgg6auY44GVXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0U2l6ZSh3LCBoKSB7XG4gICAgdGhpcy53aWR0aCA9IHc7XG4gICAgdGhpcy5oZWlnaHQgPSBoO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgcGFkZGluZ1xuICAgKiBAY2hhaW5hYmxlXG4gICAqIOefqeW9oumgmOWfn+OBruS4reOBq+ODkeODh+OCo+ODs+OCsOmgmOWfn+OCkuioreWumuOBl+OBvuOBmeOAglxuICAgKlxuICAgKiDnn6nlvaLpoJjln5/oh6rkvZPjga7jgrXjgqTjgrrjga/jg5Hjg4fjgqPjg7PjgrDpoJjln5/jga7liIbjgaDjgZHlsI/jgZXjgY/jgarjgorjgb7jgZnjgIIgIFxuICAgKiDluYXjga7mjIflrprmlrnms5Xjga8gQ1NTIOOBriBwYWRkaW5nIOaMh+WumuOBqOWQjOOBmOOCiOOBhuOBq+aZguioiOWbnuOCiuOBp+OBmeOAgiAgXG4gICAqIOW8leaVsOOBjDHjgaTjga7loLTlkIjjga/kuIrkuIvlt6blj7Pjga7lgKTjgIHlvJXmlbDjgYwy44Gk44Gu5aC05ZCI44Gv5LiK5LiL44Go5bem5Y+z44Gu5YCk44CB5byV5pWw44GM77yT44Gk44Gu5aC05ZCI44Gv5LiK44CB5bem5Y+z44CB5LiL44Gu5YCk44Go6Kej6YeI44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICByZWN0ID0gcGhpbmEuZ2VvbS5SZWN0KDUwLCAxMDAsIDE1MCwgMjAwKTtcbiAgICogICAgIHJlY3QucGFkZGluZygxMCk7XG4gICAqICAgICByZWN0Lng7IC8vID0+IDYwXG4gICAqICAgICByZWN0Lnk7IC8vID0+IDExMFxuICAgKiAgICAgcmVjdC53aWR0aDsgLy8gPT4gMTMwXG4gICAqICAgICByZWN0LmhlaWdodDsgLy8gPT4gMTgwXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB0b3Ag5LiK6L6644Gu44OR44OH44Kj44Oz44Kw5bmFXG4gICAqIEBwYXJhbSB7TnVtYmVyfSByaWdodCDlj7Povrrjga7jg5Hjg4fjgqPjg7PjgrDluYVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGJvdHRvbSDkuIvovrrjga7jg5Hjg4fjgqPjg7PjgrDluYVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGxlZnQg5bem6L6644Gu44OR44OH44Kj44Oz44Kw5bmFXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcGFkZGluZyh0b3AsIHJpZ2h0LCBib3R0b20sIGxlZnQpIHtcbiAgICAvLyBjc3Mg44GuIHBhZGRpbmcg44Gr5ZCI44KP44Gb44Gm5pmC6KiI5Zue44KK44Gr44OR44Op44Oh44O844K/6Kq/5pW0XG4gICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIHRvcCA9IHJpZ2h0ID0gYm90dG9tID0gbGVmdCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHRvcCAgICAgPSBib3R0b20gPSBhcmd1bWVudHNbMF07XG4gICAgICAgIHJpZ2h0ICAgPSBsZWZ0ICAgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICB0b3AgICAgID0gYXJndW1lbnRzWzBdO1xuICAgICAgICByaWdodCAgID0gbGVmdCA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgYm90dG9tICA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIFxuICAgIHRoaXMueCArPSBsZWZ0O1xuICAgIHRoaXMueSArPSB0b3A7XG4gICAgdGhpcy53aWR0aCAtPSBsZWZ0K3JpZ2h0O1xuICAgIHRoaXMuaGVpZ2h0LT0gdG9wICtib3R0b207XG4gICAgXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBjb250YWluc1xuICAgKiDluqfmqJkgKHgsIHkpIOOBjCDnn6nlvaLpoJjln5/jga7kuK3jgavlkKvjgb7jgozjgovjgYvjganjgYbjgYvjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIHJlY3QgPSBwaGluYS5nZW9tLlJlY3QoNTAsIDEwMCwgMTUwLCAyMDApO1xuICAgKiAgICAgcmVjdC5jb250YWlucygzNSwgNjgpOyAvLyA9PiAgdHJ1ZVxuICAgKiAgICAgcmVjdC5jb250YWlucygyMDAsIDY4KTsgLy8gPT4gZmFsc2VcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHgg5Yik5a6a44GZ44KL5a++6LGh44GuIHgg5bqn5qiZXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB5IOWIpOWumuOBmeOCi+WvvuixoeOBriB5IOW6p+aomVxuICAgKiBAcmV0dXJuIHtCb29sZWFufSDmjIflrprjgZfjgZ/luqfmqJnjgYznn6nlvaLpoJjln5/jga7kuK3jgavlkKvjgb7jgozjgovjgYvjganjgYbjgYtcbiAgICovXG4gIGNvbnRhaW5zKHgsIHkpIHtcbiAgICByZXR1cm4gdGhpcy5sZWZ0IDw9IHggJiYgeCA8PSB0aGlzLnJpZ2h0ICYmIHRoaXMudG9wIDw9IHkgJiYgeSA8PSB0aGlzLmJvdHRvbTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGNsb25lXG4gICAqIHRoaXMg44Gu44Kz44OU44O844KS55Sf5oiQ44GX44Gm6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICByZWN0ID0gcGhpbmEuZ2VvbS5SZWN0KDUwLCAxMDAsIDE1MCwgMjAwKTtcbiAgICogICAgIHJlY3QyID0gcmVjdC5jbG9uZSgpO1xuICAgKiAgICAgcmVjdDIueCA9PSByZWN0Lng7IC8vID0+IHRydWVcbiAgICpcbiAgICogQHJldHVybiB7UmVjdH0g55Sf5oiQ44GX44Gf55+p5b2i6aCY5Z+fXG4gICAqL1xuICBjbG9uZSgpIHtcbiAgICByZXR1cm4gbmV3IFJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHRvQ2lyY2xlXG4gICAqIOefqeW9oumgmOWfn+WGheOBq+WPjuOBvuOCi+acgOWkp+OBruWGhumgmOWfn+OCkueUn+aIkOOBl+OBpui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgcmVjdCA9IHBoaW5hLmdlb20uUmVjdCgzMiwgNjQsIDEwMCwgMjAwKTtcbiAgICogICAgIGNpcmNsZSA9IHJlY3QudG9DaXJjbGUoKTtcbiAgICogICAgIGNpcmNsZS54OyAvLyA9PiA4MlxuICAgKiAgICAgY2lyY2xlLnk7IC8vID0+IDE2NFxuICAgKiAgICAgY2lyY2xlLnJhZGl1czsgLy8gPT4gNTBcbiAgICpcbiAgICogQHJldHVybiB7Q2lyY2xlfSDnlJ/miJDjgZfjgZ/lhobpoJjln59cbiAgICovXG4gIHRvQ2lyY2xlKCkge1xuICAgIHZhciByYWRpdXMgPSAoKHRoaXMud2lkdGggPCB0aGlzLmhlaWdodCkgPyB0aGlzLndpZHRoIDogdGhpcy5oZWlnaHQpLzI7XG4gICAgcmV0dXJuIG5ldyBDaXJjbGUodGhpcy5jZW50ZXJYLCB0aGlzLmNlbnRlclksIHJhZGl1cyk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCB0b0FycmF5XG4gICAqIHRoaXMg44Gu5ZCE5YCk44KS6KaB57Sg44Go44GZ44KL6YWN5YiX44KS55Sf5oiQ44GX44Gm6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICByZWN0ID0gcGhpbmEuZ2VvbS5SZWN0KDMyLCA2NCwgMTAwLCAyMDApO1xuICAgKiAgICAgcmVjdC50b0FycmF5KCk7IC8vID0+IFszMiwgNjQsIDEwMCwgMjAwXVxuICAgKlxuICAgKiBAcmV0dXJuIHtOdW1iZXJbXX0g55Sf5oiQ44GX44Gf6YWN5YiXXG4gICAqL1xuICB0b0FycmF5KCkge1xuICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0XTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge051bWJlcn0gbGVmdFxuICAgKiDjgq3jg6Pjg7Pjg5Djgrnlt6bnq6/jgYvjgonnn6nlvaLpoJjln5/jga7lt6bovrrjgb7jgafjga7ot53pm6JcbiAgICpcbiAgICogbGVmdCDjgpLlpInmm7TjgZnjgovjgajnn6nlvaLpoJjln5/jga7luYXvvIh3aWR0aO+8ieOBjOiHquWLleeahOOBq+iqv+aVtOOBleOCjOOBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgcmVjdCA9IHBoaW5hLmdlb20uUmVjdCgzMiwgNjQsIDEwMCwgMjAwKTtcbiAgICogICAgIHJlY3QubGVmdDsgLy8gPT4gMzJcbiAgICogICAgIHJlY3Qud2lkdGg7IC8vID0+IDEwMFxuICAgKiAgICAgcmVjdC5yaWdodDsgLy8gPT4gMTMyXG4gICAqICAgICBcbiAgICogICAgIHJlY3QubGVmdCA9IDQyO1xuICAgKiAgICAgcmVjdC53aWR0aDsgLy8gPT4gOTBcbiAgICovXG4gIGdldCBsZWZ0KCkgICB7IHJldHVybiB0aGlzLng7IH1cbiAgc2V0IGxlZnQodikgIHsgdGhpcy53aWR0aCAtPSB2LXRoaXMueDsgdGhpcy54ID0gdjsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge051bWJlcn0gdG9wXG4gICAqIOOCreODo+ODs+ODkOOCueS4iuerr+OBi+OCieefqeW9oumgmOWfn+OBruS4iui+uuOBvuOBp+OBruS9jee9rlxuICAgKlxuICAgKiB0b3Ag44KS5aSJ5pu044GZ44KL44Go55+p5b2i6aCY5Z+f44Gu6auY44GV77yIaGVpZ2h077yJ44GM6Ieq5YuV55qE44Gr6Kq/5pW044GV44KM44G+44GZ44CCXG4gICAqL1xuICBnZXQgdG9wKCkgICB7IHJldHVybiB0aGlzLnk7IH1cbiAgc2V0IHRvcCh2KSAgeyB0aGlzLmhlaWdodCAtPSB2LXRoaXMueTsgdGhpcy55ID0gdjsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge051bWJlcn0gcmlnaHRcbiAgICog44Kt44Oj44Oz44OQ44K55bem56uv44GL44KJ55+p5b2i6aCY5Z+f44Gu5Y+z6L6644G+44Gn44Gu6Led6ZuiXG4gICAqXG4gICAqIHJpZ2h0IOOCkuWkieabtOOBmeOCi+OBqOefqeW9oumgmOWfn+OBruW5he+8iHdpZHRo77yJ44GM6Ieq5YuV55qE44Gr6Kq/5pW044GV44KM44G+44GZ44CCXG4gICAqL1xuICBnZXQgcmlnaHQoKSAgIHsgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGg7IH1cbiAgc2V0IHJpZ2h0KHYpICB7IHRoaXMud2lkdGggKz0gdi10aGlzLnJpZ2h0OyB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBib3R0b21cbiAgICog44Kt44Oj44Oz44OQ44K55LiK56uv44GL44KJ55+p5b2i6aCY5Z+f44Gu5LiL6L6644G+44Gn44Gu5L2N572uXG4gICAqXG4gICAqIGJvdHRvbSDjgpLlpInmm7TjgZnjgovjgajnn6nlvaLpoJjln5/jga7pq5jjgZXvvIhoZWlnaHTvvInjgYzoh6rli5XnmoTjgavoqr/mlbTjgZXjgozjgb7jgZnjgIJcbiAgICovXG4gIGdldCBib3R0b20oKSAgIHsgcmV0dXJuIHRoaXMueSArIHRoaXMuaGVpZ2h0OyB9XG4gIHNldCBib3R0b20odikgIHsgdGhpcy5oZWlnaHQgKz0gdi10aGlzLmJvdHRvbTsgfVxuICBcbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBjZW50ZXJYXG4gICAqIOefqeW9oumgmOWfn+OBriB4IOW6p+aomVxuICAgKlxuICAgKiDnj77mmYLngrnjgafjga/oqq3jgb/lj5bjgorlsILnlKjjgafjgZnjgIJcbiAgICovXG4gIGdldCBjZW50ZXJYKCkgICB7IHJldHVybiB0aGlzLnggKyB0aGlzLndpZHRoLzI7IH1cbiAgc2V0IGNlbnRlclgodikgIHtcbiAgICAvLyBUT0RPOiDmpJzoqI7kuK1cbiAgfVxuICAvKipcbiAgICogQHByb3BlcnR5IHtOdW1iZXJ9IGNlbnRlcllcbiAgICog55+p5b2i6aCY5Z+f44GuIHkg5bqn5qiZXG4gICAqXG4gICAqIOePvuaZgueCueOBp+OBr+iqreOBv+WPluOCiuWwgueUqOOBp+OBmeOAglxuICAgKi9cbiAgZ2V0IGNlbnRlclkoKSAgIHsgcmV0dXJuIHRoaXMueSArIHRoaXMuaGVpZ2h0LzI7IH1cbiAgc2V0IGNlbnRlclkodikgIHtcbiAgICAvLyBUT0RPOiDmpJzoqI7kuK1cbiAgfVxuXG59XG5cbi8qKlxuICogQ2lyY2xlLnRvUmVjdFxuICog5b6q55Kw5Y+C54Wn44KS5Zue6YG/44GZ44KL44Gf44KB44CB44GT44GT44Gn5a6a576pXG4gKi9cbkNpcmNsZS5wcm90b3R5cGUudG9SZWN0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzaXplID0gdGhpcy5zaXplO1xuICByZXR1cm4gbmV3IFJlY3QodGhpcy54IC0gdGhpcy5yYWRpdXMsIHRoaXMueSAtIHRoaXMucmFkaXVzLCBzaXplLCBzaXplKTtcbn07XG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmdlb20uTWF0cml4MzNcbiAqICMg6KGM5YiX44Kv44Op44K5XG4gKiAzeDPjga7ooYzliJfjgpLooajjgZnjgq/jg6njgrnjgafjgZnjgIJcbiAqIFxuICogPHByZT5cbiAqIHwgbTAwIG0wMSBtMDIgfFxuICogfCBtMTAgbTExIG0xMiB8XG4gKiB8IG0yMCBtMjEgbTIyIHxcbiAqIDwvcHJlPlxuICovXG5jbGFzcyBNYXRyaXgzMyB7XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgaW5pdFxuICAgKiDjg57jg4jjg6rjg4Pjgq/jgrnjgq/jg6njgrnjga7jgrPjg7Pjgrnjg4jjg6njgq/jgr/jgafjgZnjgIJcbiAgICpcbiAgICog5byV5pWw44GvIG0wMCwgbTAxLCBtMDIsIG0xMCwgbTExLCBtMTIsIG0yMCwgbTIxLCBtMjIg44Gu6aCG44Gr5oyH5a6a44GX44G+44GZ44CCXG4gICAqIOW8leaVsOOBjDnlgIvjgavmuoDjgZ/jgarjgYTloLTlkIjjga/ljZjkvY3ooYzliJfjgpLnlJ/miJDjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIG1hdDEgPSBwaGluYS5nZW9tLk1hdHJpeDMzKDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDkpO1xuICAgKiAgICAgbWF0MiA9IHBoaW5hLmdlb20uTWF0cml4MzMoKTtcbiAgICogICAgIG1hdDEubTAwICsgbWF0Mi5tMDA7IC8vID0+IDJcbiAgICogICAgIG1hdDEubTAxIC0gbWF0Mi5tMDE7IC8vID0+IDJcbiAgICpcbiAgICogQHBhcmFtIHsuLi5udW1iZXJ9IG0wMCwgbTAxLC4uLiDlkITopoHntKDjga7lgKRcbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMubTAwO1xuICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMubTAxO1xuICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMubTAyO1xuXG4gICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5tMTA7XG4gICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5tMTE7XG4gICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4gICAgdGhpcy5tMTI7XG5cbiAgICAvKiogQHR5cGUge251bWJlcn0gKi9cbiAgICB0aGlzLm0yMDtcbiAgICAvKiogQHR5cGUge251bWJlcn0gKi9cbiAgICB0aGlzLm0yMTtcbiAgICAvKiogQHR5cGUge251bWJlcn0gKi9cbiAgICB0aGlzLm0yMjtcblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDkpIHtcbiAgICAgIHRoaXMuc2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5pZGVudGl0eSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHNldFxuICAgKiBAY2hhaW5hYmxlIHRoaXMg44Gu5ZCE6KaB57Sg44Gu5YCk44KS5YaN6Kit5a6a44GX44G+44GZ44CCXG4gICAqIFxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgIG1hdDEgPSBwaGluYS5nZW9tLk1hdHJpeDMzKDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDkpO1xuICAgKiAgIG1hdDIgPSBwaGluYS5nZW9tLk1hdHJpeDMzKCk7XG4gICAqICAgbWF0Mi5zZXQoMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSk7XG4gICAqICAgbWF0MS50b1N0cmluZygpID09IG1hdDIudG9TdHJpbmcoKTsgLy8gPT4gdHJ1ZVxuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ9IG0wMFxuICAgKiBAcGFyYW0ge251bWJlcn0gbTAxXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtMDJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG0xMFxuICAgKiBAcGFyYW0ge251bWJlcn0gbTExXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtMTJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG0yMFxuICAgKiBAcGFyYW0ge251bWJlcn0gbTIxXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtMjJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXQobTAwLCBtMDEsIG0wMiwgbTEwLCBtMTEsIG0xMiwgbTIwLCBtMjEsIG0yMikge1xuICAgIHRoaXMubTAwID0gbTAwOyB0aGlzLm0wMSA9IG0wMTsgdGhpcy5tMDIgPSBtMDI7XG4gICAgdGhpcy5tMTAgPSBtMTA7IHRoaXMubTExID0gbTExOyB0aGlzLm0xMiA9IG0xMjtcbiAgICB0aGlzLm0yMCA9IG0yMDsgdGhpcy5tMjEgPSBtMjE7IHRoaXMubTIyID0gbTIyO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBpZGVudGl0eVxuICAgKiBAY2hhaW5hYmxlXG4gICAqIOiHqui6q+OCkuWNmOS9jeihjOWIl+OBq+OBl+OBpui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgbWF0MSA9IHBoaW5hLmdlb20uTWF0cml4MzMoMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSk7XG4gICAqICAgICBtYXQyID0gcGhpbmEuZ2VvbS5NYXRyaXgzMygpO1xuICAgKiAgICAgbWF0MS5pZGVudGl0eSgpLnRvU3RyaW5nKCkgPT0gbWF0Mi50b1N0cmluZygpOyAvLyA9PiB0cnVlXG4gICAqXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgaWRlbnRpdHkoKSB7XG4gICAgdGhpcy5tMDAgPSAxOyB0aGlzLm0wMSA9IDA7IHRoaXMubTAyID0gMDtcbiAgICB0aGlzLm0xMCA9IDA7IHRoaXMubTExID0gMTsgdGhpcy5tMTIgPSAwO1xuICAgIHRoaXMubTIwID0gMDsgdGhpcy5tMjEgPSAwOyB0aGlzLm0yMiA9IDE7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBjbG9uZVxuICAgKiDoh6rouqvjga7jgrPjg5Tjg7zjgpLnlJ/miJDjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIG1hdDEgPSBwaGluYS5nZW9tLk1hdHJpeDMzKDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDkpO1xuICAgKiAgICAgbWF0MiA9IG1hdDEuY2xvbmUoKTtcbiAgICogICAgIG1hdDEudG9TdHJpbmcoKSA9PSBtYXQyLnRvU3RyaW5nKCk7IC8vID0+IHRydWVcbiAgICogICAgIG1hdDEgPT0gbWF0MjsgLy8gPT4gZmFsc2VcbiAgICpcbiAgICogQHJldHVybiB7TWF0cml4MzN9IOihjOWIl+OCquODluOCuOOCp+OCr+ODiFxuICAgKi9cbiAgY2xvbmUoKSB7XG4gICAgcmV0dXJuIG5ldyBNYXRyaXgzMyhcbiAgICAgIHRoaXMubTAwLCB0aGlzLm0wMSwgdGhpcy5tMDIsXG4gICAgICB0aGlzLm0xMCwgdGhpcy5tMTEsIHRoaXMubTEyLFxuICAgICAgdGhpcy5tMjAsIHRoaXMubTIxLCB0aGlzLm0yMlxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBkZXRlcm1pbmFudFxuICAgKiDooYzliJflvI/jgpLov5TjgZfjgb7jgZlcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIG1hdDEgPSBwaGluYS5nZW9tLk1hdHJpeDMzKDAsIC0yLCAwLCAtMSwgMywgMSwgNCwgMiwgMSk7XG4gICAqICAgICBtYXQxLmRldGVybWluYW50KCk7IC8vID0+IC0xMFxuICAgKiAgICAgbWF0MS5pZGVudGl0eSgpLmRldGVybWluYW50KCk7IC8vID0+IDFcbiAgICpcbiAgICogQHJldHVybiB7TnVtYmVyfSDooYzliJflvI9cbiAgICovXG4gIGRldGVybWluYW50KCkge1xuICAgIHZhciBtMDAgPSB0aGlzLm0wMDsgdmFyIG0wMSA9IHRoaXMubTAxOyB2YXIgbTAyID0gdGhpcy5tMDI7XG4gICAgdmFyIG0xMCA9IHRoaXMubTEwOyB2YXIgbTExID0gdGhpcy5tMTE7IHZhciBtMTIgPSB0aGlzLm0xMjtcbiAgICB2YXIgbTIwID0gdGhpcy5tMjA7IHZhciBtMjEgPSB0aGlzLm0yMTsgdmFyIG0yMiA9IHRoaXMubTIyO1xuICAgIFxuICAgIHJldHVybiBtMDAqbTExKm0yMiArIG0xMCptMjEqbTAyICsgbTAxKm0xMiptMjAgLSBtMDIqbTExKm0yMCAtIG0wMSptMTAqbTIyIC0gbTEyKm0yMSptMDA7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCB0cmFuc3Bvc2VcbiAgICogQGNoYWluYWJsZVxuICAgKiDoh6rouqvjgpLou6Lnva7ooYzliJfjgavjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIG1hdDEgPSBwaGluYS5nZW9tLk1hdHJpeDMzKDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDkpO1xuICAgKiAgICAgbWF0MiA9IHBoaW5hLmdlb20uTWF0cml4MzMoMSwgNCwgNywgMiwgNSwgOCwgMywgNiwgOSk7XG4gICAqICAgICBtYXQxLnRyYW5zcG9zZSgpLnRvU3RyaW5nKCkgPT0gbWF0Mi50b1N0cmluZygpOyAvLyA9PiB0cnVlXG4gICAqXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgdHJhbnNwb3NlKCkge1xuICAgIHZhciBzd2FwID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgdmFyIHRlbXAgPSB0aGlzW2FdO1xuICAgICAgdGhpc1thXSA9IHRoaXNbYl07XG4gICAgICB0aGlzW2JdID0gdGVtcDtcbiAgICB9LmJpbmQodGhpcyk7XG5cbiAgICBzd2FwKCdtMDEnLCAnbTEwJyk7XG4gICAgc3dhcCgnbTAyJywgJ20yMCcpO1xuICAgIHN3YXAoJ20xMicsICdtMjEnKTtcbiAgICBcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGludmVydFxuICAgKiBAY2hhaW5hYmxlXG4gICAqIOiHqui6q+OCkumAhuihjOWIl+OBq+OBl+OBpui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgbWF0MSA9IHBoaW5hLmdlb20uTWF0cml4MzMoMCwgLTEsIDEsIC0xLCA0LCAtMiwgMSwgMSwgMSk7XG4gICAqICAgICBtYXQyID0gbWF0MS5jbG9uZSgpLmludmVydCgpO1xuICAgKiAgICAgbWF0MyA9IG1hdDEuY2xvbmUoKS5tdWx0aXBseShtYXQyKTtcbiAgICogICAgIG1hdDMudG9TdHJpbmcoKSA9PSBwaGluYS5nZW9tLk1hdHJpeDMzLklERU5USVRZLnRvU3RyaW5nKCk7IC8vID0+IHRydWVcbiAgICpcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBpbnZlcnQoKSB7XG4gICAgdmFyIG0wMCA9IHRoaXMubTAwOyB2YXIgbTAxID0gdGhpcy5tMDE7IHZhciBtMDIgPSB0aGlzLm0wMjtcbiAgICB2YXIgbTEwID0gdGhpcy5tMTA7IHZhciBtMTEgPSB0aGlzLm0xMTsgdmFyIG0xMiA9IHRoaXMubTEyO1xuICAgIHZhciBtMjAgPSB0aGlzLm0yMDsgdmFyIG0yMSA9IHRoaXMubTIxOyB2YXIgbTIyID0gdGhpcy5tMjI7XG5cbiAgICB2YXIgZGV0ID0gdGhpcy5kZXRlcm1pbmFudCgpO1xuXG4gICAgLy8gfG0wMCwgbTAxLCBtMDJ8XG4gICAgLy8gfG0xMCwgbTExLCBtMTJ8XG4gICAgLy8gfG0yMCwgbTIxLCBtMjJ8XG4gICAgdGhpcy5tMDAgPSAobTExKm0yMi1tMTIqbTIxKS9kZXQ7XG4gICAgdGhpcy5tMDEgPSAobTEwKm0yMi1tMTIqbTIwKS9kZXQqLTE7XG4gICAgdGhpcy5tMDIgPSAobTEwKm0yMS1tMTEqbTIwKS9kZXQ7XG4gICAgXG4gICAgdGhpcy5tMTAgPSAobTAxKm0yMi1tMDIqbTIxKS9kZXQqLTE7XG4gICAgdGhpcy5tMTEgPSAobTAwKm0yMi1tMDIqbTIwKS9kZXQ7XG4gICAgdGhpcy5tMTIgPSAobTAwKm0yMS1tMDEqbTIwKS9kZXQqLTE7XG4gICAgXG4gICAgdGhpcy5tMjAgPSAobTAxKm0xMi1tMDIqbTExKS9kZXQ7XG4gICAgdGhpcy5tMjEgPSAobTAwKm0xMi1tMDIqbTEwKS9kZXQqLTE7XG4gICAgdGhpcy5tMjIgPSAobTAwKm0xMS1tMDEqbTEwKS9kZXQ7XG4gICAgXG4gICAgdGhpcy50cmFuc3Bvc2UoKTtcbiAgICBcbiAgICByZXR1cm4gdGhpcztcblxuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgbXVsdGlwbHlcbiAgICogQGNoYWluYWJsZVxuICAgKiDoh6rouqvjgavliKXjga7ooYzliJfjgpLkuZfjgZjjgb7jgZnjgIJcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIG1hdDEgPSBwaGluYS5nZW9tLk1hdHJpeDMzKDAsIC0xLCAxLCAtMSwgNCwgLTIsIDEsIDEsIDEpO1xuICAgKiAgICAgbWF0MiA9IG1hdDEuY2xvbmUoKS5pbnZlcnQoKTtcbiAgICogICAgIG1hdDMgPSBtYXQxLmNsb25lKCkubXVsdGlwbHkobWF0Mik7XG4gICAqICAgICBtYXQzLnRvU3RyaW5nKCkgPT0gcGhpbmEuZ2VvbS5NYXRyaXgzMy5JREVOVElUWS50b1N0cmluZygpOyAvLyA9PiB0cnVlXG4gICAqXG4gICAqIEBwYXJhbSB7TWF0cml4MzN9IG1hdCDkuZfjgZjjgovooYzliJdcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBtdWx0aXBseShtYXQpIHtcbiAgICB2YXIgYTAwID0gdGhpcy5tMDAsIGEwMSA9IHRoaXMubTAxLCBhMDIgPSB0aGlzLm0wMjtcbiAgICB2YXIgYTEwID0gdGhpcy5tMTAsIGExMSA9IHRoaXMubTExLCBhMTIgPSB0aGlzLm0xMjtcbiAgICB2YXIgYTIwID0gdGhpcy5tMjAsIGEyMSA9IHRoaXMubTIxLCBhMjIgPSB0aGlzLm0yMjtcbiAgICB2YXIgYjAwID0gbWF0Lm0wMCwgYjAxID0gbWF0Lm0wMSwgYjAyID0gbWF0Lm0wMjtcbiAgICB2YXIgYjEwID0gbWF0Lm0xMCwgYjExID0gbWF0Lm0xMSwgYjEyID0gbWF0Lm0xMjtcbiAgICB2YXIgYjIwID0gbWF0Lm0yMCwgYjIxID0gbWF0Lm0yMSwgYjIyID0gbWF0Lm0yMjtcblxuICAgIHRoaXMubTAwID0gYTAwKmIwMCArIGEwMSpiMTAgKyBhMDIqYjIwO1xuICAgIHRoaXMubTAxID0gYTAwKmIwMSArIGEwMSpiMTEgKyBhMDIqYjIxO1xuICAgIHRoaXMubTAyID0gYTAwKmIwMiArIGEwMSpiMTIgKyBhMDIqYjIyO1xuXG4gICAgdGhpcy5tMTAgPSBhMTAqYjAwICsgYTExKmIxMCArIGExMipiMjA7XG4gICAgdGhpcy5tMTEgPSBhMTAqYjAxICsgYTExKmIxMSArIGExMipiMjE7XG4gICAgdGhpcy5tMTIgPSBhMTAqYjAyICsgYTExKmIxMiArIGExMipiMjI7XG5cbiAgICB0aGlzLm0yMCA9IGEyMCpiMDAgKyBhMjEqYjEwICsgYTIyKmIyMDtcbiAgICB0aGlzLm0yMSA9IGEyMCpiMDEgKyBhMjEqYjExICsgYTIyKmIyMTtcbiAgICB0aGlzLm0yMiA9IGEyMCpiMDIgKyBhMjEqYjEyICsgYTIyKmIyMjtcbiAgICBcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIG11bHRpcGx5VmVjdG9yMlxuICAgKiDoh6rouqvjgasy5qyh5YWD44OZ44Kv44OI44OrIHYg44KS5LmX44GY44G+44GZ44CCXG4gICAqIDLmrKHlhYPjg5njgq/jg4jjg6vjga8gKHgsIHksIDEpIOOBqOOBl+OBpuS5l+eul+OBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgbWF0ID0gcGhpbmEuZ2VvbS5NYXRyaXgzMygwLCAtMSwgMSwgLTEsIDQsIC0yLCAxLCAxLCAxKTtcbiAgICogICAgIHYgPSBwaGluYS5nZW9tLlZlY3RvcjIoMiwgNClcbiAgICogICAgIG1hdC5tdWx0aXBseVZlY3RvcjIodikgLy8gPT4ge3g6IC0zLCB5OiAxMn1cbiAgICpcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuL3ZlY3RvcjJcIikuUHJpbWl0aXZlVmVjdG9yMn0gdiDkuZfjgZjjgovjg5njgq/jg4jjg6tcbiAgICogQHJldHVybiB7VmVjdG9yMn0g5LmX566X57WQ5p6c44Gu44OZ44Kv44OI44OrXG4gICAqL1xuICBtdWx0aXBseVZlY3RvcjIodikge1xuICAgIHZhciB2eCA9IHRoaXMubTAwKnYueCArIHRoaXMubTAxKnYueSArIHRoaXMubTAyO1xuICAgIHZhciB2eSA9IHRoaXMubTEwKnYueCArIHRoaXMubTExKnYueSArIHRoaXMubTEyO1xuICAgIFxuICAgIC8vIHJldHVybiBwaGluYS5nZW9tLlZlY3RvcjIodngsIHZ5KTtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjIodngsIHZ5KTtcbiAgfVxuXG4gIC8vIOihjFxuICAvKipcbiAgICogQG1ldGhvZCBnZXRSb3dcbiAgICogcm93IOeVquebruOBruihjOOCkumFjeWIl+OBp+i/lOOBl+OBvuOBmeOAgnJvdyDjgYwgMOOAgTHjgIEyIOOBruOBhOOBmuOCjOOBi+OBp+OBquOBkeOCjOOBsCBudWxsIOOCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgbWF0MSA9IHBoaW5hLmdlb20uTWF0cml4MzMoMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSk7XG4gICAqICAgICBtYXQxLmdldFJvdygwKTsgLy8gWzEsIDIsIDNdXG4gICAqICAgICBtYXQxLmdldFJvdygxKTsgLy8gWzQsIDUsIDZdXG4gICAqICAgICBtYXQxLmdldFJvdyg5KTsgLy8gbnVsbFxuICAgKlxuICAgKiBAcGFyYW0gezB8MXwyfSByb3cg6KGM55Wq5Y+3XG4gICAqIEByZXR1cm4ge051bWJlcltdfG51bGx9IOihjOOCkuihqOOBmemFjeWIl1xuICAgKi9cbiAgZ2V0Um93KHJvdykge1xuICAgIGlmICggcm93ID09PSAwICkge1xuICAgICAgcmV0dXJuIFsgdGhpcy5tMDAsIHRoaXMubTAxLCB0aGlzLm0wMiBdO1xuICAgIH1cbiAgICBlbHNlIGlmICggcm93ID09PSAxICkge1xuICAgICAgcmV0dXJuIFsgdGhpcy5tMTAsIHRoaXMubTExLCB0aGlzLm0xMiBdO1xuICAgIH1cbiAgICBlbHNlIGlmICggcm93ID09PSAyICkge1xuICAgICAgcmV0dXJuIFsgdGhpcy5tMjAsIHRoaXMubTIxLCB0aGlzLm0yMiBdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGdldENvbFxuICAgKiBjb2wg55Wq55uu44Gu5YiX44KS6YWN5YiX44Gn6L+U44GX44G+44GZ44CCY29sIOOBjCAw44CBMeOAgTIg44Gu44GE44Ga44KM44GL44Gn44Gq44GR44KM44GwIG51bGwg44KS6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICBtYXQxID0gcGhpbmEuZ2VvbS5NYXRyaXgzMygxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5KTtcbiAgICogICAgIG1hdDEuZ2V0Q29sKDApOyAvLyBbMSwgNCwgN11cbiAgICogICAgIG1hdDEuZ2V0Q29sKDEpOyAvLyBbMiwgNSwgOF1cbiAgICogICAgIG1hdDEuZ2V0Um93KC0xKTsgLy8gbnVsbFxuICAgKlxuICAgKiBAcGFyYW0gezB8MXwyfSBjb2wg5YiX55Wq5Y+3XG4gICAqIEByZXR1cm4ge051bWJlcltdfG51bGx9IOWIl+OCkuihqOOBmemFjeWIl1xuICAgKi9cbiAgZ2V0Q29sKGNvbCkge1xuICAgIGlmICggY29sID09PSAwICkge1xuICAgICAgcmV0dXJuIFsgdGhpcy5tMDAsIHRoaXMubTEwLCB0aGlzLm0yMCBdO1xuICAgIH1cbiAgICBlbHNlIGlmICggY29sID09PSAxICkge1xuICAgICAgcmV0dXJuIFsgdGhpcy5tMDEsIHRoaXMubTExLCB0aGlzLm0yMSBdO1xuICAgIH1cbiAgICBlbHNlIGlmICggY29sID09PSAyICkge1xuICAgICAgcmV0dXJuIFsgdGhpcy5tMDIsIHRoaXMubTEyLCB0aGlzLm0yMiBdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHRvU3RyaW5nXG4gICAqIOihjOWIl+OCkiBKU09OIOW9ouW8j+OBp+ihqOePvuOBl+OBn+aWh+Wtl+WIl+OCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgdiA9IHBoaW5hLmdlb20uVmVjdG9yMigzLCA0KTtcbiAgICogICAgIHYyID0gdi5jbG9uZSgpO1xuICAgKiAgICAgdjIueCA9PSB2Lng7IC8vID0+IHRydWVcbiAgICpcbiAgICogQHJldHVybiB7U3RyaW5nfSBKU09OIOaWh+Wtl+WIl1xuICAgKi9cbiAgdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIGZvcm1hdC5jYWxsKFwifHttMDB9LCB7bTAxfSwge20wMn18XFxufHttMTB9LCB7bTExfSwge20xMn18XFxufHttMjB9LCB7bTIxfSwge20yMn18XCIsIHRoaXMpO1xuICAgIC8vIHJldHVybiBcInx7bTAwfSwge20wMX0sIHttMDJ9fFxcbnx7bTEwfSwge20xMX0sIHttMTJ9fFxcbnx7bTIwfSwge20yMX0sIHttMjJ9fFwiLmZvcm1hdCh0aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDjg4fjg5Xjgqnjg6vjg4jljZjkvY3ooYzliJfjgpLov5TjgZlcbiAgICovXG4gIHN0YXRpYyBnZXQgSURFTlRJVFkoKSB7XG4gICAgcmV0dXJuIElERU5USVRZXG4gIH1cbn1cblxudmFyIElERU5USVRZID0gbmV3IE1hdHJpeDMzKCkuaWRlbnRpdHkoKTtcblxuLyoqXG4qIEBjbGFzcyBwaGluYS5nZW9tLkNvbGxpc2lvblxuKiAjIOihneeqgeWIpOWumueUqOOCr+ODqeOCuVxuKiDooZ3nqoHliKTlrprjga7jgZ/jgoHjga7jgq/jg6njgrnjgafjgZnjgILjgZnjgbnjgabjga7jg6Hjgr3jg4Pjg4njgYzjgrnjgr/jg4bjgqPjg4Pjgq/jg6Hjgr3jg4Pjg4njgafjgZnjgIJcbiogXG4qL1xuY2xhc3MgQ29sbGlzaW9uIHtcblxuICAvKipcbiAgICogQG1ldGhvZCB0ZXN0Q2lyY2xlQ2lyY2xlXG4gICAqIEBzdGF0aWNcbiAgICogMuOBpOOBruWGhumgmOWfn+OBjOmHjeOBquOBo+OBpuOBhOOCi+OBi+OBqeOBhuOBi+OCkuWIpOWumuOBl+OBvuOBmVxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgY2lyY2xlMSA9IHBoaW5hLmdlb20uQ2lyY2xlKDEwMCwgMTAwLCAzMCk7XG4gICAqICAgICBjaXJjbGUyID0gcGhpbmEuZ2VvbS5DaXJjbGUoMTMwLCAxNDAsIDMwKTtcbiAgICogcGhpbmEuZ2VvbS5Db2xsaXNpb24udGVzdENpcmNsZUNpcmNsZShjaXJjbGUxLCBjaXJjbGUyKTsgLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBAcGFyYW0ge0NpcmNsZX0gY2lyY2xlMCDlhobpoJjln5/jgqrjg5bjgrjjgqfjgq/jg4hcbiAgICogQHBhcmFtIHtDaXJjbGV9IGNpcmNsZTEg5YaG6aCY5Z+f44Kq44OW44K444Kn44Kv44OIXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IOmgmOWfn+OBjOmHjeOBquOBo+OBpuOBhOOCi+OBi+OBqeOBhuOBi1xuICAgKi9cbiAgc3RhdGljIHRlc3RDaXJjbGVDaXJjbGUoY2lyY2xlMCwgY2lyY2xlMSkge1xuICAgIHZhciBkaXN0YW5jZVNxdWFyZWQgPSBWZWN0b3IyLmRpc3RhbmNlU3F1YXJlZChjaXJjbGUwLCBjaXJjbGUxKTtcbiAgICByZXR1cm4gZGlzdGFuY2VTcXVhcmVkIDw9IE1hdGgucG93KGNpcmNsZTAucmFkaXVzICsgY2lyY2xlMS5yYWRpdXMsIDIpO1xuICB9XG4gIC8qKlxuICAgKiBAbWV0aG9kIHRlc3RSZWN0UmVjdFxuICAgKiBAc3RhdGljXG4gICAqIDLjgaTjga7nn6nlvaLpoJjln5/jgYzph43jgarjgaPjgabjgYTjgovjgYvjganjgYbjgYvjgpLliKTlrprjgZfjgb7jgZlcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIHJlY3QxID0gcGhpbmEuZ2VvbS5SZWN0KDEwMCwgMTAwLCAzMCwgNDApO1xuICAgKiAgICAgcmVjdDIgPSBwaGluYS5nZW9tLlJlY3QoMjAwLCAyMDAsIDEwLCAxMCk7XG4gICAqICAgICBwaGluYS5nZW9tLkNvbGxpc2lvbi50ZXN0UmVjdFJlY3QocmVjdDEsIHJlY3QyKTsgLy8gPT4gZmFsc2VcbiAgICpcbiAgICogQHBhcmFtIHtSZWN0fSByZWN0MCDnn6nlvaLpoJjln5/jgqrjg5bjgrjjgqfjgq/jg4hcbiAgICogQHBhcmFtIHtSZWN0fSByZWN0MSDnn6nlvaLpoJjln5/jgqrjg5bjgrjjgqfjgq/jg4hcbiAgICogQHJldHVybiB7Qm9vbGVhbn0g6aCY5Z+f44GM6YeN44Gq44Gj44Gm44GE44KL44GL44Gp44GG44GLXG4gICAqL1xuICBzdGF0aWMgdGVzdFJlY3RSZWN0KHJlY3QwLCByZWN0MSkge1xuICAgIHJldHVybiAocmVjdDAubGVmdCA8IHJlY3QxLnJpZ2h0KSAmJiAocmVjdDAucmlnaHQgPiByZWN0MS5sZWZ0KSAmJlxuICAgICAgKHJlY3QwLnRvcCA8IHJlY3QxLmJvdHRvbSkgJiYgKHJlY3QwLmJvdHRvbSA+IHJlY3QxLnRvcCk7XG4gIH1cbiAgLyoqXG4gICAqIEBtZXRob2QgdGVzdENpcmNsZVJlY3RcbiAgICogQHN0YXRpY1xuICAgKiDlhobpoJjln5/jgajnn6nlvaLpoJjln5/jgYzph43jgarjgaPjgabjgYTjgovjgYvjganjgYbjgYvjgYvjgpLliKTlrprjgZfjgb7jgZlcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIGNpcmNsZSA9IHBoaW5hLmdlb20uQ2lyY2xlKDEwMCwgMTAwLCAzMCk7XG4gICAqICAgICByZWN0ID0gcGhpbmEuZ2VvbS5SZWN0KDEwMCwgMTAwLCAzMCwgNDApO1xuICAgKiAgICAgcGhpbmEuZ2VvbS5Db2xsaXNpb24udGVzdENpcmNsZVJlY3QoY2lyY2xlLCByZWN0KTsgLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBAcGFyYW0ge0NpcmNsZX0gY2lyY2xlIOWGhumgmOWfn+OCquODluOCuOOCp+OCr+ODiFxuICAgKiBAcGFyYW0ge1JlY3R9IHJlY3Qg55+p5b2i6aCY5Z+f44Kq44OW44K444Kn44Kv44OIXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IOmgmOWfn+OBjOmHjeOBquOBo+OBpuOBhOOCi+OBi+OBqeOBhuOBi1xuICAgKi9cbiAgc3RhdGljIHRlc3RDaXJjbGVSZWN0KGNpcmNsZSwgcmVjdCkge1xuICAgIC8vIOOBvuOBmuOBr+Wkp+OBjeOBquefqeW9ouOBp+WIpOWumijpq5jpgJ/ljJYpXG4gICAgdmFyIGJpZ1JlY3QgPSBuZXcgUmVjdChyZWN0LmxlZnQtY2lyY2xlLnJhZGl1cywgcmVjdC50b3AtY2lyY2xlLnJhZGl1cywgcmVjdC53aWR0aCtjaXJjbGUucmFkaXVzKjIsIHJlY3QuaGVpZ2h0K2NpcmNsZS5yYWRpdXMqMik7XG4gICAgaWYgKGJpZ1JlY3QuY29udGFpbnMoY2lyY2xlLngsIGNpcmNsZS55KSA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgLy8gMueorumhnuOBruefqeW9ouOBqOihneeqgeWIpOWumlxuICAgIHZhciByID0gbmV3IFJlY3QocmVjdC5sZWZ0LWNpcmNsZS5yYWRpdXMsIHJlY3QudG9wLCByZWN0LndpZHRoK2NpcmNsZS5yYWRpdXMqMiwgcmVjdC5oZWlnaHQpO1xuICAgIGlmIChyLmNvbnRhaW5zKGNpcmNsZS54LCBjaXJjbGUueSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByLnNldChyZWN0LmxlZnQsIHJlY3QudG9wLWNpcmNsZS5yYWRpdXMsIHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0K2NpcmNsZS5yYWRpdXMqMik7XG4gICAgaWYgKHIuY29udGFpbnMoY2lyY2xlLngsIGNpcmNsZS55KSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIFxuICAgIC8vIOWGhuOBqOefqeW9ouOBru+8lOeCueOBruWIpOWumlxuICAgIHZhciBjID0gbmV3IENpcmNsZShjaXJjbGUueCwgY2lyY2xlLnksIGNpcmNsZS5yYWRpdXMpO1xuICAgIC8vIGxlZnQgdG9wXG4gICAgaWYgKGMuY29udGFpbnMocmVjdC5sZWZ0LCByZWN0LnRvcCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvLyByaWdodCB0b3BcbiAgICBpZiAoYy5jb250YWlucyhyZWN0LnJpZ2h0LCByZWN0LnRvcCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvLyByaWdodCBib3R0b21cbiAgICBpZiAoYy5jb250YWlucyhyZWN0LnJpZ2h0LCByZWN0LmJvdHRvbSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvLyBsZWZ0IGJvdHRvbVxuICAgIGlmIChjLmNvbnRhaW5zKHJlY3QubGVmdCwgcmVjdC5ib3R0b20pKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8qKlxuICAgKiBAbWV0aG9kIHRlc3RDaXJjbGVMaW5lXG4gICAqIEBzdGF0aWNcbiAgICog5YaG6aCY5Z+f44Go57ea5YiG44GM6YeN44Gq44Gj44Gm44GE44KL44GL44Gp44GG44GL44KS5Yik5a6a44GX44G+44GZXG4gICAqXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICBjaXJjbGUgPSBwaGluYS5nZW9tLkNpcmNsZSgxMDAsIDEwMCwgMjApO1xuICAgKiAgICAgcDEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMCwgMCk7XG4gICAqICAgICBwMiA9IHBoaW5hLmdlb20uVmVjdG9yMigzMDAsIDQwMCk7XG4gICAqICAgICBwaGluYS5nZW9tLkNvbGxpc2lvbi50ZXN0Q2lyY2xlTGluZShjaXJjbGUsIHAxLCBwMik7IC8vID0+IHRydWVcbiAgICpcbiAgICogQHBhcmFtIHtDaXJjbGV9IGNpcmNsZSDlhobpoJjln5/jgqrjg5bjgrjjgqfjgq/jg4hcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuL3ZlY3RvcjJcIikuUHJpbWl0aXZlVmVjdG9yMn0gcDEg57ea5YiG44Gu56uv44Gu5bqn5qiZXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi92ZWN0b3IyXCIpLlByaW1pdGl2ZVZlY3RvcjJ9IHAyIOe3muWIhuOBruerr+OBruW6p+aomVxuICAgKiBAcmV0dXJuIHtCb29sZWFufSDlhobpoJjln5/jgajnt5rliIbjgYzph43jgarjgaPjgabjgYTjgovjgYvjganjgYbjgYtcbiAgICovXG4gIHN0YXRpYyB0ZXN0Q2lyY2xlTGluZSAoY2lyY2xlLCBwMSwgcDIpIHtcbiAgICAvLyDlhYjjgavnt5rliIbnq6/jgajjga7liKTlrppcbiAgICBpZiAoY2lyY2xlLmNvbnRhaW5zKHAxLngsIHAxLnkpIHx8IGNpcmNsZS5jb250YWlucyhwMi54LCBwMi55KSkgcmV0dXJuIHRydWU7XG4gICAgLy8g5Y2K5b6E44GuMuS5l1xuICAgIHZhciByMiA9IGNpcmNsZS5yYWRpdXMgKiBjaXJjbGUucmFkaXVzO1xuICAgIC8vIOWGhuOBruS4reW/g+W6p+aomVxuICAgIHZhciBwMyA9IG5ldyBWZWN0b3IyKGNpcmNsZS54LCBjaXJjbGUueSk7XG4gICAgLy8g5ZCE44OZ44Kv44OI44OrXG4gICAgdmFyIHAxcDIgPSBWZWN0b3IyLnN1YihwMSwgcDIpO1xuICAgIHZhciBwMXAzID0gVmVjdG9yMi5zdWIocDEsIHAzKTtcbiAgICB2YXIgcDJwMyA9IFZlY3RvcjIuc3ViKHAyLCBwMyk7XG4gICAgLy8g5aSW56mNXG4gICAgdmFyIGNyb3NzID0gVmVjdG9yMi5jcm9zcyhwMXAyLCBwMXAzKTtcbiAgICAvLyDlpJbnqY3jga7ntbblr77lgKTjga4y5LmXXG4gICAgdmFyIGNyb3NzMiA9IGNyb3NzICogY3Jvc3M7XG4gICAgLy8gcDFwMuOBrumVt+OBleOBrjLkuZdcbiAgICB2YXIgbGVuZ3RoMiA9IHAxcDIubGVuZ3RoU3F1YXJlZCgpO1xuICAgIC8vIOWGhuOBruS4reW/g+OBi+OCiee3muWIhuOBvuOBp+OBruWegue3muOBrui3nembouOBrjLkuZdcbiAgICB2YXIgZDIgPSBjcm9zczIgLyBsZW5ndGgyO1xuICAgIC8vIOWGhuOBruWNiuW+hOOBrjLkuZfjgojjgorlsI/jgZXjgYTjgarjgonph43opIdcbiAgICBpZiAoZDIgPD0gcjIpIHtcbiAgICAgIHZhciBkb3QxID0gVmVjdG9yMi5kb3QocDFwMywgcDFwMik7XG4gICAgICB2YXIgZG90MiA9IFZlY3RvcjIuZG90KHAycDMsIHAxcDIpO1xuICAgICAgLy8g6YCa5bi444Gv5YaF56mN44Gu5LmX566XXG4gICAgICBpZiAoZG90MSAqIGRvdDIgPD0gMCkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICAvKipcbiAgICogQG1ldGhvZCB0ZXN0TGluZUxpbmVcbiAgICogQHN0YXRpY1xuICAgKiAy44Gk44Gu57ea5YiG44GM6YeN44Gq44Gj44Gm44GE44KL44GL44Gp44GG44GL44KS5Yik5a6a44GX44G+44GZXG4gICAqIOWPguiAg++8mmh0dHA6Ly93d3c1ZC5iaWdsb2JlLm5lLmpwL350b21veWEwMy9zaHRtbC9hbGdvcml0aG0vSW50ZXJzZWN0aW9uLmh0bVxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgcDEgPSBwaGluYS5nZW9tLlZlY3RvcjIoMTAwLCAxMDApO1xuICAgKiAgICAgcDIgPSBwaGluYS5nZW9tLlZlY3RvcjIoMjAwLCAyMDApO1xuICAgKiAgICAgcDMgPSBwaGluYS5nZW9tLlZlY3RvcjIoMTUwLCAyNDApO1xuICAgKiAgICAgcDQgPSBwaGluYS5nZW9tLlZlY3RvcjIoMjAwLCAxMDApO1xuICAgKiBwaGluYS5nZW9tLkNvbGxpc2lvbi50ZXN0TGluZUxpbmUocDEsIHAyLCBwMywgcDQpOyAvLyA9PiB0cnVlXG4gICAqXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi92ZWN0b3IyXCIpLlByaW1pdGl2ZVZlY3RvcjJ9IHAxIOe3muWIhjHjga7nq6/jga7luqfmqJlcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuL3ZlY3RvcjJcIikuUHJpbWl0aXZlVmVjdG9yMn0gcDIg57ea5YiGMeOBruerr+OBruW6p+aomVxuICAgKiBAcGFyYW0ge2ltcG9ydChcIi4vdmVjdG9yMlwiKS5QcmltaXRpdmVWZWN0b3IyfSBwMyDnt5rliIYy44Gu56uv44Gu5bqn5qiZXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi92ZWN0b3IyXCIpLlByaW1pdGl2ZVZlY3RvcjJ9IHA0IOe3muWIhjLjga7nq6/jga7luqfmqJlcbiAgICogQHJldHVybiB7Qm9vbGVhbn0g57ea5YiGMeOBqOe3muWIhjLjgYzph43jgarjgaPjgabjgYTjgovjgYvjganjgYbjgYtcbiAgICovXG4gIHN0YXRpYyB0ZXN0TGluZUxpbmUgKHAxLCBwMiwgcDMsIHA0KSB7XG4gICAgLy/lkIzkuIDvvLjvvLnou7jkuIrjgavkuZfjgaPjgabjgovloLTlkIjjga7oqqTliKTlrprlm57pgb9cbiAgICBpZiAocDEueCA9PSBwMi54ICYmIHAxLnggPT0gcDMueCAmJiBwMS54ID09IHA0LngpIHtcbiAgICAgIHZhciBtaW4gPSBNYXRoLm1pbihwMS55LCBwMi55KTtcbiAgICAgIHZhciBtYXggPSBNYXRoLm1heChwMS55LCBwMi55KTtcbiAgICAgIGlmIChtaW4gPD0gcDMueSAmJiBwMy55IDw9IG1heCB8fCBtaW4gPD0gcDQueSAmJiBwNC55IDw9IG1heCkgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChwMS55ID09IHAyLnkgJiYgcDEueSA9PSBwMy55ICYmIHAxLnkgPT0gcDQueSkge1xuICAgICAgdmFyIG1pbiA9IE1hdGgubWluKHAxLngsIHAyLngpO1xuICAgICAgdmFyIG1heCA9IE1hdGgubWF4KHAxLngsIHAyLngpO1xuICAgICAgaWYgKG1pbiA8PSBwMy54ICYmIHAzLnggPD0gbWF4IHx8IG1pbiA8PSBwNC54ICYmIHA0LnggPD0gbWF4KSByZXR1cm4gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy/pgJrluLjliKTlrppcbiAgICB2YXIgYSA9IChwMS54IC0gcDIueCkgKiAocDMueSAtIHAxLnkpICsgKHAxLnkgLSBwMi55KSAqIChwMS54IC0gcDMueCk7XG4gICAgdmFyIGIgPSAocDEueCAtIHAyLngpICogKHA0LnkgLSBwMS55KSArIChwMS55IC0gcDIueSkgKiAocDEueCAtIHA0LngpO1xuICAgIHZhciBjID0gKHAzLnggLSBwNC54KSAqIChwMS55IC0gcDMueSkgKyAocDMueSAtIHA0LnkpICogKHAzLnggLSBwMS54KTtcbiAgICB2YXIgZCA9IChwMy54IC0gcDQueCkgKiAocDIueSAtIHAzLnkpICsgKHAzLnkgLSBwNC55KSAqIChwMy54IC0gcDIueCk7XG4gICAgcmV0dXJuIGEgKiBiIDw9IDAgJiYgYyAqIGQgPD0gMDtcbiAgfVxuICAvKipcbiAgICogQG1ldGhvZCB0ZXN0UmVjdExpbmVcbiAgICogQHN0YXRpY1xuICAgKiDnn6nlvaLjgajnt5rliIbjgYzph43jgarjgaPjgabjgYTjgovjgYvjganjgYbjgYvjgpLliKTlrprjgZfjgb7jgZlcbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogICAgIHJlY3QgPSBwaGluYS5nZW9tLlJlY3QoMTIwLCAxMzAsIDQwLCA1MCk7XG4gICAqICAgICBwMSA9IHBoaW5hLmdlb20uVmVjdG9yMigxMDAsIDEwMCk7XG4gICAqICAgICBwMiA9IHBoaW5hLmdlb20uVmVjdG9yMigyMDAsIDIwMCk7XG4gICAqIHBoaW5hLmdlb20uQ29sbGlzaW9uLnRlc3RSZWN0TGluZShyZWN0LCBwMSwgcDIpOyAvLyA9PiB0cnVlXG4gICAqXG4gICAqIEBwYXJhbSB7UmVjdH0gcmVjdCDnn6nlvaLpoJjln5/jgqrjg5bjgrjjgqfjgq/jg4hcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuL3ZlY3RvcjJcIikuUHJpbWl0aXZlVmVjdG9yMn0gcDEg57ea5YiG44Gu56uv44Gu5bqn5qiZXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi92ZWN0b3IyXCIpLlByaW1pdGl2ZVZlY3RvcjJ9IHAyIOe3muWIhuOBruerr+OBruW6p+aomVxuICAgKiBAcmV0dXJuIHtCb29sZWFufSDnn6nlvaLjgajnt5rliIbjgYzph43jgarjgaPjgabjgYTjgovjgYvjganjgYbjgYtcbiAgICovXG4gIHN0YXRpYyB0ZXN0UmVjdExpbmUgKHJlY3QsIHAxLCBwMikge1xuICAgICAgLy/ljIXlkKvliKTlrpoocDHjgYzlkKvjgb7jgozjgabjgozjgbDoia/jgYTjga7jgadwMuOBruWIpOWumuOBr+OBl+OBquOBhO+8iVxuICAgICAgaWYgKHJlY3QubGVmdCA8PSBwMS54ICYmIHAxLnggPD0gcmVjdC5yaWdodCAmJiByZWN0LnRvcCA8PSBwMS55ICYmIHAxLnkgPD0gcmVjdC5ib3R0b20gKSByZXR1cm4gdHJ1ZTtcblxuICAgICAgLy/nn6nlvaLjga7vvJTngrlcbiAgICAgIHZhciByMSA9IG5ldyBWZWN0b3IyKHJlY3QubGVmdCwgcmVjdC50b3ApOyAgICAgLy/lt6bkuIpcbiAgICAgIHZhciByMiA9IG5ldyBWZWN0b3IyKHJlY3QucmlnaHQsIHJlY3QudG9wKTsgICAgLy/lj7PkuIpcbiAgICAgIHZhciByMyA9IG5ldyBWZWN0b3IyKHJlY3QucmlnaHQsIHJlY3QuYm90dG9tKTsgLy/lj7PkuItcbiAgICAgIHZhciByNCA9IG5ldyBWZWN0b3IyKHJlY3QubGVmdCwgcmVjdC5ib3R0b20pOyAgLy/lt6bkuItcblxuICAgICAgLy/nn6nlvaLjga7vvJTovrrjgpLjgarjgZnnt5rliIbjgajjga7mjqXop6bliKTlrppcbiAgICAgIGlmIChDb2xsaXNpb24udGVzdExpbmVMaW5lKHAxLCBwMiwgcjEsIHIyKSkgcmV0dXJuIHRydWU7XG4gICAgICBpZiAoQ29sbGlzaW9uLnRlc3RMaW5lTGluZShwMSwgcDIsIHIyLCByMykpIHJldHVybiB0cnVlO1xuICAgICAgaWYgKENvbGxpc2lvbi50ZXN0TGluZUxpbmUocDEsIHAyLCByMywgcjQpKSByZXR1cm4gdHJ1ZTtcbiAgICAgIGlmIChDb2xsaXNpb24udGVzdExpbmVMaW5lKHAxLCBwMiwgcjEsIHI0KSkgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxufVxuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5nZW9tLlZlY3RvcjNcbiAqICMgM+asoeWFg+ODmeOCr+ODiOODq+OCr+ODqeOCue+8iOacquWun+ijhe+8iVxuICogM+asoeWFg+OBruODmeOCr+ODiOODq+OChOW6p+aomeOCkuihqOOBmeOCr+ODqeOCueOBp+OBmeOAglxuICovXG5jbGFzcyBWZWN0b3IzIHtcblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IFt4PTBdXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbeT0wXVxuICAgKiBAcGFyYW0ge251bWJlcn0gW3o9MF1cbiAgICovXG4gIGNvbnN0cnVjdG9yKHgsIHksIHopIHtcbiAgICAvKipcbiAgICAgKiB45bqn5qiZXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLnggPSB4IHx8IDA7XG5cbiAgICAvKipcbiAgICAgKiB55bqn5qiZXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLnkgPSB5IHx8IDA7XG5cbiAgICAvKipcbiAgICAgKiB65bqn5qiZXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLnogPSB6IHx8IDA7XG5cbiAgICAvKipcbiAgICAgKiB66Lu45Zue6Lui6KeS5bqmXG4gICAgICovXG4gICAgdGhpcy5hbHBoYSA9IDA7XG5cbiAgICAvKipcbiAgICAgKiB46Lu45Zue6Lui6KeS5bqmXG4gICAgICovXG4gICAgdGhpcy5iZXRhID0gMDtcblxuICAgIC8qKlxuICAgICAqIHnou7jlm57ou6Lop5LluqZcbiAgICAgKi9cbiAgICB0aGlzLmdhbW1hID0gMDtcbiAgfVxuXG59XG5cbi8qKlxuICogQ2FudmFz44GuZmlsbHN0eWxlL3N0cm9rZVN0eWxl44Gu5YCk44Go44GX44Gm5L2/55So44Gn44GN44KL5Z6L44CC5paH5a2X5YiX44Gu5aC05ZCI44CBQ1NTIGNvbG9y44OH44O844K/5Z6L44Gr5rqW5oug44GZ44KL44KC44GuXG4gKiBAdHlwZWRlZiB7c3RyaW5nIHwgQ2FudmFzR3JhZGllbnQgfCBDYW52YXNQYXR0ZXJufSBDYW52YXNTdHlsZVxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmdyYXBoaWNzLkNhbnZhc1xuICog44Kt44Oj44Oz44OQ44K55ouh5by144Kv44Op44K5XG4gKi9cbmNsYXNzIENhbnZhcyB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nIHwgSFRNTENhbnZhc0VsZW1lbnR9IFtjYW52YXNdIOODmeODvOOCueOBqOOBquOCi2NhbnZhc+imgee0oOOAguaWh+Wtl+WIl+OBp+aMh+WumuOBmeOCi+OBqOOBjeOBr2AjcGhpbmFg44Gu44KI44GG44Gr44K744Os44Kv44K/5b2i5byP44Gr44GZ44KL44CC5oyH5a6a44GX44Gq44GL44Gj44Gf5aC05ZCI44Gv5paw6KaP5L2c5oiQ44GV44KM44KLXG4gICAqL1xuICBjb25zdHJ1Y3RvcihjYW52YXMpIHtcbiAgICAvKiogQHR5cGUgSFRNTENhbnZhc0VsZW1lbnQgKi9cbiAgICB0aGlzLmNhbnZhcztcbiAgICBpZiAodHlwZW9mIGNhbnZhcyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjYW52YXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcyB8fCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICB9XG5cbiAgICAvKiogQHR5cGUgSFRNTENhbnZhc0VsZW1lbnQgKi9cbiAgICB0aGlzLmRvbUVsZW1lbnQgPSB0aGlzLmNhbnZhcztcblxuICAgIC8qKiBAdHlwZSBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQgKi9cbiAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHRoaXMuY29udGV4dC5saW5lQ2FwID0gJ3JvdW5kJztcbiAgICB0aGlzLmNvbnRleHQubGluZUpvaW4gPSAncm91bmQnO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCteOCpOOCuuOCkuOCu+ODg+ODiFxuICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGhcbiAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldFNpemUod2lkdGgsIGhlaWdodCkge1xuICAgIHRoaXMuY2FudmFzLndpZHRoICAgPSB3aWR0aDtcbiAgICB0aGlzLmNhbnZhcy5oZWlnaHQgID0gaGVpZ2h0O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCteOCpOOCuuOCkueUu+mdou+8iOOCpuOCo+ODs+ODieOCpuOCteOCpOOCuu+8ieOBq+WQiOOCj+OBm+OBpuODquOCu+ODg+ODiFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldFNpemVUb1NjcmVlbigpIHtcbiAgICB0aGlzLmNhbnZhcy5zdHlsZS5wb3NpdGlvbiAgPSBcImZpeGVkXCI7XG4gICAgdGhpcy5jYW52YXMuc3R5bGUubWFyZ2luICAgID0gXCIwcHhcIjtcbiAgICB0aGlzLmNhbnZhcy5zdHlsZS5wYWRkaW5nICAgPSBcIjBweFwiO1xuICAgIHRoaXMuY2FudmFzLnN0eWxlLmxlZnQgICAgICA9IFwiMHB4XCI7XG4gICAgdGhpcy5jYW52YXMuc3R5bGUudG9wICAgICAgID0gXCIwcHhcIjtcbiAgICByZXR1cm4gdGhpcy5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOavlOeOh+OCkue2reaMgeOBl+OBquOBjOOCieOCteOCpOOCuuOCkueUu+mdou+8iOOCpuOCo+ODs+ODieOCpuOCteOCpOOCuu+8ieOBq+WQiOOCj+OBm+OCi1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc0V2ZXI9dHJ1ZV0g44Km44Kj44Oz44OJ44Km44Oq44K144Kk44K644Gn5aSJ5pu044GM5b+F6KaB44Gr44Gq44KL44Gf44Gz44Gr44Oq44K144Kk44K65Yem55CG44KS44GZ44KL44GL44Gp44GG44GLXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgZml0U2NyZWVuKGlzRXZlcikge1xuICAgIGlzRXZlciA9IGlzRXZlciA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGlzRXZlcjtcblxuICAgIHZhciBfZml0RnVuYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGUgPSB0aGlzLmRvbUVsZW1lbnQ7XG4gICAgICB2YXIgcyA9IGUuc3R5bGU7XG4gICAgICBcbiAgICAgIHMucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgICBzLm1hcmdpbiA9IFwiYXV0b1wiO1xuICAgICAgcy5sZWZ0ID0gXCIwcHhcIjtcbiAgICAgIHMudG9wICA9IFwiMHB4XCI7XG4gICAgICBzLmJvdHRvbSA9IFwiMHB4XCI7XG4gICAgICBzLnJpZ2h0ID0gXCIwcHhcIjtcblxuICAgICAgdmFyIHJhdGVXaWR0aCA9IGUud2lkdGgvd2luZG93LmlubmVyV2lkdGg7XG4gICAgICB2YXIgcmF0ZUhlaWdodD0gZS5oZWlnaHQvd2luZG93LmlubmVySGVpZ2h0O1xuICAgICAgdmFyIHJhdGUgPSBlLmhlaWdodC9lLndpZHRoO1xuICAgICAgXG4gICAgICBpZiAocmF0ZVdpZHRoID4gcmF0ZUhlaWdodCkge1xuICAgICAgICBzLndpZHRoICA9IE1hdGguZmxvb3IoaW5uZXJXaWR0aCkrXCJweFwiO1xuICAgICAgICBzLmhlaWdodCA9IE1hdGguZmxvb3IoaW5uZXJXaWR0aCpyYXRlKStcInB4XCI7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgcy53aWR0aCAgPSBNYXRoLmZsb29yKGlubmVySGVpZ2h0L3JhdGUpK1wicHhcIjtcbiAgICAgICAgcy5oZWlnaHQgPSBNYXRoLmZsb29yKGlubmVySGVpZ2h0KStcInB4XCI7XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpO1xuICAgIFxuICAgIC8vIOS4gOW6puWun+ihjOOBl+OBpuOBiuOBj1xuICAgIF9maXRGdW5jKCk7XG5cbiAgICAvLyDjg6rjgrXjgqTjgrrmmYLjga7jg6rjgrnjg4rjgajjgZfjgabnmbvpjLLjgZfjgabjgYrjgY9cbiAgICBpZiAoaXNFdmVyKSB7XG4gICAgICBwaGluYS5nbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBfZml0RnVuYywgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDjgq/jg6rjgqJcbiAgICogQHBhcmFtIHtudW1iZXJ9IFt4PTBdXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbeT0wXVxuICAgKiBAcGFyYW0ge251bWJlcn0gW3dpZHRoXVxuICAgKiBAcGFyYW0ge251bWJlcn0gW2hlaWdodF1cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBjbGVhcih4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgeCA9IHggfHwgMDtcbiAgICB5ID0geSB8fCAwO1xuICAgIHdpZHRoID0gd2lkdGggfHwgdGhpcy53aWR0aDtcbiAgICBoZWlnaHQ9IGhlaWdodHx8IHRoaXMuaGVpZ2h0O1xuICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtDYW52YXNTdHlsZX0gZmlsbFN0eWxlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbeF1cbiAgICogQHBhcmFtIHtudW1iZXJ9IFt5XVxuICAgKiBAcGFyYW0ge251bWJlcn0gW3dpZHRoXVxuICAgKiBAcGFyYW0ge251bWJlcn0gW2hlaWdodF1cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBjbGVhckNvbG9yKGZpbGxTdHlsZSwgeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgIHggPSB4IHx8IDA7XG4gICAgeSA9IHkgfHwgMDtcbiAgICB3aWR0aCA9IHdpZHRoIHx8IHRoaXMud2lkdGg7XG4gICAgaGVpZ2h0PSBoZWlnaHR8fCB0aGlzLmhlaWdodDtcblxuICAgIHZhciBjb250ZXh0ID0gdGhpcy5jb250ZXh0O1xuXG4gICAgY29udGV4dC5zYXZlKCk7XG4gICAgY29udGV4dC5zZXRUcmFuc2Zvcm0oMS4wLCAwLjAsIDAuMCwgMS4wLCAwLjAsIDAuMCk7IC8vIOihjOWIl+WIneacn+WMllxuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gZmlsbFN0eWxlOyAgICAgLy8g5aGX44KK44Gk44G244GX44K544K/44Kk44Or44K744OD44OIXG4gICAgY29udGV4dC5maWxsUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICBjb250ZXh0LnJlc3RvcmUoKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cblxuICAvKipcbiAgICog44OR44K544KS6ZaL5aeLKOODquOCu+ODg+ODiClcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBiZWdpblBhdGgoKSB7XG4gICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOODkeOCueOCkumWieOBmOOCi1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGNsb3NlUGF0aCgpIHtcbiAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuXG4gIC8qKlxuICAgKiDmlrDopo/jg5HjgrnnlJ/miJBcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBtb3ZlVG8oeCwgeSkge1xuICAgIHRoaXMuY29udGV4dC5tb3ZlVG8oeCwgeSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44OR44K544Gr6L+95YqgXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgbGluZVRvKHgsIHkpIHtcbiAgICB0aGlzLmNvbnRleHQubGluZVRvKHgsIHkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHF1YWRyYXRpY0N1cnZlVG8oKSB7XG4gICAgdGhpcy5jb250ZXh0LnF1YWRyYXRpY0N1cnZlVG8uYXBwbHkodGhpcy5jb250ZXh0LCBhcmd1bWVudHMpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGJlemllckN1cnZlVG8oKSB7XG4gICAgdGhpcy5jb250ZXh0LmJlemllckN1cnZlVG8uYXBwbHkodGhpcy5jb250ZXh0LCBhcmd1bWVudHMpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOODkeOCueWGheOCkuWhl+OCiuOBpOOBtuOBmVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGZpbGwoKSB7XG4gICAgdGhpcy5jb250ZXh0LmZpbGwoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjg5HjgrnkuIrjgavjg6njgqTjg7PjgpLlvJXjgY9cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzdHJva2UoKSB7XG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCr+ODquODg+ODl1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGNsaXAoKSB7XG4gICAgdGhpcy5jb250ZXh0LmNsaXAoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gICAgICBcbiAgLyoqXG4gICAqIOeCueaPj+eUu1xuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGRyYXdQb2ludCh4LCB5KSB7XG4gICAgcmV0dXJuIHRoaXMuc3Ryb2tlUmVjdCh4LCB5LCAxLCAxKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDjg6njgqTjg7Pjg5HjgrnjgpLkvZzmiJBcbiAgICogQHBhcmFtIHtudW1iZXJ9IHgwXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5MFxuICAgKiBAcGFyYW0ge251bWJlcn0geDFcbiAgICogQHBhcmFtIHtudW1iZXJ9IHkxXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgbGluZSh4MCwgeTAsIHgxLCB5MSkge1xuICAgIHJldHVybiB0aGlzLm1vdmVUbyh4MCwgeTApLmxpbmVUbyh4MSwgeTEpO1xuICB9XG4gIFxuICAvKipcbiAgICog44Op44Kk44Oz44KS5o+P55S7XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4MFxuICAgKiBAcGFyYW0ge251bWJlcn0geTBcbiAgICogQHBhcmFtIHtudW1iZXJ9IHgxXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5MVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGRyYXdMaW5lKHgwLCB5MCwgeDEsIHkxKSB7XG4gICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkubGluZSh4MCwgeTAsIHgxLCB5MSkuc3Ryb2tlKCk7XG4gIH1cblxuICAvKipcbiAgICog44OA44OD44K344Ol44Op44Kk44Oz44KS5o+P55S7XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4MFxuICAgKiBAcGFyYW0ge251bWJlcn0geTBcbiAgICogQHBhcmFtIHtudW1iZXJ9IHgxXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5MVxuICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IHBhdHRlcm5cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBkcmF3RGFzaExpbmUoeDAsIHkwLCB4MSwgeTEsIHBhdHRlcm4pIHtcbiAgICB2YXIgcGF0dGVyblRhYmxlID0gbnVsbDtcbiAgICBpZiAodHlwZW9mKHBhdHRlcm4pID09IFwic3RyaW5nXCIpIHtcbiAgICAgIHBhdHRlcm5UYWJsZSA9IHBhdHRlcm47XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgcGF0dGVybiA9IHBhdHRlcm4gfHwgMHhmMGYwO1xuICAgICAgcGF0dGVyblRhYmxlID0gcGF0dGVybi50b1N0cmluZygyKTtcbiAgICB9XG4gICAgLy8gcGF0dGVyblRhYmxlID0gcGF0dGVyblRhYmxlLnBhZGRpbmcoMTYsICcxJyk7XG4gICAgcGF0dGVyblRhYmxlID0gcGFkZGluZy5jYWxsKHBhdHRlcm5UYWJsZSwgMTYsICcxJyk7XG4gICAgXG4gICAgdmFyIHZ4ID0geDEteDA7XG4gICAgdmFyIHZ5ID0geTEteTA7XG4gICAgdmFyIGxlbiA9IE1hdGguc3FydCh2eCp2eCArIHZ5KnZ5KTtcbiAgICB2eC89bGVuOyB2eS89bGVuO1xuICAgIFxuICAgIHZhciB4ID0geDA7XG4gICAgdmFyIHkgPSB5MDtcbiAgICBmb3IgKHZhciBpPTA7IGk8bGVuOyArK2kpIHtcbiAgICAgIGlmIChwYXR0ZXJuVGFibGVbaSUxNl0gPT0gJzEnKSB7XG4gICAgICAgIHRoaXMuZHJhd1BvaW50KHgsIHkpO1xuICAgICAgICAvLyB0aGlzLmZpbGxSZWN0KHgsIHksIHRoaXMuY29udGV4dC5saW5lV2lkdGgsIHRoaXMuY29udGV4dC5saW5lV2lkdGgpO1xuICAgICAgfVxuICAgICAgeCArPSB2eDtcbiAgICAgIHkgKz0gdnk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIHYwKHgwLCB5MCksIHYxKHgxLCB5MSkg44GL44KJ6KeS5bqm44KS5rGC44KB44Gm55+i5Y2w44KS5o+P55S7XG4gICAqIGh0dHA6Ly9oYWt1aGluLmpwL2FzL3JvdGF0aW9uLmh0bWxcbiAgICogQHBhcmFtIHtudW1iZXJ9IHgwXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5MFxuICAgKiBAcGFyYW0ge251bWJlcn0geDFcbiAgICogQHBhcmFtIHtudW1iZXJ9IHkxXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBhcnJvd1JhZGl1c1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGRyYXdBcnJvdyh4MCwgeTAsIHgxLCB5MSwgYXJyb3dSYWRpdXMpIHtcbiAgICB2YXIgdnggPSB4MS14MDtcbiAgICB2YXIgdnkgPSB5MS15MDtcbiAgICB2YXIgYW5nbGUgPSBNYXRoLmF0YW4yKHZ5LCB2eCkqMTgwL01hdGguUEk7XG4gICAgXG4gICAgdGhpcy5kcmF3TGluZSh4MCwgeTAsIHgxLCB5MSk7XG4gICAgdGhpcy5maWxsUG9seWdvbih4MSwgeTEsIGFycm93UmFkaXVzIHx8IDUsIDMsIGFuZ2xlKTtcbiAgICBcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG5cbiAgLyoqXG4gICAqIGxpbmVzXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgbGluZXMoKSB7XG4gICAgdGhpcy5tb3ZlVG8oYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0pO1xuICAgIGZvciAodmFyIGk9MSxsZW49YXJndW1lbnRzLmxlbmd0aC8yOyBpPGxlbjsgKytpKSB7XG4gICAgICB0aGlzLmxpbmVUbyhhcmd1bWVudHNbaSoyXSwgYXJndW1lbnRzW2kqMisxXSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOODqeOCpOODs+OCueODiOODreODvOOCr+aPj+eUu1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHN0cm9rZUxpbmVzKCkge1xuICAgIHRoaXMuYmVnaW5QYXRoKCk7XG4gICAgdGhpcy5saW5lcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHRoaXMuc3Ryb2tlKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Op44Kk44Oz5aGX44KK44Gk44G244GX5o+P55S7XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZmlsbExpbmVzKCkge1xuICAgIHRoaXMuYmVnaW5QYXRoKCk7XG4gICAgdGhpcy5saW5lcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHRoaXMuZmlsbCgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICog5Zub6KeS5b2i44OR44K544KS5L2c5oiQ44GZ44KLXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBfeFxuICAgKiBAcGFyYW0ge251bWJlcn0gX3lcbiAgICogQHBhcmFtIHtudW1iZXJ9IF93aWR0aFxuICAgKiBAcGFyYW0ge251bWJlcn0gX2hlaWdodFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHJlY3QoX3gsIF95LCBfd2lkdGgsIF9oZWlnaHQpIHtcbiAgICB0aGlzLmNvbnRleHQucmVjdC5hcHBseSh0aGlzLmNvbnRleHQsIGFyZ3VtZW50cyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDlm5vop5LlvaLloZfjgorjgaTjgbbjgZfmj4/nlLtcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBmaWxsUmVjdCgpIHtcbiAgICB0aGlzLmNvbnRleHQuZmlsbFJlY3QuYXBwbHkodGhpcy5jb250ZXh0LCBhcmd1bWVudHMpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICog5Zub6KeS5b2i44Op44Kk44Oz5o+P55S7XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc3Ryb2tlUmVjdCgpIHtcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlUmVjdC5hcHBseSh0aGlzLmNvbnRleHQsIGFyZ3VtZW50cyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDop5LkuLjlm5vop5LlvaLjg5HjgrlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHRcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJhZGl1c1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHJvdW5kUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0LCByYWRpdXMpIHtcbiAgICB2YXIgbCA9IHggKyByYWRpdXM7XG4gICAgdmFyIHIgPSB4ICsgd2lkdGggLSByYWRpdXM7XG4gICAgdmFyIHQgPSB5ICsgcmFkaXVzO1xuICAgIHZhciBiID0geSArIGhlaWdodCAtIHJhZGl1cztcbiAgICBcbiAgICAvKlxuICAgIHZhciBjdHggPSB0aGlzLmNvbnRleHQ7XG4gICAgY3R4Lm1vdmVUbyhsLCB5KTtcbiAgICBjdHgubGluZVRvKHIsIHkpO1xuICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKHgrd2lkdGgsIHksIHgrd2lkdGgsIHQpO1xuICAgIGN0eC5saW5lVG8oeCt3aWR0aCwgYik7XG4gICAgY3R4LnF1YWRyYXRpY0N1cnZlVG8oeCt3aWR0aCwgeStoZWlnaHQsIHIsIHkraGVpZ2h0KTtcbiAgICBjdHgubGluZVRvKGwsIHkraGVpZ2h0KTtcbiAgICBjdHgucXVhZHJhdGljQ3VydmVUbyh4LCB5K2hlaWdodCwgeCwgYik7XG4gICAgY3R4LmxpbmVUbyh4LCB0KTtcbiAgICBjdHgucXVhZHJhdGljQ3VydmVUbyh4LCB5LCBsLCB5KTtcbiAgICAvKiovXG4gICAgXG4gICAgdGhpcy5jb250ZXh0LmFyYyhsLCB0LCByYWRpdXMsICAgICAtTWF0aC5QSSwgLU1hdGguUEkqMC41LCBmYWxzZSk7ICAvLyDlt6bkuIpcbiAgICB0aGlzLmNvbnRleHQuYXJjKHIsIHQsIHJhZGl1cywgLU1hdGguUEkqMC41LCAgICAgICAgICAgIDAsIGZhbHNlKTsgIC8vIOWPs+S4ilxuICAgIHRoaXMuY29udGV4dC5hcmMociwgYiwgcmFkaXVzLCAgICAgICAgICAgIDAsICBNYXRoLlBJKjAuNSwgZmFsc2UpOyAgLy8g5Y+z5LiLXG4gICAgdGhpcy5jb250ZXh0LmFyYyhsLCBiLCByYWRpdXMsICBNYXRoLlBJKjAuNSwgICAgICBNYXRoLlBJLCBmYWxzZSk7ICAvLyDlt6bkuItcbiAgICB0aGlzLmNsb3NlUGF0aCgpO1xuICAgIFxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOinkuS4uOWbm+inkuW9ouWhl+OCiuOBpOOBtuOBl1xuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGhcbiAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodFxuICAgKiBAcGFyYW0ge251bWJlcn0gcmFkaXVzXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZmlsbFJvdW5kUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0LCByYWRpdXMpIHtcbiAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5yb3VuZFJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCwgcmFkaXVzKS5maWxsKCk7XG4gIH1cblxuICAvKipcbiAgICog6KeS5Li45Zub6KeS5b2i44K544OI44Ot44O844Kv5o+P55S7XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzdHJva2VSb3VuZFJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCwgcmFkaXVzKSB7XG4gICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkucm91bmRSZWN0KHgsIHksIHdpZHRoLCBoZWlnaHQsIHJhZGl1cykuc3Ryb2tlKCk7XG4gIH1cblxuICAvKipcbiAgICog5YaG44Gu44OR44K544KS6Kit5a6aXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBjaXJjbGUoeCwgeSwgcmFkaXVzKSB7XG4gICAgdGhpcy5jb250ZXh0LmFyYyh4LCB5LCByYWRpdXMsIDAsIE1hdGguUEkqMiwgZmFsc2UpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICog5aGX44KK44Gk44G244GX5YaG44KS5o+P55S7XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBmaWxsQ2lyY2xlKHgsIHksIHJhZGl1cykge1xuICAgIHZhciBjID0gdGhpcy5jb250ZXh0O1xuICAgIGMuYmVnaW5QYXRoKCk7XG4gICAgYy5hcmMoeCwgeSwgcmFkaXVzLCAwLCBNYXRoLlBJKjIsIGZhbHNlKTtcbiAgICBjLmNsb3NlUGF0aCgpO1xuICAgIGMuZmlsbCgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICog44K544OI44Ot44O844Kv5YaG44KS5o+P55S7XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzdHJva2VDaXJjbGUoeCwgeSwgcmFkaXVzKSB7XG4gICAgdmFyIGMgPSB0aGlzLmNvbnRleHQ7XG4gICAgYy5iZWdpblBhdGgoKTtcbiAgICBjLmFyYyh4LCB5LCByYWRpdXMsIDAsIE1hdGguUEkqMiwgZmFsc2UpO1xuICAgIGMuY2xvc2VQYXRoKCk7XG4gICAgYy5zdHJva2UoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDlhoblvKfjga7jg5HjgrnjgpLoqK3lrppcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJhZGl1c1xuICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRBbmdsZVxuICAgKiBAcGFyYW0ge251bWJlcn0gZW5kQW5nbGVcbiAgICogQHBhcmFtIHtib29sZWFufSBbYW50aWNsb2Nrd2lzZV1cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBhcmMoeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgYW50aWNsb2Nrd2lzZSkge1xuICAgIHRoaXMuY29udGV4dC5hcmMoeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgYW50aWNsb2Nrd2lzZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDloZfjgorjgaTjgbbjgZflhoblvKfjgpLmj4/nlLtcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJhZGl1c1xuICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRBbmdsZVxuICAgKiBAcGFyYW0ge251bWJlcn0gZW5kQW5nbGVcbiAgICogQHBhcmFtIHtib29sZWFufSBbYW50aWNsb2Nrd2lzZV1cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBmaWxsQXJjKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UpIHtcbiAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5hcmMoeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgYW50aWNsb2Nrd2lzZSkuZmlsbCgpO1xuICB9XG4gIFxuICAvKipcbiAgICog44K544OI44Ot44O844Kv5YaG5byn44KS5o+P55S7XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0QW5nbGVcbiAgICogQHBhcmFtIHtudW1iZXJ9IGVuZEFuZ2xlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2FudGljbG9ja3dpc2VdXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc3Ryb2tlQXJjKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UpIHtcbiAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5hcmMoeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgYW50aWNsb2Nrd2lzZSkuc3Ryb2tlKCk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKiBAcGFyYW0ge251bWJlcn0gcmFkaXVzXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydEFuZ2xlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBlbmRBbmdsZVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFthbnRpY2xvY2t3aXNlXVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHBpZSh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBhbnRpY2xvY2t3aXNlKSB7XG4gICAgdmFyIGNvbnRleHQgPSB0aGlzLmNvbnRleHQ7XG4gICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICBjb250ZXh0Lm1vdmVUbygwLCAwKTtcbiAgICBjb250ZXh0LmFyYyh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBhbnRpY2xvY2t3aXNlKTtcbiAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0QW5nbGVcbiAgICogQHBhcmFtIHtudW1iZXJ9IGVuZEFuZ2xlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2FudGljbG9ja3dpc2VdXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZmlsbFBpZSh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBhbnRpY2xvY2t3aXNlKSB7XG4gICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkucGllKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UpLmZpbGwoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKiBAcGFyYW0ge251bWJlcn0gcmFkaXVzXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydEFuZ2xlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBlbmRBbmdsZVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFthbnRpY2xvY2t3aXNlXVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHN0cm9rZVBpZSh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlLCBhbnRpY2xvY2t3aXNlKSB7XG4gICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkucGllKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UpLnN0cm9rZSgpO1xuICB9XG5cbiAgXG4gIC8qKlxuICAgKiDjg53jg6rjgrTjg7Pjg5HjgrlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNpemVcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNpZGVzXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbb2Zmc2V0QW5nbGVdXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcG9seWdvbih4LCB5LCBzaXplLCBzaWRlcywgb2Zmc2V0QW5nbGUpIHtcbiAgICB2YXIgcmFkRGl2ID0gKE1hdGguUEkqMikvc2lkZXM7XG4gICAgdmFyIHJhZE9mZnNldCA9IChvZmZzZXRBbmdsZSE9PXVuZGVmaW5lZCkgPyBvZmZzZXRBbmdsZSpNYXRoLlBJLzE4MCA6IC1NYXRoLlBJLzI7XG4gICAgXG4gICAgdGhpcy5tb3ZlVG8oeCArIE1hdGguY29zKHJhZE9mZnNldCkqc2l6ZSwgeSArIE1hdGguc2luKHJhZE9mZnNldCkqc2l6ZSk7XG4gICAgZm9yICh2YXIgaT0xOyBpPHNpZGVzOyArK2kpIHtcbiAgICAgIHZhciByYWQgPSByYWREaXYqaStyYWRPZmZzZXQ7XG4gICAgICB0aGlzLmxpbmVUbyhcbiAgICAgICAgeCArIE1hdGguY29zKHJhZCkqc2l6ZSxcbiAgICAgICAgeSArIE1hdGguc2luKHJhZCkqc2l6ZVxuICAgICAgKTtcbiAgICB9XG4gICAgdGhpcy5jbG9zZVBhdGgoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjg53jg6rjgrTjg7PloZfjgorjgaTjgbbjgZdcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJhZGl1c1xuICAgKiBAcGFyYW0ge251bWJlcn0gc2lkZXNcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtvZmZzZXRBbmdsZV1cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBmaWxsUG9seWdvbih4LCB5LCByYWRpdXMsIHNpZGVzLCBvZmZzZXRBbmdsZSkge1xuICAgIHJldHVybiB0aGlzLmJlZ2luUGF0aCgpLnBvbHlnb24oeCwgeSwgcmFkaXVzLCBzaWRlcywgb2Zmc2V0QW5nbGUpLmZpbGwoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDjg53jg6rjgrTjg7Pjgrnjg4jjg63jg7zjgq/mj4/nlLtcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJhZGl1c1xuICAgKiBAcGFyYW0ge251bWJlcn0gc2lkZXNcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtvZmZzZXRBbmdsZV1cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzdHJva2VQb2x5Z29uKHgsIHksIHJhZGl1cywgc2lkZXMsIG9mZnNldEFuZ2xlKSB7XG4gICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkucG9seWdvbih4LCB5LCByYWRpdXMsIHNpZGVzLCBvZmZzZXRBbmdsZSkuc3Ryb2tlKCk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBzdGFyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbeD0wXVxuICAgKiBAcGFyYW0ge251bWJlcn0gW3k9MF1cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtyYWRpdXM9NjRdXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbc2lkZXM9NV1cbiAgICogQHBhcmFtIHthbnl9IFtzaWRlSW5kZW50PTAuMzhdXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbb2Zmc2V0QW5nbGVdXG4gICAqL1xuICBzdGFyKHgsIHksIHJhZGl1cywgc2lkZXMsIHNpZGVJbmRlbnQsIG9mZnNldEFuZ2xlKSB7XG4gICAgeCA9IHggfHwgMDtcbiAgICB5ID0geSB8fCAwO1xuICAgIHJhZGl1cyA9IHJhZGl1cyB8fCA2NDtcbiAgICBzaWRlcyA9IHNpZGVzIHx8IDU7XG4gICAgdmFyIHNpZGVJbmRlbnRSYWRpdXMgPSByYWRpdXMgKiAoc2lkZUluZGVudCB8fCAwLjM4KTtcbiAgICB2YXIgcmFkT2Zmc2V0ID0gKG9mZnNldEFuZ2xlKSA/IG9mZnNldEFuZ2xlKk1hdGguUEkvMTgwIDogLU1hdGguUEkvMjtcbiAgICB2YXIgcmFkRGl2ID0gKE1hdGguUEkqMikvc2lkZXMvMjtcblxuICAgIHRoaXMubW92ZVRvKFxuICAgICAgeCArIE1hdGguY29zKHJhZE9mZnNldCkqcmFkaXVzLFxuICAgICAgeSArIE1hdGguc2luKHJhZE9mZnNldCkqcmFkaXVzXG4gICAgKTtcbiAgICBmb3IgKHZhciBpPTE7IGk8c2lkZXMqMjsgKytpKSB7XG4gICAgICB2YXIgcmFkID0gcmFkRGl2KmkgKyByYWRPZmZzZXQ7XG4gICAgICB2YXIgbGVuID0gKGklMikgPyBzaWRlSW5kZW50UmFkaXVzIDogcmFkaXVzO1xuICAgICAgdGhpcy5saW5lVG8oXG4gICAgICAgIHggKyBNYXRoLmNvcyhyYWQpKmxlbixcbiAgICAgICAgeSArIE1hdGguc2luKHJhZCkqbGVuXG4gICAgICApO1xuICAgIH1cbiAgICB0aGlzLmNsb3NlUGF0aCgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog5pif44KS5aGX44KK44Gk44G244GX5o+P55S7XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbeF1cbiAgICogQHBhcmFtIHtudW1iZXJ9IFt5XVxuICAgKiBAcGFyYW0ge251bWJlcn0gW3JhZGl1c11cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtzaWRlc11cbiAgICogQHBhcmFtIHthbnl9IFtzaWRlSW5kZW50XVxuICAgKiBAcGFyYW0ge251bWJlcn0gW29mZnNldEFuZ2xlXVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGZpbGxTdGFyKHgsIHksIHJhZGl1cywgc2lkZXMsIHNpZGVJbmRlbnQsIG9mZnNldEFuZ2xlKSB7XG4gICAgdGhpcy5iZWdpblBhdGgoKS5zdGFyKHgsIHksIHJhZGl1cywgc2lkZXMsIHNpZGVJbmRlbnQsIG9mZnNldEFuZ2xlKS5maWxsKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog5pif44KS44K544OI44Ot44O844Kv5o+P55S7XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbeF1cbiAgICogQHBhcmFtIHtudW1iZXJ9IFt5XVxuICAgKiBAcGFyYW0ge251bWJlcn0gW3JhZGl1c11cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtzaWRlc11cbiAgICogQHBhcmFtIHthbnl9IFtzaWRlSW5kZW50XVxuICAgKiBAcGFyYW0ge251bWJlcn0gW29mZnNldEFuZ2xlXVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHN0cm9rZVN0YXIoeCwgeSwgcmFkaXVzLCBzaWRlcywgc2lkZUluZGVudCwgb2Zmc2V0QW5nbGUpIHtcbiAgICB0aGlzLmJlZ2luUGF0aCgpLnN0YXIoeCwgeSwgcmFkaXVzLCBzaWRlcywgc2lkZUluZGVudCwgb2Zmc2V0QW5nbGUpLnN0cm9rZSgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIGhlYXJ0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHBhcmFtIHtudW1iZXJ9IGFuZ2xlXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgaGVhcnQoeCwgeSwgcmFkaXVzLCBhbmdsZSkge1xuICAgIHZhciBoYWxmX3JhZGl1cyA9IHJhZGl1cyowLjU7XG4gICAgLy8gdmFyIHJhZCA9IChhbmdsZSA9PT0gdW5kZWZpbmVkKSA/IE1hdGguUEkvNCA6IE1hdGguZGVnVG9SYWQoYW5nbGUpO1xuICAgIHZhciByYWQgPSAoYW5nbGUgPT09IHVuZGVmaW5lZCkgPyBNYXRoLlBJLzQgOiBkZWdUb1JhZChhbmdsZSk7XG5cbiAgICAvLyDljYrlvoQgaGFsZl9yYWRpdXMg44Gu6KeS5bqmIGFuZ2xlIOS4iuOBrueCueOBqOOBruaOpee3muOCkuaxguOCgeOCi1xuICAgIHZhciBwID0gTWF0aC5jb3MocmFkKSpoYWxmX3JhZGl1cztcbiAgICB2YXIgcSA9IE1hdGguc2luKHJhZCkqaGFsZl9yYWRpdXM7XG5cbiAgICAvLyDlhobjga7mjqXnt5rjga7mlrnnqIvlvI8gcHggKyBxeSA9IHJeMiDjgojjgoogeSA9IChyXjItcHgpL3FcbiAgICB2YXIgeDIgPSAtaGFsZl9yYWRpdXM7XG4gICAgdmFyIHkyID0gKGhhbGZfcmFkaXVzKmhhbGZfcmFkaXVzLXAqeDIpL3E7XG5cbiAgICAvLyDkuK3lv4PkvY3nva7oqr/mlbRcbiAgICB2YXIgaGVpZ2h0ID0geTIgKyBoYWxmX3JhZGl1cztcbiAgICB2YXIgb2Zmc2V0WSA9IGhhbGZfcmFkaXVzLWhlaWdodC8yO1xuXG4gICAgLy8g44OR44K544KS44K744OD44OIXG4gICAgdGhpcy5tb3ZlVG8oMCt4LCB5Mit5K29mZnNldFkpO1xuXG4gICAgdGhpcy5hcmMoLWhhbGZfcmFkaXVzK3gsIDAreStvZmZzZXRZLCBoYWxmX3JhZGl1cywgTWF0aC5QSS1yYWQsIE1hdGguUEkqMik7XG4gICAgdGhpcy5hcmMoaGFsZl9yYWRpdXMreCwgMCt5K29mZnNldFksIGhhbGZfcmFkaXVzLCBNYXRoLlBJLCByYWQpO1xuICAgIHRoaXMuY2xvc2VQYXRoKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBmaWxsIGhlYXJ0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHBhcmFtIHtudW1iZXJ9IGFuZ2xlXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZmlsbEhlYXJ0KHgsIHksIHJhZGl1cywgYW5nbGUpIHtcbiAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5oZWFydCh4LCB5LCByYWRpdXMsIGFuZ2xlKS5maWxsKCk7XG4gIH1cblxuICAvKipcbiAgICogc3Ryb2tlIGhlYXJ0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXNcbiAgICogQHBhcmFtIHtudW1iZXJ9IGFuZ2xlXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc3Ryb2tlSGVhcnQoeCwgeSwgcmFkaXVzLCBhbmdsZSkge1xuICAgIHJldHVybiB0aGlzLmJlZ2luUGF0aCgpLmhlYXJ0KHgsIHksIHJhZGl1cywgYW5nbGUpLnN0cm9rZSgpO1xuICB9XG5cbiAvKipcbiAgKiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE0MTY5MjM0L3RoZS1yZWxhdGlvbi1vZi10aGUtYmV6aWVyLWN1cnZlLWFuZC1lbGxpcHNlXG4gICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgKiBAcGFyYW0ge251bWJlcn0geVxuICAqIEBwYXJhbSB7bnVtYmVyfSB3XG4gICogQHBhcmFtIHtudW1iZXJ9IGhcbiAgKiBAcmV0dXJucyB7dGhpc31cbiAgKi9cbiAgZWxsaXBzZSh4LCB5LCB3LCBoKSB7XG4gICAgdmFyIGN0eCA9IHRoaXMuY29udGV4dDtcbiAgICB2YXIga2FwcGEgPSAwLjU1MjI4NDg7XG5cbiAgICB2YXIgb3ggPSAodyAvIDIpICoga2FwcGE7IC8vIGNvbnRyb2wgcG9pbnQgb2Zmc2V0IGhvcml6b250YWxcbiAgICB2YXIgb3kgPSAoaCAvIDIpICoga2FwcGE7IC8vIGNvbnRyb2wgcG9pbnQgb2Zmc2V0IHZlcnRpY2FsXG4gICAgdmFyIHhlID0geCArIHc7ICAgICAgICAgICAvLyB4LWVuZFxuICAgIHZhciB5ZSA9IHkgKyBoOyAgICAgICAgICAgLy8geS1lbmRcbiAgICB2YXIgeG0gPSB4ICsgdyAvIDI7ICAgICAgIC8vIHgtbWlkZGxlXG4gICAgdmFyIHltID0geSArIGggLyAyOyAgICAgICAvLyB5LW1pZGRsZVxuXG4gICAgY3R4Lm1vdmVUbyh4LCB5bSk7XG4gICAgY3R4LmJlemllckN1cnZlVG8oeCwgeW0gLSBveSwgeG0gLSBveCwgeSwgeG0sIHkpO1xuICAgIGN0eC5iZXppZXJDdXJ2ZVRvKHhtICsgb3gsIHksIHhlLCB5bSAtIG95LCB4ZSwgeW0pO1xuICAgIGN0eC5iZXppZXJDdXJ2ZVRvKHhlLCB5bSArIG95LCB4bSArIG94LCB5ZSwgeG0sIHllKTtcbiAgICBjdHguYmV6aWVyQ3VydmVUbyh4bSAtIG94LCB5ZSwgeCwgeW0gKyBveSwgeCwgeW0pO1xuICAgIC8vIGN0eC5jbG9zZVBhdGgoKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZmlsbEVsbGlwc2UoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgIHJldHVybiB0aGlzLmJlZ2luUGF0aCgpLmVsbGlwc2UoeCwgeSwgd2lkdGgsIGhlaWdodCkuZmlsbCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc3Ryb2tlRWxsaXBzZSh4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkuZWxsaXBzZSh4LCB5LCB3aWR0aCwgaGVpZ2h0KS5zdHJva2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBmaWxsVGV4dCgpIHtcbiAgICB0aGlzLmNvbnRleHQuZmlsbFRleHQuYXBwbHkodGhpcy5jb250ZXh0LCBhcmd1bWVudHMpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHN0cm9rZVRleHQoKSB7XG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVRleHQuYXBwbHkodGhpcy5jb250ZXh0LCBhcmd1bWVudHMpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOeUu+WDj+OCkuaPj+eUu1xuICAgKiBAcmV0dXJucyB7dm9pZH0gdGhpc+i/lOOBl+W/mOOCjO+8n1xuICAgKi9cbiAgZHJhd0ltYWdlKCkge1xuICAgIHRoaXMuY29udGV4dC5kcmF3SW1hZ2UuYXBwbHkodGhpcy5jb250ZXh0LCBhcmd1bWVudHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIOihjOWIl+OCkuOCu+ODg+ODiFxuICAgKiBAcGFyYW0ge251bWJlcn0gbTExXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtMTJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG0yMVxuICAgKiBAcGFyYW0ge251bWJlcn0gbTIyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkeFxuICAgKiBAcGFyYW0ge251bWJlcn0gZHlcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRUcmFuc2Zvcm0obTExLCBtMTIsIG0yMSwgbTIyLCBkeCwgZHkpIHtcbiAgICB0aGlzLmNvbnRleHQuc2V0VHJhbnNmb3JtKG0xMSwgbTEyLCBtMjEsIG0yMiwgZHgsIGR5KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDooYzliJfjgpLjg6rjgrvjg4Pjg4hcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICByZXNldFRyYW5zZm9ybSgpIHtcbiAgICB0aGlzLnNldFRyYW5zZm9ybSgxLjAsIDAuMCwgMC4wLCAxLjAsIDAuMCwgMC4wKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgICog5Lit5b+D44Gr56e75YuVXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgdHJhbnNmb3JtQ2VudGVyKCkge1xuICAgIHRoaXMuY29udGV4dC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgdGhpcy53aWR0aC8yLCB0aGlzLmhlaWdodC8yKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDnp7vli5VcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICB0cmFuc2xhdGUoeCwgeSkge1xuICAgIHRoaXMuY29udGV4dC50cmFuc2xhdGUoeCwgeSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDlm57ou6JcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJvdGF0aW9uXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcm90YXRlKHJvdGF0aW9uKSB7XG4gICAgdGhpcy5jb250ZXh0LnJvdGF0ZShyb3RhdGlvbik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDjgrnjgrHjg7zjg6tcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNjYWxlWFxuICAgKiBAcGFyYW0ge251bWJlcn0gc2NhbGVZXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2NhbGUoc2NhbGVYLCBzY2FsZVkpIHtcbiAgICB0aGlzLmNvbnRleHQuc2NhbGUoc2NhbGVYLCBzY2FsZVkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOeKtuaFi+OCkuS/neWtmFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNhdmUoKSB7XG4gICAgdGhpcy5jb250ZXh0LnNhdmUoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDnirbmhYvjgpLlvqnlhYNcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICByZXN0b3JlKCkge1xuICAgIHRoaXMuY29udGV4dC5yZXN0b3JlKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog55S75YOP44Go44GX44Gm5L+d5a2YXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbbWltZV90eXBlPVwiaW1hZ2UvcG5nXCJdXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgc2F2ZUFzSW1hZ2UobWltZV90eXBlKSB7XG4gICAgbWltZV90eXBlID0gbWltZV90eXBlIHx8IFwiaW1hZ2UvcG5nXCI7XG4gICAgdmFyIGRhdGFfdXJsID0gdGhpcy5jYW52YXMudG9EYXRhVVJMKG1pbWVfdHlwZSk7XG4gICAgLy8gZGF0YV91cmwgPSBkYXRhX3VybC5yZXBsYWNlKG1pbWVfdHlwZSwgXCJpbWFnZS9vY3RldC1zdHJlYW1cIik7XG4gICAgd2luZG93Lm9wZW4oZGF0YV91cmwsIFwic2F2ZVwiKTtcbiAgICBcbiAgICAvLyB0b0RhdGFVUkwg44KS5L2/44GI44Gw5LiL6KiY44Gu44KI44GG44Gq44OE44O844Or44GM5L2c44KM44KL44GL44KCISFcbiAgICAvLyBUT0RPOiDjg5fjg63jgrDjg6njg6DjgafntbXjgpLjgYvjgYTjgabkv53lrZjjgafjgY3jgovjg4Tjg7zjg6tcbiAgfVxuXG4gIC8qKlxuICAgKiDluYVcbiAgICovXG4gIGdldCB3aWR0aCgpICAgeyByZXR1cm4gdGhpcy5jYW52YXMud2lkdGg7IH1cbiAgc2V0IHdpZHRoKHYpICB7IHRoaXMuY2FudmFzLndpZHRoID0gdjsgfVxuXG4gIC8qKlxuICAgKiDpq5jjgZVcbiAgICovXG4gIGdldCBoZWlnaHQoKSAgIHsgcmV0dXJuIHRoaXMuY2FudmFzLmhlaWdodDsgfVxuICBzZXQgaGVpZ2h0KHYpICB7IHRoaXMuY2FudmFzLmhlaWdodCA9IHY7IH1cblxuICBnZXQgZmlsbFN0eWxlKCkgICB7IHJldHVybiB0aGlzLmNvbnRleHQuZmlsbFN0eWxlOyB9XG4gIHNldCBmaWxsU3R5bGUodikgIHsgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9IHY7IH1cblxuICBnZXQgc3Ryb2tlU3R5bGUoKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZTsgfVxuICBzZXQgc3Ryb2tlU3R5bGUodikgIHsgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gdjsgfVxuXG4gIGdldCBnbG9iYWxBbHBoYSgpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0Lmdsb2JhbEFscGhhOyB9XG4gIHNldCBnbG9iYWxBbHBoYSh2KSAgeyB0aGlzLmNvbnRleHQuZ2xvYmFsQWxwaGEgPSB2OyB9XG5cbiAgZ2V0IGdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbjsgfVxuICBzZXQgZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uKHYpICB7IHRoaXMuY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSB2OyB9XG5cbiAgZ2V0IHNoYWRvd0JsdXIoKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC5zaGFkb3dCbHVyOyB9XG4gIHNldCBzaGFkb3dCbHVyKHYpICB7IHRoaXMuY29udGV4dC5zaGFkb3dCbHVyID0gdjsgfVxuXG4gIGdldCBzaGFkb3dDb2xvcigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0LnNoYWRvd0NvbG9yOyB9XG4gIHNldCBzaGFkb3dDb2xvcih2KSAgeyB0aGlzLmNvbnRleHQuc2hhZG93Q29sb3IgPSB2OyB9XG5cbiAgZ2V0IHNoYWRvd09mZnNldFgoKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC5zaGFkb3dPZmZzZXRYOyB9XG4gIHNldCBzaGFkb3dPZmZzZXRYKHYpICB7IHRoaXMuY29udGV4dC5zaGFkb3dPZmZzZXRYID0gdjsgfVxuXG4gIGdldCBzaGFkb3dPZmZzZXRZKCkgICB7IHJldHVybiB0aGlzLmNvbnRleHQuc2hhZG93T2Zmc2V0WTsgfVxuICBzZXQgc2hhZG93T2Zmc2V0WSh2KSAgeyB0aGlzLmNvbnRleHQuc2hhZG93T2Zmc2V0WSA9IHY7IH1cblxuICBnZXQgbGluZUNhcCgpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0LmxpbmVDYXA7IH1cbiAgc2V0IGxpbmVDYXAodikgIHsgdGhpcy5jb250ZXh0LmxpbmVDYXAgPSB2OyB9XG5cbiAgZ2V0IGxpbmVKb2luKCkgICB7IHJldHVybiB0aGlzLmNvbnRleHQubGluZUpvaW47IH1cbiAgc2V0IGxpbmVKb2luKHYpICB7IHRoaXMuY29udGV4dC5saW5lSm9pbiA9IHY7IH1cblxuICBnZXQgbWl0ZXJMaW1pdCgpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0Lm1pdGVyTGltaXQ7IH1cbiAgc2V0IG1pdGVyTGltaXQodikgIHsgdGhpcy5jb250ZXh0Lm1pdGVyTGltaXQgPSB2OyB9XG5cbiAgZ2V0IGxpbmVXaWR0aCgpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0LmxpbmVXaWR0aDsgfVxuICBzZXQgbGluZVdpZHRoKHYpICB7IHRoaXMuY29udGV4dC5saW5lV2lkdGggPSB2OyB9XG5cbiAgZ2V0IGZvbnQoKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC5mb250OyB9XG4gIHNldCBmb250KHYpICB7IHRoaXMuY29udGV4dC5mb250ID0gdjsgfVxuXG4gIGdldCB0ZXh0QWxpZ24oKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC50ZXh0QWxpZ247IH1cbiAgc2V0IHRleHRBbGlnbih2KSAgeyB0aGlzLmNvbnRleHQudGV4dEFsaWduID0gdjsgfVxuXG4gIGdldCB0ZXh0QmFzZWxpbmUoKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC50ZXh0QmFzZWxpbmU7IH1cbiAgc2V0IHRleHRCYXNlbGluZSh2KSAgeyB0aGlzLmNvbnRleHQudGV4dEJhc2VsaW5lID0gdjsgfVxuXG4gIGdldCBpbWFnZVNtb290aGluZ0VuYWJsZWQoKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC5pbWFnZVNtb290aGluZ0VuYWJsZWQ7IH1cbiAgc2V0IGltYWdlU21vb3RoaW5nRW5hYmxlZCh2KSAge1xuICAgIHRoaXMuY29udGV4dC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSB2O1xuICAgIHRoaXMuY29udGV4dFsnd2Via2l0SW1hZ2VTbW9vdGhpbmdFbmFibGVkJ10gPSB2O1xuICAgIHRoaXMuY29udGV4dFsnbW96SW1hZ2VTbW9vdGhpbmdFbmFibGVkJ10gPSB2O1xuICB9XG5cbiAgLyoqXG4gICAqIOODhuOCreOCueODiOOBrumVt+OBleOCkuioiOa4rFxuICAgKiBAcGFyYW0ge3N0cmluZ30gZm9udFxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dFxuICAgKiBAcmV0dXJucyB7VGV4dE1ldHJpY3N9XG4gICAqL1xuICBzdGF0aWMgbWVhc3VyZVRleHQoZm9udCwgdGV4dCkge1xuICAgIHRoaXMuX2NvbnRleHQuZm9udCA9IGZvbnQ7XG4gICAgcmV0dXJuIHRoaXMuX2NvbnRleHQubWVhc3VyZVRleHQodGV4dCk7XG4gIH1cblxuICAvKipcbiAgICog57ea5b2i44Kw44Op44OH44O844K344On44Oz44KS55Sf5oiQXG4gICAqIEByZXR1cm5zIHtDYW52YXNHcmFkaWVudH1cbiAgICovXG4gIHN0YXRpYyBjcmVhdGVMaW5lYXJHcmFkaWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5fY29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudC5hcHBseSh0aGlzLl9jb250ZXh0LCBhcmd1bWVudHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWGhuW9ouOCsOODqeODh+ODvOOCt+ODp+ODs+OCkueUn+aIkFxuICAgKiBAcmV0dXJucyB7Q2FudmFzR3JhZGllbnR9XG4gICAqL1xuICBzdGF0aWMgY3JlYXRlUmFkaWFsR3JhZGllbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlUmFkaWFsR3JhZGllbnQuYXBwbHkodGhpcy5fY29udGV4dCwgYXJndW1lbnRzKTtcbiAgfVxuXG59XG5cbi8qKlxuICog44OH44OV44Kp44Or44OI44Gu44OX44Op44Kk44OZ44O844OIQ2FudmFz44Kz44Oz44OG44Kt44K544OIICBcbiAqIFN0YXRpY+ODoeOCveODg+ODieeUqFxuICovXG5DYW52YXMuX2NvbnRleHQgPSAoZnVuY3Rpb24oKSB7XG4gIGlmIChTdXBwb3J0LmNhbnZhcykge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKS5nZXRDb250ZXh0KCcyZCcpO1xuICB9XG4gIGVsc2Uge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59KSgpO1xuXG4vLyBpbXBvcnQgeyBmaXJzdCwgbGFzdCwgY2xlYXIgfSBmcm9tIFwiLi4vY29yZS9hcnJheVwiXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmlucHV0LklucHV0XG4gKiBfZXh0ZW5kcyBwaGluYS51dGlsLkV2ZW50RGlzcGF0Y2hlclxuICovXG5jbGFzcyBJbnB1dCBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge0hUTUxDYW52YXNFbGVtZW50IHwgSFRNTERvY3VtZW50fSBkb21FbGVtZW50IEtleUJvYXJk44K144OW44Kv44Op44K544Gn44GvSFRNTERvY3VtZW5044CB44Gd44KM5Lul5aSW44Gu44K144OW44Kv44Op44K544Gn44GvSFRNTENhbnZhc0VsZW1lbnRcbiAgICovXG4gIGNvbnN0cnVjdG9yKGRvbUVsZW1lbnQpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5kb21FbGVtZW50ID0gZG9tRWxlbWVudCB8fCB3aW5kb3cuZG9jdW1lbnQ7XG5cbiAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCk7XG4gICAgdGhpcy5zdGFydFBvc2l0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCk7XG4gICAgdGhpcy5kZWx0YVBvc2l0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCk7XG4gICAgdGhpcy5wcmV2UG9zaXRpb24gPSBuZXcgVmVjdG9yMigwLCAwKTtcbiAgICB0aGlzLl90ZW1wUG9zaXRpb24gPSBuZXcgVmVjdG9yMigwLCAwKTtcblxuICAgIHRoaXMubWF4Q2FjaGVOdW0gPSBJbnB1dC5kZWZhdWx0cy5tYXhDYWNoZU51bTtcbiAgICB0aGlzLm1pbkRpc3RhbmNlID0gSW5wdXQuZGVmYXVsdHMubWluRGlzdGFuY2U7XG4gICAgdGhpcy5tYXhEaXN0YW5jZSA9IElucHV0LmRlZmF1bHRzLm1heERpc3RhbmNlO1xuICAgIHRoaXMuY2FjaGVQb3NpdGlvbnMgPSBbXTtcbiAgICB0aGlzLmZsaWNrVmVsb2NpdHkgPSBuZXcgVmVjdG9yMigwLCAwKTtcblxuICAgIHRoaXMuZmxhZ3MgPSAwO1xuICAgIFxuICAgIC8qKlxuICAgICAqIEtleUJvYXJk44Kv44Op44K55ouh5by15pmC44Gu5Z6L44Ko44Op44O85a++562W44Gu44Gf44KBdW5pb27lnovjgajjgZnjgovjgYzjgIHmnKzjgq/jg6njgrnjgafjga9udW1iZXLjgajjgZfjgabkvb/nlKhcbiAgICAgKiBAdHlwZSB7bnVtYmVyIHwge1trOiBzdHJpbmddOiBudW1iZXJ9fVxuICAgICAqL1xuICAgIHRoaXMubGFzdDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrBcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICB1cGRhdGUoKSB7XG4gICAgdGhpcy5sYXN0ID0gdGhpcy5ub3c7XG4gICAgdGhpcy5ub3cgPSB0aGlzLmZsYWdzO1xuICAgIHRoaXMuc3RhcnQgPSAodGhpcy5ub3cgXiB0aGlzLmxhc3QpICYgdGhpcy5ub3c7XG4gICAgdGhpcy5lbmQgICA9ICh0aGlzLm5vdyBeIHRoaXMubGFzdCkgJiB0aGlzLmxhc3Q7XG5cbiAgICAvLyDlpInljJblgKTjgpLmm7TmlrBcbiAgICB0aGlzLmRlbHRhUG9zaXRpb24ueCA9IHRoaXMuX3RlbXBQb3NpdGlvbi54IC0gdGhpcy5wb3NpdGlvbi54O1xuICAgIHRoaXMuZGVsdGFQb3NpdGlvbi55ID0gdGhpcy5fdGVtcFBvc2l0aW9uLnkgLSB0aGlzLnBvc2l0aW9uLnk7XG5cbiAgICBpZiAodGhpcy5kZWx0YVBvc2l0aW9uLnggPT09IDAgJiYgdGhpcy5kZWx0YVBvc2l0aW9uLnkgPT09IDApIHtcbiAgICAgIHRoaXMuX21vdmVGbGFnID0gZmFsc2U7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5fbW92ZUZsYWcgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnN0YXJ0KSB7XG4gICAgICB0aGlzLnN0YXJ0UG9zaXRpb24uc2V0KHRoaXMucG9zaXRpb24ueCwgdGhpcy5wb3NpdGlvbi55KTtcbiAgICB9XG5cbiAgICAvLyDliY3lm57jga7luqfmqJnjgpLmm7TmlrBcbiAgICB0aGlzLnByZXZQb3NpdGlvbi5zZXQodGhpcy5wb3NpdGlvbi54LCB0aGlzLnBvc2l0aW9uLnkpO1xuXG4gICAgLy8g54++5Zyo44Gu5L2N572u44KS5pu05pawXG4gICAgdGhpcy5wb3NpdGlvbi5zZXQodGhpcy5fdGVtcFBvc2l0aW9uLngsIHRoaXMuX3RlbXBQb3NpdGlvbi55KTtcblxuICAgIGlmICh0aGlzLmNhY2hlUG9zaXRpb25zLmxlbmd0aCA+IHRoaXMubWF4Q2FjaGVOdW0pIHtcbiAgICAgIHRoaXMuY2FjaGVQb3NpdGlvbnMuc2hpZnQoKTtcbiAgICB9XG4gICAgdGhpcy5jYWNoZVBvc2l0aW9ucy5wdXNoKHRoaXMucG9zaXRpb24uY2xvbmUoKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtmbGFnPTFdIOODh+ODleOCqeODq+ODiOOBrzEodHJ1ZSlcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfc3RhcnQoeCwgeSwgZmxhZykge1xuICAgIGZsYWcgPSAoZmxhZyAhPT0gdW5kZWZpbmVkKSA/IGZsYWcgOiAxO1xuICAgIC8vIGNvbnNvbGUubG9nKCdzdGFydCcsIHgsIHkpO1xuICAgIHRoaXMuX21vdmUoeCwgeSk7XG5cbiAgICB0aGlzLmZsYWdzIHw9IGZsYWc7XG5cbiAgICB4ID0gdGhpcy5fdGVtcFBvc2l0aW9uLng7XG4gICAgeSA9IHRoaXMuX3RlbXBQb3NpdGlvbi55O1xuICAgIHRoaXMucG9zaXRpb24uc2V0KHgsIHkpO1xuICAgIHRoaXMucHJldlBvc2l0aW9uLnNldCh4LCB5KTtcblxuICAgIHRoaXMuZmxpY2tWZWxvY2l0eS5zZXQoMCwgMCk7XG4gICAgLy8gdGhpcy5jYWNoZVBvc2l0aW9ucy5jbGVhcigpO1xuICAgIHRoaXMuY2FjaGVQb3NpdGlvbnMubGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2ZsYWc9MV1cbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfZW5kKGZsYWcpIHtcbiAgICBmbGFnID0gKGZsYWcgIT09IHVuZGVmaW5lZCkgPyBmbGFnIDogMTtcbiAgICB0aGlzLmZsYWdzICY9IH4oZmxhZyk7XG5cbiAgICBpZiAodGhpcy5jYWNoZVBvc2l0aW9ucy5sZW5ndGggPCAyKSByZXR1cm47XG5cbiAgICAvLyB2YXIgZmlyc3QgPSB0aGlzLmNhY2hlUG9zaXRpb25zLmZpcnN0O1xuICAgIC8vIHZhciBsYXN0ID0gdGhpcy5jYWNoZVBvc2l0aW9ucy5sYXN0O1xuICAgIHZhciBmaXJzdCA9IHRoaXMuY2FjaGVQb3NpdGlvbnNbMF07XG4gICAgdmFyIGxhc3QgPSB0aGlzLmNhY2hlUG9zaXRpb25zW3RoaXMuY2FjaGVQb3NpdGlvbnMubGVuZ3RoLTFdO1xuXG4gICAgdmFyIHYgPSBWZWN0b3IyLnN1YihsYXN0LCBmaXJzdCk7XG5cbiAgICB2YXIgbGVuID0gdi5sZW5ndGgoKTtcblxuICAgIGlmIChsZW4gPiB0aGlzLm1pbkRpc3RhbmNlKSB7XG4gICAgICAvLyB2YXIgbm9ybWFsTGVuID0gbGVuLmNsYW1wKHRoaXMubWluRGlzdGFuY2UsIHRoaXMubWF4RGlzdGFuY2UpO1xuICAgICAgdmFyIG5vcm1hbExlbiA9IGNsYW1wKGxlbiwgdGhpcy5taW5EaXN0YW5jZSwgdGhpcy5tYXhEaXN0YW5jZSk7XG4gICAgICB2LmRpdihsZW4pLm11bChub3JtYWxMZW4pO1xuICAgICAgdGhpcy5mbGlja1ZlbG9jaXR5LnNldCh2LngsIHYueSk7XG4gICAgfVxuXG4gICAgLy8gdGhpcy5jYWNoZVBvc2l0aW9ucy5jbGVhcigpO1xuICAgIHRoaXMuY2FjaGVQb3NpdGlvbnMubGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiDjgrnjgrHjg7zjg6vjgpLogIPmha7jgZfjgabkvY3nva7jgpLnp7vli5VcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfbW92ZSh4LCB5KSB7XG4gICAgdGhpcy5fdGVtcFBvc2l0aW9uLnggPSB4O1xuICAgIHRoaXMuX3RlbXBQb3NpdGlvbi55ID0geTtcblxuICAgIC8vIGFkanVzdCBzY2FsZVxuICAgIHZhciBlbG0gPSAvKiogQHR5cGUge0hUTUxDYW52YXNFbGVtZW50fSAqLyh0aGlzLmRvbUVsZW1lbnQpO1xuICAgIHZhciByZWN0ID0gZWxtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChyZWN0LndpZHRoKSB7XG4gICAgICB0aGlzLl90ZW1wUG9zaXRpb24ueCAqPSBlbG0ud2lkdGggLyByZWN0LndpZHRoO1xuICAgIH1cbiAgICBpZiAocmVjdC5oZWlnaHQpIHtcbiAgICAgIHRoaXMuX3RlbXBQb3NpdGlvbi55ICo9IGVsbS5oZWlnaHQgLyByZWN0LmhlaWdodDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHByb3BlcnR5ICAgIHhcbiAgICogeOW6p+aomeWApFxuICAgKi9cbiAgZ2V0IHgoKSB7IHJldHVybiB0aGlzLnBvc2l0aW9uLng7IH1cbiAgc2V0IHgodikgeyB0aGlzLnBvc2l0aW9uLnggPSB2OyB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSAgICB5XG4gICAqIHnluqfmqJnlgKRcbiAgICovXG4gIGdldCB5KCkgeyByZXR1cm4gdGhpcy5wb3NpdGlvbi55OyB9XG4gIHNldCB5KHYpIHsgdGhpcy5wb3NpdGlvbi55ID0gdjsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgZHhcbiAgICogZHjlgKRcbiAgICovXG4gIGdldCBkeCgpIHsgcmV0dXJuIHRoaXMuZGVsdGFQb3NpdGlvbi54OyB9XG4gIHNldCBkeCh2KSB7IHRoaXMuZGVsdGFQb3NpdGlvbi54ID0gdjsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgZHlcbiAgICogZHnlgKRcbiAgICovXG4gIGdldCBkeSgpIHsgcmV0dXJuIHRoaXMuZGVsdGFQb3NpdGlvbi55OyB9XG4gIHNldCBkeSh2KSB7IHRoaXMuZGVsdGFQb3NpdGlvbi55ID0gdjsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgZnhcbiAgICogZnjlgKRcbiAgICovXG4gIGdldCBmeCgpIHsgcmV0dXJuIHRoaXMuZmxpY2tWZWxvY2l0eS54OyB9XG4gIHNldCBmeCh2KSB7IHRoaXMuZmxpY2tWZWxvY2l0eS54ID0gdjsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgZnlcbiAgICogZnnlgKRcbiAgICovXG4gIGdldCBmeSgpIHsgcmV0dXJuIHRoaXMuZmxpY2tWZWxvY2l0eS55OyB9XG4gIHNldCBmeSh2KSB7IHRoaXMuZmxpY2tWZWxvY2l0eS55ID0gdjsgfVxuXG59XG5cbklucHV0LmRlZmF1bHRzID0ge1xuICBtYXhDYWNoZU51bTogMyxcbiAgbWluRGlzdGFuY2U6IDEwLFxuICBtYXhEaXN0YW5jZTogMTAwLFxufTtcblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuaW5wdXQuS2V5Ym9hcmRcbiAqIF9leHRlbmRzIHBoaW5hLmlucHV0LklucHV0XG4gKi9cbmNsYXNzIEtleWJvYXJkIGV4dGVuZHMgSW5wdXQge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtEb2N1bWVudH0gZG9tRWxlbWVudFxuICAgKi9cbiAgY29uc3RydWN0b3IoZG9tRWxlbWVudCkge1xuICAgIHN1cGVyKGRvbUVsZW1lbnQpO1xuXG4gICAgLyoqIEB0eXBlIHtIVE1MRG9jdW1lbnR9ICovXG4gICAgdGhpcy5kb21FbGVtZW50O1xuXG4gICAgLyoqIEB0eXBlIHt7W2s6IG51bWJlcl06IGJvb2xlYW59fSAqL1xuICAgIHRoaXMua2V5ID0ge307XG4gICAgLyoqIEB0eXBlIHt7W2s6IG51bWJlcl06IGFueX19IHRydWV8ZmFsc2Ugb3IgMXwwICovXG4gICAgdGhpcy5wcmVzcyAgPSB7fTtcbiAgICAvKiogQHR5cGUge3tbazogbnVtYmVyXTogYW55fX0gKi9cbiAgICB0aGlzLmRvd24gICA9IHt9O1xuICAgIC8qKiBAdHlwZSB7e1trOiBudW1iZXJdOiBhbnl9fSAqL1xuICAgIHRoaXMudXAgICAgID0ge307XG4gICAgLyoqIEB0eXBlIHt7W2s6IG51bWJlcl06IGFueX19ICovXG4gICAgdGhpcy5sYXN0ICAgPSB7fTtcblxuICAgIC8qKiBAdHlwZSB7bnVtYmVyIHwgbnVsbH0gKi9cbiAgICB0aGlzLl9rZXlkb3duID0gbnVsbDtcbiAgICAvKiogQHR5cGUge251bWJlciB8IG51bGx9ICovXG4gICAgdGhpcy5fa2V5dXAgPSBudWxsO1xuICAgIC8qKiBAdHlwZSB7bnVtYmVyIHwgbnVsbH0gKi9cbiAgICB0aGlzLl9rZXlwcmVzcyA9IG51bGw7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG4gICAgICBzZWxmLmtleVtlLmtleUNvZGVdID0gdHJ1ZTtcbiAgICAgIHNlbGYuX2tleWRvd24gPSBlLmtleUNvZGU7XG4gICAgfSk7XG5cbiAgICB0aGlzLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICBzZWxmLmtleVtlLmtleUNvZGVdID0gZmFsc2U7XG4gICAgICBzZWxmLl9rZXl1cCA9IGUua2V5Q29kZTtcbiAgICB9KTtcbiAgICB0aGlzLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCBmdW5jdGlvbihlKSB7XG4gICAgICBzZWxmLl9rZXlwcmVzcyA9IGUua2V5Q29kZTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmg4XloLHmm7TmlrDlh6bnkIZcbiAgICog5q+O44OV44Os44O844Og5ZG844KT44Gn5LiL44GV44GELlxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHVwZGF0ZSgpIHtcbiAgICAvLyBUT0RPOiDkuIDmi6zjg5Pjg4Pjg4jmvJTnrpfjgafooYzjgYbjgojjgYbkv67mraPjgZnjgotcbiAgICBmb3IgKHZhciBrIGluIHRoaXMua2V5KSB7XG4gICAgICB0aGlzLmxhc3Rba10gICAgPSB0aGlzLnByZXNzW2tdO1xuICAgICAgdGhpcy5wcmVzc1trXSAgID0gdGhpcy5rZXlba107XG4gICAgICBcbiAgICAgIHRoaXMuZG93bltrXSA9ICh0aGlzLnByZXNzW2tdIF4gdGhpcy5sYXN0W2tdKSAmIHRoaXMucHJlc3Nba107XG4gICAgICB0aGlzLnVwW2tdID0gKHRoaXMucHJlc3Nba10gXiB0aGlzLmxhc3Rba10pICYgdGhpcy5sYXN0W2tdO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9rZXlkb3duKSB7XG4gICAgICB0aGlzLmZsYXJlKCdrZXlkb3duJywgeyBrZXlDb2RlOiB0aGlzLl9rZXlkb3duIH0pO1xuICAgICAgdGhpcy5fa2V5ZG93biA9IG51bGw7XG4gICAgfVxuICAgIGlmICh0aGlzLl9rZXl1cCkge1xuICAgICAgdGhpcy5mbGFyZSgna2V5dXAnLCB7IGtleUNvZGU6IHRoaXMuX2tleXVwIH0pO1xuICAgICAgdGhpcy5fa2V5dXAgPSBudWxsO1xuICAgIH1cbiAgICBpZiAodGhpcy5fa2V5cHJlc3MpIHtcbiAgICAgIHRoaXMuZmxhcmUoJ2tleXByZXNzJywgeyBrZXlDb2RlOiB0aGlzLl9rZXlwcmVzcyB9KTtcbiAgICAgIHRoaXMuX2tleXByZXNzID0gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Kt44O844KS5oq844GX44Gm44GE44KL44GL44KS44OB44Kn44OD44KvXG4gICAqIEBwYXJhbSAgIHtudW1iZXJ8a2V5b2YgdHlwZW9mIEtleWJvYXJkLktFWV9DT0RFfSBrZXkga2V5Q29kZSBvciBrZXlOYW1lXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSAgIOODgeOCp+ODg+OCr+e1kOaenFxuICAgKi9cbiAgZ2V0S2V5KGtleSkge1xuICAgIGlmICh0eXBlb2Yoa2V5KSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAga2V5ID0gS2V5Ym9hcmQuS0VZX0NPREVba2V5XTtcbiAgICB9XG4gICAgcmV0dXJuICEhdGhpcy5wcmVzc1trZXldID09PSB0cnVlO1xuICB9XG4gIFxuICAvKipcbiAgICog44Kt44O844KS5oq844GX44Gf44GL44KS44OB44Kn44OD44KvXG4gICAqIEBwYXJhbSAgIHtudW1iZXJ8a2V5b2YgdHlwZW9mIEtleWJvYXJkLktFWV9DT0RFfSBrZXkga2V5Q29kZSBvciBrZXlOYW1lXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSAgIOODgeOCp+ODg+OCr+e1kOaenFxuICAgKi9cbiAgZ2V0S2V5RG93bihrZXkpIHtcbiAgICBpZiAodHlwZW9mKGtleSkgPT0gXCJzdHJpbmdcIikge1xuICAgICAga2V5ID0gS2V5Ym9hcmQuS0VZX0NPREVba2V5XTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZG93bltrZXldID09IHRydWU7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDjgq3jg7zjgpLpm6LjgZfjgZ/jgYvjgpLjg4Hjgqfjg4Pjgq9cbiAgICogQHBhcmFtICAge251bWJlcnxrZXlvZiB0eXBlb2YgS2V5Ym9hcmQuS0VZX0NPREV9IGtleSBrZXlDb2RlIG9yIGtleU5hbWVcbiAgICogQHJldHVybnMge0Jvb2xlYW59ICAg44OB44Kn44OD44Kv57WQ5p6cXG4gICAqL1xuICBnZXRLZXlVcChrZXkpIHtcbiAgICBpZiAodHlwZW9mKGtleSkgPT0gXCJzdHJpbmdcIikge1xuICAgICAga2V5ID0gS2V5Ym9hcmQuS0VZX0NPREVba2V5XTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudXBba2V5XSA9PSB0cnVlO1xuICB9XG4gIFxuICAvKipcbiAgICog44Kt44O844Gu5pa55ZCR44KSIEFuZ2xlKERlZ3JlZSkg44Gn5Y+W5b6XXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSAgIOinkuW6pihEZWdyZWUpXG4gICAqL1xuICBnZXRLZXlBbmdsZSgpIHtcbiAgICB2YXIgYW5nbGUgPSBudWxsO1xuICAgIHZhciBhcnJvd0JpdCA9XG4gICAgICAvLyAodGhpcy5nZXRLZXkoXCJsZWZ0XCIpICAgPDwgMykgfCAvLyAxMDAwXG4gICAgICAvLyAodGhpcy5nZXRLZXkoXCJ1cFwiKSAgICAgPDwgMikgfCAvLyAwMTAwXG4gICAgICAvLyAodGhpcy5nZXRLZXkoXCJyaWdodFwiKSAgPDwgMSkgfCAvLyAwMDEwXG4gICAgICAvLyAodGhpcy5nZXRLZXkoXCJkb3duXCIpKTsgICAgICAgICAvLyAwMDAxXG4gICAgICAodGhpcy5nZXRLZXkoXCJsZWZ0XCIpID8gMSA6IDAgICA8PCAzKSB8IC8vIDEwMDBcbiAgICAgICh0aGlzLmdldEtleShcInVwXCIpID8gMSA6IDAgICAgIDw8IDIpIHwgLy8gMDEwMFxuICAgICAgKHRoaXMuZ2V0S2V5KFwicmlnaHRcIikgPyAxIDogMCAgPDwgMSkgfCAvLyAwMDEwXG4gICAgICAodGhpcy5nZXRLZXkoXCJkb3duXCIpID8gMSA6IDApOyAgICAgICAgIC8vIDAwMDFcbiAgICBcbiAgICBpZiAoYXJyb3dCaXQgIT09IDAgJiYgS2V5Ym9hcmQuQVJST1dfQklUX1RPX0FOR0xFX1RBQkxFLmhhc093blByb3BlcnR5KGFycm93Qml0KSkge1xuICAgICAgYW5nbGUgPSBLZXlib2FyZC5BUlJPV19CSVRfVE9fQU5HTEVfVEFCTEVbYXJyb3dCaXRdO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gYW5nbGU7XG4gIH1cblxuICAvKipcbiAgICog44Kt44O844Gu5oq844GX44Gm44GE44KL5ZCR44GN44KS5Y+W5b6XXG4gICAqIOato+imj+WMluOBleOCjOOBpuOBhOOCi1xuICAgKiBAcmV0dXJucyB7VmVjdG9yMn1cbiAgICovXG4gIGdldEtleURpcmVjdGlvbigpIHtcbiAgICB2YXIgZGlyZWN0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCk7XG5cbiAgICBpZiAodGhpcy5nZXRLZXkoXCJsZWZ0XCIpKSB7XG4gICAgICBkaXJlY3Rpb24ueCA9IC0xO1xuICAgIH1cbiAgICBlbHNlIGlmICh0aGlzLmdldEtleShcInJpZ2h0XCIpKSB7XG4gICAgICBkaXJlY3Rpb24ueCA9IDE7XG4gICAgfVxuICAgIGlmICh0aGlzLmdldEtleShcInVwXCIpKSB7XG4gICAgICBkaXJlY3Rpb24ueSA9IC0xO1xuICAgIH1cbiAgICBlbHNlIGlmICh0aGlzLmdldEtleShcImRvd25cIikpIHtcbiAgICAgIGRpcmVjdGlvbi55ID0gMTtcbiAgICB9XG5cbiAgICBpZiAoZGlyZWN0aW9uLnggJiYgZGlyZWN0aW9uLnkpIHtcbiAgICAgIGRpcmVjdGlvbi5kaXYoTWF0aC5TUVJUMik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRpcmVjdGlvbjtcbiAgfVxuICBcbiAgLyoqXG4gICAqIOOCreODvOOBrueKtuaFi+OCkuioreWumuOBmeOCi1xuICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlcn0ga2V5XG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gZmxhZ1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldEtleShrZXksIGZsYWcpIHtcbiAgICBpZiAodHlwZW9mKGtleSkgPT0gXCJzdHJpbmdcIikge1xuICAgICAga2V5ID0gS2V5Ym9hcmQuS0VZX0NPREVba2V5XTtcbiAgICB9XG4gICAgdGhpcy5rZXlba2V5XSA9IGZsYWc7XG4gICAgXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Kt44O844KS5YWo44Gm6Zui44GX44Gf44GT44Go44Gr44GZ44KLXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgY2xlYXJLZXkoKSB7XG4gICAgdGhpcy5rZXkgPSB7fTtcbiAgICBcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG59XG5cblxuLyoqXG4gKiBAc3RhdGljXG4gKiBAZW51bSB7bnVtYmVyfVxuICog5pa55ZCR44Gu44Ki44Oz44Kw44OrIGpzZHVja+OBp+OBr+aVsOWtl+OCkuODl+ODreODkeODhuOCo+OBq+aMh+WumuOBp+OBjeOBquOBhO+8n1xuICovXG5LZXlib2FyZC5BUlJPV19CSVRfVE9fQU5HTEVfVEFCTEUgPSB7XG4gIC8qIEBwcm9wZXJ0eSDkuIsgKi9cbiAgMHgwMTogMjcwLFxuICAvKiBAcHJvcGVydHkg5Y+zICovXG4gIDB4MDI6ICAgMCxcbiAgLyogQHByb3BlcnR5IOS4iiAqL1xuICAweDA0OiAgOTAsXG4gIC8qIEBwcm9wZXJ0eSDlt6YgKi9cbiAgMHgwODogMTgwLFxuXG4gIC8qIEBwcm9wZXJ0eSDlj7PkuIogKi9cbiAgMHgwNjogIDQ1LFxuICAvKiBAcHJvcGVydHkg5Y+z5LiLICovXG4gIDB4MDM6IDMxNSxcbiAgLyogQHByb3BlcnR5IOW3puS4iiAqL1xuICAweDBjOiAxMzUsXG4gIC8qIEBwcm9wZXJ0eSDlt6bkuIsgKi9cbiAgMHgwOTogMjI1LFxuXG4gIC8vIOS4ieaWueWQkeWQjOaZguaKvOOBl+WvvuW/nFxuICAvLyDmg7PlrprlpJbjga7mk43kvZzjgaDjgYzlr77lv5zjgZfjgajjgYTjgZ/jgbvjgYbjgYznhKHpm6NcbiAgLyogQHByb3BlcnR5IOWPs+S4iuW3piAqL1xuICAweDBlOiAgOTAsXG4gIC8qIEBwcm9wZXJ0eSDkuIrlt6bkuIsgKi9cbiAgMHgwZDogMTgwLFxuICAvKiBAcHJvcGVydHkg5bem5LiL5Y+zICovXG4gIDB4MGI6IDI3MCxcbiAgLyogQHByb3BlcnR5IOS4i+WPs+S4iiAqL1xuICAweDA3OiAgIDAsXG59O1xuXG4vKipcbiAqIEBzdGF0aWNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiDjgq3jg7znlarlj7dcbiAqL1xuS2V5Ym9hcmQuS0VZX0NPREUgPSB7XG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImJhY2tzcGFjZVwiIDogOCxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwidGFiXCIgICAgICAgOiA5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJlbnRlclwiICAgICA6IDEzLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJyZXR1cm5cIiAgICA6IDEzLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJzaGlmdFwiICAgICA6IDE2LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJjdHJsXCIgICAgICA6IDE3LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJhbHRcIiAgICAgICA6IDE4LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJwYXVzZVwiICAgICA6IDE5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJjYXBzbG9ja1wiICA6IDIwLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJlc2NhcGVcIiAgICA6IDI3LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJwYWdldXBcIiAgICA6IDMzLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJwYWdlZG93blwiICA6IDM0LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJlbmRcIiAgICAgICA6IDM1LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJob21lXCIgICAgICA6IDM2LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJsZWZ0XCIgICAgICA6IDM3LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJ1cFwiICAgICAgICA6IDM4LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJyaWdodFwiICAgICA6IDM5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJkb3duXCIgICAgICA6IDQwLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJpbnNlcnRcIiAgICA6IDQ1LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJkZWxldGVcIiAgICA6IDQ2LFxuICBcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiMFwiIDogNDgsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIjFcIiA6IDQ5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCIyXCIgOiA1MCxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiM1wiIDogNTEsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIjRcIiA6IDUyLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCI1XCIgOiA1MyxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiNlwiIDogNTQsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIjdcIiA6IDU1LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCI4XCIgOiA1NixcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiOVwiIDogNTcsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcbiAgXCJhXCIgOiA2NSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiQVwiIDogNjUsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImJcIiA6IDY2LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJCXCIgOiA2NixcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiY1wiIDogNjcsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIkNcIiA6IDY3LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJkXCIgOiA2OCxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiRFwiIDogNjgsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImVcIiA6IDY5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJFXCIgOiA2OSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiZlwiIDogNzAsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIkZcIiA6IDcwLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJnXCIgOiA3MSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiR1wiIDogNzEsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImhcIiA6IDcyLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJIXCIgOiA3MixcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiaVwiIDogNzMsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIklcIiA6IDczLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJqXCIgOiA3NCxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiSlwiIDogNzQsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImtcIiA6IDc1LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJLXCIgOiA3NSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwibFwiIDogNzYsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIkxcIiA6IDc2LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJtXCIgOiA3NyxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiTVwiIDogNzcsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIm5cIiA6IDc4LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJOXCIgOiA3OCxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwib1wiIDogNzksXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIk9cIiA6IDc5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJwXCIgOiA4MCxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiUFwiIDogODAsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcInFcIiA6IDgxLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJRXCIgOiA4MSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiclwiIDogODIsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIlJcIiA6IDgyLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJzXCIgOiA4MyxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiU1wiIDogODMsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcInRcIiA6IDg0LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJUXCIgOiA4NCxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwidVwiIDogODUsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIlVcIiA6IDg1LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJ2XCIgOiA4NixcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiVlwiIDogODYsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIndcIiA6IDg3LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJXXCIgOiA4NyxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwieFwiIDogODgsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIlhcIiA6IDg4LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJ5XCIgOiA4OSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiWVwiIDogODksXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcInpcIiA6IDkwLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJaXCIgOiA5MCxcbiAgXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIm51bXBhZDBcIiA6IDk2LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJudW1wYWQxXCIgOiA5NyxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwibnVtcGFkMlwiIDogOTgsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIm51bXBhZDNcIiA6IDk5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJudW1wYWQ0XCIgOiAxMDAsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIm51bXBhZDVcIiA6IDEwMSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwibnVtcGFkNlwiIDogMTAyLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJudW1wYWQ3XCIgOiAxMDMsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcIm51bXBhZDhcIiA6IDEwNCxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwibnVtcGFkOVwiIDogMTA1LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJtdWx0aXBseVwiICAgICAgOiAxMDYsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImFkZFwiICAgICAgICAgICA6IDEwNyxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwic3VidHJhY3RcIiAgICAgIDogMTA5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJkZWNpbWFscG9pbnRcIiAgOiAxMTAsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImRpdmlkZVwiICAgICAgICA6IDExMSxcblxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmMVwiICAgIDogMTEyLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmMlwiICAgIDogMTEzLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmM1wiICAgIDogMTE0LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmNFwiICAgIDogMTE1LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmNVwiICAgIDogMTE2LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmNlwiICAgIDogMTE3LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmN1wiICAgIDogMTE4LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmOFwiICAgIDogMTE5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmOVwiICAgIDogMTIwLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmMTBcIiAgIDogMTIxLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmMTFcIiAgIDogMTIyLFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJmMTJcIiAgIDogMTIzLFxuICBcbiAgLyogQHByb3BlcnR5ICovXG4gIFwibnVtbG9ja1wiICAgOiAxNDQsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcInNjcm9sbGxvY2tcIjogMTQ1LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJzZW1pY29sb25cIiA6IDE4NixcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiZXF1YWxzaWduXCIgOiAxODcsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImNvbW1hXCIgICAgIDogMTg4LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJkYXNoXCIgICAgICA6IDE4OSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwicGVyaW9kXCIgICAgOiAxOTAsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImZvcndhcmQgc2xhc2hcIiA6IDE5MSxcbiAgLyogQHByb3BlcnR5ICovXG4gIFwiL1wiOiAxOTEsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImdyYXZlIGFjY2VudFwiICA6IDE5MixcbiAgLyogQHByb3BlcnR5ICovXG4gIFwib3BlbiBicmFja2V0XCIgIDogMjE5LFxuICAvKiBAcHJvcGVydHkgKi9cbiAgXCJiYWNrIHNsYXNoXCIgICAgOiAyMjAsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcImNsb3NlIGJyYWNrZXRcIiAgOiAyMjEsXG4gIC8qIEBwcm9wZXJ0eSAqL1xuICBcInNpbmdsZSBxdW90ZVwiICA6IDIyMixcbiAgLyogQHByb3BlcnR5ICovXG4gIFwic3BhY2VcIiAgICAgICAgIDogMzJcblxufTtcblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuaW5wdXQuTW91c2VcbiAqIF9leHRlbmRzIHBoaW5hLmlucHV0LklucHV0XG4gKi9cbmNsYXNzIE1vdXNlIGV4dGVuZHMgSW5wdXQge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudH0gZG9tRWxlbWVudFxuICAgKi9cbiAgY29uc3RydWN0b3IoZG9tRWxlbWVudCkge1xuICAgIHN1cGVyKGRvbUVsZW1lbnQpO1xuXG4gICAgdGhpcy5pZCA9IDA7XG5cbiAgICAvKiogQHR5cGUge0hUTUxDYW52YXNFbGVtZW50fSAqL1xuICAgIHRoaXMuZG9tRWxlbWVudDtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZnVuY3Rpb24oZSkge1xuICAgICAgc2VsZi5fc3RhcnQocG9pbnRYLmdldC5jYWxsKGUpLCBwb2ludFkuZ2V0LmNhbGwoZSksIDE8PGUuYnV0dG9uKTtcbiAgICAgIC8vIHNlbGYuX3N0YXJ0KGUucG9pbnRYLCBlLnBvaW50WSwgMTw8ZS5idXR0b24pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICBzZWxmLl9lbmQoMTw8ZS5idXR0b24pO1xuICAgIH0pO1xuICAgIHRoaXMuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBmdW5jdGlvbihlKSB7XG4gICAgICBzZWxmLl9tb3ZlKHBvaW50WC5nZXQuY2FsbChlKSwgcG9pbnRZLmdldC5jYWxsKGUpKTtcbiAgICAgIC8vIHNlbGYuX21vdmUoZS5wb2ludFgsIGUucG9pbnRZKTtcbiAgICB9KTtcblxuICAgIC8vIOODnuOCpuOCueOBjOOCreODo+ODs+ODkOOCueimgee0oOOBruWkluOBq+WHuuOBn+WgtOWQiOOBruWvvuW/nFxuICAgIHRoaXMuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGZ1bmN0aW9uKGUpICB7XG4gICAgICBzZWxmLl9lbmQoMSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog44Oc44K/44Oz5Y+W5b6XXG4gICAqIEBwYXJhbSB7c3RyaW5nIHwgbnVtYmVyfSBidXR0b25cbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBnZXRCdXR0b24oYnV0dG9uKSB7XG4gICAgaWYgKHR5cGVvZihidXR0b24pID09IFwic3RyaW5nXCIpIHtcbiAgICAgIGJ1dHRvbiA9IEJVVFRPTl9NQVBbYnV0dG9uXTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuICh0aGlzLm5vdyAmIGJ1dHRvbikgIT0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiDjg5zjgr/jg7Pjg4Djgqbjg7Plj5blvpdcbiAgICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXJ9IGJ1dHRvblxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGdldEJ1dHRvbkRvd24oYnV0dG9uKSB7XG4gICAgaWYgKHR5cGVvZihidXR0b24pID09PSAnc3RyaW5nJykge1xuICAgICAgYnV0dG9uID0gQlVUVE9OX01BUFtidXR0b25dO1xuICAgIH1cblxuICAgIHJldHVybiAodGhpcy5zdGFydCAmIGJ1dHRvbikgIT0gMDtcbiAgfVxuICAgICAgXG4gIC8qKlxuICAgKiDjg5zjgr/jg7PjgqLjg4Pjg5flj5blvpdcbiAgICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXJ9IGJ1dHRvblxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGdldEJ1dHRvblVwKGJ1dHRvbikge1xuICAgIGlmICh0eXBlb2YoYnV0dG9uKSA9PSBcInN0cmluZ1wiKSB7XG4gICAgICBidXR0b24gPSBCVVRUT05fTUFQW2J1dHRvbl07XG4gICAgfVxuICAgIFxuICAgIHJldHVybiAodGhpcy5lbmQgJiBidXR0b24pICE9IDA7XG4gIH1cblxufVxuXG4vKiogQHN0YXRpYyBAcHJvcGVydHkgKi9cbk1vdXNlLkJVVFRPTl9MRUZUID0gMHgxO1xuLyoqIEBzdGF0aWMgQHByb3BlcnR5ICovXG5Nb3VzZS5CVVRUT05fTUlERExFID0gMHgyO1xuLyoqIEBzdGF0aWMgQHByb3BlcnR5ICovXG5Nb3VzZS5CVVRUT05fUklHSFQgPSAweDQ7XG5cbi8qKlxuICogQHR5cGUge3tbazogc3RyaW5nXTogbnVtYmVyfX1cbiAqL1xudmFyIEJVVFRPTl9NQVAgPSB7XG4gIFwibGVmdFwiICA6IE1vdXNlLkJVVFRPTl9MRUZULFxuICBcIm1pZGRsZVwiOiBNb3VzZS5CVVRUT05fTUlERExFLFxuICBcInJpZ2h0XCIgOiBNb3VzZS5CVVRUT05fUklHSFRcbn07XG5cbk1vdXNlLnByb3RvdHlwZS5nZXRQb2ludGluZyA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5nZXRCdXR0b24oXCJsZWZ0XCIpOyB9O1xuTW91c2UucHJvdG90eXBlLmdldFBvaW50aW5nU3RhcnQgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuZ2V0QnV0dG9uRG93bihcImxlZnRcIik7IH07XG5Nb3VzZS5wcm90b3R5cGUuZ2V0UG9pbnRpbmdFbmQgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuZ2V0QnV0dG9uVXAoXCJsZWZ0XCIpOyB9O1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5pbnB1dC5Ub3VjaFxuICogX2V4dGVuZHMgcGhpbmEuaW5wdXQuSW5wdXRcbiAqL1xuY2xhc3MgVG91Y2gkMSBleHRlbmRzIElucHV0IHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7SFRNTENhbnZhc0VsZW1lbnR9IGRvbUVsZW1lbnRcbiAgICogQHBhcmFtIHtib29sZWFufSBbaXNNdWx0aV1cbiAgICovXG4gIGNvbnN0cnVjdG9yKGRvbUVsZW1lbnQsIGlzTXVsdGkpIHtcbiAgICBzdXBlcihkb21FbGVtZW50KTtcblxuICAgIHRoaXMuaWQgPSBudWxsO1xuXG4gICAgLyoqIEB0eXBlIHtib29sZWFufSAqL1xuICAgIHRoaXMucmVsZWFzZWQgPSB1bmRlZmluZWQ7XG5cbiAgICBpZiAoaXNNdWx0aSA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIDtcbiAgICB9XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbihlKSB7XG4gICAgICBzZWxmLl9zdGFydCh0b3VjaFBvaW50WC5nZXQuY2FsbChlKSwgdG91Y2hQb2ludFkuZ2V0LmNhbGwoZSkpO1xuICAgICAgLy8gc2VsZi5fc3RhcnQoZS5wb2ludFgsIGUucG9pbnRZLCB0cnVlKTtcbiAgICB9KTtcblxuICAgIHRoaXMuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHNlbGYuX2VuZCgpO1xuICAgIH0pO1xuICAgIHRoaXMuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBmdW5jdGlvbihlKSB7XG4gICAgICBzZWxmLl9tb3ZlKHRvdWNoUG9pbnRYLmdldC5jYWxsKGUpLCB0b3VjaFBvaW50WS5nZXQuY2FsbChlKSk7XG4gICAgICAvLyBzZWxmLl9tb3ZlKGUucG9pbnRYLCBlLnBvaW50WSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog44K/44OD44OB44GX44Gm44GE44KL44GL44KS5Yik5a6aXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgZ2V0VG91Y2goKSB7XG4gICAgcmV0dXJuIHRoaXMubm93ICE9IDA7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDjgr/jg4Pjg4Hplovlp4vmmYLjgasgdHJ1ZVxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGdldFRvdWNoU3RhcnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhcnQgIT0gMDtcbiAgfVxuICBcbiAgLyoqXG4gICAqIOOCv+ODg+ODgee1guS6huaZguOBqyB0cnVlXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgZ2V0VG91Y2hFbmQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZW5kICE9IDA7XG4gIH1cblxufVxuXG4vKipcbiAqIEBtZXRob2RcbiAqIOODneOCpOODs+ODhuOCo+ODs+OCsOeKtuaFi+WPluW+lyhtb3VzZSDjgajjga7lt67nlbDlr77nrZYpXG4gKi9cblRvdWNoJDEucHJvdG90eXBlLmdldFBvaW50aW5nICAgICAgICA9IFRvdWNoJDEucHJvdG90eXBlLmdldFRvdWNoO1xuLyoqXG4gKiBAbWV0aG9kXG4gKiDjg53jgqTjg7Pjg4bjgqPjg7PjgrDjgpLplovlp4vjgZfjgZ/jgYvjgpLlj5blvpcobW91c2Ug44Go44Gu5beu55Ww5a++562WKVxuICovXG5Ub3VjaCQxLnByb3RvdHlwZS5nZXRQb2ludGluZ1N0YXJ0ICAgPSBUb3VjaCQxLnByb3RvdHlwZS5nZXRUb3VjaFN0YXJ0O1xuLyoqXG4gKiBAbWV0aG9kXG4gKiDjg53jgqTjg7Pjg4bjgqPjg7PjgrDjgpLntYLkuobjgZfjgZ/jgYvjgpLlj5blvpcobW91c2Ug44Go44Gu5beu55Ww5a++562WKVxuICovXG5Ub3VjaCQxLnByb3RvdHlwZS5nZXRQb2ludGluZ0VuZCAgICAgPSBUb3VjaCQxLnByb3RvdHlwZS5nZXRUb3VjaEVuZDtcblxuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5pbnB1dC5Ub3VjaExpc3RcbiAqL1xuY2xhc3MgVG91Y2hMaXN0IHtcblxuICAvKipcbiAgICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudH0gZG9tRWxlbWVudFxuICAgKi9cbiAgY29uc3RydWN0b3IoZG9tRWxlbWVudCkge1xuICAgIHRoaXMuZG9tRWxlbWVudCA9IGRvbUVsZW1lbnQ7XG5cbiAgICAvKiogQHR5cGUge1RvdWNoW119ICovXG4gICAgdGhpcy50b3VjaGVzID0gW107XG5cbiAgICAvKiogQHR5cGUge3tbaWQ6bnVtYmVyXTogVG91Y2h9fSAqL1xuICAgIHZhciB0b3VjaE1hcCA9IHRoaXMudG91Y2hNYXAgPSB7fTtcblxuICAgIC8vIDMyYml0IOWRqOacn+OBp0lE44KS44Or44O844OX44GV44Gb44KLXG4gICAgdGhpcy5faWQgPSBuZXcgVWludDMyQXJyYXkoMSk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGVhY2ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaDtcbiAgICB0aGlzLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGVhY2guY2FsbChlLmNoYW5nZWRUb3VjaGVzLCBmdW5jdGlvbih0KSB7XG4gICAgICAgIHZhciB0b3VjaCA9IHNlbGYuZ2V0RW1wdHkoKTtcbiAgICAgICAgdG91Y2hNYXBbdC5pZGVudGlmaWVyXSA9IHRvdWNoO1xuICAgICAgICB0b3VjaC5fc3RhcnQocG9pbnRYLmdldC5jYWxsKHQpLCBwb2ludFkuZ2V0LmNhbGwodCkpO1xuICAgICAgICAvLyB0b3VjaC5fc3RhcnQodC5wb2ludFgsIHQucG9pbnRZKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgZnVuY3Rpb24oZSkge1xuICAgICAgZWFjaC5jYWxsKGUuY2hhbmdlZFRvdWNoZXMsIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdmFyIGlkID0gdC5pZGVudGlmaWVyO1xuICAgICAgICB2YXIgdG91Y2ggPSB0b3VjaE1hcFtpZF07XG4gICAgICAgIHRvdWNoLl9lbmQoKTtcbiAgICAgICAgZGVsZXRlIHRvdWNoTWFwW2lkXTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHRoaXMuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBmdW5jdGlvbihlKSB7XG4gICAgICBlYWNoLmNhbGwoZS5jaGFuZ2VkVG91Y2hlcywgZnVuY3Rpb24odCkge1xuICAgICAgICB2YXIgdG91Y2ggPSB0b3VjaE1hcFt0LmlkZW50aWZpZXJdO1xuICAgICAgICB0b3VjaC5fbW92ZShwb2ludFguZ2V0LmNhbGwodCksIHBvaW50WS5nZXQuY2FsbCh0KSk7XG4gICAgICAgIC8vIHRvdWNoLl9tb3ZlKHQucG9pbnRYLCB0LnBvaW50WSk7XG4gICAgICB9KTtcbiAgICAgIHN0b3AuY2FsbChlKTtcbiAgICB9KTtcblxuICAgIC8vIGlQaG9uZSDjgafjga8gNuacrOaMh+S7peS4iuOCv+ODg+ODgeOBmeOCi+OBqOW8t+WItueahOOBq+OBmeOBueOBpuOBruOCv+ODg+ODgeOBjOino+mZpOOBleOCjOOCi1xuICAgIHRoaXMuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGNhbmNlbCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGNvbnNvbGUud2Fybign44GT44Gu56uv5pyr44Gn44Gu5ZCM5pmC44K/44OD44OB5pWw44Gu5Yi26ZmQ44KS6LaF44GI44G+44GX44Gf44CCJyk7XG4gICAgICBlYWNoLmNhbGwoZS5jaGFuZ2VkVG91Y2hlcywgZnVuY3Rpb24odCkge1xuICAgICAgICB2YXIgaWQgPSB0LmlkZW50aWZpZXI7XG4gICAgICAgIHZhciB0b3VjaCA9IHRvdWNoTWFwW2lkXTtcbiAgICAgICAgdG91Y2guX2VuZCgpO1xuICAgICAgICBkZWxldGUgdG91Y2hNYXBbaWRdO1xuICAgICAgfSk7XG4gICAgICBzdG9wLmNhbGwoZSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog56m644GuVG91Y2jjgq/jg6njgrnjgpLnlJ/miJDjgZfjgabov73liqDjgIHov5TjgZlcbiAgICogQHJldHVybnMge1RvdWNofVxuICAgKi9cbiAgZ2V0RW1wdHkoKSB7XG4gICAgdmFyIHRvdWNoID0gbmV3IFRvdWNoJDEodGhpcy5kb21FbGVtZW50LCB0cnVlKTtcbiAgXG4gICAgdG91Y2guaWQgPSB0aGlzLmlkO1xuICAgIHRoaXMudG91Y2hlcy5wdXNoKHRvdWNoKTtcblxuICAgIHJldHVybiB0b3VjaDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlcn0gaWRcbiAgICogQHJldHVybnMge1RvdWNofVxuICAgKi9cbiAgZ2V0VG91Y2goaWQpIHtcbiAgICByZXR1cm4gdGhpcy50b3VjaE1hcFtpZF07XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtUb3VjaH0gdG91Y2hcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICByZW1vdmVUb3VjaCh0b3VjaCkge1xuICAgIHZhciBpID0gdGhpcy50b3VjaGVzLmluZGV4T2YodG91Y2gpO1xuICAgIHRoaXMudG91Y2hlcy5zcGxpY2UoaSwgMSk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICB1cGRhdGUoKSB7XG4gICAgdGhpcy50b3VjaGVzLmZvckVhY2goZnVuY3Rpb24odG91Y2gpIHtcbiAgICAgIGlmICghdG91Y2gucmVsZWFzZWQpIHtcbiAgICAgICAgdG91Y2gudXBkYXRlKCk7XG5cbiAgICAgICAgaWYgKHRvdWNoLmZsYWdzID09PSAwKSB7XG4gICAgICAgICAgdG91Y2gucmVsZWFzZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdG91Y2gucmVsZWFzZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yZW1vdmVUb3VjaCh0b3VjaCk7XG4gICAgICB9XG5cbiAgICB9LCB0aGlzKTtcbiAgfVxuXG4gIGdldCBpZCgpIHsgcmV0dXJuIHRoaXMuX2lkWzBdKys7IH1cblxufVxuXG4vKipcbiAqIEdhbWVwYWQgQVBJ5oyH5a6a44Kk44Oz44K/44O844OV44Kn44Kk44K577yaaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0dhbWVwYWRcbiAqIOa3t+WQjOWbnumBv+OBruOBn+OCgeOBruOCqOOCpOODquOCouOCuVxuICogQHR5cGVkZWYge0dhbWVwYWR9IFJhd0dhbWVwYWRcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5pbnB1dC5HYW1lcGFkTWFuYWdlclxuICogX2V4dGVuZHMgcGhpbmEudXRpbC5FdmVudERpc3BhdGNoZXJcbiAqIFxuICog44Ky44O844Og44OR44OD44OJ44Oe44ON44O844K444Oj44O8LlxuICog44Ky44O844Og44OR44OD44OJ5o6l57aa54q25rOB44Gu55uj6KaW44CB5YCL44CF44Gu44Ky44O844Og44OR44OD44OJ44Gu5YWl5Yqb54q25oWL44Gu5pu05paw44KS6KGM44GGLlxuICovXG5jbGFzcyBHYW1lcGFkTWFuYWdlciBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8qKlxuICAgICAqIOS9nOaIkOa4iOOBv3BoaW5hLmlucHV0LkdhbWVwYWTjgqrjg5bjgrjjgqfjgq/jg4jjga7jg6rjgrnjg4hcbiAgICAgKlxuICAgICAqIEB0eXBlIHtPYmplY3QuPG51bWJlciwgUGhpbmFHYW1lcGFkPn1cbiAgICAgKi9cbiAgICB0aGlzLmdhbWVwYWRzID0ge307XG5cbiAgICAvKipcbiAgICAgKiDkvZzmiJDmuIjjgb/jgrLjg7zjg6Djg5Hjg4Pjg4njga5pbmRleOOBruODquOCueODiFxuICAgICAqIFxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAdHlwZSB7bnVtYmVyW119XG4gICAgICovXG4gICAgdGhpcy5fY3JlYXRlZCA9IFtdO1xuXG4gICAgLyoqXG4gICAgICog44Op44OD44OX5YmNR2FtZXBhZOOBruODquOCueODiFxuICAgICAqIFxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAdHlwZSB7UmF3R2FtZXBhZFtdfVxuICAgICAqL1xuICAgIHRoaXMuX3Jhd2dhbWVwYWRzID0gW107XG5cbiAgICAvKipcbiAgICAgKiBSYXdHYW1lcGFk44GudGltZXN0YW1w44Go44Gu5q+U6LyD55SoXG4gICAgICogXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEB0eXBlIHtPYmplY3QuPG51bWJlciwgbnVtYmVyPn1cbiAgICAgKi9cbiAgICB0aGlzLl9wcmV2VGltZXN0YW1wcyA9IHt9O1xuXG4gICAgLyoqXG4gICAgICogR2FtZXBhZOWPluW+l+mWouaVsFxuICAgICAqIFxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAdHlwZSB7dHlwZW9mIE5hdmlnYXRvci5wcm90b3R5cGUuZ2V0R2FtZXBhZHMgfCAoKCk9PiB2b2lkKX1cbiAgICAgKi9cbiAgICB0aGlzLl9nZXRHYW1lcGFkcztcblxuICAgIC8qKiBAdHlwZSB7Z2xvYmFsVGhpc30gKi9cbiAgICB2YXIgZ2xvYmFsID0gcGhpbmEuZ2xvYmFsO1xuICAgIHZhciBuYXZpZ2F0b3IgPSBnbG9iYWwubmF2aWdhdG9yO1xuICAgIGlmIChuYXZpZ2F0b3IgJiYgbmF2aWdhdG9yLmdldEdhbWVwYWRzKSB7XG4gICAgICB0aGlzLl9nZXRHYW1lcGFkcyA9IG5hdmlnYXRvci5nZXRHYW1lcGFkcy5iaW5kKG5hdmlnYXRvcik7XG4gICAgfSBlbHNlIGlmIChuYXZpZ2F0b3IgJiYgLyoqIEB0eXBlIHthbnl9ICovKG5hdmlnYXRvcilbJ3dlYmtpdEdldEdhbWVwYWRzJ10pIHtcbiAgICAgIHRoaXMuX2dldEdhbWVwYWRzID0gLyoqIEB0eXBlIHthbnl9ICovKG5hdmlnYXRvcilbJ3dlYmtpdEdldEdhbWVwYWRzJ10uYmluZChuYXZpZ2F0b3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9nZXRHYW1lcGFkcyA9IGZ1bmN0aW9uKCkge307XG4gICAgfVxuXG4gICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWVwYWRjb25uZWN0ZWQnLCBcbiAgICAvKiogQHRoaXMgR2FtZXBhZE1hbmFnZXIgKi9cbiAgICBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgZ2FtZXBhZCA9IHRoaXMuZ2V0KGUuZ2FtZXBhZC5pbmRleCk7XG4gICAgICBnYW1lcGFkLmNvbm5lY3RlZCA9IHRydWU7XG4gICAgICB0aGlzLmZsYXJlKCdjb25uZWN0ZWQnLCB7XG4gICAgICAgIGdhbWVwYWQ6IGdhbWVwYWQsXG4gICAgICB9KTtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWVwYWRkaXNjb25uZWN0ZWQnLFxuICAgIC8qKiBAdGhpcyBHYW1lcGFkTWFuYWdlciAqL1xuICAgIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBnYW1lcGFkID0gdGhpcy5nZXQoZS5nYW1lcGFkLmluZGV4KTtcbiAgICAgIGdhbWVwYWQuY29ubmVjdGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmZsYXJlKCdkaXNjb25uZWN0ZWQnLCB7XG4gICAgICAgIGdhbWVwYWQ6IGdhbWVwYWQsXG4gICAgICB9KTtcbiAgICB9LmJpbmQodGhpcykpO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOWHpueQhlxuICAgKiDopoHmr47jg5Xjg6zjg7zjg6Dlrp/ooYxcbiAgICogXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgdXBkYXRlKCkge1xuICAgIHRoaXMuX3BvbGwoKTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBlbmQgPSB0aGlzLl9jcmVhdGVkLmxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICB2YXIgaW5kZXggPSB0aGlzLl9jcmVhdGVkW2ldO1xuICAgICAgdmFyIHJhd2dhbWVwYWQgPSB0aGlzLl9yYXdnYW1lcGFkc1tpbmRleF07XG5cbiAgICAgIGlmICghcmF3Z2FtZXBhZCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJhd2dhbWVwYWQudGltZXN0YW1wICYmIChyYXdnYW1lcGFkLnRpbWVzdGFtcCA9PT0gdGhpcy5fcHJldlRpbWVzdGFtcHNbaV0pKSB7XG4gICAgICAgIHRoaXMuZ2FtZXBhZHNbaW5kZXhdLl91cGRhdGVTdGF0ZUVtcHR5KCk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9wcmV2VGltZXN0YW1wc1tpXSA9IHJhd2dhbWVwYWQudGltZXN0YW1wO1xuICAgICAgdGhpcy5nYW1lcGFkc1tpbmRleF0uX3VwZGF0ZVN0YXRlKHJhd2dhbWVwYWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmjIflrprjgZXjgozjgZ9pbmRleOOBrkdhbWVwYWTjgqrjg5bjgrjjgqfjgq/jg4jjgpLov5TjgZkuXG4gICAqIOacquS9nOaIkOOBruWgtOWQiOOBr+S9nOaIkOOBl+OBpui/lOOBmS5cbiAgICogXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbaW5kZXg9MF1cbiAgICogQHJldHVybnMge1BoaW5hR2FtZXBhZH1cbiAgICovXG4gIGdldChpbmRleCkge1xuICAgIGluZGV4ID0gaW5kZXggfHwgMDtcblxuICAgIGlmICghdGhpcy5nYW1lcGFkc1tpbmRleF0pIHtcbiAgICAgIHRoaXMuX2NyZWF0ZWQucHVzaChpbmRleCk7XG4gICAgICB0aGlzLmdhbWVwYWRzW2luZGV4XSA9IG5ldyBQaGluYUdhbWVwYWQoaW5kZXgpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmdhbWVwYWRzW2luZGV4XTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmjIflrprjgZXjgozjgZ9pbmRleOOBrkdhbWVwYWTjgqrjg5bjgrjjgqfjgq/jg4jjgpLnoLTmo4TjgZnjgosuXG4gICAqIOegtOajhOOBleOCjOOBn0dhbWVwYWTjgqrjg5bjgrjjgqfjgq/jg4jjga/ku6XpmY3mm7TmlrDjgZXjgozjgarjgYQuXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXhcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBkaXNwb3NlKGluZGV4KSB7XG4gICAgaWYgKGNvbnRhaW5zLmNhbGwodGhpcy5fY3JlYXRlZCwgaW5kZXgpKSB7XG4gICAgLy8gaWYgKHRoaXMuX2NyZWF0ZWQuY29udGFpbnMoaW5kZXgpKSB7XG4gICAgICB2YXIgZ2FtZXBhZCA9IHRoaXMuZ2V0KGluZGV4KTtcbiAgICAgIGRlbGV0ZSB0aGlzLmdhbWVwYWRzW2luZGV4XTtcbiAgICAgIGVyYXNlLmNhbGwodGhpcy5fY3JlYXRlZCwgaW5kZXgpO1xuICAgICAgLy8gdGhpcy5fY3JlYXRlZC5lcmFzZShpbmRleCk7XG5cbiAgICAgIGdhbWVwYWQuY29ubmVjdGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaMh+WumuOBleOCjOOBn2luZGV444Gu44Ky44O844Og44OR44OD44OJ44GM5o6l57aa5Lit44GL44Gp44GG44GL44KS6L+U44GZLlxuICAgKiBHYW1lcGFk44Kq44OW44K444Kn44Kv44OI44GM5pyq5L2c5oiQ44Gu5aC05ZCI44Gn44KC5YuV5L2c44GZ44KLLlxuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtpbmRleD0wXVxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGlzQ29ubmVjdGVkKGluZGV4KSB7XG4gICAgaW5kZXggPSBpbmRleCB8fCAwO1xuXG4gICAgcmV0dXJuIHRoaXMuX3Jhd2dhbWVwYWRzW2luZGV4XSAmJiB0aGlzLl9yYXdnYW1lcGFkc1tpbmRleF0uY29ubmVjdGVkO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfcG9sbCgpIHtcbiAgICB2YXIgcmF3R2FtZXBhZHMgPSB0aGlzLl9nZXRHYW1lcGFkcygpO1xuICAgIGlmIChyYXdHYW1lcGFkcykge1xuICAgICAgY2xlYXIuY2FsbCh0aGlzLl9yYXdnYW1lcGFkcyk7XG4gICAgICAvLyB0aGlzLl9yYXdnYW1lcGFkcy5jbGVhcigpO1xuXG4gICAgICBmb3IgKHZhciBpID0gMCwgZW5kID0gcmF3R2FtZXBhZHMubGVuZ3RoOyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgaWYgKHJhd0dhbWVwYWRzW2ldKSB7XG4gICAgICAgICAgdGhpcy5fcmF3Z2FtZXBhZHMucHVzaChcbiAgICAgICAgICAgIC8qKiBAdHlwZSB7UmF3R2FtZXBhZH0gKi8gKHJhd0dhbWVwYWRzW2ldKVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBfc3RhdGljOiB7XG4gIC8vICAgLyoqIOODluODqeOCpuOCtuOBjEdhbWVwYWQgQVBJ44Gr5a++5b+c44GX44Gm44GE44KL44GLLiAqL1xuICAvLyAgIGlzQXZhaWxhYmxlOiAoZnVuY3Rpb24oKSB7XG4gIC8vICAgICB2YXIgbmF2ID0gcGhpbmEuZ2xvYmFsLm5hdmlnYXRvcjtcbiAgLy8gICAgIGlmICghbmF2KSByZXR1cm4gZmFsc2U7XG5cbiAgLy8gICAgIHJldHVybiAoISFuYXYuZ2V0R2FtZXBhZHMpIHx8ICghIW5hdi53ZWJraXRHZXRHYW1lcGFkcyk7XG4gIC8vICAgfSkoKSxcbiAgLy8gfVxuXG59XG5cbi8vIHN0YXRpYyBwcm9wc1xuLyoqIOODluODqeOCpuOCtuOBjEdhbWVwYWQgQVBJ44Gr5a++5b+c44GX44Gm44GE44KL44GLLiAqL1xuR2FtZXBhZE1hbmFnZXIuaXNBdmFpbGFibGUgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBuYXYgPSBwaGluYS5nbG9iYWwubmF2aWdhdG9yO1xuICBpZiAoIW5hdikgcmV0dXJuIGZhbHNlO1xuXG4gIHJldHVybiAoISFuYXYuZ2V0R2FtZXBhZHMpIHx8ICghIW5hdlsnd2Via2l0R2V0R2FtZXBhZHMnXSk7XG59KSgpO1xuXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gUGhpbmFHYW1lcGFkQnV0dG9uU3RhdGUgZ2FtZXBhZOODnOOCv+ODs+ODkeODqeODoeODvOOCv1xuICogQHByb3BlcnR5IHtudW1iZXJ9IHZhbHVlIOODnOOCv+ODs+OBrueKtuaFi+OCkuihqOOBmWRvdWJsZeWei+OBruaVsOWApCDlj4LogIPvvJpodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvR2FtZXBhZEJ1dHRvbi92YWx1ZVxuICogQHByb3BlcnR5IHsqfSBwcmVzc2VkIDAgfCAxIChmYWxzZSB8IHRydWUpXG4gKiBAcHJvcGVydHkgeyp9IGxhc3QgMCB8IDEgKGZhbHNlIHwgdHJ1ZSlcbiAqIEBwcm9wZXJ0eSB7Kn0gZG93biAwIHwgMSAoZmFsc2UgfCB0cnVlKVxuICogQHByb3BlcnR5IHsqfSB1cCAwIHwgMSAoZmFsc2UgfCB0cnVlKVxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmlucHV0LkdhbWVwYWRcbiAqIOOCsuODvOODoOODkeODg+ODiVxuICpcbiAqIOebtOaOpeOCpOODs+OCueOCv+ODs+OCueWMluOBm+OBmuOAgXBoaW5hLmlucHV0LkdhbWVwYWRNYW5hZ2Vy44Kq44OW44K444Kn44Kv44OI44GL44KJ5Y+W5b6X44GX44Gm5L2/55So44GZ44KLLlxuICogXG4gKiDigLtcIkdhbWVwYWRcIuOBqOOBhOOBhuWQjeWJjeOBruOCpOODs+OCv+ODvOODleOCp+OCpOOCueOBjOOBmeOBp+OBq+WtmOWcqOOBmeOCi+OBn+OCgeOAgVxuICog77yIaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0dhbWVwYWTvvIlcbiAqIOa3t+WQjOWbnumBv+OBruOBn+OCgeOCr+ODqeOCueWQjeOCkuWkieabtFxuICovXG5jbGFzcyBQaGluYUdhbWVwYWQge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2luZGV4PTBdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihpbmRleCkge1xuICAgIHRoaXMuaW5kZXggPSBpbmRleCB8fCAwO1xuXG4gICAgLyoqIEB0eXBlIHtQaGluYUdhbWVwYWRCdXR0b25TdGF0ZVtdfSAqL1xuICAgIC8vIHRoaXMuYnV0dG9ucyA9IEFycmF5LnJhbmdlKDAsIDE2KS5tYXAoZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5idXR0b25zID0gcmFuZ2UuY2FsbChbXSwgMCwgMTYpLm1hcChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiAwLFxuICAgICAgICBwcmVzc2VkOiBmYWxzZSxcbiAgICAgICAgbGFzdDogZmFsc2UsXG4gICAgICAgIGRvd246IGZhbHNlLFxuICAgICAgICB1cDogZmFsc2UsXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICog44Ki44OK44Ot44Kw44K544OG44Kj44OD44Kv5YK+44GN566h55CG55SoXG4gICAgICogXG4gICAgICogQHR5cGUge1ZlY3RvcjJbXX1cbiAgICAgKi9cbiAgICB0aGlzLnN0aWNrcyA9IHJhbmdlLmNhbGwoW10sIDAsIDIpLm1hcChmdW5jdGlvbigpIHtcbiAgICAvLyB0aGlzLnN0aWNrcyA9IEFycmF5LnJhbmdlKDAsIDIpLm1hcChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgVmVjdG9yMigwLCAwKTtcbiAgICB9KTtcbiAgICB0aGlzLmlkID0gbnVsbDtcbiAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgIHRoaXMubWFwcGluZyA9IG51bGw7XG4gICAgdGhpcy50aW1lc3RhbXAgPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOODnOOCv+ODs+OBjOaKvOOBleOCjOOBpuOBhOOCi+OBiy5cbiAgICogXG4gICAqIEBwYXJhbSB7bnVtYmVyfGtleW9mIHR5cGVvZiBQaGluYUdhbWVwYWQuQlVUVE9OX0NPREV9IGJ1dHRvbiDjg5zjgr/jg7PjgrPjg7zjg4nmlbDlgKTjgIHjgYLjgovjgYTjga/jg6njg5njg6vmloflrZfliJdcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBnZXRLZXkoYnV0dG9uKSB7XG4gICAgaWYgKHR5cGVvZihidXR0b24pID09PSAnc3RyaW5nJykge1xuICAgICAgYnV0dG9uID0gUGhpbmFHYW1lcGFkLkJVVFRPTl9DT0RFW2J1dHRvbl07XG4gICAgfVxuICAgIGlmICh0aGlzLmJ1dHRvbnNbYnV0dG9uXSkge1xuICAgICAgcmV0dXJuIHRoaXMuYnV0dG9uc1tidXR0b25dLnByZXNzZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog44Oc44K/44Oz44KS5oq844GX44GfLlxuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ8a2V5b2YgdHlwZW9mIFBoaW5hR2FtZXBhZC5CVVRUT05fQ09ERX0gYnV0dG9uIOODnOOCv+ODs+OCs+ODvOODieaVsOWApOOAgeOBguOCi+OBhOOBr+ODqeODmeODq+aWh+Wtl+WIl1xuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGdldEtleURvd24oYnV0dG9uKSB7XG4gICAgaWYgKHR5cGVvZihidXR0b24pID09PSAnc3RyaW5nJykge1xuICAgICAgYnV0dG9uID0gUGhpbmFHYW1lcGFkLkJVVFRPTl9DT0RFW2J1dHRvbl07XG4gICAgfVxuICAgIGlmICh0aGlzLmJ1dHRvbnNbYnV0dG9uXSkge1xuICAgICAgcmV0dXJuIHRoaXMuYnV0dG9uc1tidXR0b25dLmRvd247XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog44Oc44K/44Oz44KS6Zui44GX44GfLlxuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ8a2V5b2YgdHlwZW9mIFBoaW5hR2FtZXBhZC5CVVRUT05fQ09ERX0gYnV0dG9uIOODnOOCv+ODs+OCs+ODvOODieaVsOWApOOAgeOBguOCi+OBhOOBr+ODqeODmeODq+aWh+Wtl+WIl1xuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGdldEtleVVwKGJ1dHRvbikge1xuICAgIGlmICh0eXBlb2YoYnV0dG9uKSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGJ1dHRvbiA9IFBoaW5hR2FtZXBhZC5CVVRUT05fQ09ERVtidXR0b25dO1xuICAgIH1cbiAgICBpZiAodGhpcy5idXR0b25zW2J1dHRvbl0pIHtcbiAgICAgIHJldHVybiB0aGlzLmJ1dHRvbnNbYnV0dG9uXS51cDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDljYHlrZfjgq3jg7zjga7lhaXlipvjgZXjgozjgabjgYTjgovmlrnlkJHjgpLluqbmlbDljZjkvY3jgafov5TjgZnjgIJcbiAgICogXG4gICAqIEByZXR1cm5zIHtudW1iZXIgfCBudWxsfSDjganjga7mlrnlkJHjgavjgoLlvZPjgabjga/jgb7jgonjgarjgYTmmYLjga9udWxsXG4gICAqL1xuICBnZXRLZXlBbmdsZSgpIHtcbiAgICB2YXIgYW5nbGUgPSBudWxsO1xuICAgIHZhciBhcnJvd0JpdCA9XG4gICAgICAodGhpcy5nZXRLZXkoJ2xlZnQnKSA/IDEgOiAwIDw8IDMpIHwgLy8gMTAwMFxuICAgICAgKHRoaXMuZ2V0S2V5KCd1cCcpID8gMSA6IDAgPDwgMikgfCAvLyAwMTAwXG4gICAgICAodGhpcy5nZXRLZXkoJ3JpZ2h0JykgPyAxIDogMCA8PCAxKSB8IC8vIDAwMTBcbiAgICAgICh0aGlzLmdldEtleSgnZG93bicpID8gMSA6IDApOyAvLyAwMDAxXG5cbiAgICBpZiAoYXJyb3dCaXQgIT09IDAgJiYgQVJST1dfQklUX1RPX0FOR0xFX1RBQkxFLmhhc093blByb3BlcnR5KGFycm93Qml0KSkge1xuICAgICAgYW5nbGUgPSBBUlJPV19CSVRfVE9fQU5HTEVfVEFCTEVbXG4gICAgICAgIC8qKiBAdHlwZSB7a2V5b2YgdHlwZW9mIEFSUk9XX0JJVF9UT19BTkdMRV9UQUJMRX0gKi8gKGFycm93Qml0KVxuICAgICAgXTtcbiAgICB9XG5cbiAgICByZXR1cm4gYW5nbGU7XG4gIH1cblxuICAvKipcbiAgICog5Y2B5a2X44Kt44O844Gu5YWl5Yqb44GV44KM44Gm44GE44KL5pa55ZCR44KSVmVjdG9yMuOBp1xuICAgKiDmraPopo/ljJbjgZXjgozjgabjgYTjgosuXG4gICAqIFxuICAgKiBAcmV0dXJucyB7VmVjdG9yMn1cbiAgICovXG4gIGdldEtleURpcmVjdGlvbigpIHtcbiAgICB2YXIgZGlyZWN0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCk7XG5cbiAgICBpZiAodGhpcy5nZXRLZXkoJ2xlZnQnKSkge1xuICAgICAgZGlyZWN0aW9uLnggPSAtMTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZ2V0S2V5KCdyaWdodCcpKSB7XG4gICAgICBkaXJlY3Rpb24ueCA9IDE7XG4gICAgfVxuICAgIGlmICh0aGlzLmdldEtleSgndXAnKSkge1xuICAgICAgZGlyZWN0aW9uLnkgPSAtMTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZ2V0S2V5KCdkb3duJykpIHtcbiAgICAgIGRpcmVjdGlvbi55ID0gMTtcbiAgICB9XG5cbiAgICBpZiAoZGlyZWN0aW9uLnggJiYgZGlyZWN0aW9uLnkpIHtcbiAgICAgIGRpcmVjdGlvbi5kaXYoTWF0aC5TUVJUMik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRpcmVjdGlvbjtcbiAgfVxuXG4gIC8qKlxuICAgKiDjgrnjg4bjgqPjg4Pjgq/jga7lhaXlipvjgZXjgozjgabjgYTjgovmlrnlkJEuXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gW3N0aWNrSWQ9MF1cbiAgICogQHJldHVybnMge251bWJlciB8IG51bGx9IOWvvuW/nOOBmeOCi+OCueODhuOCo+ODg+OCr+OBjOOBquOBhOWgtOWQiOOBr251bGxcbiAgICovXG4gIGdldFN0aWNrQW5nbGUoc3RpY2tJZCkge1xuICAgIHN0aWNrSWQgPSBzdGlja0lkIHx8IDA7XG4gICAgdmFyIHN0aWNrID0gdGhpcy5zdGlja3Nbc3RpY2tJZF07XG4gICAgcmV0dXJuIHN0aWNrID8gTWF0aC5hdGFuMigtc3RpY2sueSwgc3RpY2sueCkgOiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCueODhuOCo+ODg+OCr+OBruWFpeWKm+OBleOCjOOBpuOBhOOCi+aWueWQkeOCklZlY3RvcjLjgaflj5blvpdcbiAgICogXG4gICAqIFZlY3RvcjLjga/lj4Lnhafjgafjga/jgarjgY/jgIHopIfoo73jgZXjgozjgabov5TljbTjgZXjgozjgotcbiAgICogXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbc3RpY2tJZD0wXSDnnIHnlaXjgZnjgovjgagw77yI6YCa5bi45bem44Ki44OK44Ot44Kw44K544OG44Kj44OD44Kv44Gr5a++5b+c44GZ44KLaWTvvInjgajjgarjgotcbiAgICogQHJldHVybnMge1ZlY3RvcjJ9IOWvvuW/nOOBmeOCi+OCueODhuOCo+ODg+OCr+OBjOWtmOWcqOOBl+OBquOBhOWgtOWQiOOBr+WIneacn+WMluOBl+OBn1ZlY3RvcjLjgpLov5TljbRcbiAgICovXG4gIGdldFN0aWNrRGlyZWN0aW9uKHN0aWNrSWQpIHtcbiAgICBzdGlja0lkID0gc3RpY2tJZCB8fCAwO1xuICAgIHJldHVybiB0aGlzLnN0aWNrcyA/IHRoaXMuc3RpY2tzW3N0aWNrSWRdLmNsb25lKCkgOiBuZXcgVmVjdG9yMigwLCAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHVibGljIEdhbWVwYWRNYW5hZ2Vy44GL44KJ44Ki44Kv44K744K5XG4gICAqIEBwYXJhbSB7UmF3R2FtZXBhZH0gZ2FtZXBhZFxuICAgKi9cbiAgX3VwZGF0ZVN0YXRlKGdhbWVwYWQpIHtcbiAgICB0aGlzLmlkID0gZ2FtZXBhZC5pZDtcbiAgICB0aGlzLmNvbm5lY3RlZCA9IGdhbWVwYWQuY29ubmVjdGVkO1xuICAgIHRoaXMubWFwcGluZyA9IGdhbWVwYWQubWFwcGluZztcbiAgICB0aGlzLnRpbWVzdGFtcCA9IGdhbWVwYWQudGltZXN0YW1wO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGllbmQgPSBnYW1lcGFkLmJ1dHRvbnMubGVuZ3RoOyBpIDwgaWVuZDsgaSsrKSB7XG4gICAgICB0aGlzLl91cGRhdGVCdXR0b24oZ2FtZXBhZC5idXR0b25zW2ldLCBpKTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBqID0gMCwgamVuZCA9IGdhbWVwYWQuYXhlcy5sZW5ndGg7IGogPCBqZW5kOyBqICs9IDIpIHtcbiAgICAgIHRoaXMuX3VwZGF0ZVN0aWNrKGdhbWVwYWQuYXhlc1tqICsgMF0sIGogLyAyLCAneCcpO1xuICAgICAgdGhpcy5fdXBkYXRlU3RpY2soZ2FtZXBhZC5heGVzW2ogKyAxXSwgaiAvIDIsICd5Jyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOODnOOCv+ODs+OBruWFpeWKm+eKtuaFi+OCkuODquOCu+ODg+ODiFxuICAgKiBcbiAgICogQHB1YmxpYyBHYW1lcGFkTWFuYWdlcuOBi+OCieOCouOCr+OCu+OCuVxuICAgKi9cbiAgX3VwZGF0ZVN0YXRlRW1wdHkoKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGllbmQgPSB0aGlzLmJ1dHRvbnMubGVuZ3RoOyBpIDwgaWVuZDsgaSsrKSB7XG4gICAgICB0aGlzLmJ1dHRvbnNbaV0uZG93biA9IGZhbHNlO1xuICAgICAgdGhpcy5idXR0b25zW2ldLnVwID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgIC8qKlxuICAgICogQHByb3RlY3RlZFxuICAgICogQHBhcmFtIHtudW1iZXIgfCBHYW1lcGFkQnV0dG9ufSB2YWx1ZVxuICAgICogQHBhcmFtIHtudW1iZXJ9IGJ1dHRvbklkXG4gICAgKi9cbiAgIF91cGRhdGVCdXR0b24odmFsdWUsIGJ1dHRvbklkKSB7XG4gICAgaWYgKHRoaXMuYnV0dG9uc1tidXR0b25JZF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5idXR0b25zW2J1dHRvbklkXSA9IHtcbiAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgIHByZXNzZWQ6IGZhbHNlLFxuICAgICAgICBsYXN0OiBmYWxzZSxcbiAgICAgICAgZG93bjogZmFsc2UsXG4gICAgICAgIHVwOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIHZhciBidXR0b24gPSB0aGlzLmJ1dHRvbnNbYnV0dG9uSWRdO1xuXG4gICAgYnV0dG9uLmxhc3QgPSBidXR0b24ucHJlc3NlZDtcblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICBidXR0b24udmFsdWUgPSB2YWx1ZS52YWx1ZTtcbiAgICAgIGJ1dHRvbi5wcmVzc2VkID0gdmFsdWUucHJlc3NlZDtcbiAgICB9IGVsc2Uge1xuICAgICAgYnV0dG9uLnZhbHVlID0gdmFsdWU7XG4gICAgICBidXR0b24ucHJlc3NlZCA9IHZhbHVlID4gUGhpbmFHYW1lcGFkLkFOQUxPR1VFX0JVVFRPTl9USFJFU0hPTEQ7XG4gICAgfVxuXG4gICAgYnV0dG9uLmRvd24gPSAoYnV0dG9uLnByZXNzZWQgXiBidXR0b24ubGFzdCkgJiBidXR0b24ucHJlc3NlZDtcbiAgICBidXR0b24udXAgPSAoYnV0dG9uLnByZXNzZWQgXiBidXR0b24ubGFzdCkgJiBidXR0b24ubGFzdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICAgKiBAcGFyYW0ge251bWJlcn0gc3RpY2tJZFxuICAgKiBAcGFyYW0ge1wieFwifFwieVwifSBheGlzTmFtZVxuICAgKi9cbiAgX3VwZGF0ZVN0aWNrKHZhbHVlLCBzdGlja0lkLCBheGlzTmFtZSkge1xuICAgIGlmICh0aGlzLnN0aWNrc1tzdGlja0lkXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnN0aWNrc1tzdGlja0lkXSA9IG5ldyBWZWN0b3IyKDAsIDApO1xuICAgIH1cbiAgICB0aGlzLnN0aWNrc1tzdGlja0lkXVtheGlzTmFtZV0gPSB2YWx1ZTtcbiAgfVxuXG59XG5cbi8qKiDjg5bjg6njgqbjgrbjgYxHYW1lcGFkIEFQSeOBq+WvvuW/nOOBl+OBpuOBhOOCi+OBiy4gKi9cblBoaW5hR2FtZXBhZC5pc0F2YWlsYWJsZSA9IChmdW5jdGlvbigpIHtcbiAgdmFyIG5hdiA9IHBoaW5hLmdsb2JhbC5uYXZpZ2F0b3I7XG4gIGlmICghbmF2KSByZXR1cm4gZmFsc2U7XG5cbiAgcmV0dXJuICghIW5hdi5nZXRHYW1lcGFkcykgfHwgKCEhbmF2Wyd3ZWJraXRHZXRHYW1lcGFkcyddKTtcbn0pKCk7XG5cbi8qKiDjgqLjg4rjg63jgrDlhaXlipvlr77lv5zjga7jg5zjgr/jg7Pjga7loLTlkIjjgIHjganjga7nqIvluqbjgb7jgafmirzjgZfovrzjgoDjgahvbuOBq+OBquOCi+OBi+OCkuihqOOBmeOBl+OBjeOBhOWApC4gKi9cblBoaW5hR2FtZXBhZC5BTkFMT0dVRV9CVVRUT05fVEhSRVNIT0xEID0gMC41O1xuXG4vKiog44Oc44K/44Oz5ZCN44Go44Oc44K/44OzSUTjga7jg57jg4Pjg5cuICovXG5QaGluYUdhbWVwYWQuQlVUVE9OX0NPREUgPSB7XG4gICdhJzogMCxcbiAgJ2InOiAxLFxuICAneCc6IDIsXG4gICd5JzogMyxcblxuICAnbDEnOiA0LFxuICAncjEnOiA1LFxuICAnbDInOiA2LFxuICAncjInOiA3LFxuXG4gICdzZWxlY3QnOiA4LFxuICAnc3RhcnQnOiA5LFxuXG4gICdsMyc6IDEwLFxuICAncjMnOiAxMSxcblxuICAndXAnOiAxMixcbiAgJ2Rvd24nOiAxMyxcbiAgJ2xlZnQnOiAxNCxcbiAgJ3JpZ2h0JzogMTUsXG5cbiAgJ3NwZWNpYWwnOiAxNixcblxuICAnQSc6IDAsXG4gICdCJzogMSxcbiAgJ1gnOiAyLFxuICAnWSc6IDMsXG5cbiAgJ0wxJzogNCxcbiAgJ1IxJzogNSxcbiAgJ0wyJzogNixcbiAgJ1IyJzogNyxcblxuICAnU0VMRUNUJzogOCxcbiAgJ1NUQVJUJzogOSxcblxuICAnTDMnOiAxMCxcbiAgJ1IzJzogMTEsXG5cbiAgJ1VQJzogMTIsXG4gICdET1dOJzogMTMsXG4gICdMRUZUJzogMTQsXG4gICdSSUdIVCc6IDE1LFxuXG4gICdTUEVDSUFMJzogMTYsXG59O1xuXG52YXIgQVJST1dfQklUX1RPX0FOR0xFX1RBQkxFID0ge1xuICAweDAwOiBudWxsLFxuXG4gIC8qIEBwcm9wZXJ0eSDkuIsgKi9cbiAgMHgwMTogMjcwLFxuICAvKiBAcHJvcGVydHkg5Y+zICovXG4gIDB4MDI6IDAsXG4gIC8qIEBwcm9wZXJ0eSDkuIogKi9cbiAgMHgwNDogOTAsXG4gIC8qIEBwcm9wZXJ0eSDlt6YgKi9cbiAgMHgwODogMTgwLFxuXG4gIC8qIEBwcm9wZXJ0eSDlj7PkuIogKi9cbiAgMHgwNjogNDUsXG4gIC8qIEBwcm9wZXJ0eSDlj7PkuIsgKi9cbiAgMHgwMzogMzE1LFxuICAvKiBAcHJvcGVydHkg5bem5LiKICovXG4gIDB4MGM6IDEzNSxcbiAgLyogQHByb3BlcnR5IOW3puS4iyAqL1xuICAweDA5OiAyMjUsXG5cbiAgLy8g5LiJ5pa55ZCR5ZCM5pmC5oq844GX5a++5b+cXG4gIC8vIOaDs+WumuWkluOBruaTjeS9nOOBoOOBjOWvvuW/nOOBl+OBqOOBhOOBn+OBu+OBhuOBjOeEoembo1xuICAvKiBAcHJvcGVydHkg5Y+z5LiK5bemICovXG4gIDB4MGU6IDkwLFxuICAvKiBAcHJvcGVydHkg5LiK5bem5LiLICovXG4gIDB4MGQ6IDE4MCxcbiAgLyogQHByb3BlcnR5IOW3puS4i+WPsyAqL1xuICAweDBiOiAyNzAsXG4gIC8qIEBwcm9wZXJ0eSDkuIvlj7PkuIogKi9cbiAgMHgwNzogMCxcbn07XG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmlucHV0LkFjY2VsZXJvbWV0ZXJcbiAqIOOCueODnuODvOODiOODleOCqeODs+OBruOCu+ODs+OCteODvOaDheWgsVxuICovXG5jbGFzcyBBY2NlbGVyb21ldGVyIHtcbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLyoqIEBwcm9wZXJ0eSAgZ3Jhdml0eSDph43lipvjgrvjg7PjgrXjg7wgKi9cbiAgICB0aGlzLmdyYXZpdHkgICAgICAgID0gbmV3IFZlY3RvcjMoMCwgMCwgMCk7XG5cbiAgICAvKiogQHByb3BlcnR5ICBhY2NlbGVyYXRpb24g5Yqg6YCf5bqm44K744Oz44K144O8ICovXG4gICAgdGhpcy5hY2NlbGVyYXRpb24gICA9IG5ldyBWZWN0b3IzKDAsIDAsIDApO1xuXG4gICAgLyoqIEBwcm9wZXJ0eSAgcm90YXRpb24g5Zue6Lui5Yqg6YCf5bqm44K744Oz44K144O8ICovXG4gICAgdGhpcy5yb3RhdGlvbiAgICAgICA9IG5ldyBWZWN0b3IzKDAsIDAsIDApO1xuXG4gICAgLyoqIEBwcm9wZXJ0eSAgb3JpZW50YXRpb24g44K544Oe44O844OI44OV44Kp44Oz44Gu5YK+44GNICovXG4gICAgdGhpcy5vcmllbnRhdGlvbiAgICA9IG5ldyBWZWN0b3IzKDAsIDAsIDApO1xuXG4gICAgaWYgKHBoaW5hLmlzTW9iaWxlKCkpIHtcbiAgICAgIHBoaW5hLmdsb2JhbC5hZGRFdmVudExpc3RlbmVyKFwiZGV2aWNlbW90aW9uXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIGFjY2VsZXJhdGlvbiA9IHNlbGYuYWNjZWxlcmF0aW9uO1xuICAgICAgICB2YXIgZ3Jhdml0eSA9IHNlbGYuZ3Jhdml0eTtcbiAgICAgICAgdmFyIHJvdGF0aW9uID0gc2VsZi5yb3RhdGlvbjtcbiAgICAgICAgXG4gICAgICAgIGlmIChlLmFjY2VsZXJhdGlvbikge1xuICAgICAgICAgIGFjY2VsZXJhdGlvbi54ID0gZS5hY2NlbGVyYXRpb24ueDtcbiAgICAgICAgICBhY2NlbGVyYXRpb24ueSA9IGUuYWNjZWxlcmF0aW9uLnk7XG4gICAgICAgICAgYWNjZWxlcmF0aW9uLnogPSBlLmFjY2VsZXJhdGlvbi56O1xuICAgICAgICB9XG4gICAgICAgIGlmIChlLmFjY2VsZXJhdGlvbkluY2x1ZGluZ0dyYXZpdHkpIHtcbiAgICAgICAgICBncmF2aXR5LnggPSBlLmFjY2VsZXJhdGlvbkluY2x1ZGluZ0dyYXZpdHkueDtcbiAgICAgICAgICBncmF2aXR5LnkgPSBlLmFjY2VsZXJhdGlvbkluY2x1ZGluZ0dyYXZpdHkueTtcbiAgICAgICAgICBncmF2aXR5LnogPSBlLmFjY2VsZXJhdGlvbkluY2x1ZGluZ0dyYXZpdHkuejtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZS5yb3RhdGlvblJhdGUpIHtcbiAgICAgICAgICByb3RhdGlvbi54ID0gcm90YXRpb24uYmV0YSAgPSBlLnJvdGF0aW9uUmF0ZS5iZXRhO1xuICAgICAgICAgIHJvdGF0aW9uLnkgPSByb3RhdGlvbi5nYW1tYSA9IGUucm90YXRpb25SYXRlLmdhbW1hO1xuICAgICAgICAgIHJvdGF0aW9uLnogPSByb3RhdGlvbi5hbHBoYSA9IGUucm90YXRpb25SYXRlLmFscGhhO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgcGhpbmEuZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJkZXZpY2VvcmllbnRhdGlvblwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciBvcmllbnRhdGlvbiA9IHNlbGYub3JpZW50YXRpb247XG4gICAgICAgIG9yaWVudGF0aW9uLmFscGhhICAgPSBlLmFscGhhOyAgLy8geigwfjM2MClcbiAgICAgICAgb3JpZW50YXRpb24uYmV0YSAgICA9IGUuYmV0YTsgICAvLyB4KC0xODB+MTgwKVxuICAgICAgICBvcmllbnRhdGlvbi5nYW1tYSAgID0gZS5nYW1tYTsgIC8vIHkoLTkwfjkwKVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbn1cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuYXBwLlVwZGF0ZXJcbiAqL1xuY2xhc3MgVXBkYXRlciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9nYW1lL2dhbWVhcHAnKS5BcHBVbmlvbn0gYXBwXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICB0aGlzLmFwcCA9IGFwcDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vYXBwL3NjZW5lJykuU2NlbmV9IHJvb3QgXG4gICAqL1xuICB1cGRhdGUocm9vdCkge1xuICAgIHRoaXMuX3VwZGF0ZUVsZW1lbnQocm9vdCk7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtpbXBvcnQoJy4uL2FwcC9lbGVtZW50JykuRWxlbWVudH0gZWxlbWVudFxuICAgKi9cbiAgX3VwZGF0ZUVsZW1lbnQoZWxlbWVudCkge1xuICAgIHZhciBhcHAgPSB0aGlzLmFwcDtcblxuICAgIC8vIOabtOaWsOOBmeOCi+OBi+OCkuWIpOWumlxuICAgIGlmIChlbGVtZW50LmF3YWtlID09PSBmYWxzZSkgcmV0dXJuIDtcblxuICAgIC8vIOOCqOODs+OCv+ODvOODleODrOODvOODoOOCpOODmeODs+ODiFxuICAgIGlmIChlbGVtZW50LmhhcygnZW50ZXJmcmFtZScpKSB7XG4gICAgICBlbGVtZW50LmZsYXJlKCdlbnRlcmZyYW1lJywge1xuICAgICAgICBhcHA6IHRoaXMuYXBwLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8g5pu05pawXG4gICAgaWYgKGVsZW1lbnQudXBkYXRlKSBlbGVtZW50LnVwZGF0ZShhcHApO1xuXG4gICAgLy8g5a2Q5L6b44KS5pu05pawXG4gICAgdmFyIGxlbiA9IGVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoO1xuICAgIGlmIChlbGVtZW50LmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgIHZhciB0ZW1wQ2hpbGRyZW4gPSBlbGVtZW50LmNoaWxkcmVuLnNsaWNlKCk7XG4gICAgICBmb3IgKHZhciBpPTA7IGk8bGVuOyArK2kpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlRWxlbWVudCh0ZW1wQ2hpbGRyZW5baV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG59XG5cbi8qKlxuICogSW50ZXJhY3RpdmXjgq/jg6njgrnjga5hcHDjgajjgZfjgablv4XopoHjgarjg5fjg63jg5Hjg4bjgqNcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIG9uOiB0eXBlb2YgaW1wb3J0KCcuLi91dGlsL2V2ZW50ZGlzcGF0Y2hlcicpLkV2ZW50RGlzcGF0Y2hlci5wcm90b3R5cGUub25cbiAqICAgZG9tRWxlbWVudD86IEhUTUxDYW52YXNFbGVtZW50XG4gKiAgIHBvaW50ZXI/OiBpbXBvcnQoJy4uL2Rpc3BsYXkvZG9tYXBwJykuUG9pbnRlclxuICogICBwb2ludGVycz86IGltcG9ydCgnLi4vZGlzcGxheS9kb21hcHAnKS5Qb2ludGVyW11cbiAqIH19IEludGVyYWN0YWJsZUFwcFxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFwcC5JbnRlcmFjdGl2ZVxuICovXG5jbGFzcyBJbnRlcmFjdGl2ZSB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7SW50ZXJhY3RhYmxlQXBwfSBhcHAgXG4gICAqL1xuICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICB0aGlzLl9lbmFibGUgPSB0cnVlO1xuICAgIHRoaXMubXVsdGlUb3VjaCA9IHRydWU7XG4gICAgdGhpcy5jdXJzb3IgPSB7XG4gICAgICBub3JtYWw6ICcnLFxuICAgICAgaG92ZXI6ICdwb2ludGVyJyxcbiAgICB9O1xuXG4gICAgLyoqIEB0eXBlIHtpbXBvcnQoJy4vb2JqZWN0MmQnKS5PYmplY3QyRFtdfSAqL1xuICAgIHRoaXMuX2hvbGRzID0gW107XG4gICAgdGhpcy5hcHAub24oJ2NoYW5nZXNjZW5lJywgZnVuY3Rpb24oKSB7XG4gICAgICBjbGVhci5jYWxsKHRoaXMuX2hvbGRzKTtcbiAgICAgIC8vIHRoaXMuX2hvbGRzLmNsZWFyKCk7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGVuYWJsZSgpIHtcbiAgICB0aGlzLl9lbmFibGUgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZGlzYWJsZSgpIHtcbiAgICB0aGlzLl9lbmFibGUgPSBmYWxzZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDmjIflrpropoHntKDjga7jgqTjg7Pjgr/jg6njgq/jgrfjg6fjg7Pjg4Hjgqfjg4Pjgq/plovlp4sgIFxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi9lbGVtZW50JykuRWxlbWVudCB8IGltcG9ydCgnLi9vYmplY3QyZCcpLk9iamVjdDJEfSByb290IFNjZW5l44Kv44Op44K544Gr5rih44GV44KM44KL44Gf44KBXG4gICAqL1xuICBjaGVjayhyb290KSB7XG4gICAgLy8g44Kr44O844K944Or44Gu44K544K/44Kk44Or44KS5Y+N5pigXG4gICAgaWYgKHRoaXMuYXBwLmRvbUVsZW1lbnQpIHtcbiAgICAgIGlmICh0aGlzLl9ob2xkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMuYXBwLmRvbUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gdGhpcy5jdXJzb3IuaG92ZXI7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5hcHAuZG9tRWxlbWVudC5zdHlsZS5jdXJzb3IgPSB0aGlzLmN1cnNvci5ub3JtYWw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLl9lbmFibGUgfHwgIXRoaXMuYXBwLnBvaW50ZXJzKSByZXR1cm4gO1xuICAgIHRoaXMuX2NoZWNrRWxlbWVudChyb290KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmjIflrpropoHntKDjga7jgqTjg7Pjgr/jg6njgq/jgrfjg6fjg7Pjg4Hjgqfjg4Pjgq8gIFxuICAgKiDlrZDkvpvjgYzjgYTjgozjgbDlho3luLDlh6bnkIZcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtpbXBvcnQoJy4vZWxlbWVudCcpLkVsZW1lbnQgfCBpbXBvcnQoJy4vb2JqZWN0MmQnKS5PYmplY3QyRH0gZWxlbWVudCBcbiAgICovXG4gIF9jaGVja0VsZW1lbnQoZWxlbWVudCkge1xuICAgIHZhciBhcHAgPSB0aGlzLmFwcDtcblxuICAgIC8vIOabtOaWsOOBmeOCi+OBi+OCkuWIpOWumlxuICAgIGlmIChlbGVtZW50LmF3YWtlID09PSBmYWxzZSkgcmV0dXJuIDtcblxuICAgIC8vIOWtkOS+m+OCkuabtOaWsFxuICAgIHZhciBsZW4gPSBlbGVtZW50LmNoaWxkcmVuLmxlbmd0aDtcbiAgICBpZiAoZWxlbWVudC5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgdGVtcENoaWxkcmVuID0gZWxlbWVudC5jaGlsZHJlbi5zbGljZSgpO1xuICAgICAgZm9yICh2YXIgaT0wOyBpPGxlbjsgKytpKSB7XG4gICAgICAgIHRoaXMuX2NoZWNrRWxlbWVudCh0ZW1wQ2hpbGRyZW5baV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIOOCv+ODg+ODgeWIpOWumlxuICAgIHRoaXMuX2NoZWNrUG9pbnQoZWxlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICog44K/44OD44OB5Yik5a6a44KS6KGM44GGXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuL2VsZW1lbnQnKS5FbGVtZW50IHwgaW1wb3J0KCcuL29iamVjdDJkJykuT2JqZWN0MkR9IG9iaiBcbiAgICovXG4gIF9jaGVja1BvaW50KG9iaikge1xuICAgIHZhciBfb2JqID0gLyoqIEB0eXBlIHtpbXBvcnQoJy4vb2JqZWN0MmQnKS5PYmplY3QyRH0gKi8ob2JqKTtcbiAgICBpZiAodGhpcy5tdWx0aVRvdWNoKSB7XG4gICAgICB0aGlzLmFwcC5wb2ludGVycy5mb3JFYWNoKGZ1bmN0aW9uKHApIHtcbiAgICAgICAgaWYgKHAuaWQgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLl9fY2hlY2tQb2ludChfb2JqLCBwKTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5fX2NoZWNrUG9pbnQoX29iaiwgdGhpcy5hcHAucG9pbnRlcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuL29iamVjdDJkJykuT2JqZWN0MkR9IG9ialxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZGlzcGxheS9kb21hcHAnKS5Qb2ludGVyfSBwXG4gICAqL1xuICBfX2NoZWNrUG9pbnQob2JqLCBwKSB7XG4gICAgaWYgKCFvYmouaW50ZXJhY3RpdmUpIHJldHVybiA7XG5cbiAgICB2YXIgcHJldk92ZXJGbGFnID0gb2JqLl9vdmVyRmxhZ3NbcC5pZF07XG4gICAgdmFyIG92ZXJGbGFnID0gb2JqLmhpdFRlc3QocC54LCBwLnkpO1xuICAgIG9iai5fb3ZlckZsYWdzW3AuaWRdID0gb3ZlckZsYWc7XG5cbiAgICB2YXIgZSA9IHtcbiAgICAgIHBvaW50ZXI6IHAsXG4gICAgICBpbnRlcmFjdGl2ZTogdGhpcyxcbiAgICAgIG92ZXI6IG92ZXJGbGFnLFxuICAgIH07XG5cbiAgICBpZiAoIXByZXZPdmVyRmxhZyAmJiBvdmVyRmxhZykge1xuICAgICAgb2JqLmZsYXJlKCdwb2ludG92ZXInLCBlKTtcblxuICAgICAgaWYgKG9iai5ib3VuZGluZ1R5cGUgJiYgb2JqLmJvdW5kaW5nVHlwZSAhPT0gJ25vbmUnKSB7XG4gICAgICAgIHRoaXMuX2hvbGRzLnB1c2gob2JqKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHByZXZPdmVyRmxhZyAmJiAhb3ZlckZsYWcpIHtcbiAgICAgIG9iai5mbGFyZSgncG9pbnRvdXQnLCBlKTtcbiAgICAgIC8vIHRoaXMuX2hvbGRzLmVyYXNlKG9iaik7XG4gICAgICBlcmFzZS5jYWxsKHRoaXMuX2hvbGRzLCBvYmopO1xuICAgIH1cblxuICAgIGlmIChvdmVyRmxhZykge1xuICAgICAgaWYgKHAuZ2V0UG9pbnRpbmdTdGFydCgpKSB7XG4gICAgICAgIG9iai5fdG91Y2hGbGFnc1twLmlkXSA9IHRydWU7XG4gICAgICAgIG9iai5mbGFyZSgncG9pbnRzdGFydCcsIGUpO1xuICAgICAgICAvLyDjgq/jg6rjg4Pjgq/jg5Xjg6njgrDjgpLnq4vjgabjgotcbiAgICAgICAgb2JqLl9jbGlja2VkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob2JqLl90b3VjaEZsYWdzW3AuaWRdKSB7XG4gICAgICBvYmouZmxhcmUoJ3BvaW50c3RheScsIGUpO1xuICAgICAgaWYgKHAuX21vdmVGbGFnKSB7XG4gICAgICAgIG9iai5mbGFyZSgncG9pbnRtb3ZlJywgZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9iai5fdG91Y2hGbGFnc1twLmlkXT09PXRydWUgJiYgcC5nZXRQb2ludGluZ0VuZCgpKSB7XG4gICAgICBvYmouX3RvdWNoRmxhZ3NbcC5pZF0gPSBmYWxzZTtcbiAgICAgIG9iai5mbGFyZSgncG9pbnRlbmQnLCBlKTtcblxuICAgICAgaWYgKHBoaW5hLmlzTW9iaWxlKCkgJiYgb2JqLl9vdmVyRmxhZ3NbcC5pZF0pIHtcbiAgICAgICAgb2JqLl9vdmVyRmxhZ3NbcC5pZF0gPSBmYWxzZTtcbiAgICAgICAgb2JqLmZsYXJlKCdwb2ludG91dCcsIGUpO1xuICAgICAgICAvLyB0aGlzLl9ob2xkcy5lcmFzZShvYmopO1xuICAgICAgICBlcmFzZS5jYWxsKHRoaXMuX2hvbGRzLCBvYmopO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG59XG5cbi8qKlxuICogQWNjZXNzb3J544GudGFyZ2V044OX44Ot44OR44OG44Kj44Go44GX44Gm5pyA5L2O6ZmQ44GL44Gp44GG44GLXG4gKiBAdHlwZWRlZiB7e1xuICogICBkZXRhY2g6IChhY2Nlc3NvcjogQWNjZXNzb3J5KT0+IGFueVxuICogICBbazogc3RyaW5nXTogYW55XG4gKiB9fSBBY2Nlc3NvcnlUYXJnZXRcbiAqL1xuXG4vKipcbiAqIEFjY2Vzc29yeeOCouOCv+ODg+ODgeWPr+iDveOCquODluOCuOOCp+OCr+ODiFxuICogQHR5cGVkZWYge3tcbiAqICAgYXR0YWNoOiAoYWNjZXNzb3I6IEFjY2Vzc29yeSk9PiBhbnlcbiAqIH0gJiBBY2Nlc3NvcnlUYXJnZXQgfSBBY2Nlc3NvcnlBdHRhY2hhYmxlXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuYWNjZXNzb3J5LkFjY2Vzc29yeVxuICogX2V4dGVuZHMgcGhpbmEudXRpbC5FdmVudERpc3BhdGNoZXJcbiAqL1xuY2xhc3MgQWNjZXNzb3J5IGV4dGVuZHMgRXZlbnREaXNwYXRjaGVyIHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7QWNjZXNzb3J5VGFyZ2V0fSBbdGFyZ2V0XVxuICAgKi9cbiAgY29uc3RydWN0b3IodGFyZ2V0KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8qKlxuICAgICAqIOaTjeS9nOWvvuixoVxuICAgICAqIEB0eXBlIHtBY2Nlc3NvcnlUYXJnZXQgfCB1bmRlZmluZWR9XG4gICAgICovXG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw6Zai5pWwXG4gICAqIOOCouOCv+ODg+ODgeOBl+OBn3RhcmdldOOBrmVudGVyZnJhbWXjgqTjg5njg7Pjg4jjgpLntYznlLHjgZfjgaZcbiAgICog5q+O44OV44Os44O844Og5a6f6KGM44GV44KM44KLXG4gICAqIFxuICAgKiDkuLvjgavjgrXjg5bjgq/jg6njgrnjgafmi6HlvLXjgZfjgaZBY2Nlc3NvcnnjgajjgZfjgabjga7nibnlvrTjgaXjgZHjgpLooYzjgYZcbiAgICogXG4gICAqIEB2aXJ0dWFsXG4gICAqIEBwcm90ZWN0ZWRcbiAgICogQHBhcmFtIHsqfSBfYXBwIEFwcOOCr+ODqeOCueOCpOODs+OCueOCv+ODs+OCuVxuICAgKi9cbiAgdXBkYXRlKF9hcHApIHt9XG5cbiAgLyoqXG4gICAqIOaTjeS9nOWvvuixoeOCkuioreWumlxuICAgKiBcbiAgICogQHBhcmFtIHtBY2Nlc3NvcnlUYXJnZXR9IHRhcmdldFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldFRhcmdldCh0YXJnZXQpIHtcbiAgICBpZiAodGhpcy50YXJnZXQgPT09IHRhcmdldCkgcmV0dXJuIHRoaXM7XG5cbiAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjgqLjgr/jg4Pjg4Hlr77osaHjgpLov5TjgZlcbiAgICogXG4gICAqIEByZXR1cm5zIHtBY2Nlc3NvcnlUYXJnZXQgfCB1bmRlZmluZWR9XG4gICAqL1xuICBnZXRUYXJnZXQoKSB7XG4gICAgcmV0dXJuIHRoaXMudGFyZ2V0O1xuICB9XG5cbiAgLyoqXG4gICAqIOOCouOCv+ODg+ODgeWvvuixoeOBjOWtmOWcqOOBmeOCi+OBi+OBqeOBhuOBi1xuICAgKiBcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBpc0F0dGFjaGVkKCkge1xuICAgIHJldHVybiAhIXRoaXMudGFyZ2V0O1xuICB9XG5cbiAgLyoqXG4gICAqIOWvvuixoeOBq+iHqui6q+OCkuOCouOCv+ODg+ODgeOBleOBm+OCi1xuICAgKiBcbiAgICogQHRlbXBsYXRlIHtBY2Nlc3NvcnlBdHRhY2hhYmxlfSBUXG4gICAqIEBwYXJhbSB7VH0gZWxlbWVudFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGF0dGFjaFRvKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmF0dGFjaCh0aGlzKTtcbiAgICB0aGlzLnNldFRhcmdldChlbGVtZW50KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiB0YXJnZXTjgavoh6rouqvjgbjjga7jgqLjgr/jg4Pjg4HjgpLlpJbjgZXjgZvjgIF0YXJnZXTlj4LnhafjgpLliIfjgotcbiAgICogXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgcmVtb3ZlKCkge1xuICAgIGlmICghdGhpcy50YXJnZXQpIHJldHVybjtcbiAgICB0aGlzLnRhcmdldC5kZXRhY2godGhpcyk7XG4gICAgdGhpcy50YXJnZXQgPSB1bmRlZmluZWQ7XG4gIH1cblxufVxuXG4vLyBFbGVtZW505YG044Gn5ouh5by1XG4vLyBwaGluYS5hcHAuRWxlbWVudC5wcm90b3R5cGUuJG1ldGhvZCgnYXR0YWNoJywgZnVuY3Rpb24oYWNjZXNzb3J5KSB7XG4vLyAgIGlmICghdGhpcy5hY2Nlc3Nvcmllcykge1xuLy8gICAgIHRoaXMuYWNjZXNzb3JpZXMgPSBbXTtcbi8vICAgICB0aGlzLm9uKCdlbnRlcmZyYW1lJywgZnVuY3Rpb24oZSkge1xuLy8gICAgICAgdGhpcy5hY2Nlc3Nvcmllcy5lYWNoKGZ1bmN0aW9uKGFjY2Vzc29yeSkge1xuLy8gICAgICAgICBhY2Nlc3NvcnkudXBkYXRlICYmIGFjY2Vzc29yeS51cGRhdGUoZS5hcHApO1xuLy8gICAgICAgfSk7XG4vLyAgICAgfSk7XG4vLyAgIH1cblxuLy8gICB0aGlzLmFjY2Vzc29yaWVzLnB1c2goYWNjZXNzb3J5KTtcbi8vICAgYWNjZXNzb3J5LnNldFRhcmdldCh0aGlzKTtcbi8vICAgYWNjZXNzb3J5LmZsYXJlKCdhdHRhY2hlZCcpO1xuXG4vLyAgIHJldHVybiB0aGlzO1xuLy8gfSk7XG5cbi8vIHBoaW5hLmFwcC5FbGVtZW50LnByb3RvdHlwZS4kbWV0aG9kKCdkZXRhY2gnLCBmdW5jdGlvbihhY2Nlc3NvcnkpIHtcbi8vICAgaWYgKHRoaXMuYWNjZXNzb3JpZXMpIHtcbi8vICAgICB0aGlzLmFjY2Vzc29yaWVzLmVyYXNlKGFjY2Vzc29yeSk7XG4vLyAgICAgYWNjZXNzb3J5LnNldFRhcmdldChudWxsKTtcbi8vICAgICBhY2Nlc3NvcnkuZmxhcmUoJ2RldGFjaGVkJyk7XG4vLyAgIH1cblxuLy8gICByZXR1cm4gdGhpcztcbi8vIH0pO1xuXG4vKipcbiAqIEB0eXBlZGVmIHtcIm5vcm1hbFwiIHwgXCJkZWx0YVwiIHwgXCJmcHNcIn0gVHdlZW5lclVwZGF0ZVR5cGUgdHdlZW5lcuabtOaWsOOCv+OCpOODl1xuICogXG4gKiBAdHlwZWRlZiB7XCJ0b1wiIHwgXCJieVwiIHwgXCJmcm9tXCJ9IFR3ZWVuZXJUYXNrTW9kZSB0d2VlbmVy44K/44K544Kv44Oi44O844OJXG4gKiBcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHR5cGU6IFwidHdlZW5cIixcbiAqICAgbW9kZTogVHdlZW5lclRhc2tNb2RlLFxuICogICBwcm9wczogT2JqZWN0LFxuICogICBkdXJhdGlvbj86IG51bWJlcixcbiAqICAgZWFzaW5nPzogaW1wb3J0KFwiLi4vdXRpbC90d2VlblwiKS5Ud2VlbkVhc2luZ1R5cGUsXG4gKiB9fSBUd2VlblR5cGVUYXNrUGFyYW0gVHdlZW7jgq/jg6njgrnjgpLkvb/nlKjjgZnjgovjgr/jgrnjgq/jga7oqK3lrprnlKjjg5Hjg6njg6Hjg7zjgr9cbiAqIFxuICogQHR5cGVkZWYge3tcbiAqICAgdHlwZTogXCJ3YWl0XCIgfCBcImNhbGxcIiB8IFwic2V0XCIsXG4gKiAgIGRhdGE6IHtba2V5OiBzdHJpbmddOiBhbnl9XG4gKiB9fSBDb21tb25UeXBlVGFza1BhcmFtIOOBneOBruS7luOBruaxjueUqOOCv+OCueOCr+eUqOODkeODqeODoeODvOOCv1xuICogXG4gKiBAdHlwZWRlZiB7VHdlZW5UeXBlVGFza1BhcmFtIHwgQ29tbW9uVHlwZVRhc2tQYXJhbX0gVGFza1BhcmFtVW5pb25cbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5hY2Nlc3NvcnkuVHdlZW5lclxuICogIyBUd2VlbmVyXG4gKiBUd2VlbmVy44Gv44Kq44OW44K444Kn44Kv44OI44Gu44OX44Ot44OR44OG44Kj44Gr5a++44GX44Gm44CBXG4gKiBUd2VlbuOCouODi+ODoeODvOOCt+ODp+ODs+OBruWKueaenOOCkuS4juOBiOOCi+OCr+ODqeOCueOBp+OBmeOAgiAgXG4gKiDkuLvjgasge0BsaW5rIHBoaW5hLmFwcC5FbGVtZW50fSDjgajjgZ3jga7jgrXjg5bjgq/jg6njgrnjgafkvb/nlKjjgZXjgozjgb7jgZnjgIJcbiAqIF9leHRlbmRzIHBoaW5hLmFjY2Vzc29yeS5BY2Nlc3NvcnlcbiAqL1xuY2xhc3MgVHdlZW5lciBleHRlbmRzIEFjY2Vzc29yeSB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge2ltcG9ydChcIi4vYWNjZXNzb3J5XCIpLkFjY2Vzc29yeVRhcmdldH0gW3RhcmdldF1cbiAgICovXG4gIGNvbnN0cnVjdG9yKHRhcmdldCkge1xuICAgIHN1cGVyKHRhcmdldCk7XG5cbiAgICAvKipcbiAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgpLmm7TmlrDjgZnjgovmlrnms5XjgpLmjIflrprjgZfjgb7jgZnjgIIgIFxuICAgICAqIOWkieabtOOBmeOCi+OBqGR1cmF0aW9u44Gr44KI44KL5pmC6ZaT44Gu6YCy44G/5pa544GM5aSJ44KP44KK44G+44GZ44CCICBcbiAgICAgKiDoqbPjgZfjgY/jga97QGxpbmsgI1VQREFURV9NQVB944KS5Y+C54Wn44GX44Gm44GP44Gg44GV44GE44CCXG4gICAgICogQHR5cGUge1R3ZWVuZXJVcGRhdGVUeXBlfVxuICAgICAqL1xuICAgIHRoaXMudXBkYXRlVHlwZSA9ICdkZWx0YSc7XG5cbiAgICB0aGlzLl9pbml0KCk7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICog5Yid5pyf5YyWXG4gICAqL1xuICBfaW5pdCgpIHtcbiAgICB0aGlzLl9sb29wID0gZmFsc2U7XG5cbiAgICAvKiogQHR5cGUge1Rhc2tQYXJhbVVuaW9uW119ICovXG4gICAgdGhpcy5fdGFza3MgPSBbXTtcblxuICAgIHRoaXMuX2luZGV4ID0gMDtcbiAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xuICAgIHRoaXMuX3VwZGF0ZSA9IHRoaXMuX3VwZGF0ZVRhc2s7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtpbXBvcnQoJy4uL2FwcC9iYXNlYXBwJykuQmFzZUFwcH0gYXBwXG4gICAqL1xuICB1cGRhdGUoYXBwKSB7XG4gICAgdGhpcy5fdXBkYXRlKGFwcCk7XG4gIH1cblxuICAvKipcbiAgICoge0BsaW5rICN1cGRhdGVUeXBlfeOCkuWkieabtOOBl+OBvuOBmeOAglxuICAgKiBAY2hhaW5hYmxlXG4gICAqIEBwYXJhbSB7VHdlZW5lclVwZGF0ZVR5cGV9IHR5cGUg5pu05paw5pa55rOV44KS6KGo44GZ5paH5a2X5YiXXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0VXBkYXRlVHlwZSh0eXBlKSB7XG4gICAgdGhpcy51cGRhdGVUeXBlID0gdHlwZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBwcm9wc+OBp+aMh+WumuOBl+OBn+WApOOBq+OBquOCi+OBvuOBp+OAgWR1cmF0aW9u44Gn5oyH5a6a44GX44Gf5pmC6ZaT44KS44GL44GR44Gm44CB44Ki44OL44Oh44O844K344On44Oz44GV44Gb44G+44GZ44CCXG4gICAqIEBjaGFpbmFibGVcbiAgICogQHBhcmFtIHt7W2tleTogc3RyaW5nXTogYW55fX0gcHJvcHMg5aSJ5pu044GX44Gf44GE44OX44Ot44OR44OG44Kj44KSa2V544Go44GX44Gf44Kq44OW44K444Kn44Kv44OIXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbZHVyYXRpb25dIChvcHRpb25hbCkg44Ki44OL44Oh44O844K344On44Oz44Gr44GL44GR44KL5pmC6ZaTXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vdXRpbC90d2VlblwiKS5Ud2VlbkVhc2luZ1R5cGV9IFtlYXNpbmddIChvcHRpb25hbCkgZWFzaW5nIHtAbGluayBwaGluYS51dGlsLlR3ZWVuI0VBU0lOR33jgpLlj4LnhafjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICB0byhwcm9wcywgZHVyYXRpb24sIGVhc2luZykge1xuICAgIHRoaXMuX2FkZCh7XG4gICAgICB0eXBlOiAndHdlZW4nLFxuICAgICAgbW9kZTogJ3RvJyxcbiAgICAgIHByb3BzOiBwcm9wcyxcbiAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcbiAgICAgIGVhc2luZzogZWFzaW5nLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+mWi+Wni+aZguOBruWApOOBqHByb3Bz44Gn5oyH5a6a44GX44Gf5YCk44KS5Yqg566X44GX44Gf5YCk44Gr44Gq44KL44G+44Gn44CBZHVyYXRpb27jgafmjIflrprjgZfjgZ/mmYLplpPjgpLjgYvjgZHjgabjgIHjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgZXjgZvjgb7jgZnjgIJcbiAgICogQGNoYWluYWJsZVxuICAgKiBAcGFyYW0ge3tba2V5OiBzdHJpbmddOiBhbnl9fSBwcm9wcyDlpInmm7TjgZfjgZ/jgYTjg5fjg63jg5Hjg4bjgqPjgpJrZXnjgajjgZfjgZ/jgqrjg5bjgrjjgqfjgq/jg4hcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtkdXJhdGlvbl0gKG9wdGlvbmFsKSDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgavjgYvjgZHjgovmmYLplpNcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuLi91dGlsL3R3ZWVuXCIpLlR3ZWVuRWFzaW5nVHlwZX0gW2Vhc2luZ10gKG9wdGlvbmFsKSBlYXNpbmcge0BsaW5rIHBoaW5hLnV0aWwuVHdlZW4jRUFTSU5HfeOCkuWPgueFp+OBl+OBpuOBj+OBoOOBleOBhOOAglxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGJ5KHByb3BzLCBkdXJhdGlvbiwgZWFzaW5nKSB7XG4gICAgdGhpcy5fYWRkKHtcbiAgICAgIHR5cGU6ICd0d2VlbicsXG4gICAgICBtb2RlOiAnYnknLFxuICAgICAgcHJvcHM6IHByb3BzLFxuICAgICAgZHVyYXRpb246IGR1cmF0aW9uLFxuICAgICAgZWFzaW5nOiBlYXNpbmcsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBwcm9wc+OBp+aMh+WumuOBl+OBn+WApOOBi+OCieOCouODi+ODoeODvOOCt+ODp+ODs+mWi+Wni+aZguOBruWApOOBq+OBquOCi+OBvuOBp+OAgWR1cmF0aW9u44Gn5oyH5a6a44GX44Gf5pmC6ZaT44KS44GL44GR44Gm44CB44Ki44OL44Oh44O844K344On44Oz44GV44Gb44G+44GZ44CCXG4gICAqIEBjaGFpbmFibGVcbiAgICogQHBhcmFtIHt7W2tleTogc3RyaW5nXTogYW55fX0gcHJvcHMg5aSJ5pu044GX44Gf44GE44OX44Ot44OR44OG44Kj44KSa2V544Go44GX44Gf44Kq44OW44K444Kn44Kv44OIXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbZHVyYXRpb25dIChvcHRpb25hbCkg44Ki44OL44Oh44O844K344On44Oz44Gr44GL44GR44KL5pmC6ZaTXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vdXRpbC90d2VlblwiKS5Ud2VlbkVhc2luZ1R5cGV9IFtlYXNpbmddIChvcHRpb25hbCkgZWFzaW5nIHtAbGluayBwaGluYS51dGlsLlR3ZWVuI0VBU0lOR33jgpLlj4LnhafjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBmcm9tKHByb3BzLCBkdXJhdGlvbiwgZWFzaW5nKSB7XG4gICAgdGhpcy5fYWRkKHtcbiAgICAgIHR5cGU6ICd0d2VlbicsXG4gICAgICBtb2RlOiAnZnJvbScsXG4gICAgICBwcm9wczogcHJvcHMsXG4gICAgICBkdXJhdGlvbjogZHVyYXRpb24sXG4gICAgICBlYXNpbmc6IGVhc2luZyxcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDmjIflrprjgZfjgZ/mmYLplpPjgYzntYzpgY7jgZnjgovjgb7jgaflvoXmqZ/jgZfjgb7jgZnjgIJcbiAgICogQGNoYWluYWJsZVxuICAgKiBAcGFyYW0ge051bWJlcn0gdGltZSB3YWl044GZ44KL5pmC6ZaTXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgd2FpdCh0aW1lKSB7XG4gICAgdGhpcy5fYWRkKHtcbiAgICAgIHR5cGU6ICd3YWl0JyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbGltaXQ6IHRpbWUsXG4gICAgICB9LFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOePvuWcqOioreWumuOBleOCjOOBpuOBhOOCi+OCouODi+ODoeODvOOCt+ODp+ODs+OBjOe1guS6huOBl+OBn+aZguOBq+WRvOOBs+WHuuOBleOCjOOCi+mWouaVsOOCkuOCu+ODg+ODiOOBl+OBvuOBmeOAglxuICAgKiBAY2hhaW5hYmxlXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMg5ZG844Gz5Ye644GV44KM44KL6Zai5pWwXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbc2VsZl0gKG9wdGlvbmFsKSBmdW5j5YaF44GndGhpc+OBq+OBl+OBn+OBhOOCquODluOCuOOCp+OCr+ODiOOAglxuICAgKiBAcGFyYW0ge09iamVjdFtdfSBbYXJnc10gKG9wdGlvbmFsKSBmdW5j44Gu5byV5pWw44Gr44GX44Gf44GE5YCkXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgY2FsbChmdW5jLCBzZWxmLCBhcmdzKSB7XG4gICAgdGhpcy5fYWRkKHtcbiAgICAgIHR5cGU6ICdjYWxsJyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgZnVuYzogZnVuYyxcbiAgICAgICAgc2VsZjogc2VsZiB8fCB0aGlzLFxuICAgICAgICBhcmdzOiBhcmdzLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDnj77lnKjoqK3lrprjgZXjgozjgabjgYTjgovjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgYzntYLkuobjgZfjgZ/mmYLjgavjg5fjg63jg5Hjg4bjgqPjgpLjgrvjg4Pjg4jjgZfjgb7jgZnjgIIgIFxuICAgKiDnrKzkuIDlvJXmlbDjgavjgqrjg5bjgrjjgqfjgq/jg4jjgpLjgrvjg4Pjg4jjgZnjgovjgZPjgajjgoLjgafjgY3jgb7jgZnjgIJcbiAgICogQGNoYWluYWJsZVxuICAgKiBAcGFyYW0ge1N0cmluZyB8IE9iamVjdH0ga2V5IHZhbHVl44KS44K744OD44OI44GZ44KL44OX44Ot44OR44OG44Kj5ZCN44GL44CB5aSJ5pu044GX44Gf44GE44OX44Ot44OR44OG44Kj44KSa2V544Go44GX44Gf44Kq44OW44K444Kn44Kv44OI44CCXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbdmFsdWVdIChvcHRpb25hbCkg44K744OD44OI44GZ44KL5YCkXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0KGtleSwgdmFsdWUpIHtcbiAgICB2YXIgdmFsdWVzID0gbnVsbDtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAyKSB7XG4gICAgICB2YWx1ZXMgPSB7fTtcbiAgICAgIHZhbHVlc1trZXldID0gdmFsdWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdmFsdWVzID0ga2V5O1xuICAgIH1cbiAgICB0aGlzLl90YXNrcy5wdXNoKHtcbiAgICAgIHR5cGU6IFwic2V0XCIsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHZhbHVlczogdmFsdWVzXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiB4LCB544Gr5a++44GX44Gm44CBIHtAbGluayAjdG99IOOBruWHpueQhuOCkuihjOOBhOOBvuOBmeOAglxuICAgKiBAY2hhaW5hYmxlXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbZHVyYXRpb25dIChvcHRpb25hbCkg44Ki44OL44Oh44O844K344On44Oz44Gr44GL44GR44KL5pmC6ZaTXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vdXRpbC90d2VlblwiKS5Ud2VlbkVhc2luZ1R5cGV9IFtlYXNpbmddIChvcHRpb25hbCkgZWFzaW5nIHtAbGluayBwaGluYS51dGlsLlR3ZWVuI0VBU0lOR33jgpLlj4LnhafjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBtb3ZlVG8oeCwgeSwgZHVyYXRpb24sIGVhc2luZykge1xuICAgIHJldHVybiB0aGlzLnRvKHsgeDogeCwgeTogeSB9LCBkdXJhdGlvbiwgZWFzaW5nKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIHgsIHnjgavlr77jgZfjgabjgIEge0BsaW5rICNieX0g44Gu5Yem55CG44KS6KGM44GE44G+44GZ44CCXG4gICAqIEBjaGFpbmFibGVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHhcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtkdXJhdGlvbl0gKG9wdGlvbmFsKSDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgavjgYvjgZHjgovmmYLplpNcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuLi91dGlsL3R3ZWVuXCIpLlR3ZWVuRWFzaW5nVHlwZX0gW2Vhc2luZ10gKG9wdGlvbmFsKSBlYXNpbmcge0BsaW5rIHBoaW5hLnV0aWwuVHdlZW4jRUFTSU5HfeOCkuWPgueFp+OBl+OBpuOBj+OBoOOBleOBhOOAglxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIG1vdmVCeSh4LCB5LCBkdXJhdGlvbiwgZWFzaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuYnkoeyB4OiB4LCB5OiB5IH0sIGR1cmF0aW9uLCBlYXNpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIHJvdGF0aW9u44Gr5a++44GX44Gm44CBIHtAbGluayAjdG99IOOBruWHpueQhuOCkuihjOOBhOOBvuOBmeOAglxuICAgKiBAY2hhaW5hYmxlXG4gICAqIEBwYXJhbSB7TnVtYmVyfSByb3RhdGlvblxuICAgKiBAcGFyYW0ge051bWJlcn0gW2R1cmF0aW9uXSAob3B0aW9uYWwpIOOCouODi+ODoeODvOOCt+ODp+ODs+OBq+OBi+OBkeOCi+aZgumWk1xuICAgKiBAcGFyYW0ge2ltcG9ydChcIi4uL3V0aWwvdHdlZW5cIikuVHdlZW5FYXNpbmdUeXBlfSBbZWFzaW5nXSAob3B0aW9uYWwpIGVhc2luZyB7QGxpbmsgcGhpbmEudXRpbC5Ud2VlbiNFQVNJTkd944KS5Y+C54Wn44GX44Gm44GP44Gg44GV44GE44CCXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcm90YXRlVG8ocm90YXRpb24sIGR1cmF0aW9uLCBlYXNpbmcpIHtcbiAgICByZXR1cm4gdGhpcy50byh7IHJvdGF0aW9uOiByb3RhdGlvbiB9LCBkdXJhdGlvbiwgZWFzaW5nKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIHJvdGF0aW9u44Gr5a++44GX44Gm44CBIHtAbGluayAjYnl9IOOBruWHpueQhuOCkuihjOOBhOOBvuOBmeOAglxuICAgKiBAY2hhaW5hYmxlXG4gICAqIEBwYXJhbSB7TnVtYmVyfSByb3RhdGlvblxuICAgKiBAcGFyYW0ge051bWJlcn0gW2R1cmF0aW9uXSAob3B0aW9uYWwpIOOCouODi+ODoeODvOOCt+ODp+ODs+OBq+OBi+OBkeOCi+aZgumWk1xuICAgKiBAcGFyYW0ge2ltcG9ydChcIi4uL3V0aWwvdHdlZW5cIikuVHdlZW5FYXNpbmdUeXBlfSBbZWFzaW5nXSAob3B0aW9uYWwpIGVhc2luZyB7QGxpbmsgcGhpbmEudXRpbC5Ud2VlbiNFQVNJTkd944KS5Y+C54Wn44GX44Gm44GP44Gg44GV44GE44CCXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcm90YXRlQnkocm90YXRpb24sIGR1cmF0aW9uLCBlYXNpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5ieSh7IHJvdGF0aW9uOiByb3RhdGlvbiB9LCBkdXJhdGlvbiwgZWFzaW5nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBzY2FsZVgsIHNjYWxlWeOBq+WvvuOBl+OBpiB7QGxpbmsgI3RvfSDjga7lh6bnkIbjgpLooYzjgYTjgb7jgZnjgIJcbiAgICogQGNoYWluYWJsZVxuICAgKiBAcGFyYW0ge051bWJlcn0gc2NhbGUgc2NhbGVY44Goc2NhbGVZ44Gr6Kit5a6a44GZ44KL5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbZHVyYXRpb25dIChvcHRpb25hbCkg44Ki44OL44Oh44O844K344On44Oz44Gr44GL44GR44KL5pmC6ZaTXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vdXRpbC90d2VlblwiKS5Ud2VlbkVhc2luZ1R5cGV9IFtlYXNpbmddIChvcHRpb25hbCkgZWFzaW5nIHtAbGluayBwaGluYS51dGlsLlR3ZWVuI0VBU0lOR33jgpLlj4LnhafjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzY2FsZVRvKHNjYWxlLCBkdXJhdGlvbiwgZWFzaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMudG8oeyBzY2FsZVg6IHNjYWxlLCBzY2FsZVk6IHNjYWxlIH0sIGR1cmF0aW9uLCBlYXNpbmcpO1xuICB9XG4gIC8qKlxuICAgKiBzY2FsZVgsIHNjYWxlWeOBq+WvvuOBl+OBpiB7QGxpbmsgI2J5fSDjga7lh6bnkIbjgpLooYzjgYTjgb7jgZnjgIJcbiAgICogQGNoYWluYWJsZVxuICAgKiBAcGFyYW0ge051bWJlcn0gc2NhbGUgc2NhbGVY44Goc2NhbGVZ44Gr6Kit5a6a44GZ44KL5YCkXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbZHVyYXRpb25dIChvcHRpb25hbCkg44Ki44OL44Oh44O844K344On44Oz44Gr44GL44GR44KL5pmC6ZaTXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vdXRpbC90d2VlblwiKS5Ud2VlbkVhc2luZ1R5cGV9IFtlYXNpbmddIChvcHRpb25hbCkgZWFzaW5nIHtAbGluayBwaGluYS51dGlsLlR3ZWVuI0VBU0lOR33jgpLlj4LnhafjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzY2FsZUJ5KHNjYWxlLCBkdXJhdGlvbiwgZWFzaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuYnkoeyBzY2FsZVg6IHNjYWxlLCBzY2FsZVk6IHNjYWxlIH0sIGR1cmF0aW9uLCBlYXNpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIGFscGhh44Gr5a++44GX44GmIHtAbGluayAjdG99IOOBruWHpueQhuOCkuihjOOBhOOBvuOBmeOAglxuICAgKiBAY2hhaW5hYmxlXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB2YWx1ZSBhbHBoYeOBq+ioreWumuOBmeOCi+WApFxuICAgKiBAcGFyYW0ge051bWJlcn0gW2R1cmF0aW9uXSAob3B0aW9uYWwpIOOCouODi+ODoeODvOOCt+ODp+ODs+OBq+OBi+OBkeOCi+aZgumWk1xuICAgKiBAcGFyYW0ge2ltcG9ydChcIi4uL3V0aWwvdHdlZW5cIikuVHdlZW5FYXNpbmdUeXBlfSBbZWFzaW5nXSAob3B0aW9uYWwpIGVhc2luZyB7QGxpbmsgcGhpbmEudXRpbC5Ud2VlbiNFQVNJTkd944KS5Y+C54Wn44GX44Gm44GP44Gg44GV44GE44CCXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZmFkZSh2YWx1ZSwgZHVyYXRpb24sIGVhc2luZykge1xuICAgIHJldHVybiB0aGlzLnRvKHsgYWxwaGE6IHZhbHVlIH0sIGR1cmF0aW9uLCBlYXNpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIGFscGhh44KSMOOBq+OBmeOCi+OCouODi+ODoeODvOOCt+ODp+ODs+OCkuioreWumuOBl+OBvuOBmeOAglxuICAgKiBAY2hhaW5hYmxlXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbZHVyYXRpb25dIChvcHRpb25hbCkg44Ki44OL44Oh44O844K344On44Oz44Gr44GL44GR44KL5pmC6ZaTXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vdXRpbC90d2VlblwiKS5Ud2VlbkVhc2luZ1R5cGV9IFtlYXNpbmddIChvcHRpb25hbCkgZWFzaW5nIHtAbGluayBwaGluYS51dGlsLlR3ZWVuI0VBU0lOR33jgpLlj4LnhafjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBmYWRlT3V0KGR1cmF0aW9uLCBlYXNpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5mYWRlKDAuMCwgZHVyYXRpb24sIGVhc2luZyk7XG4gIH1cblxuICAvKipcbiAgICogYWxwaGHjgpIx44Gr44GZ44KL44Ki44OL44Oh44O844K344On44Oz44KS6Kit5a6a44GX44G+44GZ44CCXG4gICAqIEBjaGFpbmFibGVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtkdXJhdGlvbl0gKG9wdGlvbmFsKSDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgavjgYvjgZHjgovmmYLplpNcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuLi91dGlsL3R3ZWVuXCIpLlR3ZWVuRWFzaW5nVHlwZX0gW2Vhc2luZ10gKG9wdGlvbmFsKSBlYXNpbmcge0BsaW5rIHBoaW5hLnV0aWwuVHdlZW4jRUFTSU5HfeOCkuWPgueFp+OBl+OBpuOBj+OBoOOBleOBhOOAglxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGZhZGVJbihkdXJhdGlvbiwgZWFzaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuZmFkZSgxLjAsIGR1cmF0aW9uLCBlYXNpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+mWi+Wni1xuICAgKiBAY2hhaW5hYmxlXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcGxheSgpIHtcbiAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+OCkuS4gOaZguWBnOatolxuICAgKiBAY2hhaW5hYmxlXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcGF1c2UoKSB7XG4gICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Ki44OL44Oh44O844K344On44Oz44KS5YGc5q2i44GX44CB5pyA5Yid44G+44Gn5be744GN5oi744GX44G+44GZ44CCXG4gICAqIEBjaGFpbmFibGVcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzdG9wKCkge1xuICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xuICAgIHRoaXMucmV3aW5kKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Ki44OL44Oh44O844K344On44Oz44KS5be744GN5oi744GZXG4gICAqIEBjaGFpbmFibGVcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICByZXdpbmQoKSB7XG4gICAgdGhpcy5fdXBkYXRlID0gdGhpcy5fdXBkYXRlVGFzaztcbiAgICB0aGlzLl9pbmRleCA9IDA7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB5b3lvKCkge1xuICAgIC8vIFRPRE86IOacgOWIneOBruWApOOBjOWIhuOBi+OCieOBquOBhOOBruOBp+WPjei7ouOBp+OBjeOBquOBhC4uLlxuICAgIHRoaXMuX3VwZGF0ZSA9IHRoaXMuX3VwZGF0ZVRhc2s7XG4gICAgdGhpcy5faW5kZXggPSAwO1xuICAgIGVhY2gkMS5jYWxsKHRoaXMuX3Rhc2tzLCBmdW5jdGlvbih0YXNrKSB7XG4gICAgLy8gdGhpcy5fdGFza3MuZWFjaChmdW5jdGlvbih0YXNrKSB7XG4gICAgICBpZiAodGFzay50eXBlID09PSAndHdlZW4nKSA7XG4gICAgfSk7XG4gICAgdGhpcy5wbGF5KCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pjg6vjg7zjg5foqK3lrppcbiAgICogQGNoYWluYWJsZVxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGZsYWdcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRMb29wKGZsYWcpIHtcbiAgICB0aGlzLl9sb29wID0gZmxhZztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgpLjgq/jg6rjgqJcbiAgICogQGNoYWluYWJsZVxuICAgKiBAb3ZlcnJpZGUge0V2ZW50RGlzcGF0Y2hlciNjbGVhcn3jgpLkuIrmm7jjgY1cbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBjbGVhcigpIHtcbiAgICB0aGlzLl9pbml0KCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQHR5cGVkZWYge1tzdHJpbmcsIC4uLmFueV19IFR3ZWVuUGFyYW1BcnJheVxuICAgKiBKU09O5b2i5byP44Gn44Ki44OL44Oh44O844K344On44Oz44KS6Kit5a6a44GX44G+44GZ44CCXG4gICAqIEBjaGFpbmFibGVcbiAgICogXG4gICAqIGBgYFxuICAgKiBbXG4gICAqICAgW21ldGhvZCwgYXJnMSwgYXJnMiwsLF0sXG4gICAqICAgWyd0bycsIHt2YWx1ZTogMTAwfSwgMTAwMCwgJ3N3aW5nJ10sXG4gICAqICAgWyd3YWl0JywgMTAwMF0sXG4gICAqICAgWydzZXQnLCAndGV4dCcsICdFTkQnXVxuICAgKiBdXG4gICAqIGBgYFxuICAgKiBcbiAgICogQHBhcmFtIHtPYmplY3R9IGpzb25cbiAgICogQHBhcmFtIHtCb29sZWFufSBqc29uLmxvb3AgKG9wdGlvbmFsKSDjg6vjg7zjg5fjgZnjgovloLTlkIh0cnVlXG4gICAqIEBwYXJhbSB7VHdlZW5QYXJhbUFycmF5fSBqc29uLnR3ZWVucyDoqK3lrprjgZnjgovjgqLjg4vjg6Hjg7zjgrfjg6fjg7NcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBmcm9tSlNPTihqc29uKSB7XG4gICAgaWYgKGpzb24ubG9vcCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnNldExvb3AoanNvbi5sb29wKTtcbiAgICB9XG5cbiAgICBlYWNoJDEuY2FsbChqc29uLnR3ZWVucywgXG4gICAgLy8ganNvbi50d2VlbnMuZWFjaChcbiAgICAgIC8qKlxuICAgICAgICogQHRoaXMgVHdlZW5lclxuICAgICAgICogQHBhcmFtIHtUd2VlblBhcmFtQXJyYXl9IHRcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICB0ID0gY2xvbmUuY2FsbCh0KTtcbiAgICAgICAgLy8gdCA9IHQuY2xvbmUoKTtcbiAgICAgICAgdmFyIG1ldGhvZCA9IHQuc2hpZnQoKTtcbiAgICAgICAgdGhpc1ttZXRob2RdLmFwcGx5KHRoaXMsIHQpO1xuICAgICAgfSwgdGhpc1xuICAgICk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge1Rhc2tQYXJhbVVuaW9ufSBwYXJhbXNcbiAgICovXG4gIF9hZGQocGFyYW1zKSB7XG4gICAgdGhpcy5fdGFza3MucHVzaChwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9hcHAvYmFzZWFwcCcpLkJhc2VBcHB9IGFwcFxuICAgKi9cbiAgX3VwZGF0ZVRhc2soYXBwKSB7XG4gICAgaWYgKCF0aGlzLnBsYXlpbmcpIHJldHVybiA7XG5cbiAgICB2YXIgdGFzayA9IHRoaXMuX3Rhc2tzW3RoaXMuX2luZGV4XTtcbiAgICBpZiAoIXRhc2spIHtcbiAgICAgIGlmICh0aGlzLl9sb29wKSB7XG4gICAgICAgIHRoaXMucmV3aW5kKCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZShhcHApO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICArK3RoaXMuX2luZGV4O1xuICAgIH1cblxuICAgIGlmICh0YXNrLnR5cGUgPT09ICd0d2VlbicpIHtcbiAgICAgIC8vIHRoaXMuX3R3ZWVuID0gcGhpbmEudXRpbC5Ud2VlbigpO1xuICAgICAgdGhpcy5fdHdlZW4gPSBuZXcgVHdlZW4oKTtcblxuICAgICAgdmFyIGR1cmF0aW9uID0gdGFzay5kdXJhdGlvbiB8fCB0aGlzLl9nZXREZWZhdWx0RHVyYXRpb24oKTtcbiAgICAgIGlmICh0YXNrLm1vZGUgPT09ICd0bycpIHtcbiAgICAgICAgdGhpcy5fdHdlZW4udG8odGhpcy50YXJnZXQsIHRhc2sucHJvcHMsIGR1cmF0aW9uLCB0YXNrLmVhc2luZyk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmICh0YXNrLm1vZGUgPT09ICdieScpIHtcbiAgICAgICAgdGhpcy5fdHdlZW4uYnkodGhpcy50YXJnZXQsIHRhc2sucHJvcHMsIGR1cmF0aW9uLCB0YXNrLmVhc2luZyk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5fdHdlZW4uZnJvbSh0aGlzLnRhcmdldCwgdGFzay5wcm9wcywgZHVyYXRpb24sIHRhc2suZWFzaW5nKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3VwZGF0ZSA9IHRoaXMuX3VwZGF0ZVR3ZWVuO1xuICAgICAgdGhpcy5fdXBkYXRlKGFwcCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRhc2sudHlwZSA9PT0gJ3dhaXQnKSB7XG4gICAgICB0aGlzLl93YWl0ID0ge1xuICAgICAgICB0aW1lOiAwLFxuICAgICAgICBsaW1pdDogdGFzay5kYXRhLmxpbWl0LFxuICAgICAgfTtcblxuICAgICAgdGhpcy5fdXBkYXRlID0gdGhpcy5fdXBkYXRlV2FpdDtcbiAgICAgIHRoaXMuX3VwZGF0ZShhcHApO1xuICAgIH1cbiAgICBlbHNlIGlmICh0YXNrLnR5cGUgPT09ICdjYWxsJykge1xuICAgICAgdGFzay5kYXRhLmZ1bmMuYXBwbHkodGFzay5kYXRhLnNlbGYsIHRhc2suZGF0YS5hcmdzKTtcbiAgICAgIC8vIDHjg5Xjg6zjg7zjg6DmtojosrvjgZfjgarjgYTjgojjgYblho3luLBcbiAgICAgIHRoaXMuX3VwZGF0ZShhcHApO1xuICAgIH1cbiAgICBlbHNlIGlmICh0YXNrLnR5cGUgPT09ICdzZXQnKSB7XG4gICAgICAkZXh0ZW5kLmNhbGwodGhpcy50YXJnZXQsIHRhc2suZGF0YS52YWx1ZXMpO1xuICAgICAgLy8gdGhpcy50YXJnZXQuJGV4dGVuZCh0YXNrLmRhdGEudmFsdWVzKTtcbiAgICAgIC8vIDHjg5Xjg6zjg7zjg6DmtojosrvjgZfjgarjgYTjgojjgYblho3luLBcbiAgICAgIHRoaXMuX3VwZGF0ZShhcHApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vYXBwL2Jhc2VhcHAnKS5CYXNlQXBwfSBhcHBcbiAgICovXG4gIF91cGRhdGVUd2VlbihhcHApIHtcbiAgICB2YXIgdHdlZW4gPSB0aGlzLl90d2VlbjtcbiAgICB2YXIgdGltZSA9IHRoaXMuX2dldFVuaXRUaW1lKGFwcCk7XG5cbiAgICB0d2Vlbi5mb3J3YXJkKHRpbWUpO1xuICAgIHRoaXMuZmxhcmUoJ3R3ZWVuJyk7XG5cbiAgICBpZiAodHdlZW4udGltZSA+PSB0d2Vlbi5kdXJhdGlvbikge1xuICAgICAgZGVsZXRlIHRoaXMuX3R3ZWVuO1xuICAgICAgdGhpcy5fdHdlZW4gPSBudWxsO1xuICAgICAgdGhpcy5fdXBkYXRlID0gdGhpcy5fdXBkYXRlVGFzaztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtpbXBvcnQoJy4uL2FwcC9iYXNlYXBwJykuQmFzZUFwcH0gYXBwXG4gICAqL1xuICBfdXBkYXRlV2FpdChhcHApIHtcbiAgICB2YXIgd2FpdCA9IHRoaXMuX3dhaXQ7XG4gICAgdmFyIHRpbWUgPSB0aGlzLl9nZXRVbml0VGltZShhcHApO1xuICAgIHdhaXQudGltZSArPSB0aW1lO1xuXG4gICAgaWYgKHdhaXQudGltZSA+PSB3YWl0LmxpbWl0KSB7XG4gICAgICBkZWxldGUgdGhpcy5fd2FpdDtcbiAgICAgIHRoaXMuX3dhaXQgPSBudWxsO1xuICAgICAgdGhpcy5fdXBkYXRlID0gdGhpcy5fdXBkYXRlVGFzaztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtpbXBvcnQoJy4uL2FwcC9iYXNlYXBwJykuQmFzZUFwcH0gYXBwXG4gICAqL1xuICBfZ2V0VW5pdFRpbWUoYXBwKSB7XG4gICAgdmFyIG9iaiA9IFVQREFURV9NQVBbdGhpcy51cGRhdGVUeXBlXTtcbiAgICBpZiAob2JqKSB7XG4gICAgICByZXR1cm4gb2JqLmZ1bmMoYXBwKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICByZXR1cm4gMTAwMCAvIGFwcC5mcHM7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBfZ2V0RGVmYXVsdER1cmF0aW9uKCkge1xuICAgIHZhciBvYmogPSBVUERBVEVfTUFQW3RoaXMudXBkYXRlVHlwZV07XG4gICAgcmV0dXJuIG9iaiAmJiBvYmouZHVyYXRpb247XG4gIH1cblxufVxuXG4vKipcbiAqIEBzdGF0aWNcbiAqIHtAbGluayAjdXBkYXRlVHlwZX3jgavoqK3lrprjgZnjgovmm7TmlrDmlrnms5Xjga7lrprnvqnjgafjgZnjgIJcbiAqIOS4i+iomOOBruihqOOBq+Wumue+qea4iOOBv+OBruabtOaWsOaWueazleOCkntAbGluayAjdXBkYXRlVHlwZX3jgavoqK3lrprjgZnjgovjgZPjgajjgafjgIFcbiAqIOOCouODi+ODoeODvOOCt+ODp+ODs+OBruabtOaWsOaWueazleOCkuWkieabtOOBmeOCi+OBk+OBqOOBjOOBp+OBjeOBvuOBmeOAglxuICogXG4gKiB8IOabtOaWsOaWueazlSB8IOWNmOS9jSjjg4fjg5Xjgqnjg6vjg4jlgKQpIHwgMeODleODrOODvOODoOOBguOBn+OCiuOBruOCouODi+ODoeODvOOCt+ODp+ODs+mAn+W6piB8XG4gKiB8LXwtfC18XG4gKiB8IG5vcm1hbCB8IOODn+ODquenkigxMDAwKSB8IGFwcC5mcHPjgavjgojjgaPjgablpInljJYgfFxuICogfCBkZWx0YSB8IOODn+ODquenkigxMDAwKSB8IOe1jOmBjuaZgumWk+OBq+OCiOOBo+OBpuWkieWMliB8XG4gKiB8IGZwcyB8IOODleODrOODvOODoCgzMCkgfCDlv4XjgZrlkIzjgZjpgJ/luqbjgaflpInljJYgfFxuICogXG4gKiBAdHlwZSB7e1xuICogICBba2V5IGluIFR3ZWVuZXJVcGRhdGVUeXBlXToge1xuICogICAgIGZ1bmM6IChhcHA6IGltcG9ydCgnLi4vYXBwL2Jhc2VhcHAnKS5CYXNlQXBwKT0+IG51bWJlcixcbiAqICAgICBkdXJhdGlvbjogbnVtYmVyLFxuICogICB9XG4gKiB9fVxuICovXG52YXIgVVBEQVRFX01BUCA9IFR3ZWVuZXIuVVBEQVRFX01BUCA9IHtcbiAgbm9ybWFsOiB7XG4gICAgZnVuYzogZnVuY3Rpb24oYXBwKSB7XG4gICAgICByZXR1cm4gMTAwMCAvIGFwcC5mcHM7XG4gICAgfSxcbiAgICBkdXJhdGlvbjogMTAwMCxcbiAgfSxcblxuICBkZWx0YToge1xuICAgIGZ1bmM6IGZ1bmN0aW9uKGFwcCkge1xuICAgICAgcmV0dXJuIGFwcC50aWNrZXIuZGVsdGFUaW1lO1xuICAgIH0sXG4gICAgZHVyYXRpb246IDEwMDAsXG4gIH0sXG5cbiAgZnBzOiB7XG4gICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9LFxuICAgIGR1cmF0aW9uOiAzMCxcbiAgfSxcblxufTtcblxuLy8gRWxlbWVudOWBtOOBp+aLoeW8tVxuLy8gLyoqXG4vLyAgKiBAbWVtYmVyIHBoaW5hLmFwcC5FbGVtZW50XG4vLyAgKiBAcHJvcGVydHkgdHdlZW5lclxuLy8gICog6Ieq6Lqr44Gr44Ki44K/44OD44OB5riI44G/44Gue0BsaW5rIHBoaW5hLmFjY2Vzc29yeS5Ud2VlbmVyfeOCquODluOCuOOCp+OCr+ODiOOAglxuLy8gICovXG4vLyBwaGluYS5hcHAuRWxlbWVudC5wcm90b3R5cGUuZ2V0dGVyKCd0d2VlbmVyJywgZnVuY3Rpb24oKSB7XG4vLyAgIGlmICghdGhpcy5fdHdlZW5lcikge1xuLy8gICAgIHRoaXMuX3R3ZWVuZXIgPSBwaGluYS5hY2Nlc3NvcnkuVHdlZW5lcigpLmF0dGFjaFRvKHRoaXMpO1xuLy8gICB9XG4vLyAgIHJldHVybiB0aGlzLl90d2VlbmVyO1xuLy8gfSk7XG5cbi8qKlxuICogRHJhZ2dhYmxl44GudGFyZ2V044Gr5oyH5a6a5Y+v6IO944Gq44Kq44OW44K444Kn44Kv44OI5Z6LXG4gKiBAdHlwZWRlZiB7e1xuICogICB4OiBudW1iZXJcbiAqICAgeTogbnVtYmVyXG4gKiAgIGZsYXJlOiAodHlwZTogc3RyaW5nKT0+IGFueVxuICogICBzZXRJbnRlcmFjdGl2ZTogKGZsYWc6IGJvb2xlYW4pPT4gYW55XG4gKiB9ICYgaW1wb3J0KFwiLi9hY2Nlc3NvcnlcIikuQWNjZXNzb3J5QXR0YWNoYWJsZSB9IERyYWdnYWJsZVRhcmdldFxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFjY2Vzc29yeS5EcmFnZ2FibGVcbiAqIF9leHRlbmRzIHBoaW5hLmFjY2Vzc29yeS5BY2Nlc3NvcnlcbiAqIFxuICog5a++6LGh44KS44OJ44Op44OD44Kw5Y+v6IO944Gr44GZ44KLQWNjZXNzb3J55rS+55Sf44Kv44Op44K5XG4gKiBcbiAqIHBoaW5hLmFwcC5FbGVtZW505rS+55Sf44Kv44Op44K544Gn44GC44KM44Gw44CBXG4gKiBkcmFnZ2FibGXjgrLjg4Pjgr/jg7zjgavjgqLjgq/jgrvjgrnjgZnjgovjgaDjgZHjgafmnInlirnljJbjgZnjgovjgZPjgajjgoLlj6/og71cbiAqIFxuICogIyMjIOOCpOODmeODs+ODiOeZuueBq+OBq+OBpOOBhOOBplxuICog44OJ44Op44OD44Kw6ZaL5aeL5pmC44GrYGRyYWdzdGFydGDjgIFcbiAqIOODieODqeODg+OCsOenu+WLleavjuOBq2BkcmFnYOOAgVxuICog44OJ44Op44OD44Kw57WC5LqG5pmC44Gr5pmC44GrYGRyYWdlbmRgXG4gKiDjgqTjg5njg7Pjg4jjgpLjgZ3jgozjgZ7jgozoh6rouqvjgYrjgojjgbPlr77osaHjgqrjg5bjgrjjgqfjgq/jg4jkuKHmlrnjgafnmbrngavjgZnjgotcbiAqIFxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHRhcmdldCA9IG5ldyBwaGluYS5kaXNwbGF5LlNwcml0ZShcInBsYXllclwiKTtcbiAqIGNvbnN0IGRyYWdnYWJsZSA9IG5ldyBwaGluYS5hY2Nlc3NvcnkuRHJhZ2dhYmxlKCkuYXR0YWNoVG8odGFyZ2V0KTtcbiAqIGRyYWdnYWJsZS5vbihcImRyYWdlbmRcIiwgKCk9PiB7XG4gKiAgIGlmICghaXNWYWxpZGF0ZVBvc2l0aW9uKHRhcmdldCkpIGRyYWdnYWJsZS5iYWNrKClcbiAqIH0pXG4gKiBcbiAqIEBleGFtcGxlXG4gKiAvLyBBY3RpdmF0ZSBieSBnZXR0ZXJcbiAqIGNvbnN0IGVsID0gbmV3IHBoaW5hLmFwcC5FbGVtZW50KCk7XG4gKiBlbC5kcmFnZ2FibGU7XG4gKiBcbiAqL1xuY2xhc3MgRHJhZ2dhYmxlIGV4dGVuZHMgQWNjZXNzb3J5IHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIFxuICAgKiBAcGFyYW0ge0RyYWdnYWJsZVRhcmdldH0gW3RhcmdldF1cbiAgICogdGFyZ2V044KS5Y+X44GR5Y+W44KL44GM44CB44Gd44KM44Gg44GR44Gn44Gv5pyJ5Yq55YyW44GV44KM44Gq44GE44GT44Go44Gr5rOo5oSPXG4gICAqIOWQjOaZguOBq+acieWKueWMluOBmeOCi+WgtOWQiOOBr2F0dGFjaFRv44KS5L2/44Gj44Gm5LuY5LiO44GZ44KLXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih0YXJnZXQpIHtcbiAgICBzdXBlcih0YXJnZXQpO1xuXG4gICAgLyoqIEB0eXBlIHtEcmFnZ2FibGVUYXJnZXR9ICovXG4gICAgdGhpcy50YXJnZXQ7XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMuX2RyYWdnaW5nID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqIOKAu+acquS9v+eUqFxuICAgICAqL1xuICAgIHRoaXMuX2VuYWJsZTtcblxuICAgIC8qKlxuICAgICAqIOODieODqeODg+OCsOmWi+Wni+S9jee9ruOAgeWHpueQhuavjuOBq+abtOaWsOOBleOCjOOCi1xuICAgICAqIEB0eXBlIHtWZWN0b3IyfVxuICAgICAqL1xuICAgIHRoaXMuaW5pdGlhbFBvc2l0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5vbignYXR0YWNoZWQnLFxuICAgIC8qKiBAdGhpcyB7RHJhZ2dhYmxlfSAqL1xuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy50YXJnZXQuc2V0SW50ZXJhY3RpdmUodHJ1ZSk7XG5cbiAgICAgIHNlbGYuX2RyYWdnaW5nID0gZmFsc2U7XG5cbiAgICAgIHRoaXMudGFyZ2V0Lm9uKCdwb2ludHN0YXJ0JywgXG4gICAgICAvKiogQHRoaXMge0RyYWdnYWJsZVRhcmdldH0gKi9cbiAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoRHJhZ2dhYmxlLl9sb2NrKSByZXR1cm4gO1xuXG4gICAgICAgIHNlbGYuX2RyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgc2VsZi5pbml0aWFsUG9zaXRpb24ueCA9IHRoaXMueDtcbiAgICAgICAgc2VsZi5pbml0aWFsUG9zaXRpb24ueSA9IHRoaXMueTtcbiAgICAgICAgc2VsZi5mbGFyZSgnZHJhZ3N0YXJ0Jyk7XG4gICAgICAgIHRoaXMuZmxhcmUoJ2RyYWdzdGFydCcpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMudGFyZ2V0Lm9uKCdwb2ludG1vdmUnLCBcbiAgICAgIC8qKiBAdGhpcyB7RHJhZ2dhYmxlVGFyZ2V0fSAqL1xuICAgICAgZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoIXNlbGYuX2RyYWdnaW5nKSByZXR1cm4gO1xuXG4gICAgICAgIHRoaXMueCArPSBlLnBvaW50ZXIuZHg7XG4gICAgICAgIHRoaXMueSArPSBlLnBvaW50ZXIuZHk7XG4gICAgICAgIHNlbGYuZmxhcmUoJ2RyYWcnKTtcbiAgICAgICAgdGhpcy5mbGFyZSgnZHJhZycpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMudGFyZ2V0Lm9uKCdwb2ludGVuZCcsIFxuICAgICAgLyoqIEB0aGlzIHtEcmFnZ2FibGVUYXJnZXR9ICovXG4gICAgICBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmICghc2VsZi5fZHJhZ2dpbmcpIHJldHVybiA7XG5cbiAgICAgICAgc2VsZi5fZHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgICAgc2VsZi5mbGFyZSgnZHJhZ2VuZCcpO1xuICAgICAgICB0aGlzLmZsYXJlKCdkcmFnZW5kJyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDjg4njg6njg4PjgrDplovlp4vkvY3nva7jgavjgr/jg7zjgrLjg4Pjg4jjgpLmiLvjgZlcbiAgICog44OR44Op44Oh44O844K/5oyH5a6a44GZ44KL44GT44Go44GndHdlZW5lcuOCouODi+ODoeODvOOCt+ODp+ODs+OCkuS9v+OBo+OBpuaIu+OBmeOBk+OBqOOCguWPr+iDvVxuICAgKiBcbiAgICog57WC5LqG5pmC44GrYGJhY2tlbmRg44Kk44OZ44Oz44OI44KS55m654GrXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gW3RpbWVdIOOCouODi+ODoeODvOOCt+ODp+ODs+aZgumWk++8iOODn+ODquenku+8ieOAgueEoeaMh+WumuOBruWgtOWQiOOBr+WNs+W6p+OBq+aIu+OBmVxuICAgKiBAcGFyYW0ge2ltcG9ydChcIi4uL3V0aWwvdHdlZW5cIikuVHdlZW5FYXNpbmdUeXBlfSBbZWFzaW5nPSdlYXNlT3V0RWxhc3RpYyddIOOCouODi+ODoeODvOOCt+ODp+ODs+eorumhnlxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIGJhY2sodGltZSwgZWFzaW5nKSB7XG4gICAgaWYgKHRpbWUpIHtcbiAgICAgIHZhciB0ID0gdGhpcy50YXJnZXQ7XG4gICAgICB0LnNldEludGVyYWN0aXZlKGZhbHNlKTtcbiAgICAgIHZhciB0d2VlbmVyID0gbmV3IFR3ZWVuZXIoKS5hdHRhY2hUbyh0KTtcbiAgICAgIHR3ZWVuZXJcbiAgICAgICAgLnRvKHtcbiAgICAgICAgICB4OiB0aGlzLmluaXRpYWxQb3NpdGlvbi54LFxuICAgICAgICAgIHk6IHRoaXMuaW5pdGlhbFBvc2l0aW9uLnksXG4gICAgICAgIH0sIHRpbWUsIGVhc2luZyB8fCAnZWFzZU91dEVsYXN0aWMnKVxuICAgICAgICAuY2FsbChmdW5jdGlvbigpIHtcbiAgICAgICAgICB0d2VlbmVyLnJlbW92ZSgpO1xuXG4gICAgICAgICAgdC5zZXRJbnRlcmFjdGl2ZSh0cnVlKTtcbiAgICAgICAgICB0aGlzLmZsYXJlKCdiYWNrZW5kJyk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMudGFyZ2V0LnggPSB0aGlzLmluaXRpYWxQb3NpdGlvbi54O1xuICAgICAgdGhpcy50YXJnZXQueSA9IHRoaXMuaW5pdGlhbFBvc2l0aW9uLnk7XG4gICAgICB0aGlzLmZsYXJlKCdiYWNrZW5kJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlIOKAu+acquS9v+eUqOOBruOBn+OCgVxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIGVuYWJsZSgpIHtcbiAgICB0aGlzLl9lbmFibGUgPSB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIOWFqOOBpuOBruOCpOODs+OCueOCv+ODs+OCueOBp+ODieODqeODg+OCsOOCkueEoeWKueWMluOBmeOCi1xuICAgKiBcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBzdGF0aWMgbG9jaygpIHtcbiAgICB0aGlzLl9sb2NrID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlhajjgabjga7jgqTjg7Pjgrnjgr/jg7Pjgrnjgafjg4njg6njg4PjgrDnhKHlirnljJbjgpLop6PpmaRcbiAgICogXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgc3RhdGljIHVubG9jaygpIHtcbiAgICB0aGlzLl9sb2NrID0gZmFsc2U7XG4gIH1cblxufVxuXG4vKipcbiAqIEBwcml2YXRlXG4gKiBAdHlwZSB7Ym9vbGVhbn1cbiAqL1xuRHJhZ2dhYmxlLl9sb2NrID0gZmFsc2U7XG5cbi8vIEVsZW1lbnTlgbTjgaflrprnvqlcbi8vIHBoaW5hLmFwcC5FbGVtZW50LnByb3RvdHlwZS5nZXR0ZXIoJ2RyYWdnYWJsZScsIGZ1bmN0aW9uKCkge1xuLy8gICBpZiAoIXRoaXMuX2RyYWdnYWJsZSkge1xuLy8gICAgIHRoaXMuX2RyYWdnYWJsZSA9IHBoaW5hLmFjY2Vzc29yeS5EcmFnZ2FibGUoKS5hdHRhY2hUbyh0aGlzKTtcbi8vICAgfVxuLy8gICByZXR1cm4gdGhpcy5fZHJhZ2dhYmxlO1xuLy8gfSk7XG5cbi8qKlxuICogVE9ETzogRWxlbWVudOOBruODl+ODreODkeODhuOCo+OCkuW8leOBjee2meOBjuOBn+OBhOKAplxuICogQHR5cGVkZWYge0VsZW1lbnQgfCBhbnl9IEVsZW1lbnRCYXNlZE9iamVjdFxuICogX3R5cGVkZWYge3tbazogc3RyaW5nXTogYW55fSAmIEVsZW1lbnR9IEVsZW1lbnRCYXNlZE9iamVjdFxuICovXG5cbi8qKlxuICogRWxlbWVudOOBq+mBqeWQiOOBmeOCi+OBn+OCgeOBruODl+ODreODkeODhuOCo+OCkuS/neaMgeOBl+OBpuOCi+OBi+ODgeOCp+ODg+OCrzogdGVtcGxhdGXnlKhcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGFkZENoaWxkOiAoZWw6IEVsZW1lbnRpemFibGUpPT4gRWxlbWVudGl6YWJsZVxuICogICByZW1vdmU6ICgpPT4gRWxlbWVudGl6YWJsZVxuICogICBwYXJlbnQ/OiBFbGVtZW50aXphYmxlXG4gKiAgIGhhczogKHR5cGU6c3RyaW5nKT0+IGJvb2xlYW5cbiAqICAgZmxhcmU6ICh0eXBlOnN0cmluZyk9PiBhbnlcbiAqIH19IEVsZW1lbnRpemFibGUgXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuYXBwLkVsZW1lbnRcbiAqIF9leHRlbmRzIHBoaW5hLnV0aWwuRXZlbnREaXNwYXRjaGVyXG4gKiAjIOS4u+OBq+imgee0oOOBruimquWtkOmWouS/guOCkuaJseOBhuOCr+ODqeOCuVxuICog5Li744Gr6Kaq5a2Q6Zai5L+C562J44KS5a6a576p44GZ44KL44Kv44Op44K544Gn44GZ44CCXG4gKi9cbmNsYXNzIEVsZW1lbnQgZXh0ZW5kcyBFdmVudERpc3BhdGNoZXIge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7RWxlbWVudEJhc2VkT2JqZWN0IHwgbnVsbH1cbiAgICAgKiDopqropoHntKBcbiAgICAgKi9cbiAgICB0aGlzLnBhcmVudCA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7RWxlbWVudEJhc2VkT2JqZWN0W119XG4gICAgICog5a2Q6KaB57Sg6YWN5YiXXG4gICAgICovXG4gICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICog5pyJ5Yq544GL44Gp44GG44GLXG4gICAgICovXG4gICAgdGhpcy5hd2FrZSA9IHRydWU7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKiDopoHntKDjgq/jg6rjg4Pjgq/nrqHnkIbnlKjjg5Xjg6njgrBcbiAgICAgKi9cbiAgICB0aGlzLl9jbGlja2VkID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7aW1wb3J0KCcuLi9hY2Nlc3NvcnkvYWNjZXNzb3J5JykuQWNjZXNzb3J5W119XG4gICAgICogQWNjZXNzb3J56YWN5YiXXG4gICAgICogYXR0YWNo44Oh44K944OD44OJ44Gr44KI44Gj44Gm5Yid5pyf5YyWXG4gICAgICovXG4gICAgdGhpcy5hY2Nlc3NvcmllcyA9IHVuZGVmaW5lZDtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHR5cGUge1R3ZWVuZXJ9XG4gICAgICog5YaF6YOoVHdlZW5lcuOCr+ODqeOCuVxuICAgICAqIHR3ZWVuZXLjgqLjgq/jgrvjgrXjgavjgojjgaPjgabliJ3mnJ/ljJZcbiAgICAgKi9cbiAgICB0aGlzLl90d2VlbmVyID0gdW5kZWZpbmVkO1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAdHlwZSB7RHJhZ2dhYmxlfVxuICAgICAqL1xuICAgIHRoaXMuX2RyYWdnYWJsZSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGFkZENoaWxkXG4gICAqIOiHqui6q+OBq+WtkOimgee0oOOCkui/veWKoOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiDoh6rouqvjgpLlrZDopoHntKDjgajjgZfjgablvJXmlbDjgafmjIflrprjgZfjgZ/opoHntKDjgavov73liqDjgZnjgovjgavjga8ge0BsaW5rICNhZGRDaGlsZFRvfSDjgpLkvb/nlKjjgZfjgabjgY/jgaDjgZXjgYTjgIJcbiAgICpcbiAgICogQHRlbXBsYXRlIHtFbGVtZW50aXphYmxlfSBUXG4gICAqIEBwYXJhbSB7VH0gY2hpbGQg6L+95Yqg44GZ44KL5a2Q6KaB57SgXG4gICAqIEByZXR1cm5zIHtUfSDov73liqDjgZfjgZ/lrZDopoHntKBcbiAgICovXG4gIGFkZENoaWxkKGNoaWxkKSB7XG4gICAgaWYgKGNoaWxkLnBhcmVudCkgY2hpbGQucmVtb3ZlKCk7XG5cbiAgICBjaGlsZC5wYXJlbnQgPSB0aGlzO1xuICAgIHRoaXMuY2hpbGRyZW4ucHVzaChjaGlsZCk7XG5cbiAgICBjaGlsZC5oYXMoJ2FkZGVkJykgJiYgY2hpbGQuZmxhcmUoJ2FkZGVkJyk7XG5cbiAgICByZXR1cm4gY2hpbGQ7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBhZGRDaGlsZFRvXG4gICAqIOiHqui6q+OCkuWtkOimgee0oOOBqOOBl+OBpuW8leaVsOOBp+aMh+WumuOBl+OBn+imgee0oOOBq+i/veWKoOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiDoh6rouqvjgavlrZDopoHntKDjgpLov73liqDjgZnjgovjgavjga8ge0BsaW5rICNhZGRDaGlsZH0g44KS5L2/55So44GX44Gm44GP44Gg44GV44GE44CCXG4gICAqXG4gICAqIEB0ZW1wbGF0ZSB7RWxlbWVudGl6YWJsZX0gVFxuICAgKiBAcGFyYW0ge1R9IHBhcmVudCDoh6rouqvjgpLlrZDopoHntKDjgajjgZfjgabov73liqDjgZnjgovopoHntKBcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBhZGRDaGlsZFRvKHBhcmVudCkge1xuICAgIHBhcmVudC5hZGRDaGlsZCh0aGlzKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgYWRkQ2hpbGRBdFxuICAgKiDoh6rouqvjgpLjgIHmjIflrprjgZfjgZ/opoHntKDjga7lrZDopoHntKDjga7ku7vmhI/jga7phY3liJfjgqTjg7Pjg4fjg4Pjgq/jgrnjgavov73liqDjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQHRlbXBsYXRlIHtFbGVtZW50aXphYmxlfSBUXG4gICAqIEBwYXJhbSB7VH0gY2hpbGQg6L+95Yqg44GZ44KL5a2Q6KaB57SgXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCDjgqTjg7Pjg4fjg4Pjgq/jgrnnlarlj7dcbiAgICogQHJldHVybnMge1R9IOi/veWKoOOBl+OBn+WtkOimgee0oFxuICAgKi9cbiAgYWRkQ2hpbGRBdChjaGlsZCwgaW5kZXgpIHtcbiAgICBpZiAoY2hpbGQucGFyZW50KSBjaGlsZC5yZW1vdmUoKTtcblxuICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG4gICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDAsIGNoaWxkKTtcblxuICAgIGNoaWxkLmhhcygnYWRkZWQnKSAmJiBjaGlsZC5mbGFyZSgnYWRkZWQnKTtcblxuICAgIHJldHVybiBjaGlsZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGdldENoaWxkQXRcbiAgICog5oyH5a6a44GX44Gf44Kk44Oz44OH44OD44Kv44K544Gu5a2Q6KaB57Sg44KS6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCDjgqTjg7Pjg4fjg4Pjgq/jgrnnlarlj7dcbiAgICogQHJldHVybnMge0VsZW1lbnRCYXNlZE9iamVjdH0g5oyH5a6a44GX44Gf44Kk44Oz44OH44OD44Kv44K544Gu5a2Q6KaB57SgXG4gICAqL1xuICBnZXRDaGlsZEF0KGluZGV4KSB7XG4gICAgLy8gcmV0dXJuIHRoaXMuY2hpbGRyZW4uYXQoaW5kZXgpO1xuICAgIHJldHVybiBhdC5jYWxsKHRoaXMuY2hpbGRyZW4sIGluZGV4KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAdG9kb1xuICAgKiBAbWV0aG9kIGdldENoaWxkQnlOYW1lXG4gICAqIOaMh+WumuOBl+OBn+WQjeWJjeOBruWtkOimgee0oOOCkui/lOOBl+OBvuOBmeOAgu+8iOacquWun+ijhe+8iVxuICAgKi9cbiAgZ2V0Q2hpbGRCeU5hbWUobmFtZSkge1xuICAgIC8vIFRPRE86XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBnZXRDaGlsZEluZGV4XG4gICAqIOaMh+WumuOBl+OBn+WtkOimgee0oOOBruOCpOODs+ODh+ODg+OCr+OCueeVquWPt+OCkui/lOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAcGFyYW0ge0VsZW1lbnRCYXNlZE9iamVjdH0gY2hpbGQg5a2Q6KaB57SgXG4gICAqIEByZXR1cm4ge051bWJlcn0g5oyH5a6a44GX44Gf5a2Q6KaB57Sg44Gu44Kk44Oz44OH44OD44Kv44K555Wq5Y+3XG4gICAqL1xuICBnZXRDaGlsZEluZGV4KGNoaWxkKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4uaW5kZXhPZihjaGlsZCk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBnZXRQYXJlbnRcbiAgICog5oyH5a6a44GX44Gf6KaB57Sg44Gu6Kaq6KaB57Sg44KS6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqIEByZXR1cm4ge0VsZW1lbnRCYXNlZE9iamVjdH0g5oyH5a6a44GX44Gf6KaB57Sg44Gu6Kaq6KaB57SgXG4gICAqL1xuICBnZXRQYXJlbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgZ2V0Um9vdFxuICAgKiDmjIflrprjgZfjgZ/opoHntKDjga7pmo7lsaTjg4Tjg6rjg7zjga7jg6vjg7zjg4jjgpLov5TjgZfjgb7jgZnjgIJcbiAgICpcbiAgICogQHJldHVybiB7RWxlbWVudEJhc2VkT2JqZWN0fSDmjIflrprjgZfjgZ/opoHntKDjga7pmo7lsaTjg4Tjg6rjg7zjga7jg6vjg7zjg4hcbiAgICovXG4gIGdldFJvb3QoKSB7XG4gICAgLyoqIEB0eXBlIHtFbGVtZW50QmFzZWRPYmplY3R9ICovXG4gICAgdmFyIGVsbSA9IHRoaXM7XG4gICAgZm9yIChlbG09dGhpcy5wYXJlbnQ7IGVsbS5wYXJlbnQgIT0gbnVsbDsgZWxtID0gZWxtLnBhcmVudCkge1xuXG4gICAgfVxuICAgIHJldHVybiBlbG07XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByZW1vdmVDaGlsZFxuICAgKiBAY2hhaW5hYmxlXG4gICAqIOaMh+WumuOBl+OBn+imgee0oOOCkuiHqui6q+OBruWtkOimgee0oOOBi+OCieWJiumZpOOBl+OBvuOBmeOAglxuICAgKlxuICAgKiBAdGVtcGxhdGUge0VsZW1lbnRpemFibGV9IFRcbiAgICogQHBhcmFtIHtUfSBjaGlsZCDopoHntKBcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICByZW1vdmVDaGlsZChjaGlsZCkge1xuICAgIHZhciBpbmRleCA9IHRoaXMuY2hpbGRyZW4uaW5kZXhPZihjaGlsZCk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgY2hpbGQuaGFzKCdyZW1vdmVkJykgJiYgY2hpbGQuZmxhcmUoJ3JlbW92ZWQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCByZW1vdmVcbiAgICog6Ieq6Lqr44KS6Kaq6KaB57Sg44Gu5a2Q6KaB57Sg44GL44KJ5YmK6Zmk44GX44G+44GZ44CCXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcmVtb3ZlKCkge1xuICAgIGlmICghdGhpcy5wYXJlbnQpIHJldHVybiA7XG5cbiAgICB0aGlzLnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzKTtcbiAgICB0aGlzLnBhcmVudCA9IG51bGw7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGlzQXdha2VcbiAgICog6Ieq6Lqr44GM5pyJ5Yq544GL44Gp44GG44GL44KS6L+U44GX44G+44GZ44CCXG4gICAqXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IOacieWKueOBi+OBqeOBhuOBi1xuICAgKi9cbiAgaXNBd2FrZSgpIHtcbiAgICByZXR1cm4gdGhpcy5hd2FrZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHdha2VVcFxuICAgKiDoh6rouqvjgpLmnInlirnjgavjgZfjgb7jgZnjgIJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICB3YWtlVXAoKSB7XG4gICAgdGhpcy5hd2FrZSA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBzbGVlcFxuICAgKiDoh6rouqvjgpLnhKHlirnjgavjgZfjgb7jgZnjgIJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzbGVlcCgpIHtcbiAgICB0aGlzLmF3YWtlID0gZmFsc2U7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQHZpcnR1YWxcbiAgICog5pu05paw55So5Luu5oOz6Zai5pWwXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vZ2FtZS9nYW1lYXBwXCIpLkFwcFVuaW9ufSBbX2FwcF0g44Ki44OX44Oq44Kx44O844K344On44Oz44Kv44Op44K5XG4gICAqIEByZXR1cm5zIHthbnl9XG4gICAqL1xuICB1cGRhdGUoX2FwcCkge31cblxuICAvKipcbiAgICogQG1ldGhvZCBmcm9tSlNPTlxuICAgKiBKU09OIOW9ouW8j+OCkuS9v+OBo+OBpuiHqui6q+OBq+WtkOimgee0oOOCkui/veWKoOOBmeOCi+OBk+OBqOOBjOOBp+OBjeOBvuOBmeOAglxuICAgKlxuICAgKiAjIyMgRXhhbXBsZVxuICAgKiAgICAgIHRoaXMuZnJvbUpTT04oe1xuICAgKiAgICAgICAgXCJjaGlsZHJlblwiOiB7XG4gICAqICAgICAgICAgIFwibGFiZWxcIjogeyAgICAgICAgICAgICAgICAgIC8v44Kt44O85ZCN44GM6L+95Yqg44GZ44KL5a2Q6KaB57Sg44Gu5ZCN5YmN44Gr44Gq44KLXG4gICAqICAgICAgICAgICAgXCJjbGFzc05hbWVcIjogXCJMYWJlbFwiLCAgICAgLy/jgq/jg6njgrlcbiAgICogICAgICAgICAgICBcImFyZ3VtZW50c1wiOiBbJ2hlbGxvISddLCAgLy/liJ3mnJ/ljJbmmYLjga7lvJXmlbBcbiAgICogICAgICAgICAgICBcInhcIjozMjAsICAgICAgICAgICAgICAgICAgLy/jgZ3jga7ku5bjg5fjg63jg5Hjg4bjgqNcbiAgICogICAgICAgICAgICBcInlcIjo0ODAsXG4gICAqICAgICAgICAgIH0sXG4gICAqICAgICAgICB9LFxuICAgKiAgICAgIH0pO1xuICAgKiBcbiAgICogQHR5cGVkZWYge3tcbiAgICogICBjaGlsZHJlbj86IGZyb21KU09ORGF0YVxuICAgKiAgIGNsYXNzTmFtZT86IHN0cmluZyB8IChuZXcgKC4uLmFyZ3M6IGFueSk9PiBhbnkpXG4gICAqICAgYXJndW1lbnRzPzogYW55XG4gICAqICAgW290aGVyUHJvcDogc3RyaW5nXTogYW55XG4gICAqIH19IGZyb21KU09ORGF0YVxuICAgKiBAcGFyYW0ge2Zyb21KU09ORGF0YX0ganNvbiBKU09OIOW9ouW8j1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGZyb21KU09OKGpzb24pIHtcblxuICAgIHZhciBjcmVhdGVDaGlsZHJlbiA9IFxuICAgICAgLyoqXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlcn0gbmFtZVxuICAgICAgICogQHBhcmFtIHtmcm9tSlNPTkRhdGF9IGRhdGFcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24obmFtZSwgZGF0YSkge1xuICAgICAgdmFyIGFyZ3MgPSBkYXRhLmFyZ3VtZW50cztcbiAgICAgIGFyZ3MgPSAoYXJncyBpbnN0YW5jZW9mIEFycmF5KSA/IGFyZ3MgOiBbYXJnc107XG5cbiAgICAgIHZhciBfY2xhc3M7XG4gICAgICB2YXIgZWxlbWVudDtcbiAgICAgIGlmICh0eXBlb2YgZGF0YS5jbGFzc05hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIC8vIGlzIHBoaW5hIGNsYXNzXG4gICAgICAgIF9jbGFzcyA9IHBoaW5hLnVzaW5nKGRhdGEuY2xhc3NOYW1lKTtcbiAgICAgICAgZWxlbWVudCA9IF9jbGFzcy5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRhdGEuY2xhc3NOYW1lID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIGlzIEVTIGNsYXNzXG4gICAgICAgIC8vIEZJWE1FOiDjgqTjg7Pjgrnjgr/jg7PjgrnljJbjgavjgrnjg5fjg6zjg4Pjg4nmp4vmlofjgYzlv4XopoHjgarjgZ/jgoHjgIFlczXjgrXjg53jg7zjg4jjga7loLTlkIhiYWJlbOOBjOW/heimgVxuICAgICAgICBlbGVtZW50ID0gbmV3IGRhdGEuY2xhc3NOYW1lKC4uLmFyZ3MpO1xuICAgICAgfVxuXG4gICAgICBlbGVtZW50Lm5hbWUgPSBuYW1lO1xuICAgICAgdGhpc1tuYW1lXSA9IGVsZW1lbnQ7XG5cbiAgICAgIGVsZW1lbnQuZnJvbUpTT04oZGF0YSk7XG4gICAgICBlbGVtZW50LmFkZENoaWxkVG8odGhpcyk7XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgZm9ySW4uY2FsbChqc29uLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgLy8ganNvbi5mb3JJbihmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICBpZiAoa2V5ID09PSAnY2hpbGRyZW4nKSB7XG4gICAgICAgIGZvckluLmNhbGwodmFsdWUsIGZ1bmN0aW9uKG5hbWUsIGRhdGEpIHtcbiAgICAgICAgLy8gdmFsdWUuZm9ySW4oZnVuY3Rpb24obmFtZSwgZGF0YSkge1xuICAgICAgICAgIGNyZWF0ZUNoaWxkcmVuKG5hbWUsIGRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBpZiAoa2V5ICE9PSAndHlwZScgJiYga2V5ICE9PSAnY2xhc3NOYW1lJykge1xuICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgdGhpcyk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8vIC8qKlxuICAvLyAgKiBAbWV0aG9kIHRvSlNPTlxuICAvLyAgKiDoh6rouqvjga7lrZDopoHntKDjgpIgSlNPTiDlvaLlvI/jgafov5TjgZfjgb7jgZnjgIJcbiAgLy8gICpcbiAgLy8gICogQHJldHVybiB7SlNPTn0gSlNPTuW9ouW8j1xuICAvLyAgKi9cbiAgLy8gdG9KU09OKCkge1xuICAvLyAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMocGhpbmEudXNpbmcodGhpcy5jbGFzc05hbWUpLmRlZmF1bHRzIHx8IHt9KTtcblxuICAvLyAgIHRoaXMuX2hpZXJhcmNoaWVzLmZvckVhY2goZnVuY3Rpb24oZSkge1xuICAvLyAgICAgdmFyIGQgPSBlLmRlZmF1bHRzO1xuICAvLyAgICAgaWYgKGQpIHtcbiAgLy8gICAgICAgT2JqZWN0LmtleXMoZCkuZm9yRWFjaChmdW5jdGlvbihrKSB7XG4gIC8vICAgICAgICAgaWYgKGtleXMuaW5kZXhPZihrKSA9PT0gLTEpIHtcbiAgLy8gICAgICAgICAgIGtleXMucHVzaChrKTtcbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgIH0pO1xuICAvLyAgICAgfVxuICAvLyAgIH0pO1xuXG4gIC8vICAga2V5cy5wdXNoKCduYW1lJywgJ2NsYXNzTmFtZScpO1xuXG4gIC8vICAgdmFyIGpzb24gPSB7fTtcbiAgLy8gICAvLyBrZXlzLmVhY2goZnVuY3Rpb24oa2V5KSB7XG4gIC8vICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAvLyAgICAganNvbltrZXldID0gdGhpc1trZXldO1xuICAvLyAgIH0sIHRoaXMpO1xuXG4gIC8vICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbi5tYXAoZnVuY3Rpb24oY2hpbGQpIHtcbiAgLy8gICAgIHJldHVybiBjaGlsZC50b0pTT04oKTtcbiAgLy8gICB9KTtcblxuICAvLyAgIGlmIChjaGlsZHJlbi5sZW5ndGgpIHtcbiAgLy8gICAgIGpzb24uY2hpbGRyZW4gPSB7fTtcbiAgLy8gICAgIC8vIGNoaWxkcmVuLmVhY2goZnVuY3Rpb24oY2hpbGQsIGkpIHtcbiAgLy8gICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oY2hpbGQsIGkpIHtcbiAgLy8gICAgICAganNvbi5jaGlsZHJlbltjaGlsZC5uYW1lIHx8IChjaGlsZC5jbGFzc05hbWUgKyAnXycgKyBpKV0gPSBjaGlsZDtcbiAgLy8gICAgIH0pO1xuICAvLyAgIH1cblxuICAvLyAgIHJldHVybiBqc29uO1xuICAvLyB9XG5cbiAgLyoqXG4gICAqIGFjY2Vzc29yeeOCkuS7mOS4juOBmeOCi1xuICAgKiBAcGFyYW0gIHtpbXBvcnQoJy4uL2FjY2Vzc29yeS9hY2Nlc3NvcnknKS5BY2Nlc3Nvcnl9IGFjY2Vzc29yeSBBY2Nlc3Nvcnnntpnmib/jgq/jg6njgrlcbiAgICogQHJldHVybiB7dGhpc31cbiAgICovXG4gIGF0dGFjaChhY2Nlc3NvcnkpIHtcbiAgICBpZiAoIXRoaXMuYWNjZXNzb3JpZXMpIHtcbiAgICAgIHRoaXMuYWNjZXNzb3JpZXMgPSBbXTtcbiAgICAgIHRoaXMub24oJ2VudGVyZnJhbWUnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIHRoaXMuYWNjZXNzb3JpZXMuZm9yRWFjaChmdW5jdGlvbihhY2Nlc3NvcnkpIHtcbiAgICAgICAgICBhY2Nlc3NvcnkudXBkYXRlICYmIGFjY2Vzc29yeS51cGRhdGUoZS5hcHApO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuYWNjZXNzb3JpZXMucHVzaChhY2Nlc3NvcnkpO1xuICAgIGFjY2Vzc29yeS5zZXRUYXJnZXQodGhpcyk7XG4gICAgYWNjZXNzb3J5LmZsYXJlKCdhdHRhY2hlZCcpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogYWNjZXNzb3J544KS5YmK6ZmkXG4gICAqIEBwYXJhbSAge2ltcG9ydCgnLi4vYWNjZXNzb3J5L2FjY2Vzc29yeScpLkFjY2Vzc29yeX0gYWNjZXNzb3J5IEFjY2Vzc29yeee2meaJv+OCr+ODqeOCuVxuICAgKiBAcmV0dXJuIHt0aGlzfVxuICAgKi9cbiAgZGV0YWNoKGFjY2Vzc29yeSkge1xuICAgIGlmICh0aGlzLmFjY2Vzc29yaWVzKSB7XG4gICAgICAvLyB0aGlzLmFjY2Vzc29yaWVzLmVyYXNlKGFjY2Vzc29yeSk7XG4gICAgICBlcmFzZS5jYWxsKHRoaXMuYWNjZXNzb3JpZXMsIGFjY2Vzc29yeSk7XG4gICAgICBhY2Nlc3Nvcnkuc2V0VGFyZ2V0KG51bGwpO1xuICAgICAgYWNjZXNzb3J5LmZsYXJlKCdkZXRhY2hlZCcpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOiHqui6q+OBq+S7mOS4ju+8iGF0dGFjaO+8ieOBleOCjOOBn+WGhemDqHR3ZWVuZXLjgqrjg5bjgrjjgqfjgq/jg4jjgpLov5TljbRcbiAgICogXG4gICAqIOOCouOCr+OCu+OCueaZguOBq+WtmOWcqOOBl+OBquOBhOWgtOWQiOOAgeaWsOOBn+OBq1R3ZWVuZXLjgpLnlJ/miJDjg7vku5jkuI7jgZnjgotcbiAgICovXG4gIGdldCB0d2VlbmVyKCkge1xuICAgIGlmICghdGhpcy5fdHdlZW5lcikge1xuICAgICAgdGhpcy5fdHdlZW5lciA9IG5ldyBUd2VlbmVyKCkuYXR0YWNoVG8odGhpcyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl90d2VlbmVyO1xuICB9XG5cbiAgLyoqXG4gICAqIOiHqui6q+OBq+S7mOS4ju+8iGF0dGFjaO+8ieOBleOCjOOBn+WGhemDqGRyYWdnYWJsZeOCquODluOCuOOCp+OCr+ODiOOCkui/lOWNtFxuICAgKiBcbiAgICog44Ki44Kv44K744K55pmC44Gr5a2Y5Zyo44GX44Gq44GE5aC05ZCI44CB5paw44Gf44GrRHJhZ2dhYmxl44KS55Sf5oiQ44O75LuY5LiO44GZ44KLXG4gICAqIOOBneOBrumam+iHquWLleOBp+acieWKueWMluOBleOCjOOCi+OBn+OCgeOAgeOCouOCr+OCu+OCueOBl+OBn+WcsOeCueOBp+ODieODqeODg+OCsOWPr+iDveOBq+OBquOCi1xuICAgKi9cbiAgZ2V0IGRyYWdnYWJsZSgpIHtcbiAgICBpZiAoIXRoaXMuX2RyYWdnYWJsZSkge1xuICAgICAgdGhpcy5fZHJhZ2dhYmxlID0gbmV3IERyYWdnYWJsZSgpLmF0dGFjaFRvKHRoaXMpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fZHJhZ2dhYmxlO1xuICB9XG59XG5cbi8qKlxuICogQHR5cGVkZWYge3N0cmluZ3xudW1iZXJ9IFNjZW5lTGFiZWxcbiAqL1xuXG4vKipcbiAqIGV4aXTjg6Hjgr3jg4Pjg4nnlKjjg5Hjg6njg6Hjg7zjgr9cbiAqIEB0eXBlZGVmIHt7XG4gKiAgIG5leHRMYWJlbD86IFNjZW5lTGFiZWxcbiAqICAgW2tleTogc3RyaW5nXTogYW55LFxuICogfX0gTmV4dEFyZ3VtZW50c0ZvckV4aXRcbiAqL1xuXG4vKipcbiAqIFNjZW5l44GuQXBw44Kv44Op44K55Y+C54Wn44Go44GX44Gm5pyA5L2O6ZmQ44Gu44Kk44Oz44K/44OV44Kn44O844K544KS5YKZ44GI44Gf5Z6LXG4gKiBAdHlwZWRlZiB7e1xuICogICBwb3BTY2VuZTogdHlwZW9mIGltcG9ydChcIi4vYmFzZWFwcFwiKS5CYXNlQXBwLnByb3RvdHlwZS5wb3BTY2VuZVxuICogICBba2V5OiBzdHJpbmddOiBhbnksXG4gKiB9fSBTY2VuZUFwcEFwcGxpYWJsZVxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFwcC5TY2VuZVxuICogX2V4dGVuZHMgcGhpbmEuYXBwLkVsZW1lbnRcbiAqL1xuY2xhc3MgU2NlbmUgZXh0ZW5kcyBFbGVtZW50IHtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgLyoqXG4gICAgICogQXBw44Kv44Op44K55Y+C54WnXG4gICAgICogQHR5cGUge1NjZW5lQXBwQXBwbGlhYmxlP31cbiAgICAgKi9cbiAgICB0aGlzLmFwcDtcblxuICAgIC8qKlxuICAgICAqIOasoeOBruOCt+ODvOODs+OCkuihqOOBmeODqeODmeODq1xuICAgICAqIEB0eXBlIHtTY2VuZUxhYmVsfVxuICAgICAqL1xuICAgIHRoaXMubmV4dExhYmVsO1xuXG4gICAgLyoqXG4gICAgICog5qyh44Gu44K344O844Oz44Gr5rih44GV44KM44KL5byV5pWw44KS5L+d5oyBXG4gICAgICogTWFuYWdlclNjZW5l44Kv44Op44K544Gn5L2/55SoXG4gICAgICogQHR5cGUge2FueX1cbiAgICAgKi9cbiAgICB0aGlzLm5leHRBcmd1bWVudHM7XG4gIH1cblxuICAvKipcbiAgICog54++5Zyo44Gu44K344O844Oz44KS5oqc44GR44KLXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiBjb25zdCBzY2VuZSA9IG5ldyBTY2VuZSgpO1xuICAgKiBzY2VuZS5leGl0KFwibmV4dHNjZW5lbGFiZWxcIiwge3Njb3JlOiAxMjh9KVxuICAgKiAvLyBvclxuICAgKiBzY2VuZS5leGl0KHtuZXh0TGFiZWw6XCJuZXh0c2NlbmVsYWJlbFwiLCBzY29yZTogMTI4fSlcbiAgICogXG4gICAqIEBwYXJhbSB7U2NlbmVMYWJlbCB8IE5leHRBcmd1bWVudHNGb3JFeGl0fSBbbmV4dExhYmVsT3JBcmd1bWVudHNdXG4gICAqIOasoeOCt+ODvOODs+OBruODqeODmeODq+OAgeOCguOBl+OBj+OBr+ODqeODmeODq+i+vOOBv+OBruW8leaVsOOCquODluOCuOOCp+OCr+ODiFxuICAgKiBcbiAgICogQHBhcmFtIHthbnl9IFtuZXh0QXJndW1lbnRzXVxuICAgKiDlvJXmlbDjgqrjg5bjgrjjgqfjgq/jg4hcbiAgICog56ys5LiA5byV5pWw44KS44Op44OZ44Or5paH5a2X5YiX44Gn5oyH5a6a44GX44Gf5aC05ZCI44Gr6Kit5a6aXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGV4aXQobmV4dExhYmVsT3JBcmd1bWVudHMsIG5leHRBcmd1bWVudHMpIHtcbiAgICBpZiAoIXRoaXMuYXBwKSByZXR1cm4gO1xuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgbmV4dExhYmVsT3JBcmd1bWVudHMgPSBhcmd1bWVudHNbMF0ubmV4dExhYmVsIHx8IHRoaXMubmV4dExhYmVsO1xuICAgICAgICBuZXh0QXJndW1lbnRzID0gYXJndW1lbnRzWzBdO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm5leHRMYWJlbCA9IC8qKiBAdHlwZSB7U2NlbmVMYWJlbH0gKi8obmV4dExhYmVsT3JBcmd1bWVudHMpO1xuICAgICAgdGhpcy5uZXh0QXJndW1lbnRzID0gbmV4dEFyZ3VtZW50cztcbiAgICB9XG5cbiAgICB0aGlzLmFwcC5wb3BTY2VuZSgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHsoXG4gKiAgIFNjZW5lIHxcbiAqICAgaW1wb3J0KFwiLi4vZGlzcGxheS9kaXNwbGF5c2NlbmVcIikuRGlzcGxheVNjZW5lIHxcbiAqICAgaW1wb3J0KFwiLi4vZ2FtZS9tYW5hZ2Vyc2NlbmUuanNcIikuTWFuYWdlclNjZW5lXG4gKiApfSBTY2VuZVR5cGVVbmlvblxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFwcC5CYXNlQXBwXG4gKiBfZXh0ZW5kcyBwaGluYS51dGlsLkV2ZW50RGlzcGF0Y2hlclxuICogXG4gKiDjgqLjg5fjg6rjgrHjg7zjgrfjg6fjg7Pjgq/jg6njgrnjga7ln7rlupXjgq/jg6njgrlcbiAqL1xuY2xhc3MgQmFzZUFwcCBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8qKlxuICAgICAqIOOCt+ODvOODs+OBruOCueOCv+ODg+OCr1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAdHlwZSB7U2NlbmVUeXBlVW5pb25bXX1cbiAgICAgKi9cbiAgICB0aGlzLl9zY2VuZXMgPSBbbmV3IFNjZW5lKCldO1xuXG4gICAgLyoqXG4gICAgICog44K344O844Oz44Gu44Kk44Oz44OH44OD44Kv44K55YCkXG4gICAgICog44Ki44Kv44OG44Kj44OW5Lit44Gu44K344O844Oz566h55CG44Gr5L2/55SoXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5fc2NlbmVJbmRleCA9IDA7XG5cbiAgICAvKipcbiAgICAgKiDmm7TmlrDlh6bnkIbjgYzmnInlirnjgarnirbmhYvjgYvjganjgYbjgYtcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB0aGlzLmF3YWtlID0gdHJ1ZTtcblxuICAgIC8qKiBAdHlwZSB7VXBkYXRlcn0gKi9cbiAgICB0aGlzLnVwZGF0ZXIgPSBuZXcgVXBkYXRlcih0aGlzKTtcblxuICAgIC8qKiBAdHlwZSB7SW50ZXJhY3RpdmV9ICovXG4gICAgdGhpcy5pbnRlcmFjdGl2ZSA9IG5ldyBJbnRlcmFjdGl2ZSh0aGlzKTtcblxuICAgIC8qKiBAdHlwZSB7VGlja2VyfSAqL1xuICAgIHRoaXMudGlja2VyID0gbmV3IFRpY2tlcigpO1xuICAgIFxuICAgIC8qKlxuICAgICAqIHRpY2tlcuOBq+OCiOOBo+OBpuavjuODleODrOODvOODoOWun+ihjOOBleOCjOOCi+OCouODl+ODquWGhemDqOWHpueQhlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHR5cGUge2ltcG9ydChcIi4uL3V0aWwvZXZlbnRkaXNwYXRjaGVyXCIpLlBoaW5hRXZlbnRIYW5kbGVyIHwgbnVsbH1cbiAgICAgKi9cbiAgICB0aGlzLl9sb29wQ2FsbGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCouODl+ODquOCseODvOOCt+ODp+ODs+OCkumWi+Wni1xuICAgKiBcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBydW4oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuX2xvb3BDYWxsZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYuX2xvb3AoKTtcbiAgICB9O1xuICAgIHRoaXMudGlja2VyLnRpY2sodGhpcy5fbG9vcENhbGxlcik7XG5cbiAgICB0aGlzLnRpY2tlci5zdGFydCgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Ki44OX44Oq44Kx44O844K344On44Oz44KS5a6M5YWo5YGc5q2iXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGtpbGwoKSB7XG4gICAgdGhpcy50aWNrZXIuc3RvcCgpO1xuICAgIGlmICh0aGlzLl9sb29wQ2FsbGVyKSB0aGlzLnRpY2tlci51bnRpY2sodGhpcy5fbG9vcENhbGxlcik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog5oyH5a6a44GX44Gf44K344O844Oz44Gr5YiH44KK5pu/44GI44KLXG4gICAqIFxuICAgKiBAcGFyYW0ge1NjZW5lVHlwZVVuaW9ufSBzY2VuZVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHJlcGxhY2VTY2VuZShzY2VuZSkge1xuICAgIHRoaXMuZmxhcmUoJ3JlcGxhY2UnKTtcbiAgICB0aGlzLmZsYXJlKCdjaGFuZ2VzY2VuZScpO1xuXG4gICAgaWYgKHRoaXMuY3VycmVudFNjZW5lKSB7XG4gICAgICB0aGlzLmN1cnJlbnRTY2VuZS5hcHAgPSBudWxsO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnRTY2VuZSA9IHNjZW5lO1xuICAgIHRoaXMuY3VycmVudFNjZW5lLmFwcCA9IHRoaXM7XG4gICAgdGhpcy5jdXJyZW50U2NlbmUuZmxhcmUoJ2VudGVyJywge1xuICAgICAgYXBwOiB0aGlzLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog5oyH5a6a44GX44Gfc2NlbmXjgavpgbfnp7vjgZnjgotcbiAgICogXG4gICAqIHJlcGxhY2VTY2VuZeOBqOOBr+mBleOBhOOAgemBt+enu+WJjeOBruOCt+ODvOODs+OBr+WBnOatouOBl+OBpuS/neaMgeOBl+e2muOBkeOCi+OAglxuICAgKiDjgZ3jga7jgZ/jgoHjgIHjg53jg7zjgrrjgoTjgqrjg5bjgrfjg6fjg7PnlLvpnaLjgarjganjga7kuIDmmYLnmoTjgarjgrfjg7zjg7Pjgafjga7kvb/nlKjjgavmnIDpgalcbiAgICogXG4gICAqIOWFt+S9k+eahOOBq+OBr+OCt+ODvOODs+OCueOCv+ODg+OCr+OBq+OCt+ODvOODs+OCkui/veWKoOOBl+OBpOOBpOOAgVxuICAgKiDjgqTjg7Pjg4fjg4Pjgq/jgrnlgKTjgpLpgLLjgoHjgovjgZPjgajjgafjgrfjg7zjg7Ppgbfnp7vjgZnjgotcbiAgICogXG4gICAqIEBwYXJhbSB7U2NlbmV9IHNjZW5lXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcHVzaFNjZW5lKHNjZW5lKSB7XG4gICAgdGhpcy5mbGFyZSgncHVzaCcpO1xuICAgIHRoaXMuZmxhcmUoJ2NoYW5nZXNjZW5lJyk7XG5cbiAgICB0aGlzLmN1cnJlbnRTY2VuZS5mbGFyZSgncGF1c2UnLCB7XG4gICAgICBhcHA6IHRoaXMsXG4gICAgfSk7XG5cbiAgICB0aGlzLl9zY2VuZXMucHVzaChzY2VuZSk7XG4gICAgKyt0aGlzLl9zY2VuZUluZGV4O1xuXG4gICAgdGhpcy5mbGFyZSgncHVzaGVkJyk7XG5cbiAgICBzY2VuZS5hcHAgPSB0aGlzO1xuICAgIHNjZW5lLmZsYXJlKCdlbnRlcicsIHtcbiAgICAgIGFwcDogdGhpcyxcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOePvuWcqOOBruOCt+ODvOODs+OCkuaKnOOBkeOAgeebtOWJjeOBruOCt+ODvOODs+OBq+aIu+OCi1xuICAgKiDjg53jg7zjgrrjgoTjgqrjg5bjgrfjg6fjg7PnlLvpnaLjgarjganjgIHkuIDmmYLnmoTjgarjgrfjg7zjg7PjgpLmipzjgZHjgovpmpvjgavkvb/nlKhcbiAgICogXG4gICAqIHB1c2hTY2VuZeWQjOanmOOAgeOCt+ODvOODs+OCueOCv+ODg+OCr+OBruaTjeS9nOOBq+OCiOOBo+OBplxuICAgKiDjgqLjgq/jg4bjgqPjg5bjgarjgrfjg7zjg7PjgpLliIfjgormm7/jgYjjgotcbiAgICogXG4gICAqIEByZXR1cm5zIHtTY2VuZSB8IHZvaWR9IOaKnOOBkeOBn1NjZW5l44Kq44OW44K444Kn44Kv44OI44CB5Yem55CG44Gn44GN44Gq44GL44Gj44Gf5aC05ZCI44Gv5L2V44KC6L+U44GV44Gq44GEXG4gICAqL1xuICBwb3BTY2VuZSgpIHtcbiAgICB0aGlzLmZsYXJlKCdwb3AnKTtcbiAgICB0aGlzLmZsYXJlKCdjaGFuZ2VzY2VuZScpO1xuXG4gICAgLy8gS2VlcCByb290U2NlbmVcbiAgICBpZiAodGhpcy5fc2NlbmVzLmxlbmd0aCA8PSAxKSByZXR1cm47XG5cbiAgICB2YXIgc2NlbmUgPSAvKiogQHR5cGUge1NjZW5lfSAqLyh0aGlzLl9zY2VuZXMucG9wKCkpO1xuICAgIC0tdGhpcy5fc2NlbmVJbmRleDtcblxuICAgIHNjZW5lLmZsYXJlKCdleGl0Jywge1xuICAgICAgYXBwOiB0aGlzLFxuICAgIH0pO1xuICAgIHNjZW5lLmFwcCA9IG51bGw7XG5cbiAgICB0aGlzLmZsYXJlKCdwb3BlZCcpO1xuXG4gICAgdGhpcy5jdXJyZW50U2NlbmUuZmxhcmUoJ3Jlc3VtZScsIHtcbiAgICAgIGFwcDogdGhpcyxcbiAgICAgIHByZXZTY2VuZTogc2NlbmUsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2NlbmU7XG4gIH1cblxuICAvKipcbiAgICog44Ki44OX44Oq44Kx44O844K344On44Oz44Gu5YaN6ZaLXG4gICAqIOabtOaWsOWHpueQhuOBruWun+ihjOOCkuWGjemWi+OBmeOCi1xuICAgKiBcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzdGFydCgpIHtcbiAgICB0aGlzLmF3YWtlID0gdHJ1ZTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCouODl+ODquOCseODvOOCt+ODp+ODs+OBruS4gOaZguWBnOatolxuICAgKiDmm7TmlrDlh6bnkIbjgpLlrp/ooYzjgZfjgarjgYTjgojjgYbjgavjgZnjgotcbiAgICogXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc3RvcCgpIHtcbiAgICB0aGlzLmF3YWtlID0gZmFsc2U7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBzdGF0cy5qcyggaHR0cHM6Ly9naXRodWIuY29tL21yZG9vYi9zdGF0cy5qcy8gKeOCkuWun+ihjOOBl+OAgVxuICAgKiDjg5Hjg5Xjgqnjg7zjg57jg7Pjgrnjg6Ljg4vjgr/jg7zjgpLooajnpLrjgZnjgotcbiAgICogXG4gICAqIHN0YXRzLmpz44GM44Kw44Ot44O844OQ44Or44Gn6Kqt44G/6L6844G+44KM44Gm44GE44Gq44GE5aC05ZCI44CBXG4gICAqIGNkbmpz44GL44KJcjE054mI44K544Kv44Oq44OX44OI44KS6Kqt44G/6L6844KAXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGVuYWJsZVN0YXRzKCkge1xuICAgIGlmIChwaGluYS5nbG9iYWxbJ1N0YXRzJ10pIHtcbiAgICAgIHRoaXMuc3RhdHMgPSBuZXcgcGhpbmEuZ2xvYmFsWydTdGF0cyddKCk7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuc3RhdHMuZG9tRWxlbWVudCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gY29uc29sZS53YXJuKFwibm90IGRlZmluZWQgc3RhdHMuXCIpO1xuICAgICAgdmFyIFNUQVRTX1VSTCA9ICdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9zdGF0cy5qcy9yMTQvU3RhdHMuanMnO1xuICAgICAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgc2NyaXB0LnNyYyA9IFNUQVRTX1VSTDtcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICAgIHNjcmlwdC5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5lbmFibGVTdGF0cygpO1xuICAgICAgfS5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBkYXQuR1VJKCBodHRwczovL2dpdGh1Yi5jb20vZGF0YWFydHMvZGF0Lmd1aSAp44KS5Yid5pyf5YyW44GX44CBXG4gICAqIOOBneOBruOCpOODs+OCueOCv+ODs+OCueOCkuOCs+ODvOODq+ODkOODg+OCr+mWouaVsOOBq+a4oeOBl+OBpuWun+ihjFxuICAgKiBcbiAgICogZGF0LkdVSeOBjOOCsOODreODvOODkOODq+OBp+iqreOBv+i+vOOBvuOCjOOBpuOBhOOBquOBhOWgtOWQiOOAgVxuICAgKiBjZG5qc+OBi+OCiXYwLjUuMeeJiOOCueOCr+ODquODl+ODiOOCkuiqreOBv+i+vOOCgFxuICAgKiBcbiAgICogQHBhcmFtIHsoZGF0R1VJT2JqZWN0PzogYW55KSA9PiBhbnl9IGNhbGxiYWNrXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZW5hYmxlRGF0R1VJKGNhbGxiYWNrKSB7XG4gICAgaWYgKHBoaW5hLmdsb2JhbFsnZGF0J10pIHtcbiAgICAgIHZhciBndWkgPSBuZXcgcGhpbmEuZ2xvYmFsWydkYXQnXS5HVUkoKTtcbiAgICAgIGNhbGxiYWNrKGd1aSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gY29uc29sZS53YXJuKFwibm90IGRlZmluZWQgZGF0LkdVSS5cIik7XG4gICAgICB2YXIgVVJMID0gJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2RhdC1ndWkvMC41LjEvZGF0Lmd1aS5qcyc7XG4gICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICBzY3JpcHQuc3JjID0gVVJMO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgICAgc2NyaXB0Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZ3VpID0gbmV3IHBoaW5hLmdsb2JhbFsnZGF0J10uR1VJKCk7XG4gICAgICAgIGNhbGxiYWNrKGd1aSk7XG4gICAgICB9LmJpbmQodGhpcyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICog44Or44O844OX5Yem55CG6Zai5pWwXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIF9sb29wKCkge1xuICAgIHRoaXMuX3VwZGF0ZSgpO1xuICAgIHRoaXMuaW50ZXJhY3RpdmUuY2hlY2sodGhpcy5jdXJyZW50U2NlbmUpO1xuICAgIHRoaXMuX2RyYXcoKTtcblxuICAgIC8vIHN0YXRzIHVwZGF0ZVxuICAgIGlmICh0aGlzLnN0YXRzKSB0aGlzLnN0YXRzLnVwZGF0ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICog5pu05paw5Yem55CG6Zai5pWwXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIF91cGRhdGUoKSB7XG4gICAgaWYgKHRoaXMuYXdha2UpIHtcbiAgICAgIC8vIOOCqOODs+OCv+ODvOODleODrOODvOODoOOCpOODmeODs+ODiFxuICAgICAgaWYgKHRoaXMuaGFzKCdlbnRlcmZyYW1lJykpIHtcbiAgICAgICAgdGhpcy5mbGFyZSgnZW50ZXJmcmFtZScpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnVwZGF0ZSAmJiB0aGlzLnVwZGF0ZSgpO1xuICAgICAgdGhpcy51cGRhdGVyLnVwZGF0ZSh0aGlzLmN1cnJlbnRTY2VuZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOeUqOS7ruaDs+mWouaVsFxuICAgKiBcbiAgICogQHZpcnR1YWxcbiAgICogQHJldHVybnMge2FueX1cbiAgICovXG4gIHVwZGF0ZSgpIHt9XG5cbiAgLyoqXG4gICAqIOaPj+eUu+eUqOS7ruaDs+mWouaVsFxuICAgKiBcbiAgICogQHZpcnR1YWxcbiAgICogQHJldHVybnMge2FueX1cbiAgICovXG4gIF9kcmF3KCkge31cblxuICAvKipcbiAgICog54++5Zyo44Ki44Kv44OG44Kj44OW5Lit44Gu44K344O844OzXG4gICAqL1xuICBnZXQgY3VycmVudFNjZW5lKCkgICB7IHJldHVybiB0aGlzLl9zY2VuZXNbdGhpcy5fc2NlbmVJbmRleF07IH1cbiAgc2V0IGN1cnJlbnRTY2VuZSh2KSAgeyB0aGlzLl9zY2VuZXNbdGhpcy5fc2NlbmVJbmRleF0gPSB2OyB9XG5cbiAgLyoqXG4gICAqIOagueacrOOCt+ODvOODs+OAguOCpOODs+OCueOCv+ODs+OCueWMluOBrumam+OBq+iHquWLleeahOOBq+ioreWumlxuICAgKi9cbiAgZ2V0IHJvb3RTY2VuZSgpICAgeyByZXR1cm4gdGhpcy5fc2NlbmVzWzBdOyB9XG4gIHNldCByb290U2NlbmUodikgIHsgdGhpcy5fc2NlbmVzWzBdID0gdjsgfVxuXG4gIC8qKlxuICAgKiDntYzpgY7jg5Xjg6zjg7zjg6DmlbBcbiAgICovXG4gIGdldCBmcmFtZSgpIHsgcmV0dXJuIHRoaXMudGlja2VyLmZyYW1lOyB9XG4gIHNldCBmcmFtZSh2KSB7IHRoaXMudGlja2VyLmZyYW1lID0gdjsgfVxuXG4gIC8qKlxuICAgKiBGcmFtZSBwZXIgc2Vjb25kICBcbiAgICog56eS6ZaT44Gu5pu05paw44GK44KI44Gz5o+P55S75Yem55CG5Zue5pWwXG4gICAqL1xuICBnZXQgZnBzKCkgeyByZXR1cm4gdGhpcy50aWNrZXIuZnBzOyB9XG4gIHNldCBmcHModikgeyB0aGlzLnRpY2tlci5mcHMgPSB2OyB9XG5cbiAgLyoqXG4gICAqIOWJjeODleODrOODvOODoOOBp+OBruWHpueQhuOBq+OBi+OBi+OBo+OBn+aZgumWk1xuICAgKi9cbiAgZ2V0IGRlbHRhVGltZSgpIHsgcmV0dXJuIHRoaXMudGlja2VyLmRlbHRhVGltZTsgfVxuXG4gIC8qKlxuICAgKiDjgqLjg5fjg6rjgrHjg7zjgrfjg6fjg7Pplovlp4vjgYvjgonjga7ntYzpgY7mmYLplpNcbiAgICovXG4gIGdldCBlbGFwc2VkVGltZSgpIHsgcmV0dXJuIHRoaXMudGlja2VyLmVsYXBzZWRUaW1lOyB9XG5cbiAgLyoqXG4gICAqIOePvuWcqOOBruaZgumWk++8iOacgOW+jOOBruabtOaWsOaZguOBrlVOSVjjgr/jgqTjg6Djgrnjgr/jg7Pjg5fvvIlcbiAgICovXG4gIGdldCBjdXJyZW50VGltZSgpIHsgcmV0dXJuIHRoaXMudGlja2VyLmN1cnJlbnRUaW1lOyB9XG5cbiAgLyoqXG4gICAqIOOCouODl+ODquOCseODvOOCt+ODp+ODs+mWi+Wni+aZgumWk++8iFVOSVjjgr/jgqTjg6Djgrnjgr/jg7Pjg5fvvIlcbiAgICovXG4gIGdldCBzdGFydFRpbWUoKSB7IHJldHVybiB0aGlzLnRpY2tlci5zdGFydFRpbWU7IH1cbn1cblxuLyoqXG4gKiDliKTlrprlh6bnkIbjga7pmpvjgIHjganjga7jgojjgYbjgarlvaLnirbjgajjgZfjgabmibHjgYbjgYtcbiAqIEB0eXBlZGVmIHtcInJlY3RcInxcImNpcmNsZVwifFwibm9uZVwifSBPYmplY3QyREJvdW5kaW5nVHlwZVxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICB4PzogTnVtYmVyLFxuICogIHk/OiBOdW1iZXIsXG4gKiAgc2NhbGVYPzogTnVtYmVyLFxuICogIHNjYWxlWT86IE51bWJlcixcbiAqICByb3RhdGlvbj86IE51bWJlcixcbiAqICBvcmlnaW5YPzogTnVtYmVyLFxuICogIG9yaWdpblk/OiBOdW1iZXIsXG4gKiAgd2lkdGg/OiBOdW1iZXIsXG4gKiAgaGVpZ2h0PzogTnVtYmVyLFxuICogIHJhZGl1cz86IE51bWJlcixcbiAqICBib3VuZGluZ1R5cGU/OiBPYmplY3QyREJvdW5kaW5nVHlwZSxcbiAqIH19IE9iamVjdDJET3B0aW9uc1xuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFwcC5PYmplY3QyRFxuICogT2JqZWN0MkRcbiAqIF9leHRlbmRzIHBoaW5hLmFwcC5FbGVtZW50XG4gKi9cbmNsYXNzIE9iamVjdDJEIGV4dGVuZHMgRWxlbWVudCB7XG5cbiAgLy8gLyoqIOS9jee9riAqL1xuICAvLyBwb3NpdGlvbjogbnVsbCxcbiAgLy8gLyoqIOWbnui7oiAqL1xuICAvLyByb3RhdGlvbjogMCxcbiAgLy8gLyoqIOOCueOCseODvOODqyAqL1xuICAvLyBzY2FsZTogbnVsbCxcbiAgLy8gLyoqIOWfuua6luS9jee9riAqL1xuICAvLyBvcmlnaW46IG51bGwsXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7T2JqZWN0MkRPcHRpb25zfSBbb3B0aW9uc11cbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwoe30sIG9wdGlvbnMsIE9iamVjdDJELmRlZmF1bHRzKTtcbiAgICAvLyBvcHRpb25zID0gKHt9KS4kc2FmZShvcHRpb25zLCBwaGluYS5hcHAuT2JqZWN0MkQuZGVmYXVsdHMpO1xuXG4gICAgLyoqIEB0eXBlIHtWZWN0b3IyfSDkvY3nva4gKi9cbiAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFZlY3RvcjIob3B0aW9ucy54LCBvcHRpb25zLnkpO1xuXG4gICAgLyoqIEB0eXBlIHtWZWN0b3IyfSDjgrnjgrHjg7zjg6sgKi9cbiAgICB0aGlzLnNjYWxlICAgID0gbmV3IFZlY3RvcjIob3B0aW9ucy5zY2FsZVgsIG9wdGlvbnMuc2NhbGVZKTtcblxuICAgIC8qKiBAdHlwZSB7bnVtYmVyfSDlm57ou6LvvIjluqbmlbDljZjkvY3vvIkgKi9cbiAgICB0aGlzLnJvdGF0aW9uID0gb3B0aW9ucy5yb3RhdGlvbiB8fCAwO1xuXG4gICAgLyoqIEB0eXBlIHtWZWN0b3IyfSDln7rmupbkvY3nva7jgIHlm57ou6Lou7ggKi9cbiAgICB0aGlzLm9yaWdpbiAgID0gbmV3IFZlY3RvcjIob3B0aW9ucy5vcmlnaW5YLCBvcHRpb25zLm9yaWdpblkpO1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAdHlwZSB7TWF0cml4MzN9XG4gICAgICog44Ot44O844Kr44Or5aSJ5o+b6KGM5YiXXG4gICAgICovXG4gICAgdGhpcy5fbWF0cml4ID0gbmV3IE1hdHJpeDMzKCkuaWRlbnRpdHkoKTtcbiAgICAvKipcbiAgICAgKiBAdHlwZSB7TWF0cml4MzMgfCBudWxsfVxuICAgICAqIOODr+ODvOODq+ODieWkieaPm+ihjOWIl1xuICAgICAqL1xuICAgIHRoaXMuX3dvcmxkTWF0cml4ID0gbmV3IE1hdHJpeDMzKCkuaWRlbnRpdHkoKTtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHR5cGUge251bWJlcn0g6KGM5YiX6KiI566X55So44Kt44Oj44OD44K344Ol5YCkXG4gICAgICovXG4gICAgdGhpcy5fY2FjaGVkUm90YXRpb247XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAdHlwZSB7bnVtYmVyfSDooYzliJfoqIjnrpfnlKjjgq3jg6Pjg4Pjgrfjg6XlgKRcbiAgICAgKi9cbiAgICB0aGlzLl9zcjtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtudW1iZXJ9IOihjOWIl+ioiOeul+eUqOOCreODo+ODg+OCt+ODpeWApFxuICAgICAqL1xuICAgIHRoaXMuX2NyO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICog44Kk44Oz44K/44Op44Kv44K344On44Oz5Y+v6IO944GL44Gp44GG44GLXG4gICAgICovXG4gICAgdGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHt7IFtpZDogbnVtYmVyXTogYm9vbGVhbiB9fVxuICAgICAqIEludGVyYWN0aXZl44Kv44Op44K544Gn44Gu44OV44Op44Kw5Yem55CG55SoXG4gICAgICovXG4gICAgdGhpcy5fb3ZlckZsYWdzID0ge307XG4gICAgLyoqXG4gICAgICogQHR5cGUge3sgW2lkOiBudW1iZXJdOiBib29sZWFuIH19XG4gICAgICogSW50ZXJhY3RpdmXjgq/jg6njgrnjgafjga7jg5Xjg6njgrDlh6bnkIbnlKhcbiAgICAgKi9cbiAgICB0aGlzLl90b3VjaEZsYWdzID0ge307XG5cbiAgICAvKipcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLl93aWR0aDtcbiAgICAvKipcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLl9oZWlnaHQ7XG4gICAgLyoqXG4gICAgICog5Y2K5b6EOiBib3VuZGluZ1R5cGXjgYxjaXJjbGXjga7loLTlkIjjga7jgb/kvb/nlKhcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5fcmFkaXVzO1xuICAgIC8qKlxuICAgICAqIOebtOW+hDogYm91bmRpbmdUeXBl44GMY2lyY2xl44Gu6Zqb44Grd2lkdGgvaGVpZ2h05YCk44Go44GX44Gm5L2/55SoICBcbiAgICAgKiByYWRpdXPjgqLjgq/jgrvjgrVzZXTjga7pmpvjgavmm7TmlrBcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5fZGlhbWV0ZXI7XG5cbiAgICB0aGlzLndpZHRoID0gb3B0aW9ucy53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IG9wdGlvbnMuaGVpZ2h0O1xuICAgIHRoaXMucmFkaXVzID0gb3B0aW9ucy5yYWRpdXM7XG4gICAgLyoqXG4gICAgICog5b2T44Gf44KK5Yik5a6a56+E5Zuy44Gu56iu5YilXG4gICAgICogQHR5cGUge09iamVjdDJEQm91bmRpbmdUeXBlfVxuICAgICAqL1xuICAgIHRoaXMuYm91bmRpbmdUeXBlID0gb3B0aW9ucy5ib3VuZGluZ1R5cGU7XG5cbiAgICAvKiogQHR5cGUge09iamVjdDJEfFBoaW5hRWxlbWVudH0gKi9cbiAgICB0aGlzLnBhcmVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiDngrnjgajooZ3nqoHjgZfjgabjgYTjgovjgYvjgpLliKTlrppcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHhcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICovXG4gIGhpdFRlc3QoeCwgeSkge1xuICAgIGlmICh0aGlzLmJvdW5kaW5nVHlwZSA9PT0gJ3JlY3QnKSB7XG4gICAgICByZXR1cm4gdGhpcy5oaXRUZXN0UmVjdCh4LCB5KTtcbiAgICB9XG4gICAgZWxzZSBpZiAodGhpcy5ib3VuZGluZ1R5cGUgPT09ICdjaXJjbGUnKSB7XG4gICAgICByZXR1cm4gdGhpcy5oaXRUZXN0Q2lyY2xlKHgsIHkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIC8vIG5vbmUg44Gu5aC05ZCIXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6Ieq6Lqr44KS55+p5b2i44Go44GX44Gm44CB54K544Go6KGd56qB44GX44Gm44GE44KL44GL44KS5Yik5a6aXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgaGl0VGVzdFJlY3QoeCwgeSkge1xuICAgIHZhciBwID0gdGhpcy5nbG9iYWxUb0xvY2FsKG5ldyBWZWN0b3IyKHgsIHkpKTtcblxuICAgIHZhciBsZWZ0ICAgPSAtdGhpcy53aWR0aCp0aGlzLm9yaWdpblg7XG4gICAgdmFyIHJpZ2h0ICA9ICt0aGlzLndpZHRoKigxLXRoaXMub3JpZ2luWCk7XG4gICAgdmFyIHRvcCAgICA9IC10aGlzLmhlaWdodCp0aGlzLm9yaWdpblk7XG4gICAgdmFyIGJvdHRvbSA9ICt0aGlzLmhlaWdodCooMS10aGlzLm9yaWdpblkpO1xuXG4gICAgcmV0dXJuICggbGVmdCA8IHAueCAmJiBwLnggPCByaWdodCApICYmICggdG9wICA8IHAueSAmJiBwLnkgPCBib3R0b20gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDoh6rouqvjgpLlhoblvaLjgajjgZfjgabjgIHngrnjgajooZ3nqoHjgZfjgabjgYTjgovjgYvjgpLliKTlrppcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBoaXRUZXN0Q2lyY2xlKHgsIHkpIHtcbiAgICAvLyDlhobliKTlrppcbiAgICB2YXIgcCA9IHRoaXMuZ2xvYmFsVG9Mb2NhbChuZXcgVmVjdG9yMih4LCB5KSk7XG4gICAgaWYgKCgocC54KSoocC54KSsocC55KSoocC55KSkgPCAodGhpcy5yYWRpdXMqdGhpcy5yYWRpdXMpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICog6KaB57Sg44Go6KGd56qB44GX44Gm44GE44KL44GL44KS5Yik5a6aXG4gICAqIEBwYXJhbSB7T2JqZWN0MkR9IGVsbVxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGhpdFRlc3RFbGVtZW50KGVsbSkge1xuICAgIHZhciByZWN0MCA9IHRoaXM7XG4gICAgdmFyIHJlY3QxID0gZWxtO1xuICAgIHJldHVybiAocmVjdDAubGVmdCA8IHJlY3QxLnJpZ2h0KSAmJiAocmVjdDAucmlnaHQgPiByZWN0MS5sZWZ0KSAmJlxuICAgICAgICAgICAocmVjdDAudG9wIDwgcmVjdDEuYm90dG9tKSAmJiAocmVjdDAuYm90dG9tID4gcmVjdDEudG9wKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuKHjgZXjgozjgZ/luqfmqJnjgpLjg63jg7zjgqvjg6vluqfmqJnjgavlpInmj5vjgZfjgabov5TjgZlcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuLi9nZW9tL3ZlY3RvcjJcIikuUHJpbWl0aXZlVmVjdG9yMn0gcCDlgKTjga/lpInmm7TjgZfjgb7jgZvjgpNcbiAgICogQHJldHVybnMge1ZlY3RvcjJ9IOaWsOimj+S9nOaIkOOBleOCjOOBn+ODreODvOOCq+ODq+W6p+aomeOCquODluOCuOOCp+OCr+ODiFxuICAgKi9cbiAgZ2xvYmFsVG9Mb2NhbChwKSB7XG4gICAgdmFyIG1hdHJpeCA9IHRoaXMuX3dvcmxkTWF0cml4LmNsb25lKCk7XG4gICAgbWF0cml4LmludmVydCgpO1xuICAgIC8vIG1hdHJpeC50cmFuc3Bvc2UoKTtcblxuICAgIHZhciB0ZW1wID0gbWF0cml4Lm11bHRpcGx5VmVjdG9yMihwKTtcblxuICAgIHJldHVybiB0ZW1wO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCpOODs+OCv+ODqeOCr+OCt+ODp+ODs+WPr+iDveOBi+OBqeOBhuOBi+OCkuWkieabtCAgXG4gICAqIOWQjOaZguOBq2JvdW5kaW5nVHlwZeOCguWkieabtOWPr+iDvVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGZsYWdcbiAgICogQHBhcmFtIHtPYmplY3QyREJvdW5kaW5nVHlwZX0gW3R5cGVdXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0SW50ZXJhY3RpdmUoZmxhZywgdHlwZSkge1xuICAgIHRoaXMuaW50ZXJhY3RpdmUgPSBmbGFnO1xuICAgIGlmICh0eXBlKSB7XG4gICAgICB0aGlzLmJvdW5kaW5nVHlwZSA9IHR5cGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogWCDluqfmqJnlgKTjgpLjgrvjg4Pjg4hcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHhcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRYKHgpIHtcbiAgICB0aGlzLnBvc2l0aW9uLnggPSB4O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICogWSDluqfmqJnlgKTjgpLjgrvjg4Pjg4hcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRZKHkpIHtcbiAgICB0aGlzLnBvc2l0aW9uLnkgPSB5O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICogWFkg5bqn5qiZ44KS44K744OD44OIXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0UG9zaXRpb24oeCwgeSkge1xuICAgIHRoaXMucG9zaXRpb24ueCA9IHg7XG4gICAgdGhpcy5wb3NpdGlvbi55ID0geTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDlm57ou6LjgpLjgrvjg4Pjg4hcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdGF0aW9uXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0Um90YXRpb24ocm90YXRpb24pIHtcbiAgICB0aGlzLnJvdGF0aW9uID0gcm90YXRpb247XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44K544Kx44O844Or44KS44K744OD44OIXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbeV0g55yB55Wl44GX44Gf5aC05ZCI44CBeOODkeODqeODoeODvOOCv+WApOOBjOmBqeeUqOOBleOCjOOBvuOBmVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldFNjYWxlKHgsIHkpIHtcbiAgICB0aGlzLnNjYWxlLnggPSB4O1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgdGhpcy5zY2FsZS55ID0geDtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNjYWxlLnkgPSB5O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgLyoqXG4gICAqIOWfuua6lueCueOCkuOCu+ODg+ODiFxuICAgKiBAcGFyYW0ge051bWJlcn0geFxuICAgKiBAcGFyYW0ge051bWJlcn0geVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldE9yaWdpbih4LCB5KSB7XG4gICAgdGhpcy5vcmlnaW4ueCA9IHg7XG4gICAgdGhpcy5vcmlnaW4ueSA9IHk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDluYXjgpLjgrvjg4Pjg4hcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHdpZHRoXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0V2lkdGgod2lkdGgpIHtcbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDpq5jjgZXjgpLjgrvjg4Pjg4hcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGhlaWdodFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldEhlaWdodChoZWlnaHQpIHtcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgLyoqXG4gICAqIOOCteOCpOOCuijluYUsIOmrmOOBlSnjgpLjgrvjg4Pjg4hcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHdpZHRoXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBoZWlnaHRcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRTaXplKHdpZHRoLCBoZWlnaHQpIHtcbiAgICB0aGlzLndpZHRoICA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7T2JqZWN0MkRCb3VuZGluZ1R5cGV9IHR5cGVcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRCb3VuZGluZ1R5cGUodHlwZSkge1xuICAgIHRoaXMuYm91bmRpbmdUeXBlID0gdHlwZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIG1vdmVUbyh4LCB5KSB7XG4gICAgdGhpcy5wb3NpdGlvbi54ID0geDtcbiAgICB0aGlzLnBvc2l0aW9uLnkgPSB5O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgbW92ZUJ5KHgsIHkpIHtcbiAgICB0aGlzLnBvc2l0aW9uLnggKz0geDtcbiAgICB0aGlzLnBvc2l0aW9uLnkgKz0geTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjgrDjg63jg7zjg5Djg6vooYzliJfjgpLoqIjnrpdcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBfY2FsY1dvcmxkTWF0cml4KCkge1xuICAgIGlmICghdGhpcy5wYXJlbnQpIHJldHVybiA7XG5cbiAgICAvLyBjYWNoZSBjaGVja1xuICAgIGlmICh0aGlzLnJvdGF0aW9uICE9IHRoaXMuX2NhY2hlZFJvdGF0aW9uKSB7XG4gICAgICB0aGlzLl9jYWNoZWRSb3RhdGlvbiA9IHRoaXMucm90YXRpb247XG5cbiAgICAgIHZhciByID0gdGhpcy5yb3RhdGlvbiooTWF0aC5QSS8xODApO1xuICAgICAgdGhpcy5fc3IgPSBNYXRoLnNpbihyKTtcbiAgICAgIHRoaXMuX2NyID0gTWF0aC5jb3Mocik7XG4gICAgfVxuXG4gICAgdmFyIGxvY2FsID0gdGhpcy5fbWF0cml4O1xuICAgIHZhciBwYXJlbnQgPSAvKiogQHR5cGUge09iamVjdDJEfSAqLyh0aGlzLnBhcmVudCkuX3dvcmxkTWF0cml4IHx8IE1hdHJpeDMzLklERU5USVRZO1xuICAgIHZhciB3b3JsZCA9IHRoaXMuX3dvcmxkTWF0cml4O1xuXG4gICAgLy8g44Ot44O844Kr44Or44Gu6KGM5YiX44KS6KiI566XXG4gICAgbG9jYWwubTAwID0gdGhpcy5fY3IgKiB0aGlzLnNjYWxlLng7XG4gICAgbG9jYWwubTAxID0tdGhpcy5fc3IgKiB0aGlzLnNjYWxlLnk7XG4gICAgbG9jYWwubTEwID0gdGhpcy5fc3IgKiB0aGlzLnNjYWxlLng7XG4gICAgbG9jYWwubTExID0gdGhpcy5fY3IgKiB0aGlzLnNjYWxlLnk7XG4gICAgbG9jYWwubTAyID0gdGhpcy5wb3NpdGlvbi54O1xuICAgIGxvY2FsLm0xMiA9IHRoaXMucG9zaXRpb24ueTtcblxuICAgIC8vIGNhY2hlXG4gICAgdmFyIGEwMCA9IGxvY2FsLm0wMDsgdmFyIGEwMSA9IGxvY2FsLm0wMTsgdmFyIGEwMiA9IGxvY2FsLm0wMjtcbiAgICB2YXIgYTEwID0gbG9jYWwubTEwOyB2YXIgYTExID0gbG9jYWwubTExOyB2YXIgYTEyID0gbG9jYWwubTEyO1xuICAgIHZhciBiMDAgPSBwYXJlbnQubTAwOyB2YXIgYjAxID0gcGFyZW50Lm0wMTsgdmFyIGIwMiA9IHBhcmVudC5tMDI7XG4gICAgdmFyIGIxMCA9IHBhcmVudC5tMTA7IHZhciBiMTEgPSBwYXJlbnQubTExOyB2YXIgYjEyID0gcGFyZW50Lm0xMjtcblxuICAgIC8vIOimquOBruihjOWIl+OBqOaOm+OBkeWQiOOCj+OBm+OCi1xuICAgIHdvcmxkLm0wMCA9IGIwMCAqIGEwMCArIGIwMSAqIGExMDtcbiAgICB3b3JsZC5tMDEgPSBiMDAgKiBhMDEgKyBiMDEgKiBhMTE7XG4gICAgd29ybGQubTAyID0gYjAwICogYTAyICsgYjAxICogYTEyICsgYjAyO1xuXG4gICAgd29ybGQubTEwID0gYjEwICogYTAwICsgYjExICogYTEwO1xuICAgIHdvcmxkLm0xMSA9IGIxMCAqIGEwMSArIGIxMSAqIGExMTtcbiAgICB3b3JsZC5tMTIgPSBiMTAgKiBhMDIgKyBiMTEgKiBhMTIgKyBiMTI7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgeFxuICAgKiB45bqn5qiZ5YCkXG4gICAqL1xuICBnZXQgeCgpICAgeyByZXR1cm4gdGhpcy5wb3NpdGlvbi54OyB9XG4gIHNldCB4KHYpICB7IHRoaXMucG9zaXRpb24ueCA9IHY7IH1cblxuICAvKipcbiAgICogQHByb3BlcnR5ICAgIHlcbiAgICogeeW6p+aomeWApFxuICAgKi9cbiAgZ2V0IHkoKSAgIHsgcmV0dXJuIHRoaXMucG9zaXRpb24ueTsgfVxuICBzZXQgeSh2KSAgeyB0aGlzLnBvc2l0aW9uLnkgPSB2OyB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSAgICBvcmlnaW5YXG4gICAqIHjluqfmqJnlgKRcbiAgICovXG4gIGdldCBvcmlnaW5YKCkgICB7IHJldHVybiB0aGlzLm9yaWdpbi54OyB9XG4gIHNldCBvcmlnaW5YKHYpICB7IHRoaXMub3JpZ2luLnggPSB2OyB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSAgICBvcmlnaW5ZXG4gICAqIHnluqfmqJnlgKRcbiAgICovXG4gIGdldCBvcmlnaW5ZKCkgICB7IHJldHVybiB0aGlzLm9yaWdpbi55OyB9XG4gIHNldCBvcmlnaW5ZKHYpICB7IHRoaXMub3JpZ2luLnkgPSB2OyB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSAgICBzY2FsZVhcbiAgICog44K544Kx44O844OrWOWApFxuICAgKi9cbiAgZ2V0IHNjYWxlWCgpICAgeyByZXR1cm4gdGhpcy5zY2FsZS54OyB9XG4gIHNldCBzY2FsZVgodikgIHsgdGhpcy5zY2FsZS54ID0gdjsgfVxuICBcbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSAgICBzY2FsZVlcbiAgICog44K544Kx44O844OrWeWApFxuICAgKi9cbiAgZ2V0IHNjYWxlWSgpICAgeyByZXR1cm4gdGhpcy5zY2FsZS55OyB9XG4gIHNldCBzY2FsZVkodikgIHsgdGhpcy5zY2FsZS55ID0gdjsgfVxuICBcbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSAgICB3aWR0aFxuICAgKiB3aWR0aFxuICAgKi9cbiAgZ2V0IHdpZHRoKCkgICB7XG4gICAgcmV0dXJuICh0aGlzLmJvdW5kaW5nVHlwZSA9PT0gJ3JlY3QnKSA/XG4gICAgICB0aGlzLl93aWR0aCA6IHRoaXMuX2RpYW1ldGVyO1xuICB9XG4gIHNldCB3aWR0aCh2KSAgeyB0aGlzLl93aWR0aCA9IHY7IH1cblxuICAvKipcbiAgICogQHByb3BlcnR5ICAgIGhlaWdodFxuICAgKiBoZWlnaHRcbiAgICovXG4gIGdldCBoZWlnaHQoKSAgIHtcbiAgICByZXR1cm4gKHRoaXMuYm91bmRpbmdUeXBlID09PSAncmVjdCcpID9cbiAgICAgIHRoaXMuX2hlaWdodCA6IHRoaXMuX2RpYW1ldGVyO1xuICB9XG4gIHNldCBoZWlnaHQodikgIHsgdGhpcy5faGVpZ2h0ID0gdjsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgcmFkaXVzXG4gICAqIOWNiuW+hFxuICAgKi9cbiAgZ2V0IHJhZGl1cygpICAge1xuICAgIHJldHVybiAodGhpcy5ib3VuZGluZ1R5cGUgPT09ICdyZWN0JykgP1xuICAgICAgKHRoaXMud2lkdGgrdGhpcy5oZWlnaHQpLzQgOiB0aGlzLl9yYWRpdXM7XG4gIH1cbiAgc2V0IHJhZGl1cyh2KSAge1xuICAgIHRoaXMuX3JhZGl1cyA9IHY7XG4gICAgdGhpcy5fZGlhbWV0ZXIgPSB2KjI7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgdG9wXG4gICAqIOW3plxuICAgKi9cbiAgZ2V0IHRvcCgpICAgeyByZXR1cm4gdGhpcy55IC0gdGhpcy5oZWlnaHQqdGhpcy5vcmlnaW5ZOyB9XG4gIHNldCB0b3AodikgIHsgdGhpcy55ID0gdiArIHRoaXMuaGVpZ2h0KnRoaXMub3JpZ2luWTsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgcmlnaHRcbiAgICog5bemXG4gICAqL1xuICBnZXQgcmlnaHQoKSAgIHsgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGgqKDEtdGhpcy5vcmlnaW5YKTsgfVxuICBzZXQgcmlnaHQodikgIHsgdGhpcy54ID0gdiAtIHRoaXMud2lkdGgqKDEtdGhpcy5vcmlnaW5YKTsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgYm90dG9tXG4gICAqIOW3plxuICAgKi9cbiAgZ2V0IGJvdHRvbSgpICAgeyByZXR1cm4gdGhpcy55ICsgdGhpcy5oZWlnaHQqKDEtdGhpcy5vcmlnaW5ZKTsgfVxuICBzZXQgYm90dG9tKHYpICB7IHRoaXMueSA9IHYgLSB0aGlzLmhlaWdodCooMS10aGlzLm9yaWdpblkpOyB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSAgICBsZWZ0XG4gICAqIOW3plxuICAgKi9cbiAgZ2V0IGxlZnQoKSAgIHsgcmV0dXJuIHRoaXMueCAtIHRoaXMud2lkdGgqdGhpcy5vcmlnaW5YOyB9XG4gIHNldCBsZWZ0KHYpICB7IHRoaXMueCA9IHYgKyB0aGlzLndpZHRoKnRoaXMub3JpZ2luWDsgfVxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkgICAgY2VudGVyWFxuICAgKiBjZW50ZXJYXG4gICAqL1xuICBnZXQgY2VudGVyWCgpICAgeyByZXR1cm4gdGhpcy54ICsgdGhpcy53aWR0aC8yIC0gdGhpcy53aWR0aCp0aGlzLm9yaWdpblg7IH1cbiAgLy8gc2V0IGNlbnRlclgodikgIHtcbiAgLy8gICAvLyBUT0RPOiDjganjgYbjgZfjgojjgYbjgYvjgao/P1xuICAvLyB9XG5cbiAgLyoqXG4gICAqIEBwcm9wZXJ0eSAgICBjZW50ZXJZXG4gICAqIGNlbnRlcllcbiAgICovXG4gIGdldCBjZW50ZXJZKCkgICB7IHJldHVybiB0aGlzLnkgKyB0aGlzLmhlaWdodC8yIC0gdGhpcy5oZWlnaHQqdGhpcy5vcmlnaW5ZOyB9XG4gIC8vIHNldCBjZW50ZXJZKHYpICB7XG4gIC8vICAgLy8gVE9ETzog44Gp44GG44GX44KI44GG44GL44GqPz9cbiAgLy8gfVxufVxuXG4vKipcbiAqIEB0eXBlIHtPYmplY3QyRE9wdGlvbnN9XG4gKiBAc3RhdGljXG4gKi9cbk9iamVjdDJELmRlZmF1bHRzID0ge1xuICB4OiAwLFxuICB5OiAwLFxuICBzY2FsZVg6IDEsXG4gIHNjYWxlWTogMSxcbiAgcm90YXRpb246IDAsXG4gIG9yaWdpblg6IDAuNSxcbiAgb3JpZ2luWTogMC41LFxuICB3aWR0aDogNjQsXG4gIGhlaWdodDogNjQsXG4gIHJhZGl1czogMzIsXG4gIGJvdW5kaW5nVHlwZTogJ3JlY3QnLFxufTtcblxuLyoqXG4gKiBwaGluYeeLrOiHquOBrlBvaW50ZXLlnotcbiAqIEB0eXBlZGVmIHtNb3VzZSB8IFBoaW5hVG91Y2h9IFBvaW50ZXJcbiAqL1xuXG4vKipcbiAqIERvbUFwcOWIneacn+WMluOCquODl+OCt+ODp+ODsyAgXG4gKiBkb21FbGVtZW5044KC44GX44GP44GvcXVlcnnjgYTjgZrjgozjgYvjga/lv4XjgZrmjIflrprjgZnjgovjgZPjgahcbiAqIEB0eXBlZGVmIHt7XG4gKiAgZG9tRWxlbWVudD86IEhUTUxDYW52YXNFbGVtZW50O1xuICogIHF1ZXJ5Pzogc3RyaW5nOyBcbiAqICBmcHM/OiBudW1iZXI7IFxuICogIHJ1bm5lcj86IChydW46IFRpbWVySGFuZGxlciwgZGVsYXk6IG51bWJlcikgPT4gdm9pZDtcbiAqIH19IERvbUFwcE9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5kaXNwbGF5LkRvbUFwcFxuICogX2V4dGVuZHMgcGhpbmEuYXBwLkJhc2VBcHBcbiAqL1xuY2xhc3MgRG9tQXBwIGV4dGVuZHMgQmFzZUFwcCB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge0RvbUFwcE9wdGlvbnN9IG9wdGlvbnNcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgLyoqIEB0eXBlIEhUTUxDYW52YXNFbGVtZW50ICovXG4gICAgdGhpcy5kb21FbGVtZW50O1xuXG4gICAgaWYgKG9wdGlvbnMuZG9tRWxlbWVudCkge1xuICAgICAgdGhpcy5kb21FbGVtZW50ID0gb3B0aW9ucy5kb21FbGVtZW50O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGlmIChvcHRpb25zLnF1ZXJ5KSB7XG4gICAgICAgIHRoaXMuZG9tRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9ucy5xdWVyeSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgY29uc29sZS5hc3NlcnQoJ2Vycm9yJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMuZnBzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuZnBzID0gb3B0aW9ucy5mcHM7XG4gICAgfVxuICAgIFxuICAgIGlmKHR5cGVvZiBvcHRpb25zLnJ1bm5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhpcy50aWNrZXIucnVubmVyID0gb3B0aW9ucy5ydW5uZXI7XG4gICAgfVxuXG4gICAgdGhpcy5tb3VzZSA9IG5ldyBNb3VzZSh0aGlzLmRvbUVsZW1lbnQpO1xuICAgIHRoaXMudG91Y2ggPSBuZXcgVG91Y2gkMSh0aGlzLmRvbUVsZW1lbnQpO1xuICAgIHRoaXMudG91Y2hMaXN0ID0gbmV3IFRvdWNoTGlzdCh0aGlzLmRvbUVsZW1lbnQpO1xuICAgIHRoaXMua2V5Ym9hcmQgPSBuZXcgS2V5Ym9hcmQoZG9jdW1lbnQpO1xuICAgIC8vIC8vIOWKoOmAn+W6puOCu+ODs+OCteODvOOCkueUn+aIkFxuICAgIC8vIHRoaXMuYWNjZWxlcm9tZXRlciA9IHBoaW5hLmlucHV0LkFjY2VsZXJvbWV0ZXIoKTtcblxuICAgIC8vIOODneOCpOODs+OCv+OCkuOCu+ODg+ODiChQQyDjgafjga8gTW91c2UsIE1vYmlsZSDjgafjga8gVG91Y2gpXG4gICAgLyoqIEB0eXBlIHtQb2ludGVyfSAqL1xuICAgIHRoaXMucG9pbnRlciA9IHRoaXMudG91Y2g7XG4gICAgLyoqIEB0eXBlIHtQb2ludGVyW119ICovXG4gICAgdGhpcy5wb2ludGVycyA9IHRoaXMudG91Y2hMaXN0LnRvdWNoZXM7XG4gICAgdGhpcy5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIFxuICAgIC8qKiBAdGhpcyBEb21BcHAgKi9cbiAgICBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnBvaW50ZXIgPSB0aGlzLnRvdWNoO1xuICAgICAgdGhpcy5wb2ludGVycyA9IHRoaXMudG91Y2hMaXN0LnRvdWNoZXM7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBcbiAgICAvKiogQHRoaXMgRG9tQXBwICovXG4gICAgZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5wb2ludGVyID0gdGhpcy5tb3VzZTtcbiAgICAgIHRoaXMucG9pbnRlcnMgPSBbdGhpcy5tb3VzZV07XG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIC8vIGtleWJvYXJkIGV2ZW50XG4gICAgdGhpcy5rZXlib2FyZC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHRoaXMuY3VycmVudFNjZW5lICYmIHRoaXMuY3VycmVudFNjZW5lLmZsYXJlKCdrZXlkb3duJywge1xuICAgICAgICBrZXlDb2RlOiBlLmtleUNvZGUsXG4gICAgICB9KTtcbiAgICB9LmJpbmQodGhpcykpO1xuICAgIHRoaXMua2V5Ym9hcmQub24oJ2tleXVwJywgZnVuY3Rpb24oZSkge1xuICAgICAgdGhpcy5jdXJyZW50U2NlbmUgJiYgdGhpcy5jdXJyZW50U2NlbmUuZmxhcmUoJ2tleXVwJywge1xuICAgICAgICBrZXlDb2RlOiBlLmtleUNvZGUsXG4gICAgICB9KTtcbiAgICB9LmJpbmQodGhpcykpO1xuICAgIHRoaXMua2V5Ym9hcmQub24oJ2tleXByZXNzJywgZnVuY3Rpb24oZSkge1xuICAgICAgdGhpcy5jdXJyZW50U2NlbmUgJiYgdGhpcy5jdXJyZW50U2NlbmUuZmxhcmUoJ2tleXByZXNzJywge1xuICAgICAgICBrZXlDb2RlOiBlLmtleUNvZGUsXG4gICAgICB9KTtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgLy8gY2xpY2sg5a++5b+cXG4gICAgdmFyIGV2ZW50TmFtZSA9IHBoaW5hLmlzTW9iaWxlKCkgPyAndG91Y2hlbmQnIDogJ21vdXNldXAnO1xuICAgIHRoaXMuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgdGhpcy5fY2hlY2tDbGljay5iaW5kKHRoaXMpKTtcblxuICAgIC8vIOaxuuWumuaZguOBruWHpueQhuOCkuOCquODleOBq+OBmeOCiyhpUGhvbmUg5pmC44Gu44Gh44KJ44Gk44GN5a++562WKVxuICAgIHRoaXMuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbihlKSB7IHN0b3AuY2FsbChlKTsgfSk7XG4gICAgdGhpcy5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oZSkgeyBzdG9wLmNhbGwoZSk7IH0pO1xuXG4gICAgLy8g44Km44Kj44Oz44OJ44Km44OV44Kp44O844Kr44K55pmC44Kk44OZ44Oz44OI44Oq44K544OK44KS55m76YyyXG4gICAgcGhpbmEuZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmZsYXJlKCdmb2N1cycpO1xuICAgICAgdGhpcy5jdXJyZW50U2NlbmUuZmxhcmUoJ2ZvY3VzJyk7XG4gICAgfS5iaW5kKHRoaXMpLCBmYWxzZSk7XG4gICAgLy8g44Km44Kj44Oz44OJ44Km44OW44Op44O85pmC44Kk44OZ44Oz44OI44Oq44K544OK44KS55m76YyyXG4gICAgcGhpbmEuZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuZmxhcmUoJ2JsdXInKTtcbiAgICAgIHRoaXMuY3VycmVudFNjZW5lLmZsYXJlKCdibHVyJyk7XG4gICAgfS5iaW5kKHRoaXMpLCBmYWxzZSk7XG5cbiAgICAvLyDmm7TmlrDplqLmlbDjgpLnmbvpjLJcbiAgICB0aGlzLm9uKCdlbnRlcmZyYW1lJywgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLm1vdXNlLnVwZGF0ZSgpO1xuICAgICAgdGhpcy50b3VjaC51cGRhdGUoKTtcbiAgICAgIHRoaXMudG91Y2hMaXN0LnVwZGF0ZSgpO1xuICAgICAgdGhpcy5rZXlib2FyZC51cGRhdGUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiB0b3VjaGVuZC9tb3VzZXVw44Gn44Gu55aR5Ly8Y2xpY2vjgqTjg5njg7Pjg4jlh6bnkIZcbiAgICogQHBhcmFtIHsqfSBfZSBcbiAgICovXG4gIF9jaGVja0NsaWNrKF9lKSB7XG4gICAgLyoqIEBwYXJhbSB7aW1wb3J0KCcuLi9hcHAvZWxlbWVudCcpLkVsZW1lbnR9IGVsZW1lbnQgKi9cbiAgICB2YXIgX2NoZWNrID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgaWYgKGVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgICBlbGVtZW50LmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgICBfY2hlY2soY2hpbGQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChlbGVtZW50Ll9jbGlja2VkICYmIGVsZW1lbnQuaGFzKCdjbGljaycpKSB7XG4gICAgICAgIGVsZW1lbnQuZmxhcmUoJ2NsaWNrJyk7XG4gICAgICB9XG4gICAgICBlbGVtZW50Ll9jbGlja2VkID0gZmFsc2U7XG4gICAgfTtcblxuICAgIF9jaGVjayh0aGlzLmN1cnJlbnRTY2VuZSk7XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHtpbXBvcnQoXCIuLi9hcHAvZWxlbWVudFwiKS5FbGVtZW50ICYge1xuICogICBiYWNrZ3JvdW5kQ29sb3I/OiBpbXBvcnQoXCIuLi9ncmFwaGljcy9jYW52YXNcIikuQ2FudmFzU3R5bGVcbiAqIH19IFJlbmRlcmFibGVTY2VuZVxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge2ltcG9ydChcIi4vZGlzcGxheWVsZW1lbnRcIikuRGlzcGxheUVsZW1lbnQgJiB7XG4gKiAgIGNsaXA/OiAoY2FudmFzOiBpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhcyk9PiBhbnksXG4gKiAgIGRyYXc/OiAoY2FudmFzOiBpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhcyk9PiBhbnlcbiAqIH19IFJlbmRlcmFibGVFbGVtZW50XG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZGlzcGxheS5DYW52YXNSZW5kZXJlclxuICovXG5jbGFzcyBDYW52YXNSZW5kZXJlciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhc1xuICAgKi9cbiAgY29uc3RydWN0b3IoY2FudmFzKSB7XG4gICAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG4gICAgdGhpcy5fY29udGV4dCA9IHRoaXMuY2FudmFzLmNvbnRleHQ7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtSZW5kZXJhYmxlU2NlbmV9IHNjZW5lXG4gICAqL1xuICByZW5kZXIoc2NlbmUpIHtcbiAgICB0aGlzLmNhbnZhcy5jbGVhcigpO1xuICAgIGlmIChzY2VuZS5iYWNrZ3JvdW5kQ29sb3IpIHtcbiAgICAgIHRoaXMuY2FudmFzLmNsZWFyQ29sb3Ioc2NlbmUuYmFja2dyb3VuZENvbG9yKTtcbiAgICB9XG5cbiAgICB0aGlzLl9jb250ZXh0LnNhdmUoKTtcbiAgICB0aGlzLnJlbmRlckNoaWxkcmVuKHNjZW5lKTtcbiAgICB0aGlzLl9jb250ZXh0LnJlc3RvcmUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2ltcG9ydChcIi4uL2FwcC9lbGVtZW50XCIpLkVsZW1lbnRCYXNlZE9iamVjdH0gb2JqXG4gICAqL1xuICByZW5kZXJDaGlsZHJlbihvYmopIHtcbiAgICAvLyDlrZDkvpvjgZ/jgaHjgoLlrp/ooYxcbiAgICBpZiAob2JqLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgIHZhciB0ZW1wQ2hpbGRyZW4gPSAvKiogQHR5cGUge1JlbmRlcmFibGVFbGVtZW50W119Ki8ob2JqLmNoaWxkcmVuLnNsaWNlKCkpO1xuICAgICAgZm9yICh2YXIgaT0wLGxlbj10ZW1wQ2hpbGRyZW4ubGVuZ3RoOyBpPGxlbjsgKytpKSB7XG4gICAgICAgIHRoaXMucmVuZGVyT2JqZWN0KHRlbXBDaGlsZHJlbltpXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7UmVuZGVyYWJsZUVsZW1lbnR9IG9ialxuICAgKi9cbiAgcmVuZGVyT2JqZWN0KG9iaikge1xuICAgIGlmIChvYmoudmlzaWJsZSA9PT0gZmFsc2UgJiYgIW9iai5pbnRlcmFjdGl2ZSkgcmV0dXJuO1xuXG4gICAgb2JqLl9jYWxjV29ybGRNYXRyaXggJiYgb2JqLl9jYWxjV29ybGRNYXRyaXgoKTtcblxuICAgIGlmIChvYmoudmlzaWJsZSA9PT0gZmFsc2UpIHJldHVybjtcblxuICAgIG9iai5fY2FsY1dvcmxkQWxwaGEgJiYgb2JqLl9jYWxjV29ybGRBbHBoYSgpO1xuXG4gICAgdmFyIGNvbnRleHQgPSB0aGlzLmNhbnZhcy5jb250ZXh0O1xuXG4gICAgY29udGV4dC5nbG9iYWxBbHBoYSA9IG9iai5fd29ybGRBbHBoYTtcbiAgICBjb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IG9iai5ibGVuZE1vZGU7XG5cbiAgICBpZiAob2JqLl93b3JsZE1hdHJpeCkge1xuICAgICAgLy8g6KGM5YiX44KS44K744OD44OIXG4gICAgICB2YXIgbSA9IG9iai5fd29ybGRNYXRyaXg7XG4gICAgICBjb250ZXh0LnNldFRyYW5zZm9ybSggbS5tMDAsIG0ubTEwLCBtLm0wMSwgbS5tMTEsIG0ubTAyLCBtLm0xMiApO1xuICAgIH1cblxuICAgIGlmIChvYmouY2xpcCkge1xuXG4gICAgICBjb250ZXh0LnNhdmUoKTtcblxuICAgICAgb2JqLmNsaXAodGhpcy5jYW52YXMpO1xuICAgICAgY29udGV4dC5jbGlwKCk7XG5cbiAgICAgIGlmIChvYmouZHJhdykgb2JqLmRyYXcodGhpcy5jYW52YXMpO1xuXG4gICAgICAvLyDlrZDkvpvjgZ/jgaHjgoLlrp/ooYxcbiAgICAgIGlmIChvYmoucmVuZGVyQ2hpbGRCeVNlbGYgPT09IGZhbHNlICYmIG9iai5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIHRlbXBDaGlsZHJlbiA9IG9iai5jaGlsZHJlbi5zbGljZSgpO1xuICAgICAgICAgIGZvciAodmFyIGk9MCxsZW49dGVtcENoaWxkcmVuLmxlbmd0aDsgaTxsZW47ICsraSkge1xuICAgICAgICAgICAgICB0aGlzLnJlbmRlck9iamVjdCh0ZW1wQ2hpbGRyZW5baV0pO1xuICAgICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgaWYgKG9iai5kcmF3KSBvYmouZHJhdyh0aGlzLmNhbnZhcyk7XG5cbiAgICAgIC8vIOWtkOS+m+OBn+OBoeOCguWun+ihjFxuICAgICAgaWYgKG9iai5yZW5kZXJDaGlsZEJ5U2VsZiA9PT0gZmFsc2UgJiYgb2JqLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmFyIHRlbXBDaGlsZHJlbiA9IG9iai5jaGlsZHJlbi5zbGljZSgpO1xuICAgICAgICBmb3IgKHZhciBpPTAsbGVuPXRlbXBDaGlsZHJlbi5sZW5ndGg7IGk8bGVuOyArK2kpIHtcbiAgICAgICAgICB0aGlzLnJlbmRlck9iamVjdCh0ZW1wQ2hpbGRyZW5baV0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHdpZHRoPzogbnVtYmVyLFxuICogICBoZWlnaHQ/OiBudW1iZXIsXG4gKiAgIGltYWdlU21vb3RoaW5nPzogYm9vbGVhbixcbiAqICAgYmFja2dyb3VuZENvbG9yPzogaW1wb3J0KFwiLi4vZ3JhcGhpY3MvY2FudmFzXCIpLkNhbnZhc1N0eWxlLFxuICogfX0gRGlzcGxheVNjZW5lT3B0aW9uc1xuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmRpc3BsYXkuRGlzcGxheVNjZW5lXG4gKiBfZXh0ZW5kcyBwaGluYS5hcHAuU2NlbmVcbiAqL1xuY2xhc3MgRGlzcGxheVNjZW5lIGV4dGVuZHMgU2NlbmUge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0Rpc3BsYXlTY2VuZU9wdGlvbnN9IFtwYXJhbXNdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgcGFyYW1zID0gJHNhZmUuY2FsbCh7fSwgcGFyYW1zLCBEaXNwbGF5U2NlbmUuZGVmYXVsdHMpO1xuICAgIC8vIHBhcmFtcyA9ICh7fSkuJHNhZmUocGFyYW1zLCBEaXNwbGF5U2NlbmUuZGVmYXVsdHMpO1xuXG4gICAgdGhpcy5jYW52YXMgPSBuZXcgQ2FudmFzKCk7XG4gICAgdGhpcy5jYW52YXMuc2V0U2l6ZShwYXJhbXMud2lkdGgsIHBhcmFtcy5oZWlnaHQpO1xuICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgQ2FudmFzUmVuZGVyZXIodGhpcy5jYW52YXMpO1xuICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gKHBhcmFtcy5iYWNrZ3JvdW5kQ29sb3IpID8gcGFyYW1zLmJhY2tncm91bmRDb2xvciA6IG51bGw7XG5cbiAgICB0aGlzLndpZHRoID0gcGFyYW1zLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gcGFyYW1zLmhlaWdodDtcbiAgICB0aGlzLmdyaWRYID0gbmV3IEdyaWQocGFyYW1zLndpZHRoLCAxNik7XG4gICAgdGhpcy5ncmlkWSA9IG5ldyBHcmlkKHBhcmFtcy5oZWlnaHQsIDE2KTtcblxuICAgIC8vIFRPRE86IOS4gOaXpuOCgOOCiuOChOOCiuWvvuW/nFxuICAgIHRoaXMuaW50ZXJhY3RpdmUgPSB0cnVlO1xuICAgIC8vIHRoaXMuc2V0SW50ZXJhY3RpdmUgPSBmdW5jdGlvbihmbGFnKSB7XG4gICAgLy8gICB0aGlzLmludGVyYWN0aXZlID0gZmxhZztcbiAgICAvLyB9O1xuICAgIHRoaXMuX292ZXJGbGFncyA9IHt9O1xuICAgIHRoaXMuX3RvdWNoRmxhZ3MgPSB7fTtcblxuICAgIHZhciBjdHggPSB0aGlzLmNhbnZhcy5jb250ZXh0O1xuICAgIGlmIChwYXJhbXMuaW1hZ2VTbW9vdGhpbmcgPT09IGZhbHNlKSB7XG4gICAgICBjdHguaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7XG4gICAgICBjdHhbJ3dlYmtpdEltYWdlU21vb3RoaW5nRW5hYmxlZCddID0gZmFsc2U7XG4gICAgICBjdHhbJ21zSW1hZ2VTbW9vdGhpbmdFbmFibGVkJ10gPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtib29sZWFufSBmbGFnXG4gICAqL1xuICBzZXRJbnRlcmFjdGl2ZShmbGFnKSB7XG4gICAgdGhpcy5pbnRlcmFjdGl2ZSA9IGZsYWc7XG4gIH1cblxuICBoaXRUZXN0KCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEB2aXJ0dWFsXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vZGlzcGxheS9jYW52YXNhcHBcIikuQ2FudmFzQXBwfSBbX2FwcF0g44Ki44OX44Oq44Kx44O844K344On44Oz5pys5L2T44Gu5Y+C54WnXG4gICAqL1xuICB1cGRhdGUoX2FwcCkge31cblxuICAvKipcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfdXBkYXRlKCkge1xuICAgIGlmICh0aGlzLnVwZGF0ZSkge1xuICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfcmVuZGVyKCkge1xuICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMpO1xuICB9XG5cbn1cblxuLyoqIEB0eXBlIERpc3BsYXlTY2VuZU9wdGlvbnMgKi9cbkRpc3BsYXlTY2VuZS5kZWZhdWx0cyA9IHtcbiAgd2lkdGg6IDY0MCxcbiAgaGVpZ2h0OiA5NjAsXG4gIGltYWdlU21vb3RoaW5nOiB0cnVlLFxufTtcblxuLyoqXG4gKiBDYW52YXNBcHDliJ3mnJ/ljJbjgqrjg5fjgrfjg6fjg7MgIFxuICogRGlzcGxheVNjZW5l44Gu5Yid5pyf5YyW44Gr5L2/44KP44KM44KL44GT44Go44KC6ICD44GI44CB44Gd44Gu44Kq44OX44K344On44Oz44OR44Op44Oh44O844K/44KC57aZ5om/XG4gKiBAdHlwZWRlZiB7eyBcbiAqICBhcHBlbmQ/OiBib29sZWFuXG4gKiAgY29sdW1ucz86IG51bWJlclxuICogIGJhY2tncm91bmRDb2xvcj86IGltcG9ydChcIi4uL2dyYXBoaWNzL2NhbnZhc1wiKS5DYW52YXNTdHlsZVxuICogIGZpdD86IGJvb2xlYW5cbiAqICBwaXhlbGF0ZWQ/OiBib29sZWFuXG4gKiB9IFxuICogJiBpbXBvcnQoXCIuL2RvbWFwcFwiKS5Eb21BcHBPcHRpb25zXG4gKiAmIGltcG9ydChcIi4vZGlzcGxheXNjZW5lXCIpLkRpc3BsYXlTY2VuZU9wdGlvbnMgfSBDYW52YXNBcHBPcHRpb25zXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZGlzcGxheS5DYW52YXNBcHBcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuRG9tQXBwXG4gKi9cbmNsYXNzIENhbnZhc0FwcCBleHRlbmRzIERvbUFwcCB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge0NhbnZhc0FwcE9wdGlvbnN9IG9wdGlvbnNcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbCgob3B0aW9ucyB8fCB7fSksIENhbnZhc0FwcC5kZWZhdWx0cyk7XG4gICAgLy8gb3B0aW9ucyA9IChvcHRpb25zIHx8IHt9KS4kc2FmZShDYW52YXNBcHAuZGVmYXVsdHMpO1xuICAgIFxuICAgIGlmICghb3B0aW9ucy5xdWVyeSAmJiAhb3B0aW9ucy5kb21FbGVtZW50KSB7XG4gICAgICBvcHRpb25zLmRvbUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgIGlmIChvcHRpb25zLmFwcGVuZCkge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG9wdGlvbnMuZG9tRWxlbWVudCk7XG4gICAgICB9XG4gICAgfVxuICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgdGhpcy5ncmlkWCA9IG5ldyBHcmlkKHtcbiAgICAgIHdpZHRoOiBvcHRpb25zLndpZHRoLFxuICAgICAgY29sdW1uczogb3B0aW9ucy5jb2x1bW5zLFxuICAgIH0pO1xuICAgIHRoaXMuZ3JpZFkgPSBuZXcgR3JpZCh7XG4gICAgICB3aWR0aDogb3B0aW9ucy5oZWlnaHQsXG4gICAgICBjb2x1bW5zOiBvcHRpb25zLmNvbHVtbnMsXG4gICAgfSk7XG5cbiAgICB0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXModGhpcy5kb21FbGVtZW50KTtcbiAgICB0aGlzLmNhbnZhcy5zZXRTaXplKG9wdGlvbnMud2lkdGgsIG9wdGlvbnMuaGVpZ2h0KTtcblxuICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gKG9wdGlvbnMuYmFja2dyb3VuZENvbG9yICE9PSB1bmRlZmluZWQpID8gb3B0aW9ucy5iYWNrZ3JvdW5kQ29sb3IgOiAnd2hpdGUnO1xuXG4gICAgdGhpcy5yZXBsYWNlU2NlbmUobmV3IERpc3BsYXlTY2VuZSh7XG4gICAgICB3aWR0aDogb3B0aW9ucy53aWR0aCxcbiAgICAgIGhlaWdodDogb3B0aW9ucy5oZWlnaHQsXG4gICAgfSkpO1xuXG4gICAgaWYgKG9wdGlvbnMuZml0KSB7XG4gICAgICB0aGlzLmZpdFNjcmVlbigpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zLnBpeGVsYXRlZCkge1xuICAgICAgLy8g44OB44Op44Gk44GN6Ziy5q2iXG4gICAgICAvLyDjg4njg4Pjg4jntbXjgrLjg7zjg6Djga7jgrXjg53jg7zjg4hcbiAgICAgIC8vIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3MtaW1hZ2VzLyN0aGUtaW1hZ2UtcmVuZGVyaW5nXG4gICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvaW1hZ2UtcmVuZGVyaW5nI0Jyb3dzZXJfY29tcGF0aWJpbGl0eVxuICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0ZpcmVmb3hcXC9cXGQrLykpIHtcbiAgICAgICAgdGhpcy5kb21FbGVtZW50LnN0eWxlLmltYWdlUmVuZGVyaW5nID0gJ2NyaXNwLWVkZ2VzJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZG9tRWxlbWVudC5zdHlsZS5pbWFnZVJlbmRlcmluZyA9ICdwaXhlbGF0ZWQnO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHB1c2hTY2VuZSwgcG9wU2NlbmUg5a++562WXG4gICAgdGhpcy5vbigncHVzaCcsIGZ1bmN0aW9uKCkge1xuICAgICAgLy8gb25lbnRlciDlr77nrZbjgafmj4/nlLvjgZfjgabjgYrjgY9cbiAgICAgIGlmICh0aGlzLmN1cnJlbnRTY2VuZS5jYW52YXMpIHtcbiAgICAgICAgdGhpcy5fZHJhdygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKiDmj4/nlLvlh6bnkIZcbiAgICovXG4gIF9kcmF3KCkge1xuICAgIGlmICh0aGlzLmJhY2tncm91bmRDb2xvcikge1xuICAgICAgdGhpcy5jYW52YXMuY2xlYXJDb2xvcih0aGlzLmJhY2tncm91bmRDb2xvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2FudmFzLmNsZWFyKCk7XG4gICAgfVxuXG4gICAgdmFyIGN1cnJlbnRTY2VuZSA9IC8qKiBAdHlwZSB7RGlzcGxheVNjZW5lfSAqLyh0aGlzLmN1cnJlbnRTY2VuZSk7XG4gICAgaWYgKGN1cnJlbnRTY2VuZS5jYW52YXMpIHtcbiAgICAgIGN1cnJlbnRTY2VuZS5fcmVuZGVyKCk7XG5cbiAgICAgIC8vIHRoaXMuX3NjZW5lcy5lYWNoKFxuICAgICAgdGhpcy5fc2NlbmVzLmZvckVhY2goXG4gICAgICAvKiogQHBhcmFtIHtEaXNwbGF5U2NlbmV9IHNjZW5lICovXG4gICAgICBmdW5jdGlvbihzY2VuZSkge1xuICAgICAgICB2YXIgYyA9IHNjZW5lLmNhbnZhcztcbiAgICAgICAgaWYgKGMpIHtcbiAgICAgICAgICB0aGlzLmNhbnZhcy5jb250ZXh0LmRyYXdJbWFnZShjLmRvbUVsZW1lbnQsIDAsIDAsIGMud2lkdGgsIGMuaGVpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbnZhc+OCr+ODqeOCueOBrmZpdFNjcmVlbuOCkuWun+ihjFxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIGZpdFNjcmVlbigpIHtcbiAgICB0aGlzLmNhbnZhcy5maXRTY3JlZW4oKTtcbiAgfVxuXG59XG5cbi8qKlxuICogQHN0YXRpY1xuICogQHR5cGUge0NhbnZhc0FwcE9wdGlvbnN9XG4gKi9cbkNhbnZhc0FwcC5kZWZhdWx0cyA9IHtcbiAgd2lkdGg6IDY0MCxcbiAgaGVpZ2h0OiA5NjAsXG4gIGNvbHVtbnM6IDEyLFxuICBmaXQ6IHRydWUsXG4gIGFwcGVuZDogdHJ1ZSxcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgYWxwaGE/OiBudW1iZXIsXG4gKiAgIHZpc2libGU/OiBib29sZWFuLFxuICogfSAmIGltcG9ydChcIi4uL2FwcC9vYmplY3QyZFwiKS5PYmplY3QyRE9wdGlvbnN9IERpc3BsYXlFbGVtZW50T3B0aW9uc1xuICovXG5cbi8qKlxuICogZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DYW52YXNSZW5kZXJpbmdDb250ZXh0MkQvZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uKSDjga50eXBl44Go5ZCM44GYXG4gKiBAdHlwZWRlZiB7ICdzb3VyY2Utb3ZlcicgfCAnc291cmNlLWluJyB8ICdzb3VyY2Utb3V0JyB8ICdzb3VyY2UtYXRvcCcgfCAnZGVzdGluYXRpb24tb3ZlcicgfCAnZGVzdGluYXRpb24taW4nIHwgJ2Rlc3RpbmF0aW9uLW91dCcgfCAnZGVzdGluYXRpb24tYXRvcCcgfCAnbGlnaHRlcicgfCAnY29weScgfCAneG9yJyB8ICdtdWx0aXBseScgfCAnc2NyZWVuJyB8ICdvdmVybGF5JyB8ICdkYXJrZW4nIHwgJ2xpZ2h0ZW4nIHwgJ2NvbG9yLWRvZGdlJyB8ICdjb2xvci1idXJuJyB8ICdoYXJkLWxpZ2h0JyB8ICdzb2Z0LWxpZ2h0JyB8ICdkaWZmZXJlbmNlJyB8ICdleGNsdXNpb24nIHwgJ2h1ZScgfCAnc2F0dXJhdGlvbicgfCAnY29sb3InIHwgJ2x1bWlub3NpdHknfSBCbGVuZE1vZGVcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5kaXNwbGF5LkRpc3BsYXlFbGVtZW50XG4gKiBfZXh0ZW5kcyBwaGluYS5hcHAuT2JqZWN0MkRcbiAqL1xuY2xhc3MgRGlzcGxheUVsZW1lbnQgZXh0ZW5kcyBPYmplY3QyRCB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7RGlzcGxheUVsZW1lbnRPcHRpb25zfSBbb3B0aW9uc10gXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwoe30sIG9wdGlvbnN8fHt9LCBEaXNwbGF5RWxlbWVudC5kZWZhdWx0cyk7XG4gICAgLy8gb3B0aW9ucyA9ICh7fSkuJHNhZmUob3B0aW9ucyB8fCB7fSwgcGhpbmEuZGlzcGxheS5EaXNwbGF5RWxlbWVudC5kZWZhdWx0cyk7XG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICAvKipcbiAgICAgKiDooajnpLrjg5Xjg6njgrBcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB0aGlzLnZpc2libGUgPSAob3B0aW9ucy52aXNpYmxlICE9IG51bGwpID8gb3B0aW9ucy52aXNpYmxlIDogdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIOOCouODq+ODleOCoeWApFxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5hbHBoYSA9IChvcHRpb25zLmFscGhhICE9IG51bGwpID8gb3B0aW9ucy5hbHBoYSA6IDEuMDtcblxuICAgIC8qKlxuICAgICAqIOODluODrOODs+ODieODouODvOODiVxuICAgICAqIEB0eXBlIHtCbGVuZE1vZGV9XG4gICAgICovXG4gICAgdGhpcy5ibGVuZE1vZGUgPSBcInNvdXJjZS1vdmVyXCI7XG5cbiAgICAvKipcbiAgICAgKiDlrZDkvpvjgpIg6Ieq5YiG44GuQ2FudmFzUmVuZGVyZXIg44Gn5o+P55S744GZ44KL44GLXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdGhpcy5yZW5kZXJDaGlsZEJ5U2VsZiA9IGZhbHNlO1xuXG4gICAgLyoqIEB0eXBlIHtEaXNwbGF5RWxlbWVudH0g5Z6L44Ki44K144O844K344On44OzICovXG4gICAgdGhpcy5wYXJlbnQ7XG5cbiAgICAvKipcbiAgICAgKiDjgrDjg63jg7zjg5Djg6vjgqLjg6vjg5XjgqHlhoXpg6jlgKRcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMuX3dvcmxkQWxwaGEgPSAxLjA7XG4gIH1cblxuICAvKipcbiAgICog44Ki44Or44OV44Kh5YCk44KS44K744OD44OIXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBhbHBoYVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldEFscGhhKGFscGhhKSB7XG4gICAgdGhpcy5hbHBoYSA9IGFscGhhO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOihqOekui/pnZ7ooajnpLrjgpLjgrvjg4Pjg4hcbiAgICogQHBhcmFtIHtib29sZWFufSBmbGFnXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0VmlzaWJsZShmbGFnKSB7XG4gICAgdGhpcy52aXNpYmxlID0gZmxhZztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDooajnpLpcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzaG93KCkge1xuICAgIHRoaXMudmlzaWJsZSA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog6Z2e6KGo56S6XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgaGlkZSgpIHtcbiAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjgrDjg63jg7zjg5Djg6vjgqLjg6vjg5XjgqHlgKTjga7lho3oqIjnrpdcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfY2FsY1dvcmxkQWxwaGEoKSB7XG4gICAgaWYgKHRoaXMuYWxwaGEgPCAwKSB7XG4gICAgICB0aGlzLl93b3JsZEFscGhhID0gMDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCF0aGlzLnBhcmVudCkge1xuICAgICAgdGhpcy5fd29ybGRBbHBoYSA9IHRoaXMuYWxwaGE7XG4gICAgICByZXR1cm4gO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHZhciB3b3JsZEFscGhhID0gKHRoaXMucGFyZW50Ll93b3JsZEFscGhhICE9PSB1bmRlZmluZWQpID8gdGhpcy5wYXJlbnQuX3dvcmxkQWxwaGEgOiAxLjA7XG4gICAgICAvLyBhbHBoYVxuICAgICAgdGhpcy5fd29ybGRBbHBoYSA9IHdvcmxkQWxwaGEgKiB0aGlzLmFscGhhO1xuICAgIH1cbiAgfVxuXG59XG5cbi8qKlxuICogQHR5cGUge0Rpc3BsYXlFbGVtZW50T3B0aW9uc31cbiAqL1xuRGlzcGxheUVsZW1lbnQuZGVmYXVsdHMgPSB7XG4gIGFscGhhOiAxLjAsXG4gIHZpc2libGU6IHRydWUsXG59O1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5hc3NldC5Bc3NldE1hbmFnZXJcbiAqIFxuICovXG5jbGFzcyBBc3NldE1hbmFnZXIge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBcInNvdW5kXCLjgIFcImltYWdlXCLjgarjganjga7jgqLjgrvjg4Pjg4jnqK7poZ5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGtleSDjgqLjgrvjg4Pjg4jjga7jgq3jg7xcbiAgICovXG4gIHN0YXRpYyBnZXQodHlwZSwga2V5KSB7XG4gICAgcmV0dXJuIHRoaXMuYXNzZXRzW3R5cGVdICYmIHRoaXMuYXNzZXRzW3R5cGVdW2tleV07XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXJ9IHR5cGUgXCJzb3VuZFwi44CBXCJpbWFnZVwi44Gq44Gp44Gu44Ki44K744OD44OI56iu6aGeXG4gICAqIEBwYXJhbSB7c3RyaW5nIHwgbnVtYmVyfSBrZXkg44Ki44K744OD44OI55m76Yyy44Kt44O8XG4gICAqIEBwYXJhbSB7YW55fSBhc3NldCBBc3NldOOCquODluOCuOOCp+OCr+ODiFxuICAgKi9cbiAgc3RhdGljIHNldCh0eXBlLCBrZXksIGFzc2V0KSB7XG4gICAgaWYgKCF0aGlzLmFzc2V0c1t0eXBlXSkge1xuICAgICAgdGhpcy5hc3NldHNbdHlwZV0gPSB7fTtcbiAgICB9XG4gICAgdGhpcy5hc3NldHNbdHlwZV1ba2V5XSA9IGFzc2V0O1xuICB9XG5cbiAgLyoqXG4gICAqIOacquWun+ijhVxuICAgKiBAcGFyYW0geyp9IHR5cGUgXG4gICAqIEBwYXJhbSB7Kn0ga2V5IFxuICAgKi9cbiAgc3RhdGljIGNvbnRhaW5zKHR5cGUsIGtleSkge1xuICAgIHJldHVybiA7XG4gIH1cblxufVxuXG5Bc3NldE1hbmFnZXIuYXNzZXRzID0ge1xuICBpbWFnZToge30sXG4gIHNvdW5kOiB7fSxcbiAgc3ByaXRlc2hlZXQ6IHt9LFxufTtcblxuLyoqXG4gKiBTcHJpdGXnlLvlg4/jgr3jg7zjgrnjgajjgZfjgabkvb/jgYjjgovjgqrjg5bjgrjjgqfjgq/jg4jlnotcbiAqIFRleHR1cmXjgq/jg6njgrnjgoRDYW52YXPjgq/jg6njgrnjgarjgalcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGRvbUVsZW1lbnQ6IEhUTUxDYW52YXNFbGVtZW50IHwgSFRNTEltYWdlRWxlbWVudDtcbiAqICAgW2tleTogc3RyaW5nXTogYW55O1xuICogfX0gU3ByaXRlSW1hZ2VcbiAqL1xuXG4vKipcbiAqIEFzc2V0TWFuYWdlcuOBq+eZu+mMsuOBl+OBn+eUu+WDj+OCreODvOOAgeOCguOBl+OBj+OBr1Nwcml0ZUltYWdl44Kq44OW44K444Kn44Kv44OIXG4gKiBAdHlwZWRlZiB7c3RyaW5nIHwgU3ByaXRlSW1hZ2V9IFNwcml0ZUltYWdlU3JjXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZGlzcGxheS5TcHJpdGVcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuRGlzcGxheUVsZW1lbnRcbiAqL1xuY2xhc3MgU3ByaXRlIGV4dGVuZHMgRGlzcGxheUVsZW1lbnQge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge1Nwcml0ZUltYWdlU3JjfSBpbWFnZVxuICAgKiBAcGFyYW0ge251bWJlcn0gW3dpZHRoXVxuICAgKiBAcGFyYW0ge251bWJlcn0gW2hlaWdodF1cbiAgICovXG4gIGNvbnN0cnVjdG9yKGltYWdlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8qKlxuICAgICAqIOOCueODl+ODqeOCpOODiOWFg+eUu+WDj++8iOODhuOCr+OCueODgeODo++8ieOAgnNldEltYWdl44Gn5Yid5pyf5YyWXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAdHlwZSB7U3ByaXRlSW1hZ2V9XG4gICAgICovXG4gICAgdGhpcy5faW1hZ2U7XG5cbiAgICAvKipcbiAgICAgKiDjg5Xjg6zjg7zjg6DjgqTjg7Pjg4fjg4Pjgq/jgrnjgIJzZXRJbWFnZeOBp+WIneacn+WMllxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLl9mcmFtZUluZGV4O1xuXG4gICAgLyoqXG4gICAgICog55S75YOP5o+P55S756+E5ZuyXG4gICAgICogQHR5cGUge1JlY3R9XG4gICAgICovXG4gICAgdGhpcy5zcmNSZWN0ID0gbmV3IFJlY3QoKTtcblxuICAgIHRoaXMuc2V0SW1hZ2UoaW1hZ2UsIHdpZHRoLCBoZWlnaHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7aW1wb3J0KFwiLi4vZ3JhcGhpY3MvY2FudmFzXCIpLkNhbnZhc30gY2FudmFzIFxuICAgKi9cbiAgZHJhdyhjYW52YXMpIHtcbiAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlLmRvbUVsZW1lbnQ7XG5cbiAgICAvLyBjYW52YXMuY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsXG4gICAgLy8gICAwLCAwLCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0LFxuICAgIC8vICAgLXRoaXMud2lkdGgqdGhpcy5vcmlnaW4ueCwgLXRoaXMuaGVpZ2h0KnRoaXMub3JpZ2luLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0XG4gICAgLy8gICApO1xuXG4gICAgdmFyIHNyY1JlY3QgPSB0aGlzLnNyY1JlY3Q7XG4gICAgY2FudmFzLmNvbnRleHQuZHJhd0ltYWdlKGltYWdlLFxuICAgICAgc3JjUmVjdC54LCBzcmNSZWN0LnksIHNyY1JlY3Qud2lkdGgsIHNyY1JlY3QuaGVpZ2h0LFxuICAgICAgLXRoaXMuX3dpZHRoKnRoaXMub3JpZ2luWCwgLXRoaXMuX2hlaWdodCp0aGlzLm9yaWdpblksIHRoaXMuX3dpZHRoLCB0aGlzLl9oZWlnaHRcbiAgICAgICk7XG4gIH1cblxuICAvKipcbiAgICog44K544OX44Op44Kk44OI5YWD55S75YOP44KS6Kit5a6aXG4gICAqIEBwYXJhbSB7U3ByaXRlSW1hZ2VTcmN9IGltYWdlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbd2lkdGhdXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbaGVpZ2h0XVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldEltYWdlKGltYWdlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgaWYgKHR5cGVvZiBpbWFnZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGltYWdlID0gQXNzZXRNYW5hZ2VyLmdldCgnaW1hZ2UnLCBpbWFnZSk7XG4gICAgfVxuICAgIHRoaXMuX2ltYWdlID0gLyoqQHR5cGUge1Nwcml0ZUltYWdlfSAqLyAoaW1hZ2UpO1xuICAgIHRoaXMud2lkdGggPSB0aGlzLl9pbWFnZS5kb21FbGVtZW50LndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5faW1hZ2UuZG9tRWxlbWVudC5oZWlnaHQ7XG5cbiAgICBpZiAod2lkdGgpIHsgdGhpcy53aWR0aCA9IHdpZHRoOyB9XG4gICAgaWYgKGhlaWdodCkgeyB0aGlzLmhlaWdodCA9IGhlaWdodDsgfVxuXG4gICAgdGhpcy5mcmFtZUluZGV4ID0gMDtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOODleODrOODvOODoOOCpOODs+ODh+ODg+OCr+OCueOCkuaMh+WumuOBl+OAgeOBneOBruODleODrOODvOODoOOBq+WQiOOCj+OBm+OBpuaPj+eUu+evhOWbsuOCkuabtOaWsCAgXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCDjg5Xjg6zjg7zjg6DjgqTjg7Pjg4fjg4Pjgq/jgrnjgILmnIDlpKflgKTjgpLotoXjgYjjgZ/loLTlkIjjga/jg6vjg7zjg5dcbiAgICogQHBhcmFtIHtudW1iZXJ9IFt3aWR0aF0g44OV44Os44O844Og44K144Kk44K65bmFXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbaGVpZ2h0XSDjg5Xjg6zjg7zjg6DjgrXjgqTjgrrpq5jjgZVcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRGcmFtZUluZGV4KGluZGV4LCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgdmFyIHR3ICA9IHdpZHRoIHx8IHRoaXMuX3dpZHRoOyAgICAgIC8vIHR3XG4gICAgdmFyIHRoICA9IGhlaWdodCB8fCB0aGlzLl9oZWlnaHQ7ICAgIC8vIHRoXG4gICAgdmFyIHJvdyA9IH5+KHRoaXMuaW1hZ2UuZG9tRWxlbWVudC53aWR0aCAvIHR3KTtcbiAgICB2YXIgY29sID0gfn4odGhpcy5pbWFnZS5kb21FbGVtZW50LmhlaWdodCAvIHRoKTtcbiAgICB2YXIgbWF4SW5kZXggPSByb3cqY29sO1xuICAgIGluZGV4ID0gaW5kZXglbWF4SW5kZXg7XG4gICAgXG4gICAgdmFyIHggPSBpbmRleCVyb3c7XG4gICAgdmFyIHkgPSB+fihpbmRleC9yb3cpO1xuICAgIHRoaXMuc3JjUmVjdC54ID0geCp0dztcbiAgICB0aGlzLnNyY1JlY3QueSA9IHkqdGg7XG4gICAgdGhpcy5zcmNSZWN0LndpZHRoICA9IHR3O1xuICAgIHRoaXMuc3JjUmVjdC5oZWlnaHQgPSB0aDtcblxuICAgIHRoaXMuX2ZyYW1lSW5kZXggPSBpbmRleDtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZ2V0IGltYWdlKCkge3JldHVybiB0aGlzLl9pbWFnZTt9XG4gIHNldCBpbWFnZSh2KSB7XG4gICAgdGhpcy5zZXRJbWFnZSh2KTtcbiAgfVxuXG4gIGdldCBmcmFtZUluZGV4KCkge3JldHVybiB0aGlzLl9mcmFtZUluZGV4O31cbiAgc2V0IGZyYW1lSW5kZXgoaWR4KSB7XG4gICAgdGhpcy5zZXRGcmFtZUluZGV4KGlkeCk7XG4gIH1cbn1cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZGlzcGxheS5QbGFpbkVsZW1lbnRcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuRGlzcGxheUVsZW1lbnRcbiAqL1xuY2xhc3MgUGxhaW5FbGVtZW50IGV4dGVuZHMgRGlzcGxheUVsZW1lbnQge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0Rpc3BsYXlFbGVtZW50LmRlZmF1bHRzfSBvcHRpb25zIFxuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIHRoaXMuY2FudmFzID0gbmV3IENhbnZhcygpO1xuICAgIHRoaXMuY2FudmFzLnNldFNpemUodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7Q2FudmFzfSBjYW52YXNcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBkcmF3KGNhbnZhcykge1xuICAgIHZhciBpbWFnZSA9IHRoaXMuY2FudmFzLmRvbUVsZW1lbnQ7XG4gICAgdmFyIHcgPSBpbWFnZS53aWR0aDtcbiAgICB2YXIgaCA9IGltYWdlLmhlaWdodDtcblxuICAgIHZhciB4ID0gLXcqdGhpcy5vcmlnaW4ueDtcbiAgICB2YXIgeSA9IC1oKnRoaXMub3JpZ2luLnk7XG5cbiAgICBjYW52YXMuY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsXG4gICAgICAwLCAwLCB3LCBoLFxuICAgICAgeCwgeSwgdywgaFxuICAgICAgKTtcbiAgfVxufVxuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5kaXNwbGF5LkxheWVyXG4gKiBfZXh0ZW5kcyBwaGluYS5kaXNwbGF5LkRpc3BsYXlFbGVtZW50XG4gKi9cbmNsYXNzIExheWVyIGV4dGVuZHMgRGlzcGxheUVsZW1lbnQge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0Rpc3BsYXlFbGVtZW50LmRlZmF1bHRzfSBbb3B0aW9uc10gXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwoe30sIG9wdGlvbnN8fHt9LCB7XG4gICAgLy8gb3B0aW9ucyA9ICh7fSkuJHNhZmUob3B0aW9ucywge1xuICAgICAgd2lkdGg6IDY0MCxcbiAgICAgIGhlaWdodDogOTYwLFxuICAgIH0pO1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIHRoaXMud2lkdGggPSBvcHRpb25zLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQ7XG4gICAgdGhpcy5ncmlkWCA9IG5ldyBHcmlkKG9wdGlvbnMud2lkdGgsIDE2KTtcbiAgICB0aGlzLmdyaWRZID0gbmV3IEdyaWQob3B0aW9ucy5oZWlnaHQsIDE2KTtcbiAgICB0aGlzLnJlbmRlckNoaWxkQnlTZWxmID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIEhUTUxDYW52YXNFbGVtZW50IFxuICAgICAqL1xuICAgIHRoaXMuZG9tRWxlbWVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0NhbnZhc30gY2FudmFzXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgZHJhdyhjYW52YXMpIHtcbiAgICBpZiAoIXRoaXMuZG9tRWxlbWVudCkgcmV0dXJuIDtcblxuICAgIHZhciBpbWFnZSA9IHRoaXMuZG9tRWxlbWVudDtcbiAgICBjYW52YXMuY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsXG4gICAgICAwLCAwLCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0LFxuICAgICAgLXRoaXMud2lkdGgqdGhpcy5vcmlnaW5YLCAtdGhpcy5oZWlnaHQqdGhpcy5vcmlnaW5ZLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodFxuICAgICAgKTtcbiAgfVxufVxuXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmRpc3BsYXkuQ2FudmFzTGF5ZXJcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuTGF5ZXJcbiAqL1xuY2xhc3MgQ2FudmFzTGF5ZXIgZXh0ZW5kcyBMYXllciB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7RGlzcGxheUVsZW1lbnQuZGVmYXVsdHN9IG9wdGlvbnMgXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgdGhpcy5jYW52YXMgPSBuZXcgQ2FudmFzKCk7XG4gICAgdGhpcy5jYW52YXMud2lkdGggID0gdGhpcy53aWR0aDtcbiAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLmhlaWdodDtcblxuICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgQ2FudmFzUmVuZGVyZXIodGhpcy5jYW52YXMpO1xuICAgIHRoaXMuZG9tRWxlbWVudCA9IHRoaXMuY2FudmFzLmRvbUVsZW1lbnQ7XG5cbiAgICB0aGlzLm9uKCdlbnRlcmZyYW1lJyxcbiAgICAvKiogQHRoaXMgQ2FudmFzTGF5ZXIgKi9cbiAgICBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB0ZW1wID0gdGhpcy5fd29ybGRNYXRyaXg7XG4gICAgICB0aGlzLl93b3JsZE1hdHJpeCA9IG51bGw7XG4gICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzKTtcbiAgICAgIHRoaXMuX3dvcmxkTWF0cml4ID0gdGVtcDtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0NhbnZhc30gY2FudmFzXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgZHJhdyhjYW52YXMpIHtcbiAgICB2YXIgaW1hZ2UgPSB0aGlzLmRvbUVsZW1lbnQ7XG4gICAgY2FudmFzLmNvbnRleHQuZHJhd0ltYWdlKGltYWdlLFxuICAgICAgMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCxcbiAgICAgIC10aGlzLndpZHRoKnRoaXMub3JpZ2luWCwgLXRoaXMuaGVpZ2h0KnRoaXMub3JpZ2luWSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHRcbiAgICAgICk7XG4gIH1cbn1cblxudmFyIFRIUkVFID0gcGhpbmEuZ2xvYmFsWydUSFJFRSddO1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5kaXNwbGF5LlRocmVlTGF5ZXJcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuTGF5ZXJcbiAqL1xuY2xhc3MgVGhyZWVMYXllciBleHRlbmRzIExheWVyIHtcblxuICAvLyBzY2VuZTogbnVsbCxcbiAgLy8gY2FtZXJhOiBudWxsLFxuICAvLyBsaWdodDogbnVsbCxcbiAgLy8gcmVuZGVyZXI6IG51bGwsXG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgdGhpcy5zY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xuXG4gICAgdGhpcy5jYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoIDc1LCBvcHRpb25zLndpZHRoIC8gb3B0aW9ucy5oZWlnaHQsIDEsIDEwMDAwICk7XG4gICAgdGhpcy5jYW1lcmEucG9zaXRpb24ueiA9IDEwMDA7XG5cbiAgICB0aGlzLmxpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoIDB4ZmZmZmZmLCAxICk7XG4gICAgdGhpcy5saWdodC5wb3NpdGlvbi5zZXQoIDEsIDEsIDEgKS5ub3JtYWxpemUoKTtcbiAgICB0aGlzLnNjZW5lLmFkZCggdGhpcy5saWdodCApO1xuXG4gICAgdGhpcy5yZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKCk7XG4gICAgdGhpcy5yZW5kZXJlci5zZXRDbGVhckNvbG9yKCAweGYwZjBmMCApO1xuICAgIHRoaXMucmVuZGVyZXIuc2V0U2l6ZSggb3B0aW9ucy53aWR0aCwgb3B0aW9ucy5oZWlnaHQgKTtcblxuICAgIHRoaXMub24oJ2VudGVyZnJhbWUnLFxuICAgIC8qKiBAdGhpcyBUaHJlZUxheWVyICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlciggdGhpcy5zY2VuZSwgdGhpcy5jYW1lcmEgKTtcbiAgICB9KTtcblxuICAgIHRoaXMuZG9tRWxlbWVudCA9IHRoaXMucmVuZGVyZXIuZG9tRWxlbWVudDtcbiAgfVxufVxuXG4vKipcbiAqIFNoYXBl44Kv44Op44K544Kq44OX44K344On44OzXG4gKiBAdHlwZWRlZiB7e1xuICogICBwYWRkaW5nPzogbnVtYmVyLFxuICogICBiYWNrZ3JvdW5kQ29sb3I/OiBpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhc1N0eWxlLFxuICogICBmaWxsPzogaW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXNTdHlsZSB8IGZhbHNlLFxuICogICBzdHJva2U/OiBpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhc1N0eWxlIHwgZmFsc2UsXG4gKiAgIHN0cm9rZVdpZHRoPzogbnVtYmVyLFxuICogICBsaW5lQ2FwPzogQ2FudmFzTGluZUNhcCxcbiAqICAgbGluZUpvaW4/OiBDYW52YXNMaW5lSm9pbixcbiAqICAgc2hhZG93Pzogc3RyaW5nIHwgZmFsc2UsXG4gKiAgIHNoYWRvd0JsdXI/OiBudW1iZXIsXG4gKiB9ICYgaW1wb3J0KCcuLi9kaXNwbGF5L2Rpc3BsYXllbGVtZW50JykuRGlzcGxheUVsZW1lbnRPcHRpb25zIH0gU2hhcGVPcHRpb25zXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZGlzcGxheS5TaGFwZVxuICogX2V4dGVuZHMgcGhpbmEuZGlzcGxheS5QbGFpbkVsZW1lbnRcbiAqL1xuY2xhc3MgU2hhcGUgZXh0ZW5kcyBQbGFpbkVsZW1lbnQge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge1NoYXBlT3B0aW9uc30gW29wdGlvbnNdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgLy8gb3B0aW9ucyA9ICh7fSkuJHNhZmUob3B0aW9ucyB8fCB7fSwgcGhpbmEuZGlzcGxheS5TaGFwZS5kZWZhdWx0cyk7XG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwoe30sIG9wdGlvbnN8fHt9LCBTaGFwZS5kZWZhdWx0cyk7XG5cbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIHRoaXMucGFkZGluZyA9IG9wdGlvbnMucGFkZGluZztcblxuICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gb3B0aW9ucy5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgdGhpcy5maWxsID0gb3B0aW9ucy5maWxsO1xuICAgIHRoaXMuc3Ryb2tlID0gb3B0aW9ucy5zdHJva2U7XG4gICAgdGhpcy5zdHJva2VXaWR0aCA9IG9wdGlvbnMuc3Ryb2tlV2lkdGg7XG4gICAgdGhpcy5saW5lQ2FwID0gb3B0aW9ucy5saW5lQ2FwO1xuICAgIHRoaXMubGluZUpvaW4gPSBvcHRpb25zLmxpbmVKb2luO1xuXG4gICAgdGhpcy5zaGFkb3cgPSBvcHRpb25zLnNoYWRvdztcbiAgICB0aGlzLnNoYWRvd0JsdXIgPSBvcHRpb25zLnNoYWRvd0JsdXI7XG5cbiAgICB0aGlzLndhdGNoRHJhdyA9IHRydWU7XG4gICAgdGhpcy5fZGlydHlEcmF3ID0gdHJ1ZTtcblxuICAgIC8qKiBAdGhpcyBTaGFwZSAqL1xuICAgIHZhciBjaGVja1JlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gcmVuZGVyXG4gICAgICBpZiAodGhpcy53YXRjaERyYXcgJiYgdGhpcy5fZGlydHlEcmF3ID09PSB0cnVlKSB7XG4gICAgICAgIHRoaXMucmVuZGVyKHRoaXMuY2FudmFzKTtcbiAgICAgICAgdGhpcy5fZGlydHlEcmF3ID0gZmFsc2U7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMub24oJ2VudGVyZnJhbWUnLCBjaGVja1JlbmRlcik7XG4gICAgdGhpcy5vbignYWRkZWQnLCBjaGVja1JlbmRlcik7XG4gIH1cblxuICBjYWxjQ2FudmFzV2lkdGgoKSB7XG4gICAgcmV0dXJuIHRoaXMud2lkdGggKyB0aGlzLnBhZGRpbmcqMjtcbiAgfVxuXG4gIGNhbGNDYW52YXNIZWlnaHQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVpZ2h0ICsgdGhpcy5wYWRkaW5nKjI7XG4gIH1cblxuICBjYWxjQ2FudmFzU2l6ZSAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLmNhbGNDYW52YXNXaWR0aCgpLFxuICAgICAgaGVpZ2h0OiB0aGlzLmNhbGNDYW52YXNIZWlnaHQoKSxcbiAgICB9O1xuICB9XG5cbiAgaXNTdHJva2FibGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3Ryb2tlICYmIDAgPCB0aGlzLnN0cm9rZVdpZHRoO1xuICB9XG5cbiAgLyoqXG4gICAqIEB2aXJ0dWFsXG4gICAqIEBwYXJhbSAge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBfY2FudmFzIFxuICAgKiBAcmV0dXJucyB7YW55fVxuICAgKi9cbiAgcHJlcmVuZGVyKF9jYW52YXMpIHtcblxuICB9XG5cbiAgLyoqXG4gICAqIEB2aXJ0dWFsXG4gICAqIEBwYXJhbSAge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBfY2FudmFzIFxuICAgKiBAcmV0dXJucyB7YW55fVxuICAgKi9cbiAgcG9zdHJlbmRlcihfY2FudmFzKSB7XG5cbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gIHtpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhc30gY2FudmFzIFxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIHJlbmRlckZpbGwoY2FudmFzKSB7XG4gICAgY2FudmFzLmZpbGwoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgcmVuZGVyU3Ryb2tlKGNhbnZhcykge1xuICAgIGNhbnZhcy5zdHJva2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcmVuZGVyKGNhbnZhcykge1xuICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmNvbnRleHQ7XG4gICAgLy8g44Oq44K144Kk44K6XG4gICAgdmFyIHNpemUgPSB0aGlzLmNhbGNDYW52YXNTaXplKCk7XG4gICAgY2FudmFzLnNldFNpemUoc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpO1xuICAgIC8vIOOCr+ODquOCouOCq+ODqeODvFxuICAgIGNhbnZhcy5jbGVhckNvbG9yKHRoaXMuYmFja2dyb3VuZENvbG9yKTtcbiAgICAvLyDkuK3lv4PjgavluqfmqJnjgpLnp7vli5VcbiAgICBjYW52YXMudHJhbnNmb3JtQ2VudGVyKCk7XG5cbiAgICAvLyDmj4/nlLvliY3lh6bnkIZcbiAgICB0aGlzLnByZXJlbmRlcih0aGlzLmNhbnZhcyk7XG5cbiAgICAvLyDjgrnjg4jjg63jg7zjgq/mj4/nlLtcbiAgICBpZiAodGhpcy5pc1N0cm9rYWJsZSgpKSB7XG4gICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gLyoqIEB0eXBlIHtpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhc1N0eWxlfSAqLyh0aGlzLnN0cm9rZSk7XG4gICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IHRoaXMuc3Ryb2tlV2lkdGg7XG4gICAgICBjb250ZXh0LmxpbmVDYXAgPSB0aGlzLmxpbmVDYXA7XG4gICAgICBjb250ZXh0LmxpbmVKb2luID0gdGhpcy5saW5lSm9pbjtcbiAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IDA7XG4gICAgICB0aGlzLnJlbmRlclN0cm9rZShjYW52YXMpO1xuICAgIH1cblxuICAgIC8vIOWhl+OCiuOBpOOBtuOBl+aPj+eUu1xuICAgIGlmICh0aGlzLmZpbGwpIHtcbiAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gdGhpcy5maWxsO1xuXG4gICAgICAvLyBzaGFkb3cg44GuIG9uL29mZlxuICAgICAgaWYgKHRoaXMuc2hhZG93KSB7XG4gICAgICAgIGNvbnRleHQuc2hhZG93Q29sb3IgPSB0aGlzLnNoYWRvdztcbiAgICAgICAgY29udGV4dC5zaGFkb3dCbHVyID0gdGhpcy5zaGFkb3dCbHVyO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IDA7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucmVuZGVyRmlsbChjYW52YXMpO1xuICAgIH1cblxuICAgIC8vIOaPj+eUu+W+jOWHpueQhlxuICAgIHRoaXMucG9zdHJlbmRlcih0aGlzLmNhbnZhcyk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDmjIflrprjg5fjg63jg5Hjg4bjgqPjgpLnm6PoppbjgZfjgIHlpInmm7TjgYzjgYLjgaPjgZ/jgonjg4Djg7zjg4bjgqPjg5Xjg6njgrDjgpLnq4vjgabjgablho3mj4/nlLvjgpLkv4PjgZlcbiAgICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIHN0YXRpYyB3YXRjaFJlbmRlclByb3BlcnR5KGtleSkge1xuICAgIC8vIHRoaXMucHJvdG90eXBlLiR3YXRjaChrZXksIGZ1bmN0aW9uKG5ld1ZhbCwgb2xkVmFsKSB7XG4gICAgJHdhdGNoLmNhbGwodGhpcy5wcm90b3R5cGUsIGtleSwgZnVuY3Rpb24obmV3VmFsLCBvbGRWYWwpIHtcbiAgICAgIGlmIChuZXdWYWwgIT09IG9sZFZhbCkge1xuICAgICAgICB0aGlzLl9kaXJ0eURyYXcgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHnjgpLjgb7jgajjgoHjgabooYzjgYZcbiAgICogQHBhcmFtIHtzdHJpbmdbXX0ga2V5c1xuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIHN0YXRpYyB3YXRjaFJlbmRlclByb3BlcnRpZXMoa2V5cykge1xuICAgIHZhciB3YXRjaFJlbmRlclByb3BlcnR5ID0gdGhpcy53YXRjaFJlbmRlclByb3BlcnR5IHx8IFNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHk7XG4gICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgd2F0Y2hSZW5kZXJQcm9wZXJ0eS5jYWxsKHRoaXMsIGtleSk7XG4gICAgfSwgdGhpcyk7XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlIHtTaGFwZU9wdGlvbnN9XG4gKiBAc3RhdGljXG4gKi9cblNoYXBlLmRlZmF1bHRzID0ge1xuICB3aWR0aDogNjQsXG4gIGhlaWdodDogNjQsXG4gIHBhZGRpbmc6IDgsXG5cbiAgYmFja2dyb3VuZENvbG9yOiAnI2FhYScsXG4gIGZpbGw6ICcjMDBhJyxcbiAgc3Ryb2tlOiAnI2FhYScsXG4gIHN0cm9rZVdpZHRoOiA0LFxuICBsaW5lQ2FwOiAncm91bmQnLFxuICBsaW5lSm9pbjogJ3JvdW5kJyxcblxuICBzaGFkb3c6IGZhbHNlLFxuICBzaGFkb3dCbHVyOiA0LFxufTtcblxuLy8gX2RlZmluZWRcblNoYXBlLndhdGNoUmVuZGVyUHJvcGVydGllcyhbXG4gICd3aWR0aCcsXG4gICdoZWlnaHQnLFxuICAncmFkaXVzJyxcbiAgJ3BhZGRpbmcnLFxuICAnYmFja2dyb3VuZENvbG9yJyxcbiAgJ2ZpbGwnLFxuICAnc3Ryb2tlJyxcbiAgJ3N0cm9rZVdpZHRoJyxcbiAgJ2xpbmVDYXAnLFxuICAnbGluZUpvaW4nLFxuICAnc2hhZG93JyxcbiAgJ3NoYWRvd0JsdXInLFxuXSk7XG5cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBjb3JuZXJSYWRpdXM/OiBudW1iZXJcbiAqIH0gJiBTaGFwZU9wdGlvbnMgfSBSZWN0YW5nbGVTaGFwZU9wdGlvbnNcbiAqL1xuXG4gIC8qKlxuICogQGNsYXNzIHBoaW5hLmRpc3BsYXkuUmVjdGFuZ2xlU2hhcGVcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuU2hhcGVcbiAqIOefqeW9ouaPj+eUu+OCr+ODqeOCuVxuICovXG5jbGFzcyBSZWN0YW5nbGVTaGFwZSBleHRlbmRzIFNoYXBlIHtcblxuICAvKipcbiAgICogQHBhcmFtIHtSZWN0YW5nbGVTaGFwZU9wdGlvbnN9IFtvcHRpb25zXVxuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIC8vIG9wdGlvbnMgPSAoe30pLiRzYWZlKG9wdGlvbnMgfHwge30sIHBoaW5hLmRpc3BsYXkuUmVjdGFuZ2xlU2hhcGUuZGVmYXVsdHMpO1xuICAgIG9wdGlvbnMgPSAkc2FmZS5jYWxsKHt9LCBvcHRpb25zfHx7fSwgUmVjdGFuZ2xlU2hhcGUuZGVmYXVsdHMpO1xuXG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICB0aGlzLmNvcm5lclJhZGl1cyA9IG9wdGlvbnMuY29ybmVyUmFkaXVzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSAge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqL1xuICBwcmVyZW5kZXIoY2FudmFzKSB7XG4gICAgY2FudmFzLnJvdW5kUmVjdCgtdGhpcy53aWR0aC8yLCAtdGhpcy5oZWlnaHQvMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMuY29ybmVyUmFkaXVzKTtcbiAgfVxuXG59XG5cbi8qKlxuICogQHR5cGUge1JlY3RhbmdsZVNoYXBlT3B0aW9uc31cbiAqIEBzdGF0aWNcbiAqL1xuUmVjdGFuZ2xlU2hhcGUuZGVmYXVsdHMgPSB7XG4gIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgZmlsbDogJ2JsdWUnLFxuICBzdHJva2U6ICcjYWFhJyxcbiAgc3Ryb2tlV2lkdGg6IDQsXG4gIGNvcm5lclJhZGl1czogMCxcbn07XG5cbi8vIF9kZWZpbmVkXG5TaGFwZS53YXRjaFJlbmRlclByb3BlcnR5LmNhbGwoUmVjdGFuZ2xlU2hhcGUsICdjb3JuZXJSYWRpdXMnKTtcblxuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHJhZGl1cz86IG51bWJlclxuICogfSAmIFNoYXBlT3B0aW9ucyB9IENpcmNsZVNoYXBlT3B0aW9uc1xuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmRpc3BsYXkuQ2lyY2xlU2hhcGVcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuU2hhcGVcbiAqL1xuY2xhc3MgQ2lyY2xlU2hhcGUgZXh0ZW5kcyBTaGFwZSB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7Q2lyY2xlU2hhcGVPcHRpb25zfSBbb3B0aW9uc11cbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAvLyBvcHRpb25zID0gKHt9KS4kc2FmZShvcHRpb25zIHx8IHt9LCBwaGluYS5kaXNwbGF5LkNpcmNsZVNoYXBlLmRlZmF1bHRzKTtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbCh7fSwgb3B0aW9uc3x8e30sIENpcmNsZVNoYXBlLmRlZmF1bHRzKTtcblxuICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgdGhpcy5zZXRCb3VuZGluZ1R5cGUoJ2NpcmNsZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSAge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqL1xuICBwcmVyZW5kZXIoY2FudmFzKSB7XG4gICAgY2FudmFzLmNpcmNsZSgwLCAwLCB0aGlzLnJhZGl1cyk7XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlIHtDaXJjbGVTaGFwZU9wdGlvbnN9XG4gKiBAc3RhdGljXG4gKi9cbkNpcmNsZVNoYXBlLmRlZmF1bHRzID0ge1xuICBiYWNrZ3JvdW5kQ29sb3I6ICd0cmFuc3BhcmVudCcsXG4gIGZpbGw6ICdyZWQnLFxuICBzdHJva2U6ICcjYWFhJyxcbiAgc3Ryb2tlV2lkdGg6IDQsXG4gIHJhZGl1czogMzIsXG59O1xuXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmRpc3BsYXkuVHJpYW5nbGVTaGFwZVxuICogX2V4dGVuZHMgcGhpbmEuZGlzcGxheS5TaGFwZVxuICovXG5jbGFzcyBUcmlhbmdsZVNoYXBlIGV4dGVuZHMgU2hhcGUge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0NpcmNsZVNoYXBlT3B0aW9uc30gW29wdGlvbnNdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgLy8gb3B0aW9ucyA9ICh7fSkuJHNhZmUob3B0aW9ucyB8fCB7fSwgcGhpbmEuZGlzcGxheS5UcmlhbmdsZVNoYXBlLmRlZmF1bHRzKTtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbCh7fSwgb3B0aW9uc3x8e30sIFRyaWFuZ2xlU2hhcGUuZGVmYXVsdHMpO1xuXG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICB0aGlzLnNldEJvdW5kaW5nVHlwZSgnY2lyY2xlJyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtICB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhcyBcbiAgICovXG4gIHByZXJlbmRlcihjYW52YXMpIHtcbiAgICBjYW52YXMucG9seWdvbigwLCAwLCB0aGlzLnJhZGl1cywgMyk7XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlIHtDaXJjbGVTaGFwZU9wdGlvbnN9XG4gKiBAc3RhdGljXG4gKi9cblRyaWFuZ2xlU2hhcGUuZGVmYXVsdHMgPSB7XG4gIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgZmlsbDogJ2dyZWVuJyxcbiAgc3Ryb2tlOiAnI2FhYScsXG4gIHN0cm9rZVdpZHRoOiA0LFxuXG4gIHJhZGl1czogMzIsXG59O1xuXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgc2lkZXM/OiBudW1iZXIsXG4gKiB9ICYgQ2lyY2xlU2hhcGVPcHRpb25zIH0gUG9seWdvblNoYXBlT3B0aW9uc1xuICovXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHNpZGVJbmRlbnQ/OiBudW1iZXIsXG4gKiB9ICYgUG9seWdvblNoYXBlT3B0aW9ucyB9IFN0YXJTaGFwZU9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5kaXNwbGF5LlN0YXJTaGFwZVxuICogX2V4dGVuZHMgcGhpbmEuZGlzcGxheS5TaGFwZVxuICovXG5jbGFzcyBTdGFyU2hhcGUgZXh0ZW5kcyBTaGFwZSB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7U3RhclNoYXBlT3B0aW9uc30gW29wdGlvbnNdIFxuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIC8vIG9wdGlvbnMgPSAoe30pLiRzYWZlKG9wdGlvbnMgfHwge30sIHBoaW5hLmRpc3BsYXkuU3RhclNoYXBlLmRlZmF1bHRzKTtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbCh7fSwgb3B0aW9uc3x8e30sIFN0YXJTaGFwZS5kZWZhdWx0cyk7XG5cbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIHRoaXMuc2V0Qm91bmRpbmdUeXBlKCdjaXJjbGUnKTtcbiAgICB0aGlzLnNpZGVzID0gb3B0aW9ucy5zaWRlcztcbiAgICB0aGlzLnNpZGVJbmRlbnQgPSBvcHRpb25zLnNpZGVJbmRlbnQ7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtICB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhcyBcbiAgICovXG4gIHByZXJlbmRlcihjYW52YXMpIHtcbiAgICBjYW52YXMuc3RhcigwLCAwLCB0aGlzLnJhZGl1cywgdGhpcy5zaWRlcywgdGhpcy5zaWRlSW5kZW50KTtcbiAgfVxuXG59XG5cbi8qKlxuICogQHR5cGUge1N0YXJTaGFwZU9wdGlvbnN9XG4gKiBAc3RhdGljXG4gKi9cblN0YXJTaGFwZS5kZWZhdWx0cyA9IHtcbiAgYmFja2dyb3VuZENvbG9yOiAndHJhbnNwYXJlbnQnLFxuICBmaWxsOiAneWVsbG93JyxcbiAgc3Ryb2tlOiAnI2FhYScsXG4gIHN0cm9rZVdpZHRoOiA0LFxuXG4gIHJhZGl1czogMzIsXG4gIHNpZGVzOiA1LFxuICBzaWRlSW5kZW50OiAwLjM4LFxufTtcblxuLy8gX2RlZmluZWRcblNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHkuY2FsbChTdGFyU2hhcGUsICdzaWRlcycpO1xuU2hhcGUud2F0Y2hSZW5kZXJQcm9wZXJ0eS5jYWxsKFN0YXJTaGFwZSwgJ3NpZGVJbmRlbnQnKTtcblxuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5kaXNwbGF5LlBvbHlnb25TaGFwZVxuICogX2V4dGVuZHMgcGhpbmEuZGlzcGxheS5TaGFwZVxuICovXG5jbGFzcyBQb2x5Z29uU2hhcGUgZXh0ZW5kcyBTaGFwZSB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7UG9seWdvblNoYXBlT3B0aW9uc30gW29wdGlvbnNdIFxuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIC8vIG9wdGlvbnMgPSAoe30pLiRzYWZlKG9wdGlvbnMgfHwge30sIHBoaW5hLmRpc3BsYXkuUG9seWdvblNoYXBlLmRlZmF1bHRzKTtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbCh7fSwgb3B0aW9uc3x8e30sIFBvbHlnb25TaGFwZS5kZWZhdWx0cyk7XG5cbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIHRoaXMuc2V0Qm91bmRpbmdUeXBlKCdjaXJjbGUnKTtcbiAgICB0aGlzLnNpZGVzID0gb3B0aW9ucy5zaWRlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gIHtpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhc30gY2FudmFzIFxuICAgKi9cbiAgcHJlcmVuZGVyKGNhbnZhcykge1xuICAgIGNhbnZhcy5wb2x5Z29uKDAsIDAsIHRoaXMucmFkaXVzLCB0aGlzLnNpZGVzKTtcbiAgfVxuXG59XG5cbi8qKlxuICogQHR5cGUge1BvbHlnb25TaGFwZU9wdGlvbnN9XG4gKiBAc3RhdGljXG4gKi9cblBvbHlnb25TaGFwZS5kZWZhdWx0cyA9IHtcbiAgYmFja2dyb3VuZENvbG9yOiAndHJhbnNwYXJlbnQnLFxuICBmaWxsOiAnY3lhbicsXG4gIHN0cm9rZTogJyNhYWEnLFxuICBzdHJva2VXaWR0aDogNCxcblxuICByYWRpdXM6IDMyLFxuICBzaWRlczogNSxcbn07XG5cbi8vIGRlZmluZWRcblNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHkuY2FsbChQb2x5Z29uU2hhcGUsICdzaWRlcycpO1xuXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgY29ybmVyQW5nbGU/OiBudW1iZXIsXG4gKiB9ICYgQ2lyY2xlU2hhcGVPcHRpb25zIH0gSGVhcnRTaGFwZU9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5kaXNwbGF5LkhlYXJ0U2hhcGVcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuU2hhcGVcbiAqL1xuY2xhc3MgSGVhcnRTaGFwZSBleHRlbmRzIFNoYXBlIHtcblxuICAvKipcbiAgICogQHBhcmFtIHtIZWFydFNoYXBlT3B0aW9uc30gW29wdGlvbnNdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgLy8gb3B0aW9ucyA9ICh7fSkuJHNhZmUob3B0aW9ucyB8fCB7fSwgcGhpbmEuZGlzcGxheS5IZWFydFNoYXBlLmRlZmF1bHRzKTtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbCh7fSwgb3B0aW9uc3x8e30sIEhlYXJ0U2hhcGUuZGVmYXVsdHMpO1xuXG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICB0aGlzLnNldEJvdW5kaW5nVHlwZSgnY2lyY2xlJyk7XG4gICAgdGhpcy5jb3JuZXJBbmdsZSA9IG9wdGlvbnMuY29ybmVyQW5nbGU7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtICB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhcyBcbiAgICovXG4gIHByZXJlbmRlcihjYW52YXMpIHtcbiAgICBjYW52YXMuaGVhcnQoMCwgMCwgdGhpcy5yYWRpdXMsIHRoaXMuY29ybmVyQW5nbGUpO1xuICB9XG5cbn1cblxuLyoqXG4gKiBAdHlwZSB7SGVhcnRTaGFwZU9wdGlvbnN9XG4gKiBAc3RhdGljXG4gKi9cbkhlYXJ0U2hhcGUuZGVmYXVsdHMgPSB7XG4gIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgZmlsbDogJ3BpbmsnLFxuICBzdHJva2U6ICcjYWFhJyxcbiAgc3Ryb2tlV2lkdGg6IDQsXG5cbiAgcmFkaXVzOiAzMixcbiAgY29ybmVyQW5nbGU6IDQ1LFxufTtcblxuLy8gZGVmaW5lZFxuU2hhcGUud2F0Y2hSZW5kZXJQcm9wZXJ0eS5jYWxsKEhlYXJ0U2hhcGUsICdjb3JuZXJBbmdsZScpO1xuXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgcGF0aHM/OiBWZWN0b3IyW11cbiAqIH0gJiBTaGFwZU9wdGlvbnMgfSBQYXRoU2hhcGVPcHRpb25zXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZGlzcGxheS5QYXRoU2hhcGVcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuU2hhcGVcbiAqL1xuY2xhc3MgUGF0aFNoYXBlIGV4dGVuZHMgU2hhcGUge1xuICAvLyBwYXRoczogbnVsbCxcblxuICAvKipcbiAgICogQHBhcmFtIHtQYXRoU2hhcGVPcHRpb25zfSBbb3B0aW9uc11cbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAvLyBvcHRpb25zID0gKHt9KS4kc2FmZShvcHRpb25zIHx8IHt9LCBwaGluYS5kaXNwbGF5LlBhdGhTaGFwZS5kZWZhdWx0cyk7XG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwoe30sIG9wdGlvbnN8fHt9LCBQYXRoU2hhcGUuZGVmYXVsdHMpO1xuXG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgdGhpcy5wYXRocyA9IG9wdGlvbnMucGF0aHMgfHwgW107XG4gICAgdGhpcy5saW5lSm9pbiA9IG9wdGlvbnMubGluZUpvaW47XG4gICAgdGhpcy5saW5lQ2FwID0gb3B0aW9ucy5saW5lQ2FwO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7VmVjdG9yMltdfSBwYXRoc1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldFBhdGhzIChwYXRocykge1xuICAgIHRoaXMucGF0aHMgPSBwYXRocztcbiAgICB0aGlzLl9kaXJ0eURyYXcgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgY2xlYXIgKCkge1xuICAgIHRoaXMucGF0aHMubGVuZ3RoID0gMDtcbiAgICB0aGlzLl9kaXJ0eURyYXcgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7VmVjdG9yMltdfSBwYXRocyBcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBhZGRQYXRocyAocGF0aHMpIHtcbiAgICBbXS5wdXNoLmFwcGx5KHRoaXMucGF0aHMsIHBhdGhzKTtcbiAgICB0aGlzLl9kaXJ0eURyYXcgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgYWRkUGF0aCAoeCwgeSkge1xuICAgIHRoaXMucGF0aHMucHVzaChuZXcgVmVjdG9yMih4LCB5KSk7XG4gICAgdGhpcy5fZGlydHlEcmF3ID0gdHJ1ZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlcn0gaVxuICAgKiBAcmV0dXJucyB7VmVjdG9yMn1cbiAgICovXG4gIGdldFBhdGggKGkpIHtcbiAgICByZXR1cm4gdGhpcy5wYXRoc1tpXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJucyB7VmVjdG9yMltdfSBwYXRocyBcbiAgICovXG4gIGdldFBhdGhzICgpIHtcbiAgICByZXR1cm4gdGhpcy5wYXRocztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlcn0gaVxuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKi9cbiAgY2hhbmdlUGF0aCAoaSwgeCwgeSkge1xuICAgIHRoaXMucGF0aHNbaV0uc2V0KHgsIHkpO1xuICAgIHRoaXMuX2RpcnR5RHJhdyA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybnMge3t3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcn19XG4gICAqL1xuICBjYWxjQ2FudmFzU2l6ZSAoKSB7XG4gICAgdmFyIHBhdGhzID0gdGhpcy5wYXRocztcbiAgICBpZiAocGF0aHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogdGhpcy5wYWRkaW5nICogMixcbiAgICAgICAgaGVpZ2h0OnRoaXMucGFkZGluZyAqIDIsXG4gICAgICB9O1xuICAgIH1cbiAgICB2YXIgbWF4WCA9IC1JbmZpbml0eTtcbiAgICB2YXIgbWF4WSA9IC1JbmZpbml0eTtcbiAgICB2YXIgbWluWCA9IEluZmluaXR5O1xuICAgIHZhciBtaW5ZID0gSW5maW5pdHk7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGF0aHMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgIHZhciBwYXRoID0gcGF0aHNbaV07XG4gICAgICBpZiAobWF4WCA8IHBhdGgueCkgeyBtYXhYID0gcGF0aC54OyB9XG4gICAgICBpZiAobWluWCA+IHBhdGgueCkgeyBtaW5YID0gcGF0aC54OyB9XG4gICAgICBpZiAobWF4WSA8IHBhdGgueSkgeyBtYXhZID0gcGF0aC55OyB9XG4gICAgICBpZiAobWluWSA+IHBhdGgueSkgeyBtaW5ZID0gcGF0aC55OyB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogTWF0aC5tYXgoTWF0aC5hYnMobWF4WCksIE1hdGguYWJzKG1pblgpKSAqIDIgKyB0aGlzLnBhZGRpbmcgKiAyLFxuICAgICAgaGVpZ2h0OiBNYXRoLm1heChNYXRoLmFicyhtYXhZKSwgTWF0aC5hYnMobWluWSkpICogMiArIHRoaXMucGFkZGluZyAqIDIsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cbiAgY2FsY0NhbnZhc1dpZHRoICgpIHtcbiAgICByZXR1cm4gdGhpcy5jYWxjQ2FudmFzU2l6ZSgpLndpZHRoO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBjYWxjQ2FudmFzSGVpZ2h0ICgpIHtcbiAgICByZXR1cm4gdGhpcy5jYWxjQ2FudmFzU2l6ZSgpLmhlaWdodDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gIHtpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhc30gY2FudmFzIFxuICAgKi9cbiAgcHJlcmVuZGVyIChjYW52YXMpIHtcbiAgICB2YXIgcGF0aHMgPSB0aGlzLnBhdGhzO1xuICAgIGlmIChwYXRocy5sZW5ndGggPiAxKSB7XG4gICAgICB2YXIgYyA9IGNhbnZhcy5jb250ZXh0O1xuICAgICAgdmFyIHAgPSBwYXRoc1swXTtcbiAgICAgIGMuYmVnaW5QYXRoKCk7XG4gICAgICBjLm1vdmVUbyhwLngsIHAueSk7XG4gICAgICBmb3IgKHZhciBpID0gMSwgbGVuID0gcGF0aHMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgcCA9IHBhdGhzW2ldO1xuICAgICAgICBjLmxpbmVUbyhwLngsIHAueSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cblxuLyoqXG4gKiBAdHlwZSB7UGF0aFNoYXBlT3B0aW9uc31cbiAqIEBzdGF0aWNcbiAqL1xuUGF0aFNoYXBlLmRlZmF1bHRzID0ge1xuICBmaWxsOiBmYWxzZSxcbiAgYmFja2dyb3VuZENvbG9yOiAndHJhbnNwYXJlbnQnLFxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICB0ZXh0Pzogc3RyaW5nXG4gKiAgIGZvbnRTaXplPzogbnVtYmVyXG4gKiAgIGZvbnRXZWlnaHQ/OiBzdHJpbmcgfCBudW1iZXJcbiAqICAgZm9udEZhbWlseT86IHN0cmluZ1xuICogICBhbGlnbj86IENhbnZhc1RleHRBbGlnblxuICogICBiYXNlbGluZT86IENhbnZhc1RleHRCYXNlbGluZVxuICogICBsaW5lSGVpZ2h0PzogbnVtYmVyXG4gKiB9ICYgaW1wb3J0KFwiLi9zaGFwZVwiKS5TaGFwZU9wdGlvbnMgfSBMYWJlbE9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5kaXNwbGF5LkxhYmVsXG4gKiBfZXh0ZW5kcyBwaGluYS5kaXNwbGF5LlNoYXBlXG4gKi9cbmNsYXNzIExhYmVsIGV4dGVuZHMgU2hhcGUge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtMYWJlbE9wdGlvbnN9IFtvcHRpb25zXVxuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdICE9PSAnb2JqZWN0Jykge1xuICAgICAgb3B0aW9ucyA9IHsgdGV4dDogYXJndW1lbnRzWzBdLCB9O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIG9wdGlvbnMgPSBhcmd1bWVudHNbMF07XG4gICAgfVxuXG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwoe30sIG9wdGlvbnN8fHt9LCBMYWJlbC5kZWZhdWx0cyk7XG4gICAgLy8gb3B0aW9ucyA9ICh7fSkuJHNhZmUob3B0aW9ucywgcGhpbmEuZGlzcGxheS5MYWJlbC5kZWZhdWx0cyk7XG5cbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIC8qKiBAdHlwZSB7c3RyaW5nfG51bWJlcn0gKi9cbiAgICB0aGlzLl90ZXh0O1xuXG4gICAgdGhpcy50ZXh0ID0gb3B0aW9ucy50ZXh0O1xuICAgIHRoaXMuZm9udFNpemUgPSBvcHRpb25zLmZvbnRTaXplO1xuICAgIHRoaXMuZm9udFdlaWdodCA9IG9wdGlvbnMuZm9udFdlaWdodDtcbiAgICB0aGlzLmZvbnRGYW1pbHkgPSBvcHRpb25zLmZvbnRGYW1pbHk7XG4gICAgdGhpcy5hbGlnbiA9IG9wdGlvbnMuYWxpZ247XG4gICAgdGhpcy5iYXNlbGluZSA9IG9wdGlvbnMuYmFzZWxpbmU7XG4gICAgdGhpcy5saW5lSGVpZ2h0ID0gb3B0aW9ucy5saW5lSGVpZ2h0O1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBjYWxjQ2FudmFzV2lkdGgoKSB7XG4gICAgdmFyIHdpZHRoID0gMDtcbiAgICB2YXIgY2FudmFzID0gdGhpcy5jYW52YXM7XG4gICAgY2FudmFzLmNvbnRleHQuZm9udCA9IHRoaXMuZm9udDtcbiAgICB0aGlzLl9saW5lcy5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIHZhciB3ID0gY2FudmFzLmNvbnRleHQubWVhc3VyZVRleHQobGluZSkud2lkdGg7XG4gICAgICBpZiAod2lkdGggPCB3KSB7XG4gICAgICAgIHdpZHRoID0gdztcbiAgICAgIH1cbiAgICB9LCB0aGlzKTtcbiAgICBpZiAodGhpcy5hbGlnbiAhPT0gJ2NlbnRlcicpIHdpZHRoKj0yO1xuXG4gICAgcmV0dXJuIHdpZHRoICsgdGhpcy5wYWRkaW5nKjI7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG4gIGNhbGNDYW52YXNIZWlnaHQoKSB7XG4gICAgdmFyIGhlaWdodCA9IHRoaXMuZm9udFNpemUgKiB0aGlzLl9saW5lcy5sZW5ndGg7XG4gICAgaWYgKHRoaXMuYmFzZWxpbmUgIT09ICdtaWRkbGUnKSBoZWlnaHQqPTI7XG4gICAgcmV0dXJuIGhlaWdodCp0aGlzLmxpbmVIZWlnaHQgKyB0aGlzLnBhZGRpbmcqMjtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gIHtpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhc30gY2FudmFzIFxuICAgKi9cbiAgcHJlcmVuZGVyKGNhbnZhcykge1xuICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmNvbnRleHQ7XG4gICAgY29udGV4dC5mb250ID0gdGhpcy5mb250O1xuICAgIGNvbnRleHQudGV4dEFsaWduID0gdGhpcy5hbGlnbjtcbiAgICBjb250ZXh0LnRleHRCYXNlbGluZSA9IHRoaXMuYmFzZWxpbmU7XG5cbiAgICB2YXIgbGluZXMgPSB0aGlzLl9saW5lcztcbiAgICB0aGlzLmxpbmVTaXplID0gdGhpcy5mb250U2l6ZSp0aGlzLmxpbmVIZWlnaHQ7XG4gICAgdGhpcy5fb2Zmc2V0ID0gLU1hdGguZmxvb3IobGluZXMubGVuZ3RoLzIpKnRoaXMubGluZVNpemU7XG4gICAgdGhpcy5fb2Zmc2V0ICs9ICgobGluZXMubGVuZ3RoKzEpJTIpICogKHRoaXMubGluZVNpemUvMik7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtICB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhcyBcbiAgICovXG4gIHJlbmRlckZpbGwoY2FudmFzKSB7XG4gICAgdmFyIGNvbnRleHQgPSBjYW52YXMuY29udGV4dDtcbiAgICB0aGlzLl9saW5lcy5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUsIGkpIHtcbiAgICAgIGNvbnRleHQuZmlsbFRleHQobGluZSwgMCwgaSp0aGlzLmxpbmVTaXplK3RoaXMuX29mZnNldCk7XG4gICAgfSwgdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtICB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhcyBcbiAgICovXG4gIHJlbmRlclN0cm9rZShjYW52YXMpIHtcbiAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5jb250ZXh0O1xuICAgIHRoaXMuX2xpbmVzLmZvckVhY2goZnVuY3Rpb24obGluZSwgaSkge1xuICAgICAgY29udGV4dC5zdHJva2VUZXh0KGxpbmUsIDAsIGkqdGhpcy5saW5lU2l6ZSt0aGlzLl9vZmZzZXQpO1xuICAgIH0sIHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIHRleHRcbiAgICogQHJldHVybnMge3N0cmluZ3xudW1iZXJ9XG4gICAqL1xuICBnZXQgdGV4dCgpIHsgcmV0dXJuIHRoaXMuX3RleHQ7IH1cbiAgc2V0IHRleHQodikge1xuICAgIHRoaXMuX3RleHQgPSB2O1xuICAgIHRoaXMuX2xpbmVzID0gKHRoaXMudGV4dCArICcnKS5zcGxpdCgnXFxuJyk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybnMge3N0cmluZ31cbiAgICovXG4gIGdldCBmb250KCkge1xuICAgIHJldHVybiBmb3JtYXQuY2FsbChcIntmb250V2VpZ2h0fSB7Zm9udFNpemV9cHgge2ZvbnRGYW1pbHl9XCIsIHRoaXMpO1xuICAgIC8vIHJldHVybiBcIntmb250V2VpZ2h0fSB7Zm9udFNpemV9cHgge2ZvbnRGYW1pbHl9XCIuZm9ybWF0KHRoaXMpO1xuICB9XG5cbn1cblxuLyoqXG4gKiBAdHlwZSB7TGFiZWxPcHRpb25zfVxuICogQHN0YXRpY1xuICovXG5MYWJlbC5kZWZhdWx0cyA9IHtcbiAgYmFja2dyb3VuZENvbG9yOiAndHJhbnNwYXJlbnQnLFxuXG4gIGZpbGw6ICdibGFjaycsXG4gIHN0cm9rZTogbnVsbCxcbiAgc3Ryb2tlV2lkdGg6IDIsXG5cbiAgLy8gXG4gIHRleHQ6ICdIZWxsbywgd29ybGQhJyxcbiAgLy8gXG4gIGZvbnRTaXplOiAzMixcbiAgZm9udFdlaWdodDogJycsXG4gIGZvbnRGYW1pbHk6IFwiJ0hpcmFLYWt1UHJvTi1XMydcIiwgLy8gSGlyYWdpbm8gb3IgSGVsdmV0aWNhLFxuICAvLyBcbiAgYWxpZ246ICdjZW50ZXInLFxuICBiYXNlbGluZTogJ21pZGRsZScsXG4gIGxpbmVIZWlnaHQ6IDEuMixcbn07XG5cbi8vIGRlZmluZWRcblNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHkuY2FsbChMYWJlbCwgJ3RleHQnKTtcblNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHkuY2FsbChMYWJlbCwgJ2ZvbnRTaXplJyk7XG5TaGFwZS53YXRjaFJlbmRlclByb3BlcnR5LmNhbGwoTGFiZWwsICdmb250V2VpZ2h0Jyk7XG5TaGFwZS53YXRjaFJlbmRlclByb3BlcnR5LmNhbGwoTGFiZWwsICdmb250RmFtaWx5Jyk7XG5TaGFwZS53YXRjaFJlbmRlclByb3BlcnR5LmNhbGwoTGFiZWwsICdhbGlnbicpO1xuU2hhcGUud2F0Y2hSZW5kZXJQcm9wZXJ0eS5jYWxsKExhYmVsLCAnYmFzZWxpbmUnKTtcblNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHkuY2FsbChMYWJlbCwgJ2xpbmVIZWlnaHQnKTtcblxuLyoqXG4gKiBTcHJpdGXjgq/jg6njgrnjgarjganjgIFGcmFtZUFuaW1hdGlvbuOBrnRhcmdldOOBqOOBl+OBpumBqeato+OBquWei1xuICogQHR5cGVkZWYge3tcbiAqICAgc3JjUmVjdDogaW1wb3J0KFwiLi4vZ2VvbS9yZWN0XCIpLlJlY3RcbiAqICAgd2lkdGg6IG51bWJlclxuICogICBoZWlnaHQ6IG51bWJlclxuICogfSAmIGltcG9ydChcIi4vYWNjZXNzb3J5XCIpLkFjY2Vzc29yeVRhcmdldCB9IEZyYW1lQW5pbWF0aW9uVGFyZ2V0XG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuYWNjZXNzb3J5LkZyYW1lQW5pbWF0aW9uXG4gKiBfZXh0ZW5kcyBwaGluYS5hY2Nlc3NvcnkuQWNjZXNzb3J5XG4gKiBcbiAqIOODleODrOODvOODoOOCouODi+ODoeODvOOCt+ODp+ODs+WItuW+oeOCkuihjOOBhkFjY2Vzc29yeea0vueUn+OCr+ODqeOCuVxuICogXG4gKiDkuojjgoHjg63jg7zjg4nvvIjjg5Hjg7zjgrnvvInjgZfjgZ/jgrnjg5fjg6njgqTjg4jjgrfjg7zjg4hKU09O44OH44O844K/44KS5L2/44GE44CBXG4gKiBTcHJpdGXjgq/jg6njgrnjga7jg5Xjg6zjg7zjg6Dnr4Tlm7LjgpLliLblvqHjgZnjgovjgZPjgajjgafjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgpLlrp/nj77jgZnjgotcbiAqIEBzZWUgaHR0cHM6Ly9xaWl0YS5jb20vYWxrbjIwMy9pdGVtcy9hMjg3Yzc1MjQxOTNmNWY0Y2E5MFxuICogXG4gKiBAZXhhbXBsZVxuICogLy8g5LqI44KBXCJwbGF5ZXJfc3NcIuOBqOOBhOOBhuWQjeWJjeOBp+OCueODl+ODqeOCpOODiOOCt+ODvOODiOeUu+WDj+OAgUpzb27jg4fjg7zjgr/jgpLjgqLjgrvjg4Pjg4jnmbvpjLLjgZfjgabjgYrjgY9cbiAqIC8vIHBsYXllcl9zc+OBq+OBr1wid2Fsa1wi44Go44GE44GG5ZCN5YmN44Gu44Ki44OL44Oh44O844K344On44Oz44KS5a6a576pXG4gKiBjb25zdCB0YXJnZXQgPSBuZXcgcGhpbmEuZGlzcGxheS5TcHJpdGUoXCJwbGF5ZXJfc3NcIik7XG4gKiBjb25zdCBmcmFtZUFuaW0gPSBuZXcgcGhpbmEuYWNjZXNzb3J5LkZyYW1lQW5pbWF0aW9uKFwicGxheWVyX3NzXCIpLmF0dGFjaFRvKHRhcmdldCk7XG4gKiBmcmFtZUFuaW0uZ290b0FuZFBsYXkoXCJ3YWxrXCIpO1xuICovXG5jbGFzcyBGcmFtZUFuaW1hdGlvbiBleHRlbmRzIEFjY2Vzc29yeSB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge3N0cmluZ30gc3Mg44Ot44O844OJ5riI44G/44K544OX44Op44Kk44OI44K344O844OI44OH44O844K/QXNzZXTjgq3jg7xcbiAgICovXG4gIGNvbnN0cnVjdG9yKHNzKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8qKiBAdHlwZSB7RnJhbWVBbmltYXRpb25UYXJnZXR9ICovXG4gICAgdGhpcy50YXJnZXQ7XG5cbiAgICAvKipcbiAgICAgKiDjgrnjg5fjg6njgqTjg4jjgrfjg7zjg4jjgqrjg5bjgrjjgqfjgq/jg4hcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7aW1wb3J0KCcuLi9hc3NldC9zcHJpdGVzaGVldCcpLlNwcml0ZVNoZWV0fVxuICAgICAqL1xuICAgIHRoaXMuc3MgPSBBc3NldE1hbmFnZXIuZ2V0KCdzcHJpdGVzaGVldCcsIHNzKTtcblxuICAgIC8qKlxuICAgICAqIOWGjeeUn+S4reOBruOCouODi+ODoeODvOOCt+ODp+ODs+OBruODh+ODvOOCv+OCquODluOCuOOCp+OCr+ODiFxuICAgICAqIFxuICAgICAqIEB0eXBlIHtpbXBvcnQoXCIuLi9hc3NldC9zcHJpdGVzaGVldFwiKS5TcHJpdGVTaGVldEFuaW1hdGlvbkRhdGEgfCBudWxsfVxuICAgICAqL1xuICAgIHRoaXMuY3VycmVudEFuaW1hdGlvbjtcblxuICAgIC8qKlxuICAgICAqIOWGjeeUn+S4reOBruOCouODi+ODoeODvOOCt+ODp+ODs+WQjVxuICAgICAqIFxuICAgICAqIEB0eXBlIHsoc3RyaW5nIHwgbnVtYmVyKSB8IG51bGx9XG4gICAgICovXG4gICAgdGhpcy5jdXJyZW50QW5pbWF0aW9uTmFtZTtcblxuICAgIC8qKlxuICAgICAqIOWBnOatoueKtuaFi1xuICAgICAqIFxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIOODleODrOODvOODoOOCteOCpOOCuuOBq+WQiOOCj+OBm+OBpuWvvuixoeOBruW5heODu+mrmOOBleOCkuWkieOBiOOCi+OBi+OBqeOBhuOBi1xuICAgICAqIFxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMuZml0ID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIOePvuWcqOOBruOCouODi+ODoeODvOOCt+ODp+ODs+ODleODrOODvOODoOOCkuihqOOBmeOCpOODs+ODh+ODg+OCr+OCueWApFxuICAgICAqIFxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHRoaXMuY3VycmVudEZyYW1lSW5kZXg7XG5cbiAgICAvKipcbiAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pmm7TmlrDnlKjjga7jgqLjg5fjg6rjg5Xjg6zjg7zjg6Djga7jgqvjgqbjg7Pjg4jlgKRcbiAgICAgKiBcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB0aGlzLmZyYW1lO1xuXG4gICAgLyoqXG4gICAgICog57WC5LqG44OV44Op44Kw77yadHJ1ZeOBruaZguOBr3VwZGF0ZeaZguOBq2N1cnJlbnRGcmFtZUluZGV444GM44Oq44K744OD44OI44GV44KM44KLXG4gICAgICogXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyp9IF9hcHAgQXBw44Kv44Op44K544Kk44Oz44K544K/44Oz44K5XG4gICAqL1xuICB1cGRhdGUoX2FwcCkge1xuICAgIGlmICh0aGlzLnBhdXNlZCkgcmV0dXJuIDtcbiAgICBpZiAoIXRoaXMuY3VycmVudEFuaW1hdGlvbikgcmV0dXJuIDtcblxuICAgIGlmICh0aGlzLmZpbmlzaGVkKSB7XG4gICAgICB0aGlzLmZpbmlzaGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmN1cnJlbnRGcmFtZUluZGV4ID0gMDtcbiAgICAgIHJldHVybiA7XG4gICAgfVxuXG4gICAgKyt0aGlzLmZyYW1lO1xuICAgIGlmICh0aGlzLmZyYW1lJXRoaXMuY3VycmVudEFuaW1hdGlvbi5mcmVxdWVuY3kgPT09IDApIHtcbiAgICAgICsrdGhpcy5jdXJyZW50RnJhbWVJbmRleDtcbiAgICAgIHRoaXMuX3VwZGF0ZUZyYW1lKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaMh+WumuOCouODi+ODoeODvOOCt+ODp+ODs+OCkuWGjeeUn1xuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXJ9IG5hbWUg44Ki44OL44Oh44O844K344On44Oz5ZCNXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2tlZXA9dHJ1ZV0g5ZCM5ZCN44Ki44OL44Oh44O844K344On44Oz44GM44GZ44Gn44Gr5YaN55Sf5Lit44Gu5aC05ZCI44CB44Gd44Gu44G+44G+44Gr44GZ44KL44GL44Gp44GG44GLXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZ290b0FuZFBsYXkobmFtZSwga2VlcCkge1xuICAgIGtlZXAgPSAoa2VlcCAhPT0gdW5kZWZpbmVkKSA/IGtlZXAgOiB0cnVlO1xuICAgIGlmIChrZWVwICYmIHRoaXMuY3VycmVudEFuaW1hdGlvblxuICAgICAgICAgICAgICYmIG5hbWUgPT09IHRoaXMuY3VycmVudEFuaW1hdGlvbk5hbWVcbiAgICAgICAgICAgICAmJiB0aGlzLmN1cnJlbnRGcmFtZUluZGV4IDwgdGhpcy5jdXJyZW50QW5pbWF0aW9uLmZyYW1lcy5sZW5ndGhcbiAgICAgICAgICAgICAmJiAhdGhpcy5wYXVzZWQpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnRBbmltYXRpb25OYW1lID0gbmFtZTtcbiAgICB0aGlzLmZyYW1lID0gMDtcbiAgICB0aGlzLmN1cnJlbnRGcmFtZUluZGV4ID0gMDtcbiAgICB0aGlzLmN1cnJlbnRBbmltYXRpb24gPSB0aGlzLnNzLmdldEFuaW1hdGlvbihuYW1lKTtcbiAgICB0aGlzLl91cGRhdGVGcmFtZSgpO1xuXG4gICAgdGhpcy5wYXVzZWQgPSBmYWxzZTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOaMh+WumuOCouODi+ODoeODvOOCt+ODp+ODs+WPiuOBs+OBneOBruWGkumgreODleODrOODvOODoOOCkuOCu+ODg+ODiOW+jOOAgeWBnOatoueKtuaFi+OBq+OBmeOCi1xuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg44Ki44OL44Oh44O844K344On44Oz5ZCNXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZ290b0FuZFN0b3AobmFtZSkge1xuICAgIHRoaXMuY3VycmVudEFuaW1hdGlvbk5hbWUgPSBuYW1lO1xuICAgIHRoaXMuZnJhbWUgPSAwO1xuICAgIHRoaXMuY3VycmVudEZyYW1lSW5kZXggPSAwO1xuICAgIHRoaXMuY3VycmVudEFuaW1hdGlvbiA9IHRoaXMuc3MuZ2V0QW5pbWF0aW9uKG5hbWUpO1xuICAgIHRoaXMuX3VwZGF0ZUZyYW1lKCk7XG5cbiAgICB0aGlzLnBhdXNlZCA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjg5Xjg6zjg7zjg6Dmm7TmlrDlh6bnkIZcbiAgICogXG4gICAqIEBwcm90ZWN0ZWRcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfdXBkYXRlRnJhbWUoKSB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRBbmltYXRpb24pIHJldHVybjtcblxuICAgIHZhciBhbmltID0gdGhpcy5jdXJyZW50QW5pbWF0aW9uO1xuICAgIGlmICh0aGlzLmN1cnJlbnRGcmFtZUluZGV4ID49IGFuaW0uZnJhbWVzLmxlbmd0aCkge1xuICAgICAgaWYgKGFuaW0ubmV4dCkge1xuICAgICAgICB0aGlzLmdvdG9BbmRQbGF5KGFuaW0ubmV4dCk7XG4gICAgICAgIHJldHVybiA7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5wYXVzZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgaW5kZXggPSBhbmltLmZyYW1lc1t0aGlzLmN1cnJlbnRGcmFtZUluZGV4XTtcbiAgICB2YXIgZnJhbWUgPSB0aGlzLnNzLmdldEZyYW1lKGluZGV4KTtcbiAgICB0aGlzLnRhcmdldC5zcmNSZWN0LnNldChmcmFtZS54LCBmcmFtZS55LCBmcmFtZS53aWR0aCwgZnJhbWUuaGVpZ2h0KTtcblxuICAgIGlmICh0aGlzLmZpdCkge1xuICAgICAgdGhpcy50YXJnZXQud2lkdGggPSBmcmFtZS53aWR0aDtcbiAgICAgIHRoaXMudGFyZ2V0LmhlaWdodCA9IGZyYW1lLmhlaWdodDtcbiAgICB9XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHg6IG51bWJlclxuICogICB5OiBudW1iZXJcbiAqICAgc2V0SW50ZXJhY3RpdmU6IChmbGFnOmJvb2xlYW4pID0+IGFueVxuICogfSAmIGltcG9ydChcIi4vYWNjZXNzb3J5XCIpLkFjY2Vzc29yeUF0dGFjaGFibGUgfSBGbGlja2FibGVUYXJnZXRcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5hY2Nlc3NvcnkuRmxpY2thYmxlXG4gKiBGbGlja2FibGVcbiAqIF9leHRlbmRzIHBoaW5hLmFjY2Vzc29yeS5BY2Nlc3NvcnlcbiAqL1xuY2xhc3MgRmxpY2thYmxlIGV4dGVuZHMgQWNjZXNzb3J5IHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7RmxpY2thYmxlVGFyZ2V0fSB0YXJnZXRcbiAgICovXG4gIGNvbnN0cnVjdG9yKHRhcmdldCkge1xuICAgIHN1cGVyKHRhcmdldCk7XG5cbiAgICAvKiogQHR5cGUge0ZsaWNrYWJsZVRhcmdldH0gKi9cbiAgICB0aGlzLnRhcmdldDtcblxuICAgIC8qKlxuICAgICAqIOODleODquODg+OCr+mWi+Wni+S9jee9rlxuICAgICAqL1xuICAgIHRoaXMuaW5pdGlhbFBvc2l0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCk7XG5cbiAgICAvKipcbiAgICAgKiDmkanmk6blgKRcbiAgICAgKiBAZGVmYXVsdCAwLjlcbiAgICAgKi9cbiAgICB0aGlzLmZyaWN0aW9uID0gMC45O1xuXG4gICAgLyoqXG4gICAgICog6YCf5bqm44OZ44Kv44OI44OrXG4gICAgICovXG4gICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWN0b3IyKDAsIDApO1xuXG4gICAgLyoqXG4gICAgICog5LiK5LiL44Gu56e75YuV44KS6Kix5Y+v44GZ44KL44GL44Gp44GG44GL77yI5Yid5pyf5YCk77yadHJ1Ze+8iVxuICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgKi9cbiAgICB0aGlzLnZlcnRpY2FsID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIOW3puWPs+OBruenu+WLleOCkuioseWPr+OBmeOCi+OBi+OBqeOBhuOBi++8iOWIneacn+WApO+8mnRydWXvvIlcbiAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICovXG4gICAgdGhpcy5ob3Jpem9udGFsID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIOOCreODo+ODg+OCt+ODpeOBl+OBn+W3ruWIhuWApFxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB0aGlzLmNhY2hlTGlzdCA9IFtdO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMub24oJ2F0dGFjaGVkJywgXG4gICAgLyoqIEB0aGlzIHtGbGlja2FibGV9ICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLnRhcmdldC5zZXRJbnRlcmFjdGl2ZSh0cnVlKTtcblxuICAgICAgdGhpcy50YXJnZXQub24oJ3BvaW50c3RhcnQnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIHNlbGYuaW5pdGlhbFBvc2l0aW9uLnNldCh0aGlzLngsIHRoaXMueSk7XG4gICAgICAgIHNlbGYudmVsb2NpdHkuc2V0KDAsIDApO1xuICAgICAgfSk7XG4gICAgICB0aGlzLnRhcmdldC5vbigncG9pbnRzdGF5JywgZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoc2VsZi5ob3Jpem9udGFsKSB7XG4gICAgICAgICAgdGhpcy54ICs9IGUucG9pbnRlci5keDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi52ZXJ0aWNhbCkge1xuICAgICAgICAgIHRoaXMueSArPSBlLnBvaW50ZXIuZHk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2VsZi5jYWNoZUxpc3QubGVuZ3RoID4gMykgc2VsZi5jYWNoZUxpc3Quc2hpZnQoKTtcbiAgICAgICAgc2VsZi5jYWNoZUxpc3QucHVzaChlLnBvaW50ZXIuZGVsdGFQb3NpdGlvbi5jbG9uZSgpKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLnRhcmdldC5vbigncG9pbnRlbmQnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIC8vIOWLleOBjeOBruOBguOCiyBkZWx0YSBwb3NpdGlvbiDjgpLlvozjgo3jgYvjgonmpJzntKLjgIBcbiAgICAgICAgdmFyIGRlbHRhID0gc2VsZi5jYWNoZUxpc3QucmV2ZXJzZSgpLmZpbmQoZnVuY3Rpb24odikge1xuICAgICAgICAgIHJldHVybiB2Lmxlbmd0aFNxdWFyZWQoKSA+IDEwO1xuICAgICAgICB9KTtcbiAgICAgICAgY2xlYXIuY2FsbChzZWxmLmNhY2hlTGlzdCk7XG4gICAgICAgIC8vIHNlbGYuY2FjaGVMaXN0LmNsZWFyKCk7XG5cbiAgICAgICAgaWYgKGRlbHRhKSB7XG4gICAgICAgICAgc2VsZi52ZWxvY2l0eS54ID0gZGVsdGEueDtcbiAgICAgICAgICBzZWxmLnZlbG9jaXR5LnkgPSBkZWx0YS55O1xuXG4gICAgICAgICAgc2VsZi5mbGFyZSgnZmxpY2tzdGFydCcsIHtcbiAgICAgICAgICAgIGRpcmVjdGlvbjogZGVsdGEubm9ybWFsaXplKCksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgc2VsZi5mbGFyZSgnZmxpY2tjYW5jZWwnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHNlbGYuZmxhcmUoJ2ZsaWNrJyk7XG4gICAgICAgIC8vIHNlbGYuZmxhcmUoJ2ZsaWNrZW5kJyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDplqLmlbBcbiAgICogQHBhcmFtIHsqfSBfYXBwIEFwcOOCr+ODqeOCueOCpOODs+OCueOCv+ODs+OCuVxuICAgKi9cbiAgdXBkYXRlKF9hcHApIHtcbiAgICBpZiAoIXRoaXMudGFyZ2V0KSByZXR1cm4gO1xuXG4gICAgdGhpcy52ZWxvY2l0eS54ICo9IHRoaXMuZnJpY3Rpb247XG4gICAgdGhpcy52ZWxvY2l0eS55ICo9IHRoaXMuZnJpY3Rpb247XG5cbiAgICBpZiAodGhpcy5ob3Jpem9udGFsKSB7XG4gICAgICB0aGlzLnRhcmdldC5wb3NpdGlvbi54ICs9IHRoaXMudmVsb2NpdHkueDtcbiAgICB9XG4gICAgaWYgKHRoaXMudmVydGljYWwpIHtcbiAgICAgIHRoaXMudGFyZ2V0LnBvc2l0aW9uLnkgKz0gdGhpcy52ZWxvY2l0eS55O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDkvY3nva7jg7vpgJ/luqbjgpLjg5Xjg6rjg4Pjgq/liY3jgavmiLvjgZlcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBjYW5jZWwoKSB7XG4gICAgdGhpcy50YXJnZXQueCA9IHRoaXMuaW5pdGlhbFBvc2l0aW9uLng7XG4gICAgdGhpcy50YXJnZXQueSA9IHRoaXMuaW5pdGlhbFBvc2l0aW9uLnk7XG4gICAgdGhpcy52ZWxvY2l0eS5zZXQoMCwgMCk7XG5cbiAgICAvLyBUT0RPOiBcbiAgICAvLyB0aGlzLnNldEludGVyYWN0aXZlKGZhbHNlKTtcbiAgICAvLyB0aGlzLnR3ZWVuZXIuY2xlYXIoKVxuICAgIC8vICAgICAubW92ZSh0aGlzLmluaXRpYWxYLCB0aGlzLmluaXRpYWxZLCA1MDAsIFwiZWFzZU91dEVsYXN0aWNcIilcbiAgICAvLyAgICAgLmNhbGwoZnVuY3Rpb24gKCkge1xuICAgIC8vICAgICAgICAgdGhpcy5zZXRJbnRlcmFjdGl2ZSh0cnVlKTtcbiAgICAvLyAgICAgICAgIHRoaXMuZmlyZSh0bS5ldmVudC5FdmVudChcImJhY2tlbmRcIikpO1xuICAgIC8vICAgICB9LmJpbmQodGhpcykpO1xuICB9XG5cbiAgLyoqXG4gICAqIOODleODquODg+OCr+WPr+iDveOBq+OBmeOCi1xuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIGVuYWJsZSgpIHtcbiAgICB0aGlzLl9lbmFibGUgPSB0cnVlO1xuICB9XG5cbn1cblxuLy8gVE9ETzogRWxlbWVudOWBtOOBp+WRvOOBtu+8n1xuLy8gcGhpbmEuYXBwLkVsZW1lbnQucHJvdG90eXBlLmdldHRlcignZmxpY2thYmxlJywgZnVuY3Rpb24oKSB7XG4vLyAgIGlmICghdGhpcy5fZmxpY2thYmxlKSB7XG4vLyAgICAgdGhpcy5fZmxpY2thYmxlID0gcGhpbmEuYWNjZXNzb3J5LkZsaWNrYWJsZSgpLmF0dGFjaFRvKHRoaXMpO1xuLy8gICB9XG4vLyAgIHJldHVybiB0aGlzLl9mbGlja2FibGU7XG4vLyB9KTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBwb3NpdGlvbjogaW1wb3J0KFwiLi4vZ2VvbS92ZWN0b3IyXCIpLlByaW1pdGl2ZVZlY3RvcjJcbiAqIH0gJiBpbXBvcnQoXCIuL2FjY2Vzc29yeVwiKS5BY2Nlc3NvcnlBdHRhY2hhYmxlIH0gUGh5c2ljYWxUYXJnZXRcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5hY2Nlc3NvcnkuUGh5c2ljYWxcbiAqIOacrOeJqeOBp+OBr+OBquOBhOOBruOBp+WQjeWJjeWkieOBiOOCi+OBi+OCglxuICogRmFrZVBoeXNpY2FsIG9yIE1hcmlvUGh5c2ljYWwgb3IgTGllUGh5c2ljYWxcbiAqIFJldHJvUHlzaWNhbCBvciBQeXNpY2FMaWtlXG4gKiBfZXh0ZW5kcyBwaGluYS5hY2Nlc3NvcnkuQWNjZXNzb3J5XG4gKi9cbmNsYXNzIFBoeXNpY2FsIGV4dGVuZHMgQWNjZXNzb3J5ICB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge1BoeXNpY2FsVGFyZ2V0fSB0YXJnZXRcbiAgICovXG4gIGNvbnN0cnVjdG9yKHRhcmdldCkge1xuICAgIHN1cGVyKHRhcmdldCk7XG5cbiAgICAvKipcbiAgICAgKiDjgYvjgYvjgaPjgabjgYTjgovlipvjga7jg5njgq/jg4jjg6tcbiAgICAgKi9cbiAgICB0aGlzLnZlbG9jaXR5ID0gbmV3IFZlY3RvcjIoMCwgMCk7XG5cbiAgICAvKipcbiAgICAgKiDph43lipvjg5njgq/jg4jjg6tcbiAgICAgKi9cbiAgICB0aGlzLmdyYXZpdHkgPSBuZXcgVmVjdG9yMigwLCAwKTtcblxuICAgIC8qKlxuICAgICAqIOaRqeaTpuWApFxuICAgICAqIEBkZWZhdWx0IDEuMFxuICAgICAqL1xuICAgIHRoaXMuZnJpY3Rpb24gPSAxLjA7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw6Zai5pWwXG4gICAqIEBwYXJhbSB7Kn0gX2FwcCBBcHDjgq/jg6njgrnjgqTjg7Pjgrnjgr/jg7PjgrlcbiAgICovXG4gIHVwZGF0ZShfYXBwKSB7XG4gICAgdmFyIHQgPSAvKiogQHR5cGUge1BoeXNpY2FsVGFyZ2V0fSAqLyh0aGlzLnRhcmdldCk7XG5cbiAgICB0aGlzLnZlbG9jaXR5LnggKj0gdGhpcy5mcmljdGlvbjtcbiAgICB0aGlzLnZlbG9jaXR5LnkgKj0gdGhpcy5mcmljdGlvbjtcblxuICAgIHRoaXMudmVsb2NpdHkueCArPSB0aGlzLmdyYXZpdHkueDtcbiAgICB0aGlzLnZlbG9jaXR5LnkgKz0gdGhpcy5ncmF2aXR5Lnk7XG5cbiAgICB0LnBvc2l0aW9uLnggKz0gdGhpcy52ZWxvY2l0eS54O1xuICAgIHQucG9zaXRpb24ueSArPSB0aGlzLnZlbG9jaXR5Lnk7XG4gIH1cblxuICAvKipcbiAgICog5Yqb44OZ44Kv44OI44Or44KS44K744OD44OIXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZm9yY2UoeCwgeSkge1xuICAgIHRoaXMudmVsb2NpdHkuc2V0KHgsIHkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOWKm+ODmeOCr+ODiOODq+OBq+WApOOCkuWKoOeul1xuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIGFkZEZvcmNlKHgsIHkpIHtcbiAgICB0aGlzLnZlbG9jaXR5LnggKz0geDtcbiAgICB0aGlzLnZlbG9jaXR5LnkgKz0geTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDph43lipvjg5njgq/jg4jjg6vjgpLjgrvjg4Pjg4hcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRHcmF2aXR5KHgsIHkpIHtcbiAgICB0aGlzLmdyYXZpdHkuc2V0KHgsIHkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOaRqeaTpuWApOOCkuOCu+ODg+ODiFxuICAgKiBAcGFyYW0ge251bWJlcn0gZnJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRGcmljdGlvbihmcikge1xuICAgIHRoaXMuZnJpY3Rpb24gPSBmcjtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxufVxuXG4vLyBwaGluYS5hcHAuRWxlbWVudC5wcm90b3R5cGUuZ2V0dGVyKCdwaHlzaWNhbCcsIGZ1bmN0aW9uKCkge1xuLy8gICBpZiAoIXRoaXMuX3BoeXNpY2FsKSB7XG4vLyAgICAgdGhpcy5fcGh5c2ljYWwgPSBwaGluYS5hY2Nlc3NvcnkuUGh5c2ljYWwoKS5hdHRhY2hUbyh0aGlzKTtcbi8vICAgfVxuLy8gICByZXR1cm4gdGhpcy5fcGh5c2ljYWw7XG4vLyB9KTtcblxuLyoqIEB0eXBlZGVmIHtzdHJpbmcgfCBpbXBvcnQoXCIuL2ZpbGVcIikuRmlsZUFzc2V0TG9hZFBhcmFtIHwgYW55fSBBc3NldFNyYyDln7rmnKznmoTjgavjga/mloflrZfliJfjgaDjgYxBc3NldOeorumhnuOBq+OCiOOBo+OBpuWkieOCj+OCiyAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5hc3NldC5Bc3NldFxuICogX2V4dGVuZHMgcGhpbmEudXRpbC5FdmVudERpc3BhdGNoZXJcbiAqL1xuY2xhc3MgQXNzZXQgZXh0ZW5kcyBFdmVudERpc3BhdGNoZXIge1xuXG4gIC8vIHNlcnZlckVycm9yOiBmYWxzZSxcbiAgLy8gbm90Rm91bmQ6IGZhbHNlLFxuICAvLyBsb2FkRXJyb3I6IGZhbHNlLFxuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLmxvYWRlZCA9IGZhbHNlO1xuICAgIHRoaXMuc2VydmVyRXJyb3IgPSBmYWxzZTtcbiAgICB0aGlzLm5vdEZvdW5kID0gZmFsc2U7XG4gICAgdGhpcy5sb2FkRXJyb3IgPSBmYWxzZTtcblxuICAgIC8qKiBAdHlwZSB7QXNzZXRTcmN9ICovXG4gICAgdGhpcy5zcmMgPSB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtBc3NldFNyY30gc3JjXG4gICAqIEByZXR1cm5zIHtGbG93fVxuICAgKi9cbiAgbG9hZChzcmMpIHtcbiAgICB0aGlzLnNyYyA9IHNyYztcbiAgICByZXR1cm4gbmV3IEZsb3codGhpcy5fbG9hZC5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDjg63jg7zjg4nmuIjjgb/jgYvjganjgYbjgYtcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBpc0xvYWRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5sb2FkZWQ7XG4gIH1cblxuICAvKipcbiAgICog44Ki44K744OD44OI56iu6aGe44Gr5b+c44GY44Gm44K144OW44Kv44Op44K544Gn44Kq44O844OQ44O844Op44Kk44OJXG4gICAqIEBwcm90ZWN0ZWRcbiAgICogQHBhcmFtIHsoLi4uYXJnczogYW55KSA9PiBhbnl9IHJlc29sdmVcbiAgICovXG4gIF9sb2FkKHJlc29sdmUpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYubG9hZGVkID0gdHJ1ZTtcbiAgICAgIHJlc29sdmUoKTtcbiAgICB9LCAxMDApO1xuICB9XG5cbiAgLyoqXG4gICAqIEB2aXJ0dWFsXG4gICAqIOODreODvOODieWkseaVl+aZguOBq+ODgOODn+ODvOOCkuOCu+ODg+ODiOOBmeOCi1xuICAgKi9cbiAgbG9hZER1bW15KCkgeyB9XG5cbn1cblxudmFyIGdldEZpcnN0ID0gZnVuY3Rpb24oYXJyYXkpIHsgcmV0dXJuIGZpcnN0LmdldC5jYWxsKGFycmF5KTsgfTtcbnZhciBnZXRMYXN0ID0gZnVuY3Rpb24oYXJyYXkpIHsgcmV0dXJuIGxhc3QuZ2V0LmNhbGwoYXJyYXkpOyB9O1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5hc3NldC5UZXh0dXJlXG4gKiBfZXh0ZW5kcyBwaGluYS5hc3NldC5Bc3NldFxuICovXG5jbGFzcyBUZXh0dXJlIGV4dGVuZHMgQXNzZXQge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvKiogQHR5cGUge0hUTUxJbWFnZUVsZW1lbnR8SFRNTENhbnZhc0VsZW1lbnR9ICovXG4gICAgdGhpcy5kb21FbGVtZW50ID0gbmV3IEltYWdlKCk7XG4gICAgXG4gICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovXG4gICAgdGhpcy5zcmM7XG4gIH1cblxuICAvKipcbiAgICogQHByb3RlY3RlZFxuICAgKiBAb3ZlcnJpZGVcbiAgICogQHBhcmFtIHsoLi4uYXJnczogYW55KSA9PiBhbnl9IHJlc29sdmVcbiAgICovXG4gIF9sb2FkKHJlc29sdmUpIHtcbiAgICB0aGlzLmRvbUVsZW1lbnQgPSBuZXcgSW1hZ2UoKTtcblxuICAgIHZhciBpc0xvY2FsID0gKGxvY2F0aW9uLnByb3RvY29sID09ICdmaWxlOicpO1xuICAgIGlmICggIWlzTG9jYWwgJiYgISgvXmRhdGE6Ly50ZXN0KHRoaXMuc3JjKSkgKSA7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5kb21FbGVtZW50Lm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHNlbGYubG9hZGVkID0gdHJ1ZTtcbiAgICAgIHJlc29sdmUoc2VsZik7XG4gICAgfTtcbiAgICAvKiogQHBhcmFtIHtFdmVudH0gZSAqL1xuICAgIHRoaXMuZG9tRWxlbWVudC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xuICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQuY2FsbChcIltwaGluYS5qc10gbm90IGZvdW5kIGB7MH1gIVwiLCB0aGlzLnNyYykpO1xuICAgICAgLy8gY29uc29sZS5lcnJvcihcIltwaGluYS5qc10gbm90IGZvdW5kIGB7MH1gIVwiLmZvcm1hdCh0aGlzLnNyYykpO1xuXG4gICAgICAvLyB2YXIga2V5ID0gc2VsZi5zcmMuc3BsaXQoJy8nKS5sYXN0LnJlcGxhY2UoJy5wbmcnLCAnJykuc3BsaXQoJz8nKS5maXJzdC5zcGxpdCgnIycpLmZpcnN0O1xuICAgICAgdmFyIGtleSA9IGdldEZpcnN0KFxuICAgICAgICBnZXRGaXJzdChcbiAgICAgICAgICBnZXRMYXN0KFxuICAgICAgICAgICAgc2VsZi5zcmMuc3BsaXQoJy8nKVxuICAgICAgICAgICkucmVwbGFjZSgnLnBuZycsICcnKS5zcGxpdCgnPycpXG4gICAgICAgICkuc3BsaXQoJyMnKVxuICAgICAgKTtcblxuICAgICAgLy8g5Z6L44Ki44K144O844K344On44OzXG4gICAgICB2YXIgdGFyZ2V0ID0gLyoqIEB0eXBlIHtIVE1MSW1hZ2VFbGVtZW50fSAqLyAoZS50YXJnZXQpO1xuICAgICAgdGFyZ2V0Lm9uZXJyb3IgPSBudWxsO1xuICAgICAgdGFyZ2V0LnNyYyA9IFwiaHR0cDovL2R1bW15aW1hZ2UuY29tLzEyOHgxMjgvNDQ0NDQ0L2VlZWVlZSZ0ZXh0PVwiICsga2V5O1xuICAgIH07XG5cbiAgICB0aGlzLmRvbUVsZW1lbnQuc3JjID0gdGhpcy5zcmM7XG4gIH1cblxuICAvKipcbiAgICog5paw44Gf44GrVGV4dHVyZeOCkuOCr+ODreODvOODs+eUn+aIkOOBl+OBpui/lOOBmVxuICAgKiBAcmV0dXJucyB7VGV4dHVyZX1cbiAgICovXG4gIGNsb25lKCkge1xuICAgIHZhciBpbWFnZSA9IHRoaXMuZG9tRWxlbWVudDtcbiAgICB2YXIgY2FudmFzID0gbmV3IENhbnZhcygpLnNldFNpemUoaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7XG4gICAgdmFyIHQgPSBuZXcgVGV4dHVyZSgpO1xuICAgIGNhbnZhcy5jb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7XG4gICAgdC5kb21FbGVtZW50ID0gY2FudmFzLmRvbUVsZW1lbnQ7XG4gICAgcmV0dXJuIHQ7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHt7IHI6IG51bWJlcjsgZzogbnVtYmVyOyBiOiBudW1iZXI7IH19IFtjb2xvcl1cbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICB0cmFuc21pdChjb2xvcikge1xuICAgIC8vIGltYWdh44Kq44OW44K444Kn44Kv44OI44KS44Ky44OD44OIXG4gICAgdmFyIGltYWdlID0gdGhpcy5kb21FbGVtZW50O1xuICAgIC8vIOaWsOimj2NhbnZhc+S9nOaIkFxuICAgIHZhciBjYW52YXMgPSBuZXcgQ2FudmFzKCkuc2V0U2l6ZShpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0KTtcbiAgICAvLyDmlrDopo9jYW52YXPjgavmj4/nlLtcbiAgICBjYW52YXMuY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDApO1xuICAgIC8vIGNhbnZhc+WFqOS9k+OBruOCpOODoeODvOOCuOODh+ODvOOCv+mFjeWIl+OCkuOCsuODg+ODiFxuICAgIHZhciBpbWFnZURhdGEgPSBjYW52YXMuY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICB2YXIgZGF0YSA9IGltYWdlRGF0YS5kYXRhO1xuICAgIC8vIOmAj+mBjuiJsuOBruaMh+WumuOBjOOBquOBkeOCjOOBsOW3puS4iuOBrnJnYuWApOOCkuaKveWHulxuICAgIHZhciByID0gKGNvbG9yICE9PSB1bmRlZmluZWQpID8gY29sb3IuciA6IGRhdGFbMF07XG4gICAgdmFyIGcgPSAoY29sb3IgIT09IHVuZGVmaW5lZCkgPyBjb2xvci5nIDogZGF0YVsxXTtcbiAgICB2YXIgYiA9IChjb2xvciAhPT0gdW5kZWZpbmVkKSA/IGNvbG9yLmIgOiBkYXRhWzJdO1xuICAgIC8vIOmFjeWIl+OCkjTopoHntKDnm67jgYvjgok044Gk6aOb44Gz77yI44Ki44Or44OV44Kh5YCk77yJ44Gn44Or44O844OXXG4gICAgLy8gKDMpLnN0ZXAoZGF0YS5sZW5ndGgsIDQsIGZ1bmN0aW9uKGkpIHtcbiAgICBzdGVwLmNhbGwoMywgZGF0YS5sZW5ndGgsIDQsIGZ1bmN0aW9uKGkpIHtcbiAgICAgIC8vIHJnYuWApOOCkumAhueul+OBp+OCsuODg+ODiOOBl+OAgeW3puS4iuOBrnJnYuOBqOavlOi8g1xuICAgICAgaWYgKGRhdGFbaSAtIDNdID09PSByICYmIGRhdGFbaSAtIDJdID09PSBnICYmIGRhdGFbaSAtIDFdID09PSBiKSB7XG4gICAgICAgIC8vIOS4gOiHtOOBl+OBn+WgtOWQiOOBr+OCouODq+ODleOCoeWApOOCkuabuOOBjeaPm+OBiOOCi1xuICAgICAgICBkYXRhW2ldID0gMDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvLyDmm7jjgY3mj5vjgYjjgZ/jgqTjg6Hjg7zjgrjjg4fjg7zjgr/jgpJjYW52YXPjgavmiLvjgZlcbiAgICBjYW52YXMuY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcblxuICAgIHRoaXMuZG9tRWxlbWVudCA9IGNhbnZhcy5kb21FbGVtZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHsocGl4ZWw6IFVpbnQ4Q2xhbXBlZEFycmF5LCBpbmRleDogbnVtYmVyLCB4OiBudW1iZXIsIHk6IG51bWJlciwgaW1hZ2VEYXRhOiBJbWFnZURhdGEgKT0+IHZvaWR9IEZpbHRlckZ1bmNcbiAgICogQHBhcmFtIHtGaWx0ZXJGdW5jIHwgRmlsdGVyRnVuY1tdfSBmaWx0ZXJzXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZmlsdGVyKGZpbHRlcnMpIHtcbiAgICBpZiAoIWZpbHRlcnMpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoZmlsdGVycykpIHtcbiAgICAgIGZpbHRlcnMgPSBbZmlsdGVyc107XG4gICAgfVxuICAgIHZhciBpbWFnZSA9IHRoaXMuZG9tRWxlbWVudDtcbiAgICB2YXIgdyA9IGltYWdlLndpZHRoO1xuICAgIHZhciBoID0gaW1hZ2UuaGVpZ2h0O1xuICAgIHZhciBjYW52YXMgPSBuZXcgQ2FudmFzKCkuc2V0U2l6ZSh3LCBoKTtcblxuICAgIC8qKiBAdHlwZSB7SW1hZ2VEYXRhfSAqL1xuICAgIHZhciBpbWFnZURhdGEgPSBudWxsO1xuXG4gICAgY2FudmFzLmNvbnRleHQuZHJhd0ltYWdlKGltYWdlLCAwLCAwKTtcbiAgICBpbWFnZURhdGEgPSBjYW52YXMuY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgdywgaCk7XG4gICAgZmlsdGVycy5mb3JFYWNoKCBmdW5jdGlvbiAoZm4pIHtcbiAgICAgIGlmICh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBoLnRpbWVzKCBmdW5jdGlvbiAoeSkge1xuICAgICAgICB0aW1lcy5jYWxsKGgsIGZ1bmN0aW9uICh5KSB7XG4gICAgICAgICAgLy8gdy50aW1lcyggZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICB0aW1lcy5jYWxsKHcsIGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICB2YXIgaSA9ICh5ICogdyArIHgpICogNDtcbiAgICAgICAgICAgIHZhciBwaXhlbCA9IGltYWdlRGF0YS5kYXRhLnNsaWNlKGksIGkgKyA0KTtcbiAgICAgICAgICAgIGZuKHBpeGVsLCBpLCB4LCB5LCBpbWFnZURhdGEpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjYW52YXMuY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcbiAgICB0aGlzLmRvbUVsZW1lbnQgPSBjYW52YXMuZG9tRWxlbWVudDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG59XG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFzc2V0LlNvdW5kXG4gKiBfZXh0ZW5kcyBwaGluYS5hc3NldC5Bc3NldFxuICovXG5jbGFzcyBTb3VuZCBleHRlbmRzIEFzc2V0IHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX2xvb3AgPSBmYWxzZTtcbiAgICB0aGlzLl9sb29wU3RhcnQgPSAwO1xuICAgIHRoaXMuX2xvb3BFbmQgPSAwO1xuICAgIHRoaXMuX3BsYXliYWNrUmF0ZSA9IDE7XG4gICAgdGhpcy5jb250ZXh0ID0gU291bmQuZ2V0QXVkaW9Db250ZXh0KCk7XG4gICAgdGhpcy5nYWluTm9kZSA9IHRoaXMuY29udGV4dC5jcmVhdGVHYWluKCk7XG5cbiAgICAvKiogQHR5cGUgeyhBdWRpb0J1ZmZlclNvdXJjZU5vZGUgfCBPc2NpbGxhdG9yTm9kZSk/fSAqL1xuICAgIHRoaXMuc291cmNlO1xuXG4gICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovXG4gICAgdGhpcy5zcmM7XG4gIH1cblxuICAvKipcbiAgICog6Z+z5rqQ44KS5YaN55SfXG4gICAqIOmfs+a6kOe1guS6huaZguOBq1wiZW5kZWRcIuOCpOODmeODs+ODiOOCkueZuueUn1xuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ9IFt3aGVuPTBdIOaMh+WumuOBruenkuaVsOOAgeWGjeeUn+OCkumBheOCieOBm+OCi1xuICAgKiBAcGFyYW0ge251bWJlcn0gW29mZnNldD0wXSDpn7PmupDjga7jganjga7mmYLplpPkvY3nva7jgaflho3nlJ/jgZnjgovjgYvjgpLnp5LmlbDmjIflrppcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtkdXJhdGlvbl0g5YaN55Sf5pmC6ZaT44KS56eS5pWw5oyH5a6aXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgcGxheSh3aGVuLCBvZmZzZXQsIGR1cmF0aW9uKSB7XG4gICAgd2hlbiA9IHdoZW4gPyB3aGVuICsgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lIDogMDtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgIGlmICh0aGlzLnNvdXJjZSkgO1xuXG4gICAgdmFyIHNvdXJjZSA9IHRoaXMuc291cmNlID0gdGhpcy5jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgIHZhciBidWZmZXIgPSBzb3VyY2UuYnVmZmVyID0gdGhpcy5idWZmZXI7XG4gICAgc291cmNlLmxvb3AgPSB0aGlzLl9sb29wO1xuICAgIHNvdXJjZS5sb29wU3RhcnQgPSB0aGlzLl9sb29wU3RhcnQ7XG4gICAgc291cmNlLmxvb3BFbmQgPSB0aGlzLl9sb29wRW5kO1xuICAgIHNvdXJjZS5wbGF5YmFja1JhdGUudmFsdWUgPSB0aGlzLl9wbGF5YmFja1JhdGU7XG5cbiAgICAvLyBjb25uZWN0XG4gICAgc291cmNlLmNvbm5lY3QodGhpcy5nYWluTm9kZSk7XG4gICAgdGhpcy5nYWluTm9kZS5jb25uZWN0KFNvdW5kLmdldE1hc3RlckdhaW4oKSk7XG5cbiAgICAvLyBwbGF5XG4gICAgaWYgKGR1cmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNvdXJjZS5zdGFydCh3aGVuLCBvZmZzZXQsIGR1cmF0aW9uKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBzb3VyY2Uuc3RhcnQod2hlbiwgb2Zmc2V0KTtcbiAgICB9XG5cbiAgICAvLyBjaGVjayBwbGF5IGVuZFxuICAgIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKCdlbmRlZCcsIGZ1bmN0aW9uKCl7XG4gICAgICB0aGlzLmZsYXJlKCdlbmRlZCcpO1xuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDlho3nlJ/jgpLlgZzmraLvvIjlho3nlJ/kuK3jgafjgarjgYvjgaPjgZ/mmYLjga/kvZXjgoLjgZfjgarjgYTvvIkgIFxuICAgKiDlho3nlJ/kuK3jgaDjgaPjgZ/loLTlkIjjgIHlkIzmmYLjgatcInN0b3BcIiwgXCJlbmRlZFwi44Kk44OZ44Oz44OI44KS55m654Gr44GZ44KLXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuc291cmNlKSB7XG4gICAgICAvLyBzdG9wIOOBmeOCi+OBqCBzb3VyY2UuZW5kZWTjgoLnmbrngavjgZnjgotcbiAgICAgIHRoaXMuc291cmNlLnN0b3AgJiYgdGhpcy5zb3VyY2Uuc3RvcCgwKTtcbiAgICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICAgIHRoaXMuZmxhcmUoJ3N0b3AnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDlho3nlJ/jgpLkuIDmmYLlgZzmraJcbiAgICog5ZCM5pmC44GrXCJwYXVzZVwi44Kk44OZ44Oz44OI44KS55m654Gr44GZ44KLXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHBhdXNlKCkge1xuICAgIC8qKiBAdHlwZSB7QXVkaW9CdWZmZXJTb3VyY2VOb2RlfSAqL1xuICAgICh0aGlzLnNvdXJjZSkucGxheWJhY2tSYXRlLnZhbHVlID0gMDtcbiAgICB0aGlzLmZsYXJlKCdwYXVzZScpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOWGjeeUn+OCkuWGjemWi1xuICAgKiDlkIzmmYLjgatcInJlc3VtZVwi44Kk44OZ44Oz44OI44KS55m654Gr44GZ44KLXG4gICAqIFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHJlc3VtZSgpIHtcbiAgICAvKiogQHR5cGUge0F1ZGlvQnVmZmVyU291cmNlTm9kZX0gKi9cbiAgICAodGhpcy5zb3VyY2UpLnBsYXliYWNrUmF0ZS52YWx1ZSA9IHRoaXMuX3BsYXliYWNrUmF0ZTtcbiAgICB0aGlzLmZsYXJlKCdyZXN1bWUnKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiDmnKrlrp/oo4VcbiAgICogXG4gICAqIEBwYXJhbSB7Kn0gdHlwZSBcbiAgICovXG4gIF9vc2NpbGxhdG9yKHR5cGUpIHtcbiAgICB2YXIgY29udGV4dCA9IHRoaXMuY29udGV4dDtcblxuICAgIHZhciBvc2NpbGxhdG9yID0gY29udGV4dC5jcmVhdGVPc2NpbGxhdG9yKCk7XG5cbiAgICAvLyBTaW5lIHdhdmUgaXMgdHlwZSA9IOKAnHNpbmXigJ1cbiAgICAvLyBTcXVhcmUgd2F2ZSBpcyB0eXBlID0g4oCcc3F1YXJl4oCdXG4gICAgLy8gU2F3dG9vdGggd2F2ZSBpcyB0eXBlID0g4oCcc2F34oCdXG4gICAgLy8gVHJpYW5nbGUgd2F2ZSBpcyB0eXBlID0g4oCcdHJpYW5nbGXigJ1cbiAgICAvLyBDdXN0b20gd2F2ZSBpcyB0eXBlID0g4oCcY3VzdG9t4oCdIFxuICAgIG9zY2lsbGF0b3IudHlwZSA9IHR5cGUgfHwgJ3NpbmUnO1xuXG4gICAgdGhpcy5zb3VyY2UgPSBvc2NpbGxhdG9yO1xuICAgIC8vIGNvbm5lY3RcbiAgICB0aGlzLnNvdXJjZS5jb25uZWN0KGNvbnRleHQuZGVzdGluYXRpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIEF1ZGlvQnVmZmVy44GL44KJ44Ot44O844OJXG4gICAqIFxuICAgKiBAcGFyYW0ge0F1ZGlvQnVmZmVyfSBbYnVmZmVyXSBcbiAgICovXG4gIGxvYWRGcm9tQnVmZmVyKGJ1ZmZlcikge1xuICAgIHZhciBjb250ZXh0ID0gdGhpcy5jb250ZXh0O1xuXG4gICAgLy8gc2V0IGRlZmF1bHQgYnVmZmVyXG4gICAgaWYgKCFidWZmZXIpIHtcbiAgICAgIGJ1ZmZlciA9IGNvbnRleHQuY3JlYXRlQnVmZmVyKCAxLCA0NDEwMCwgNDQxMDAgKTtcbiAgICAgIHZhciBjaGFubmVsID0gYnVmZmVyLmdldENoYW5uZWxEYXRhKDApO1xuXG4gICAgICBmb3IoIHZhciBpPTA7IGkgPCBjaGFubmVsLmxlbmd0aDsgaSsrIClcbiAgICAgIHtcbiAgICAgICAgY2hhbm5lbFtpXSA9IE1hdGguc2luKCBpIC8gMTAwICogTWF0aC5QSSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gc291cmNlXG4gICAgdGhpcy5idWZmZXIgPSBidWZmZXI7XG4gIH1cblxuICAvKipcbiAgICog44Or44O844OX6Kit5a6aXG4gICAqIFxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGxvb3BcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRMb29wKGxvb3ApIHtcbiAgICB0aGlzLmxvb3AgPSBsb29wO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOODq+ODvOODl+mWi+Wni+S9jee9ruOCkuenkuaVsOOBp+ioreWumlxuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ9IGxvb3BTdGFydFxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldExvb3BTdGFydChsb29wU3RhcnQpIHtcbiAgICB0aGlzLmxvb3BTdGFydCA9IGxvb3BTdGFydDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDjg6vjg7zjg5fntYLkuobkvY3nva7jgpLnp5LmlbDjgafoqK3lrppcbiAgICogXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsb29wRW5kXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0TG9vcEVuZChsb29wRW5kKSB7XG4gICAgdGhpcy5sb29wRW5kID0gbG9vcEVuZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgLyoqXG4gICAqIOWGjeeUn+mAn+W6puOCkuioreWumlxuICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9BdWRpb0J1ZmZlclNvdXJjZU5vZGUvcGxheWJhY2tSYXRlXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gcGxheWJhY2tSYXRlXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0UGxheWJhY2tSYXRlKHBsYXliYWNrUmF0ZSkge1xuICAgIHRoaXMucGxheWJhY2tSYXRlID0gcGxheWJhY2tSYXRlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKiBAcGFyYW0geyguLi5hcmdzOiBhbnkpID0+IGFueX0gclxuICAgKi9cbiAgX2xvYWQocikge1xuICAgIGlmICgvXmRhdGE6Ly50ZXN0KHRoaXMuc3JjKSkge1xuICAgICAgdGhpcy5fbG9hZEZyb21VUklTY2hlbWUocik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5fbG9hZEZyb21GaWxlKHIpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0geyguLi5hcmdzOiBhbnkpID0+IGFueX0gclxuICAgKi9cbiAgX2xvYWRGcm9tRmlsZShyKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdmFyIHhtbCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHhtbC5vcGVuKCdHRVQnLCB0aGlzLnNyYyk7XG4gICAgeG1sLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHhtbC5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgIGlmIChbMjAwLCAyMDEsIDBdLmluZGV4T2YoeG1sLnN0YXR1cykgIT09IC0xKSB7XG5cbiAgICAgICAgICAvLyDpn7Pmpb3jg5DjgqTjg4rjg6rjg7zjg4fjg7zjgr9cbiAgICAgICAgICB2YXIgZGF0YSA9IHhtbC5yZXNwb25zZTtcblxuICAgICAgICAgIC8vIHdlYmF1ZGlvIOeUqOOBq+WkieaPm1xuICAgICAgICAgIHNlbGYuY29udGV4dC5kZWNvZGVBdWRpb0RhdGEoZGF0YSwgZnVuY3Rpb24oYnVmZmVyKSB7XG4gICAgICAgICAgICBzZWxmLmxvYWRGcm9tQnVmZmVyKGJ1ZmZlcik7XG4gICAgICAgICAgICByKHNlbGYpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwi6Z+z5aOw44OV44Kh44Kk44Or44Gu44OH44Kz44O844OJ44Gr5aSx5pWX44GX44G+44GX44Gf44CCKFwiICsgc2VsZi5zcmMgKyBcIilcIik7XG4gICAgICAgICAgICByKHNlbGYpO1xuICAgICAgICAgICAgc2VsZi5mbGFyZSgnZGVjb2RlZXJyb3InKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICB9IGVsc2UgaWYgKHhtbC5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICAgIC8vIG5vdCBmb3VuZFxuXG4gICAgICAgICAgc2VsZi5sb2FkRXJyb3IgPSB0cnVlO1xuICAgICAgICAgIHNlbGYubm90Rm91bmQ9IHRydWU7XG4gICAgICAgICAgcihzZWxmKTtcbiAgICAgICAgICBzZWxmLmZsYXJlKCdsb2FkZXJyb3InKTtcbiAgICAgICAgICBzZWxmLmZsYXJlKCdub3Rmb3VuZCcpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8g44K144O844OQ44O844Ko44Op44O8XG5cbiAgICAgICAgICBzZWxmLmxvYWRFcnJvciA9IHRydWU7XG4gICAgICAgICAgc2VsZi5zZXJ2ZXJFcnJvciA9IHRydWU7XG4gICAgICAgICAgcihzZWxmKTtcbiAgICAgICAgICBzZWxmLmZsYXJlKCdsb2FkZXJyb3InKTtcbiAgICAgICAgICBzZWxmLmZsYXJlKCdzZXJ2ZXJlcnJvcicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHhtbC5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuXG4gICAgeG1sLnNlbmQobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHsoLi4uYXJnczogYW55KSA9PiBhbnl9IHJcbiAgICovXG4gIF9sb2FkRnJvbVVSSVNjaGVtZShyKSB7XG4gICAgdmFyIGJ5dGVTdHJpbmcgPSAnJztcbiAgICBpZiAodGhpcy5zcmMuc3BsaXQoJywnKVswXS5pbmRleE9mKCdiYXNlNjQnKSA+PSAwKSB7XG4gICAgICBieXRlU3RyaW5nID0gYXRvYih0aGlzLnNyYy5zcGxpdCgnLCcpWzFdKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBieXRlU3RyaW5nID0gdW5lc2NhcGUodGhpcy5zcmMuc3BsaXQoJywnKVsxXSk7XG4gICAgfVxuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBsZW4gPSBieXRlU3RyaW5nLmxlbmd0aDtcbiAgICB2YXIgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkobGVuKTtcblxuICAgIGZvciAodmFyIGk9MDsgaTxsZW47ICsraSkge1xuICAgICAgYnVmZmVyW2ldID0gYnl0ZVN0cmluZy5jaGFyQ29kZUF0KGkpO1xuICAgIH1cblxuICAgIC8vIHdlYmF1ZGlvIOeUqOOBq+WkieaPm1xuICAgIHRoaXMuY29udGV4dC5kZWNvZGVBdWRpb0RhdGEoYnVmZmVyLmJ1ZmZlciwgZnVuY3Rpb24oYnVmZmVyKSB7XG4gICAgICBzZWxmLmxvYWRGcm9tQnVmZmVyKGJ1ZmZlcik7XG4gICAgICByKHNlbGYpO1xuICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgY29uc29sZS53YXJuKFwi6Z+z5aOw44OV44Kh44Kk44Or44Gu44OH44Kz44O844OJ44Gr5aSx5pWX44GX44G+44GX44Gf44CCKFwiICsgc2VsZi5zcmMgKyBcIilcIik7XG4gICAgICBzZWxmLmxvYWRlZCA9IHRydWU7XG4gICAgICByKHNlbGYpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKiDjg4Djg5/jg7zjg5Djg4Pjg5XjgqHjgpLjg63jg7zjg4lcbiAgICovXG4gIGxvYWREdW1teSgpIHtcbiAgICB0aGlzLmxvYWRGcm9tQnVmZmVyKCk7XG4gIH1cblxuICAvKipcbiAgICog6Z+z6YePXG4gICAqL1xuICBnZXQgdm9sdW1lKCkgIHsgcmV0dXJuIHRoaXMuZ2Fpbk5vZGUuZ2Fpbi52YWx1ZTsgfVxuICBzZXQgdm9sdW1lKHYpIHsgdGhpcy5nYWluTm9kZS5nYWluLnZhbHVlID0gdjsgfVxuXG4gIC8qKlxuICAgKiDjg6vjg7zjg5foqK3lrppcbiAgICovXG4gIGdldCBsb29wKCkgIHsgcmV0dXJuIHRoaXMuX2xvb3A7IH1cbiAgc2V0IGxvb3Aodikge1xuICAgIHRoaXMuX2xvb3AgPSB2O1xuICB9XG5cbiAgLyoqXG4gICAqIOODq+ODvOODl+mWi+Wni+aZgumWk+S9jee9rihzZWNvbmQpXG4gICAqL1xuICBnZXQgbG9vcFN0YXJ0KCkgIHsgcmV0dXJuIHRoaXMuX2xvb3BTdGFydDsgfVxuICBzZXQgbG9vcFN0YXJ0KHYpIHtcbiAgICB0aGlzLl9sb29wU3RhcnQgPSB2O1xuICB9XG5cbiAgLyoqXG4gICAqIOODq+ODvOODl+e1guS6huaZgumWk+S9jee9rihzZWNvbmQpXG4gICAqL1xuICBnZXQgbG9vcEVuZCgpICB7IHJldHVybiB0aGlzLl9sb29wRW5kOyB9XG4gIHNldCBsb29wRW5kKHYpIHtcbiAgICB0aGlzLl9sb29wRW5kID0gdjtcbiAgfVxuXG4gIC8qKlxuICAgKiDlho3nlJ/pgJ/luqZcbiAgICovXG4gIGdldCBwbGF5YmFja1JhdGUoKSB7IHJldHVybiB0aGlzLl9wbGF5YmFja1JhdGU7IH1cbiAgc2V0IHBsYXliYWNrUmF0ZSh2KSB7XG4gICAgdGhpcy5fcGxheWJhY2tSYXRlID0gdjtcbiAgICB0aGlzLnNvdXJjZSA9IC8qKiBAdHlwZSB7QXVkaW9CdWZmZXJTb3VyY2VOb2RlfSAqLyh0aGlzLnNvdXJjZSk7XG4gICAgaWYgKHRoaXMuc291cmNlICYmIHRoaXMuc291cmNlLnBsYXliYWNrUmF0ZS52YWx1ZSAhPT0gMCkge1xuICAgICAgdGhpcy5zb3VyY2UucGxheWJhY2tSYXRlLnZhbHVlID0gdjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog44Oe44K544K/44O844Gu44Ky44Kk44Oz44OO44O844OJ44KS6L+U44GX44G+44GZ44CCICBcbiAgICogR2Fpbk5vZGXjgYzmnKrnlJ/miJDjga7loLTlkIjjga/nlJ/miJDjgZfjgabov5TjgZfjgb7jgZnjgIJcbiAgICogQHJldHVybnMge0dhaW5Ob2RlfVxuICAgKi9cbiAgc3RhdGljIGdldE1hc3RlckdhaW4oKSB7XG4gICAgaWYoIXRoaXMuX21hc3RlckdhaW4pIHtcbiAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5nZXRBdWRpb0NvbnRleHQoKTtcbiAgICAgIHRoaXMuX21hc3RlckdhaW4gPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICAgIHRoaXMuX21hc3RlckdhaW4uY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX21hc3RlckdhaW47XG4gIH1cblxuICAvKipcbiAgICogV2ViQXVkaW/jga7jgrPjg7Pjg4bjgq3jgrnjg4jjgpLnlJ/miJDjgZfjgabov5TjgZfjgb7jgZnjgIIgIFxuICAgKiDjgZnjgafjgavnlJ/miJDmuIjjgb/jga7loLTlkIjjga/jgZ3jgozjgpLov5TjgZfjgb7jgZnjgIIgIFxuICAgKiBXZWJBdWRpb+acquOCteODneODvOODiOOBruWgtOWQiOOBr251bGzjgpLov5TjgZfjgb7jgZnjgIJcbiAgICogQHJldHVybnMge0F1ZGlvQ29udGV4dCB8IG51bGx9XG4gICAqL1xuICBzdGF0aWMgZ2V0QXVkaW9Db250ZXh0KCkge1xuICAgIGlmICghU3VwcG9ydC53ZWJBdWRpbykgcmV0dXJuIG51bGw7XG5cbiAgICBpZiAodGhpcy5jb250ZXh0KSByZXR1cm4gdGhpcy5jb250ZXh0O1xuXG4gICAgdmFyIGcgPSBwaGluYS5nbG9iYWw7XG4gICAgdmFyIGNvbnRleHQgPSBudWxsO1xuXG4gICAgaWYgKGcuQXVkaW9Db250ZXh0KSB7XG4gICAgICBjb250ZXh0ID0gbmV3IEF1ZGlvQ29udGV4dCgpO1xuICAgIH1cbiAgICBlbHNlIGlmIChnWyd3ZWJraXRBdWRpb0NvbnRleHQnXSkge1xuICAgICAgY29udGV4dCA9IG5ldyBnWyd3ZWJraXRBdWRpb0NvbnRleHQnXSgpO1xuICAgIH1cbiAgICBlbHNlIGlmIChnWydtb3pBdWRpb0NvbnRleHQnXSkge1xuICAgICAgY29udGV4dCA9IG5ldyBnWydtb3pBdWRpb0NvbnRleHQnXSgpO1xuICAgIH1cblxuICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG5cbiAgICByZXR1cm4gY29udGV4dDtcbiAgfVxuXG4gIC8qKlxuICAgKiDjg57jgrnjgr/jg7zpn7Pph4/jgpLlj5blvpdcbiAgICovXG4gIHN0YXRpYyBnZXQgdm9sdW1lKCkge1xuICAgIHJldHVybiB0aGlzLmdldE1hc3RlckdhaW4oKS5nYWluLnZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIOODnuOCueOCv+ODvOmfs+mHj+OCkuOCu+ODg+ODiFxuICAgKiBAcGFyYW0ge251bWJlcn0gdlxuICAgKi9cbiAgc3RhdGljIHNldCB2b2x1bWUodikge1xuICAgIHRoaXMuZ2V0TWFzdGVyR2FpbigpLmdhaW4udmFsdWUgPSB2O1xuICB9XG59XG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFzc2V0LlNjcmlwdFxuICogX2V4dGVuZHMgcGhpbmEuYXNzZXQuQXNzZXRcbiAqL1xuY2xhc3MgU2NyaXB0IGV4dGVuZHMgQXNzZXQge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgXG4gICAgLyoqIEB0eXBlIHtzdHJpbmd9ICovXG4gICAgdGhpcy5zcmM7XG4gIH1cblxuICBfbG9hZChyZXNvbHZlKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuZG9tRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgIHRoaXMuZG9tRWxlbWVudC5zcmMgPSB0aGlzLnNyYztcblxuICAgIHRoaXMuZG9tRWxlbWVudC5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJlc29sdmUoc2VsZik7XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmRvbUVsZW1lbnQpO1xuICB9XG5cbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBTcHJpdGVTaGVldEZyYW1lRGF0YVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHgg44OV44Os44O844Og5bem5LiKeOW6p+aomVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHkg44OV44Os44O844Og5bem5LiKeeW6p+aomVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHdpZHRoIOODleODrOODvOODoOaoquW5hVxuICogQHByb3BlcnR5IHtudW1iZXJ9IGhlaWdodCDjg5Xjg6zjg7zjg6DnuKbluYVcbiAqL1xuXG4gLyoqXG4gKiDlkITjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pjga7oqbPntLBcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFNwcml0ZVNoZWV0QW5pbWF0aW9uRGF0YVxuICogQHByb3BlcnR5IHtudW1iZXJbXX0gZnJhbWVzIOODleODrOODvOODoOeVquWPt+mghuOBruaVsOWIlyBleCkgWzAsIDEsIDJdXG4gKiBAcHJvcGVydHkge3N0cmluZyB8IG51bWJlcn0gbmV4dCDnj77jgqLjg4vjg6Hjg7zjgrfjg6fjg7PntYLkuobmmYLjgavnp7vooYzjgZfjgZ/jgYTjgqLjg4vjg6Hjg7zjgrfjg6fjg7PlkI3jgIHjg6vjg7zjg5fjgZXjgZvjgZ/jgYTloLTlkIjjga/lkIzjgZjjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgpLmjIflrppcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmcmVxdWVuY3kg44OV44Os44O844Og5pu05paw6aC75bqm77yI6ZaT6ZqU77yJXG4gKi9cblxuLyoqXG4gKiBTcHJpdGVTaGVldEFuaW1hdGlvbkRhdGHjga7phY3liJfniYhcbiAqIEB0eXBlZGVmIHtbXG4gKiAgIG51bWJlciwgLy8g6ZaL5aeL44OV44Os44O844OgaW5kZXhcbiAqICAgbnVtYmVyLCAvLyDntYLkuobjg5Xjg6zjg7zjg6BpbmRleFxuICogICBzdHJpbmcgfCBudW1iZXIsIC8vIG5leHRcbiAqICAgbnVtYmVyICAvLyBmcmVxdWVuY3lcbiAqIF19IFNwcml0ZVNoZWV0QW5pbWF0aW9uRGF0YUFycmF5XG4gKi9cblxuLyoqXG4gKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pjg4bjg7zjg5bjg6tcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIFtrZXkgaW4gKHN0cmluZyB8IG51bWJlcildOiBTcHJpdGVTaGVldEFuaW1hdGlvbkRhdGFcbiAqIH19IFNwcml0ZVNoZWV0QW5pbWF0aW9uVGFibGVcbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFNwcml0ZVNoZWV0RnJhbWVTZXR1cFBhcmFtXG4gKiBAcHJvcGVydHkge251bWJlcn0gd2lkdGgg77yR44OV44Os44O844Og44Gu5qiq5bmFXG4gKiBAcHJvcGVydHkge251bWJlcn0gaGVpZ2h0IO+8keODleODrOODvOODoOOBrue4puW5hVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHJvd3Mg5qiq44Gu44OV44Os44O844Og5pWwXG4gKiBAcHJvcGVydHkge251bWJlcn0gY29scyDnuKbjga7jg5Xjg6zjg7zjg6DmlbBcbiAqL1xuXG4vKipcbiAqIFNwcml0ZVNoZWV044Kv44Op44K544K744OD44OI44Ki44OD44OX55So44Gu44OH44O844K/44Kq44OW44K444Kn44Kv44OIXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBTcHJpdGVTaGVldFNldHVwUGFyYW1cbiAqIEBwcm9wZXJ0eSB7U3ByaXRlU2hlZXRGcmFtZVNldHVwUGFyYW19IGZyYW1lIOODleODrOODvOODoOOBruOCteOCpOOCuuODu+WIhuWJsuaVsOODh+ODvOOCv1xuICogQHByb3BlcnR5IHt7XG4gKiAgIFtrZXkgaW4gKHN0cmluZyB8IG51bWJlcildOiBTcHJpdGVTaGVldEFuaW1hdGlvbkRhdGEgfCBTcHJpdGVTaGVldEFuaW1hdGlvbkRhdGFBcnJheVxuICogfX0gYW5pbWF0aW9uc1xuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFzc2V0LlNwcml0ZVNoZWV0XG4gKiBfZXh0ZW5kcyBwaGluYS5hc3NldC5Bc3NldFxuICovXG5jbGFzcyBTcHJpdGVTaGVldCBleHRlbmRzIEFzc2V0IHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgLyoqXG4gICAgICoganNvbuODleOCoeOCpOODq+OBuOOBruODkeOCueaWh+Wtl+WIl+OAgeOCguOBl+OBj+OBr2pzb27jg4fjg7zjgr/jgqrjg5bjgrjjgqfjgq/jg4jjgZ3jga7jgoLjga5cbiAgICAgKiBAdHlwZSB7c3RyaW5nIHwgU3ByaXRlU2hlZXRTZXR1cFBhcmFtfVxuICAgICAqL1xuICAgIHRoaXMuc3JjO1xuXG4gICAgLyoqXG4gICAgICog57eP44OV44Os44O844Og5pWwXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLmZyYW1lO1xuXG4gICAgLyoqIEB0eXBlIHtTcHJpdGVTaGVldEZyYW1lRGF0YVtdfSAqL1xuICAgIHRoaXMuZnJhbWVzO1xuXG4gICAgLyoqIEB0eXBlIHtTcHJpdGVTaGVldEFuaW1hdGlvblRhYmxlfSAqL1xuICAgIHRoaXMuYW5pbWF0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge1Nwcml0ZVNoZWV0U2V0dXBQYXJhbX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgc2V0dXAocGFyYW1zKSB7XG4gICAgdGhpcy5fc2V0dXBGcmFtZShwYXJhbXMuZnJhbWUpO1xuICAgIHRoaXMuX3NldHVwQW5pbShwYXJhbXMuYW5pbWF0aW9ucyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqIEBwYXJhbSB7KGFyZzA6IHRoaXMpID0+IHZvaWR9IHJlc29sdmVcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBfbG9hZChyZXNvbHZlKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBpZiAodHlwZW9mIHRoaXMuc3JjID09PSAnc3RyaW5nJykge1xuICAgICAgdmFyIHhtbCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgeG1sLm9wZW4oJ0dFVCcsIHRoaXMuc3JjKTtcbiAgICAgIHhtbC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHhtbC5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgICAgaWYgKFsyMDAsIDIwMSwgMF0uaW5kZXhPZih4bWwuc3RhdHVzKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0geG1sLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgICAgIHZhciBqc29uID0gSlNPTi5wYXJzZShkYXRhKTtcblxuICAgICAgICAgICAgc2VsZi5zZXR1cChqc29uKTtcblxuICAgICAgICAgICAgcmVzb2x2ZShzZWxmKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHhtbC5zZW5kKG51bGwpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuc2V0dXAodGhpcy5zcmMpO1xuICAgICAgcmVzb2x2ZShzZWxmKTtcbiAgICB9XG5cbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge1Nwcml0ZVNoZWV0RnJhbWVTZXR1cFBhcmFtfSBmcmFtZVxuICAgKi9cbiAgX3NldHVwRnJhbWUoZnJhbWUpIHtcbiAgICAvKiogQHR5cGUge1Nwcml0ZVNoZWV0RnJhbWVEYXRhW119ICovXG4gICAgdmFyIGZyYW1lcyA9IHRoaXMuZnJhbWVzID0gW107XG4gICAgdmFyIHVuaXRXaWR0aCA9IGZyYW1lLndpZHRoO1xuICAgIHZhciB1bml0SGVpZ2h0ID0gZnJhbWUuaGVpZ2h0O1xuXG4gICAgdmFyIGNvdW50ID0gZnJhbWUucm93cyAqIGZyYW1lLmNvbHM7XG4gICAgdGhpcy5mcmFtZSA9IGNvdW50O1xuXG4gICAgdGltZXMuY2FsbChjb3VudCwgZnVuY3Rpb24oaSkge1xuICAgIC8vIChjb3VudCkudGltZXMoZnVuY3Rpb24oaSkge1xuICAgICAgdmFyIHhJbmRleCA9IGklZnJhbWUuY29scztcbiAgICAgIHZhciB5SW5kZXggPSAoaS9mcmFtZS5jb2xzKXwwO1xuXG4gICAgICBmcmFtZXMucHVzaCh7XG4gICAgICAgIHg6IHhJbmRleCp1bml0V2lkdGgsXG4gICAgICAgIHk6IHlJbmRleCp1bml0SGVpZ2h0LFxuICAgICAgICB3aWR0aDogdW5pdFdpZHRoLFxuICAgICAgICBoZWlnaHQ6IHVuaXRIZWlnaHQsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge1Nwcml0ZVNoZWV0U2V0dXBQYXJhbVtcImFuaW1hdGlvbnNcIl19IGFuaW1hdGlvbnNcbiAgICovXG4gIF9zZXR1cEFuaW0oYW5pbWF0aW9ucykge1xuICAgIHRoaXMuYW5pbWF0aW9ucyA9IHt9O1xuXG4gICAgLy8g44OH44OV44Kp44Or44OI44Ki44OL44Oh44O844K344On44OzXG4gICAgdGhpcy5hbmltYXRpb25zW1wiZGVmYXVsdFwiXSA9IHtcbiAgICAgICAgZnJhbWVzOiByYW5nZS5jYWxsKFtdLCAwLCB0aGlzLmZyYW1lKSxcbiAgICAgICAgLy8gZnJhbWVzOiBbXS5yYW5nZSgwLCB0aGlzLmZyYW1lKSxcbiAgICAgICAgbmV4dDogXCJkZWZhdWx0XCIsXG4gICAgICAgIGZyZXF1ZW5jeTogMSxcbiAgICB9O1xuXG4gICAgLy8gYW5pbWF0aW9ucy5mb3JJbihcbiAgICBmb3JJbi5jYWxsKGFuaW1hdGlvbnMsIFxuICAgIC8qKlxuICAgICAqIEB0aGlzIHtTcHJpdGVTaGVldH1cbiAgICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlcn0ga2V5XG4gICAgICogQHBhcmFtIHtTcHJpdGVTaGVldEFuaW1hdGlvbkRhdGEgfCBTcHJpdGVTaGVldEFuaW1hdGlvbkRhdGFBcnJheX0gdmFsdWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICB2YXIgYW5pbSA9IHZhbHVlO1xuXG4gICAgICBpZiAoYW5pbSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9uc1trZXldID0ge1xuICAgICAgICAgIGZyYW1lczogcmFuZ2UuY2FsbChbXSwgYW5pbVswXSwgYW5pbVsxXSksXG4gICAgICAgICAgLy8gZnJhbWVzOiBbXS5yYW5nZShhbmltWzBdLCBhbmltWzFdKSxcbiAgICAgICAgICBuZXh0OiBhbmltWzJdLFxuICAgICAgICAgIGZyZXF1ZW5jeTogYW5pbVszXSB8fCAxLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9uc1trZXldID0ge1xuICAgICAgICAgIGZyYW1lczogYW5pbS5mcmFtZXMsXG4gICAgICAgICAgbmV4dDogYW5pbS5uZXh0LFxuICAgICAgICAgIGZyZXF1ZW5jeTogYW5pbS5mcmVxdWVuY3kgfHwgMVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgfSwgdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICog44OV44Os44O844Og44KS5Y+W5b6XXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxuICAgKiBAcmV0dXJucyB7U3ByaXRlU2hlZXRGcmFtZURhdGF9XG4gICAqL1xuICBnZXRGcmFtZShpbmRleCkge1xuICAgIHJldHVybiB0aGlzLmZyYW1lc1tpbmRleF07XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXJ9IFtuYW1lPVwiZGVmYXVsdFwiXVxuICAgKiBAcmV0dXJucyB7U3ByaXRlU2hlZXRBbmltYXRpb25EYXRhfVxuICAgKi9cbiAgZ2V0QW5pbWF0aW9uKG5hbWUpIHtcbiAgICBuYW1lID0gKG5hbWUgIT09IHVuZGVmaW5lZCkgPyBuYW1lIDogXCJkZWZhdWx0XCI7XG4gICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9uc1tuYW1lXTtcbiAgfVxuXG59XG5cbi8qKiBAdHlwZWRlZiB7c3RyaW5nfG51bWJlcnxudWxsfSBGb250TmFtZSDln7rmnKzjga9zdHJpbmflnosgKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuYXNzZXQuRm9udFxuICogX2V4dGVuZHMgcGhpbmEuYXNzZXQuQXNzZXRcbiAqL1xuY2xhc3MgRm9udCBleHRlbmRzIEFzc2V0IHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgLyoqIEB0eXBlIHtGb250TmFtZX0gKi9cbiAgICB0aGlzLmZvbnROYW1lID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxuICAgKiBAcmV0dXJucyB7Rmxvd31cbiAgICovXG4gIGxvYWQocGF0aCkge1xuICAgIHRoaXMuc3JjID0gcGF0aDtcblxuICAgIHZhciByZWcgPSAvKC4qKSg/OlxcLihbXi5dKyQpKS87XG4gICAgdmFyIGtleSA9IHRoaXMuZm9udE5hbWUgfHwgbGFzdC5nZXQuY2FsbChwYXRoLm1hdGNoKHJlZylbMV0uc3BsaXQoJy8nKSk7ICAgIC8v44OV44Kp44Oz44OI5ZCN5oyH5a6a44GM54Sh44GE5aC05ZCI44GvcGF0aOOBruaLoeW8teWtkOWJjeOCkuS9v+eUqFxuICAgIC8vIHZhciBrZXkgPSB0aGlzLmZvbnROYW1lIHx8IHBhdGgubWF0Y2gocmVnKVsxXS5zcGxpdCgnLycpLmxhc3Q7ICAgIC8v44OV44Kp44Oz44OI5ZCN5oyH5a6a44GM54Sh44GE5aC05ZCI44GvcGF0aOOBruaLoeW8teWtkOWJjeOCkuS9v+eUqFxuICAgIHZhciB0eXBlID0gcGF0aC5tYXRjaChyZWcpWzJdO1xuICAgIHZhciBmb3JtYXQkMSA9IFwidW5rbm93blwiO1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSBcInR0ZlwiOlxuICAgICAgICBmb3JtYXQkMSA9IFwidHJ1ZXR5cGVcIjsgYnJlYWs7XG4gICAgICBjYXNlIFwib3RmXCI6XG4gICAgICAgIGZvcm1hdCQxID0gXCJvcGVudHlwZVwiOyBicmVhaztcbiAgICAgIGNhc2UgXCJ3b2ZmXCI6XG4gICAgICAgIGZvcm1hdCQxID0gXCJ3b2ZmXCI7IGJyZWFrO1xuICAgICAgY2FzZSBcIndvZmYyXCI6XG4gICAgICAgIGZvcm1hdCQxID0gXCJ3b2ZmMlwiOyBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGNvbnNvbGUud2FybihcIuOCteODneODvOODiOOBl+OBpuOBhOOBquOBhOODleOCqeODs+ODiOW9ouW8j+OBp+OBmeOAgihcIiArIHBhdGggKyBcIilcIik7XG4gICAgfVxuICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0JDE7XG4gICAgdGhpcy5mb250TmFtZSA9IGtleTtcblxuICAgIGlmIChmb3JtYXQkMSAhPT0gXCJ1bmtub3duXCIpIHtcbiAgICAgIHZhciB0ZXh0ID0gZm9ybWF0LmNhbGwoXCJAZm9udC1mYWNlIHsgZm9udC1mYW1pbHk6ICd7MH0nOyBzcmM6IHVybCh7MX0pIGZvcm1hdCgnezJ9Jyk7IH1cIiwga2V5LCBwYXRoLCBmb3JtYXQkMSk7XG4gICAgICAvLyB2YXIgdGV4dCA9IFwiQGZvbnQtZmFjZSB7IGZvbnQtZmFtaWx5OiAnezB9Jzsgc3JjOiB1cmwoezF9KSBmb3JtYXQoJ3syfScpOyB9XCIuZm9ybWF0KGtleSwgcGF0aCwgZm9ybWF0KTtcbiAgICAgIHZhciBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImhlYWRcIik7XG4gICAgICB2YXIgZm9udEZhY2VTdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgICBpZiAoZm9udEZhY2VTdHlsZUVsZW1lbnQuaW5uZXJUZXh0KSB7XG4gICAgICAgIGZvbnRGYWNlU3R5bGVFbGVtZW50LmlubmVyVGV4dCA9IHRleHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb250RmFjZVN0eWxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgICB9XG4gICAgICBlLmFwcGVuZENoaWxkKGZvbnRGYWNlU3R5bGVFbGVtZW50KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEZsb3codGhpcy5fbG9hZC5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyhhcmcwOiBGb250KSA9PiB2b2lkfSByZXNvbHZlXG4gICAqL1xuICBfbG9hZChyZXNvbHZlKSB7XG4gICAgaWYgKHRoaXMuZm9ybWF0ICE9PSBcInVua25vd25cIikge1xuICAgICAgdGhpcy5fY2hlY2tMb2FkZWQodGhpcy5mb250TmFtZSwgXG4gICAgICAvKiogQHRoaXMge0ZvbnR9ICovXG4gICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xuICAgICAgICByZXNvbHZlKHRoaXMpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xuICAgICAgcmVzb2x2ZSh0aGlzKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtGb250TmFtZX0gZm9udFxuICAgKiBAcGFyYW0geygpID0+IGFueX0gW2NhbGxiYWNrXVxuICAgKi9cbiAgX2NoZWNrTG9hZGVkIChmb250LCBjYWxsYmFjaykge1xuICAgIHZhciBjYW52YXMgPSBuZXcgQ2FudmFzKCk7XG4gICAgdmFyIERFRkFVTFRfRk9OVCA9IGNhbnZhcy5jb250ZXh0LmZvbnQuc3BsaXQoJyAnKVsxXTtcbiAgICBjYW52YXMuY29udGV4dC5mb250ID0gJzQwcHggJyArIERFRkFVTFRfRk9OVDtcblxuICAgIHZhciBjaGVja1RleHQgPSBcIjEyMzQ1Njc4OTAtXlxcXFxxd2VydHl1aW9wQFthc2RmZ2hqa2w7Ol16eGN2Ym5tLC4vXFwhXFxcIiMkJSYnKCk9fnxRV0VSVFlVSU9QYHtBU0RGR0hKS0wrKn1aWENWQk5NPD4/X++8ke+8ku+8k++8lO+8le+8lu+8l++8mO+8me+8kO+8je+8vu+/pe+9ke+9l++9he+9ku+9lO+9me+9le+9ie+9j++9kO+9ge+9k++9hO+9hu+9h++9iO+9iu+9i++9jO+9mu+9mO+9g++9lu+9gu+9ju+9je+8jO+8juOBguOBhOOBhuOBi+OBleOBn+OBquOCkuOCk+aZguOBr+mHkeOBquOCilwiO1xuICAgIC8vIOeJueauiuaWh+Wtl+WvvuW/nFxuICAgIGNoZWNrVGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ZjA0Yik7XG5cbiAgICB2YXIgYmVmb3JlID0gY2FudmFzLmNvbnRleHQubWVhc3VyZVRleHQoY2hlY2tUZXh0KS53aWR0aDtcbiAgICBjYW52YXMuY29udGV4dC5mb250ID0gJzQwcHggJyArIGZvbnQgKyAnLCAnICsgREVGQVVMVF9GT05UO1xuXG4gICAgdmFyIHRpbWVvdXRDb3VudCA9IDMwO1xuICAgIHZhciBjaGVja0xvYWRGb250ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGFmdGVyID0gY2FudmFzLmNvbnRleHQubWVhc3VyZVRleHQoY2hlY2tUZXh0KS53aWR0aDtcbiAgICAgIGlmIChhZnRlciAhPT0gYmVmb3JlKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICgtLXRpbWVvdXRDb3VudCA+IDApIHtcbiAgICAgICAgICBzZXRUaW1lb3V0KGNoZWNrTG9hZEZvbnQsIDEwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCJ0aW1lb3V0IGZvbnQgbG9hZGluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgY2hlY2tMb2FkRm9udCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7Rm9udE5hbWV9IG5hbWVcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICBzZXRGb250TmFtZShuYW1lKSB7XG4gICAgaWYgKHRoaXMubG9hZGVkKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCLjg5Xjgqnjg7Pjg4jlkI3jga9Mb2Fk5YmN44Gr44Gu44G/6Kit5a6a44GM5Ye65p2l44G+44GZKFwiICsgbmFtZSArIFwiKVwiKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB0aGlzLmZvbnROYW1lID0gbmFtZTtcbiAgICBcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJucyB7Rm9udE5hbWV9XG4gICAqL1xuICBnZXRGb250TmFtZSgpIHtcbiAgICByZXR1cm4gdGhpcy5mb250TmFtZTtcbiAgfVxuXG59XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgcGF0aDogc3RyaW5nLFxuICogICBkYXRhVHlwZTogXCJ4bWxcInwgXCJqc29uXCIsXG4gKiB9fSBGaWxlQXNzZXRMb2FkUGFyYW1cbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5hc3NldC5GaWxlXG4gKiBfZXh0ZW5kcyBwaGluYS5hc3NldC5Bc3NldFxuICovXG5jbGFzcyBGaWxlIGV4dGVuZHMgQXNzZXQge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5kYXRhID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuZGF0YVR5cGUgPSB1bmRlZmluZWQ7XG4gIH1cblxuICBfbG9hZChyZXNvbHZlKSB7XG5cbiAgICB2YXIgcGFyYW1zID0ge307XG5cbiAgICBpZiAodHlwZW9mIHRoaXMuc3JjID09PSAnc3RyaW5nJykge1xuICAgICAgJGV4dGVuZC5jYWxsKHBhcmFtcywge1xuICAgICAgLy8gcGFyYW1zLiRleHRlbmQoe1xuICAgICAgICBwYXRoOiB0aGlzLnNyYyxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgdGhpcy5zcmMgPT09ICdvYmplY3QnKSB7XG4gICAgICAkZXh0ZW5kLmNhbGwocGFyYW1zLCB0aGlzLnNyYyk7XG4gICAgICAvLyBwYXJhbXMuJGV4dGVuZCh0aGlzLnNyYyk7XG4gICAgfVxuXG4gICAgJHNhZmUuY2FsbChwYXJhbXMsIHtcbiAgICAvLyBwYXJhbXMuJHNhZmUoe1xuICAgICAgcGF0aDogJycsXG4gICAgICBkYXRhVHlwZTogJ3RleHQnLFxuICAgIH0pO1xuXG4gICAgLy8gbG9hZFxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgeG1sID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgeG1sLm9wZW4oJ0dFVCcsIHBhcmFtcy5wYXRoKTtcbiAgICB4bWwub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoeG1sLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgaWYgKFsyMDAsIDIwMSwgMF0uaW5kZXhPZih4bWwuc3RhdHVzKSAhPT0gLTEpIHtcbiAgICAgICAgICAvKiogQHR5cGUge3N0cmluZ3xEb2N1bWVudH0gKi9cbiAgICAgICAgICB2YXIgZGF0YSA9IHhtbC5yZXNwb25zZVRleHQ7XG5cbiAgICAgICAgICBpZiAocGFyYW1zLmRhdGFUeXBlID09PSAnanNvbicpIHtcbiAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgIH0gZWxzZSBpZiAocGFyYW1zLmRhdGFUeXBlID09PSAneG1sJykge1xuICAgICAgICAgICAgZGF0YSA9IChuZXcgRE9NUGFyc2VyKCkpLnBhcnNlRnJvbVN0cmluZyhkYXRhLCBcInRleHQveG1sXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzZWxmLmRhdGFUeXBlID0gcGFyYW1zLmRhdGFUeXBlO1xuXG4gICAgICAgICAgc2VsZi5kYXRhID0gZGF0YTtcbiAgICAgICAgICByZXNvbHZlKHNlbGYpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHhtbC5zZW5kKG51bGwpO1xuICAgIC8vIHRoaXMuZG9tRWxlbWVudCA9IG5ldyBJbWFnZSgpO1xuICAgIC8vIHRoaXMuZG9tRWxlbWVudC5zcmMgPSB0aGlzLnNyYztcblxuICAgIC8vIHZhciBzZWxmID0gdGhpcztcbiAgICAvLyB0aGlzLmRvbUVsZW1lbnQub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gICBzZWxmLmxvYWRlZCA9IHRydWU7XG4gICAgLy8gICByZXNvbHZlKHNlbGYpO1xuICAgIC8vIH07XG4gIH1cblxufVxuXG4vKipcbiAqIGFzc2V0S2V544GudmFsdWXjga/pgJrluLjjga9zdHJpbmfvvIjjg5HjgrnmloflrZfliJfvvIlcbiAqIOOBn+OBoOOBl+ODkeODvOOCuea4iOOBv2pzb27jgarjganjga7nibnmrorjgarlvaLlvI/jgoLlj5fjgZHku5jjgZHjgovjgZ/jgoHjgIFhbnnlnovjgajjgZfjgabjgYTjgotcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIFthc3NldFR5cGU6IHN0cmluZ106IHtcbiAqICAgICBbYXNzZXRLZXk6IHN0cmluZ106IGFueVxuICogICB9XG4gKiB9fSBBc3NldExvYWRlckxvYWRQYXJhbVxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmFzc2V0LkFzc2V0TG9hZGVyXG4gKiBfZXh0ZW5kcyBwaGluYS51dGlsLkV2ZW50RGlzcGF0Y2hlclxuICovXG5jbGFzcyBBc3NldExvYWRlciBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge3sgY2FjaGU6IGJvb2xlYW4gfX0gW3BhcmFtc11cbiAgICovXG4gIGNvbnN0cnVjdG9yKHBhcmFtcykge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvLyBwYXJhbXMgPSAocGFyYW1zIHx8IHt9KS4kc2FmZSh7XG4gICAgLy8gICBjYWNoZTogdHJ1ZSxcbiAgICAvLyB9KTtcbiAgICBwYXJhbXMgPSAkc2FmZS5jYWxsKHBhcmFtc3x8e30sIHsgY2FjaGU6IHRydWUgfSk7XG5cbiAgICB0aGlzLmFzc2V0cyA9IHt9O1xuICAgIHRoaXMuY2FjaGUgPSBwYXJhbXMuY2FjaGU7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtBc3NldExvYWRlckxvYWRQYXJhbX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHtGbG93fVxuICAgKi9cbiAgbG9hZChwYXJhbXMpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGZsb3dzID0gW107XG5cbiAgICB2YXIgY291bnRlciA9IDA7XG4gICAgdmFyIGxlbmd0aCA9IDA7XG4gICAgZm9ySW4uY2FsbChwYXJhbXMsIGZ1bmN0aW9uKF90eXBlLCBhc3NldHMpIHtcbiAgICAvLyBwYXJhbXMuZm9ySW4oZnVuY3Rpb24odHlwZSwgYXNzZXRzKSB7XG4gICAgICBsZW5ndGggKz0gT2JqZWN0LmtleXMoYXNzZXRzKS5sZW5ndGg7XG4gICAgfSk7XG4gICAgXG4gICAgZm9ySW4uY2FsbChwYXJhbXMsIGZ1bmN0aW9uKHR5cGUsIGFzc2V0cykge1xuICAgIC8vIHBhcmFtcy5mb3JJbihmdW5jdGlvbih0eXBlLCBhc3NldHMpIHtcbiAgICAgIGZvckluLmNhbGwoYXNzZXRzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICAvLyBhc3NldHMuZm9ySW4oZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgICB2YXIgZnVuYyA9IEFzc2V0TG9hZGVyLmFzc2V0TG9hZEZ1bmN0aW9uc1t0eXBlXTtcbiAgICAgICAgdmFyIGZsb3cgPSBmdW5jKGtleSwgdmFsdWUpO1xuICAgICAgICBmbG93LnRoZW4oZnVuY3Rpb24oYXNzZXQpIHtcbiAgICAgICAgICBpZiAoc2VsZi5jYWNoZSkge1xuICAgICAgICAgICAgQXNzZXRNYW5hZ2VyLnNldCh0eXBlLCBrZXksIGFzc2V0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2VsZi5mbGFyZSgncHJvZ3Jlc3MnLCB7XG4gICAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICAgIGFzc2V0OiBhc3NldCxcbiAgICAgICAgICAgIHByb2dyZXNzOiAoKytjb3VudGVyL2xlbmd0aCksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBmbG93cy5wdXNoKGZsb3cpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cblxuICAgIGlmIChzZWxmLmNhY2hlKSB7XG5cbiAgICAgIHNlbGYub24oJ3Byb2dyZXNzJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoZS5wcm9ncmVzcyA+PSAxLjApIHtcbiAgICAgICAgICAvLyBsb2Fk5aSx5pWX5pmC44CB5a++562WXG5cbiAgICAgICAgICBmb3JJbi5jYWxsKHBhcmFtcywgZnVuY3Rpb24odHlwZSwgYXNzZXRzKSB7XG4gICAgICAgICAgLy8gcGFyYW1zLmZvckluKGZ1bmN0aW9uKHR5cGUsIGFzc2V0cykge1xuICAgICAgICAgICAgZm9ySW4uY2FsbChhc3NldHMsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgIC8vIGFzc2V0cy5mb3JJbihmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICAgIHZhciBhc3NldCA9IEFzc2V0TWFuYWdlci5nZXQodHlwZSwga2V5KTtcbiAgICAgICAgICAgICAgaWYgKGFzc2V0LmxvYWRFcnJvcikge1xuICAgICAgICAgICAgICAgIHZhciBkdW1teSA9IEFzc2V0TWFuYWdlci5nZXQodHlwZSwgJ2R1bW15Jyk7XG4gICAgICAgICAgICAgICAgaWYgKGR1bW15KSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZHVtbXkubG9hZEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGR1bW15LmxvYWREdW1teSgpO1xuICAgICAgICAgICAgICAgICAgICBkdW1teS5sb2FkRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIEFzc2V0TWFuYWdlci5zZXQodHlwZSwga2V5LCBkdW1teSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGFzc2V0LmxvYWREdW1teSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gRmxvdy5hbGwoZmxvd3MpLnRoZW4oZnVuY3Rpb24oYXJncykge1xuICAgICAgc2VsZi5mbGFyZSgnbG9hZCcpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOOCouOCu+ODg+ODiOeorumhnuOBq+W/nOOBmOOBn+ODreODvOODiemWouaVsOOCkueZu+mMslxuICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlcn0ga2V5IOOCouOCu+ODg+ODiOOCv+OCpOODl+WQjVxuICAgKiBAcGFyYW0geyguLi5hcmdzOiBhbnkpPT4gRmxvd30gZnVuYyBGbG9344Kk44Oz44K544K/44Oz44K544KS6L+U44GZ6Zai5pWwXG4gICAqL1xuICBzdGF0aWMgcmVnaXN0ZXIoa2V5LCBmdW5jKSB7XG4gICAgdGhpcy5hc3NldExvYWRGdW5jdGlvbnNba2V5XSA9IGZ1bmM7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxufVxuXG4vKipcbiAqIOeZu+mMsua4iOOBv+OCouOCu+ODg+ODiOODreODvOODiemWouaVsFxuICovXG5Bc3NldExvYWRlci5hc3NldExvYWRGdW5jdGlvbnMgPSB7XG4gIGltYWdlOiBmdW5jdGlvbihrZXksIHBhdGgpIHtcbiAgICB2YXIgdGV4dHVyZSA9IG5ldyBUZXh0dXJlKCk7XG4gICAgdmFyIGZsb3cgPSB0ZXh0dXJlLmxvYWQocGF0aCk7XG4gICAgcmV0dXJuIGZsb3c7XG4gIH0sXG4gIHNvdW5kOiBmdW5jdGlvbihrZXksIHBhdGgpIHtcbiAgICB2YXIgc291bmQgPSBuZXcgU291bmQoKTtcbiAgICB2YXIgZmxvdyA9IHNvdW5kLmxvYWQocGF0aCk7XG4gICAgcmV0dXJuIGZsb3c7XG4gIH0sXG4gIHNwcml0ZXNoZWV0OiBmdW5jdGlvbihrZXksIHBhdGgpIHtcbiAgICB2YXIgc3MgPSBuZXcgU3ByaXRlU2hlZXQoKTtcbiAgICB2YXIgZmxvdyA9IHNzLmxvYWQocGF0aCk7XG4gICAgcmV0dXJuIGZsb3c7XG4gIH0sXG4gIHNjcmlwdDogZnVuY3Rpb24oa2V5LCBwYXRoKSB7XG4gICAgdmFyIHNjcmlwdCA9IG5ldyBTY3JpcHQoKTtcbiAgICByZXR1cm4gc2NyaXB0LmxvYWQocGF0aCk7XG4gIH0sXG4gIGZvbnQ6IGZ1bmN0aW9uKGtleSwgcGF0aCkge1xuICAgIHZhciBmb250ID0gbmV3IEZvbnQoKTtcbiAgICBmb250LnNldEZvbnROYW1lKGtleSk7XG4gICAgcmV0dXJuIGZvbnQubG9hZChwYXRoKTtcbiAgfSxcbiAganNvbjogZnVuY3Rpb24oa2V5LCBwYXRoKSB7XG4gICAgdmFyIHRleHQgPSBuZXcgRmlsZSgpO1xuICAgIHJldHVybiB0ZXh0LmxvYWQoe1xuICAgICAgcGF0aDogcGF0aCxcbiAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICB9KTtcbiAgfSxcbiAgeG1sOiBmdW5jdGlvbihrZXksIHBhdGgpIHtcbiAgICB2YXIgdGV4dCA9IG5ldyBGaWxlKCk7XG4gICAgcmV0dXJuIHRleHQubG9hZCh7XG4gICAgICBwYXRoOiBwYXRoLFxuICAgICAgZGF0YVR5cGU6IFwieG1sXCIsXG4gICAgfSk7XG4gIH0sXG4gIHRleHQ6IGZ1bmN0aW9uKGtleSwgcGF0aCkge1xuICAgIHZhciB0ZXh0ID0gbmV3IEZpbGUoKTtcbiAgICByZXR1cm4gdGV4dC5sb2FkKHBhdGgpO1xuICB9XG59O1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5hc3NldC5Tb3VuZE1hbmFnZXJcbiAqIOWFqOOBpuOBruOCr+ODqeOCueODoeODs+ODkOODvOOBjHN0YXRpY+OBqumdmeeahOOCr+ODqeOCuVxuICog44K144Km44Oz44OJ44Gu5YaN55Sf44Gv5Z+65pys44GT44KM44KS5L2/44GGXG4gKiBcbiAqICMjIyBSZWZcbiAqIC0gaHR0cDovL2V2b2x2ZS5yZWludHJvZHVjaW5nLmNvbS9fc291cmNlL2NsYXNzZXMvYXMzL1NvdW5kTWFuYWdlci9Tb3VuZE1hbmFnZXIuaHRtbFxuICogLSBodHRwczovL2dpdGh1Yi5jb20vbmlja2xvY2t3b29kL1NvdW5kTWFuYWdlclxuICovXG5jbGFzcyBTb3VuZE1hbmFnZXIge1xuICAvLyB2b2x1bWU6IDAuOCxcbiAgLy8gbXVzaWNWb2x1bWU6IDAuOCxcbiAgLy8gbXV0ZUZsYWc6IGZhbHNlLFxuICAvLyBjdXJyZW50TXVzaWM6IG51bGwsXG5cbiAgLyoqXG4gICAqIEBwcml2YXRlIOOCpOODs+OCueOCv+ODs+OCueWMluOBl+OBquOBhFxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIC8qKlxuICAgKiDpn7PmupDjgpLlho3nlJ9cbiAgICogXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOmfs+a6kOOCreODvOWQjVxuICAgKiBAcGFyYW0ge251bWJlcn0gW3doZW49MF0g5oyH5a6a44Gu56eS5pWw44CB5YaN55Sf44KS6YGF44KJ44Gb44KLXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbb2Zmc2V0PTBdIOmfs+a6kOOBruOBqeOBruaZgumWk+S9jee9ruOBp+WGjeeUn+OBmeOCi+OBi+OCkuenkuaVsOaMh+WumlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2R1cmF0aW9uXSDlho3nlJ/mmYLplpPjgpLnp5LmlbDmjIflrppcbiAgICogQHJldHVybnMge2ltcG9ydCgnLi4vYXNzZXQvc291bmQnKS5Tb3VuZH1cbiAgICovXG4gIHN0YXRpYyBwbGF5KG5hbWUsIHdoZW4sIG9mZnNldCwgZHVyYXRpb24pIHtcbiAgICAvKiogQHR5cGUge2ltcG9ydCgnLi4vYXNzZXQvc291bmQnKS5Tb3VuZH0gKi9cbiAgICB2YXIgc291bmQgPSBBc3NldE1hbmFnZXIuZ2V0KCdzb3VuZCcsIG5hbWUpO1xuXG4gICAgc291bmQudm9sdW1lID0gdGhpcy5nZXRWb2x1bWUoKTtcbiAgICBzb3VuZC5wbGF5KHdoZW4sIG9mZnNldCwgZHVyYXRpb24pO1xuXG4gICAgcmV0dXJuIHNvdW5kO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlIOacquWun+ijheOBruOBn+OCgVxuICAgKi9cbiAgc3RhdGljIHN0b3AoKSB7XG4gICAgLy8gVE9ETzogXG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGUg5pyq5a6f6KOF44Gu44Gf44KBXG4gICAqL1xuICBzdGF0aWMgcGF1c2UoKSB7XG4gICAgLy8gVE9ETzogXG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGUg5pyq5a6f6KOF44Gu44Gf44KBXG4gICAqL1xuICBzdGF0aWMgZmFkZSgpIHtcbiAgICAvLyBUT0RPOiBcbiAgfVxuXG4gIC8qKlxuICAgKiDpgJrluLjjgrXjgqbjg7Pjg4npn7Pph4/jgpLjgrvjg4Pjg4hcbiAgICogXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB2b2x1bWVcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBzdGF0aWMgc2V0Vm9sdW1lKHZvbHVtZSkge1xuICAgIHRoaXMudm9sdW1lID0gdm9sdW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIOmAmuW4uOOCteOCpuODs+ODiemfs+mHj+OCkuWPluW+l1xuICAgKiBcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG4gIHN0YXRpYyBnZXRWb2x1bWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudm9sdW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIOODn+ODpeODvOODiFxuICAgKiBcbiAgICogQHJldHVybnMge1NvdW5kTWFuYWdlcn1cbiAgICovXG4gIHN0YXRpYyBtdXRlKCkge1xuICAgIHRoaXMubXV0ZUZsYWcgPSB0cnVlO1xuICAgIGlmICh0aGlzLmN1cnJlbnRNdXNpYykge1xuICAgICAgdGhpcy5jdXJyZW50TXVzaWMudm9sdW1lID0gMDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog44Of44Ol44O844OI6Kej6ZmkXG4gICAqIFxuICAgKiBAcmV0dXJucyB7U291bmRNYW5hZ2VyfVxuICAgKi9cbiAgc3RhdGljIHVubXV0ZSgpIHtcbiAgICB0aGlzLm11dGVGbGFnID0gZmFsc2U7XG4gICAgaWYgKHRoaXMuY3VycmVudE11c2ljKSB7XG4gICAgICB0aGlzLmN1cnJlbnRNdXNpYy52b2x1bWUgPSB0aGlzLmdldFZvbHVtZU11c2ljKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOODn+ODpeODvOODiOeKtuaFi+OBi+OBqeOBhuOBi1xuICAgKiBcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBzdGF0aWMgaXNNdXRlKCkge1xuICAgIHJldHVybiB0aGlzLm11dGVGbGFnO1xuICB9XG5cbiAgLyoqXG4gICAqIOmfs+alveezu+OBrumfs+a6kOOCkuWGjeeUn++8muODq+ODvOODl+OBruacieeEoeOBquOBqeOCkue0sOOBi+OBj+iqv+aVtOWPr+iDvVxuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg6Z+z5rqQ44Kt44O85ZCNXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbZmFkZVRpbWVdIOaMh+WumuaZgumWk+OCkuOBi+OBkeOBpumfs+mHj+ODleOCp+ODvOODieOCpOODs+OAguWNmOS9jeOBr+ODn+ODquenklxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtsb29wXSDjg6vjg7zjg5fjgZnjgovjgYvjganjgYbjgYvjgIJEZWZhdWx0OiB0cnVlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbd2hlbj0wXSDmjIflrprjga7np5LmlbDjgIHlho3nlJ/jgpLpgYXjgonjgZvjgotcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtvZmZzZXQ9MF0g6Z+z5rqQ44Gu44Gp44Gu5pmC6ZaT5L2N572u44Gn5YaN55Sf44GZ44KL44GL44KS56eS5pWw5oyH5a6aXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbZHVyYXRpb25dIOWGjeeUn+aZgumWk+OCkuenkuaVsOaMh+WumlxuICAgKiBAcmV0dXJucyB7aW1wb3J0KCcuLi9hc3NldC9zb3VuZCcpLlNvdW5kfSDlho3nlJ/jgZfjgZ9Tb3VuZOOCr+ODqeOCuVxuICAgKi9cbiAgc3RhdGljIHBsYXlNdXNpYyhuYW1lLCBmYWRlVGltZSwgbG9vcCwgd2hlbiwgb2Zmc2V0LCBkdXJhdGlvbikge1xuICAgIGxvb3AgPSAobG9vcCAhPT0gdW5kZWZpbmVkKSA/IGxvb3AgOiB0cnVlO1xuXG4gICAgaWYgKHRoaXMuY3VycmVudE11c2ljKSB7XG4gICAgICB0aGlzLnN0b3BNdXNpYyhmYWRlVGltZSk7XG4gICAgfVxuXG4gICAgLyoqIEB0eXBlIHtpbXBvcnQoJy4uL2Fzc2V0L3NvdW5kJykuU291bmR9ICovXG4gICAgdmFyIG11c2ljID0gQXNzZXRNYW5hZ2VyLmdldCgnc291bmQnLCBuYW1lKTtcblxuICAgIG11c2ljLnNldExvb3AobG9vcCk7XG4gICAgbXVzaWMucGxheSh3aGVuLCBvZmZzZXQsIGR1cmF0aW9uKTtcblxuICAgIGlmIChmYWRlVGltZSA+IDApIHtcbiAgICAgIHZhciBjb3VudCA9IDMyO1xuICAgICAgdmFyIGNvdW50ZXIgPSAwO1xuICAgICAgdmFyIHVuaXRUaW1lID0gZmFkZVRpbWUvY291bnQ7XG4gICAgICB2YXIgdm9sdW1lID0gdGhpcy5nZXRWb2x1bWVNdXNpYygpO1xuXG4gICAgICBtdXNpYy52b2x1bWUgPSAwO1xuICAgICAgdmFyIGlkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvdW50ZXIgKz0gMTtcbiAgICAgICAgdmFyIHJhdGUgPSBjb3VudGVyL2NvdW50O1xuICAgICAgICBtdXNpYy52b2x1bWUgPSByYXRlKnZvbHVtZTtcblxuICAgICAgICBpZiAocmF0ZSA+PSAxKSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChpZCk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LCB1bml0VGltZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgbXVzaWMudm9sdW1lID0gdGhpcy5nZXRWb2x1bWVNdXNpYygpO1xuICAgIH1cblxuICAgIHRoaXMuY3VycmVudE11c2ljID0gbXVzaWM7XG5cbiAgICByZXR1cm4gdGhpcy5jdXJyZW50TXVzaWM7XG4gIH1cblxuICAvKipcbiAgICog6Z+z5qW944KS5YGc5q2iXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gW2ZhZGVUaW1lXSDmjIflrprmmYLplpPjgpLjgYvjgZHjgabpn7Pph4/jg5Xjgqfjg7zjg4njgqLjgqbjg4jjgILljZjkvY3jga/jg5/jg6rnp5JcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBzdGF0aWMgc3RvcE11c2ljKGZhZGVUaW1lKSB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRNdXNpYykgeyByZXR1cm4gOyB9XG5cbiAgICB2YXIgbXVzaWMgPSB0aGlzLmN1cnJlbnRNdXNpYztcbiAgICB0aGlzLmN1cnJlbnRNdXNpYyA9IG51bGw7XG5cbiAgICBpZiAoZmFkZVRpbWUgPiAwKSB7XG4gICAgICB2YXIgY291bnQgPSAzMjtcbiAgICAgIHZhciBjb3VudGVyID0gMDtcbiAgICAgIHZhciB1bml0VGltZSA9IGZhZGVUaW1lL2NvdW50O1xuICAgICAgdmFyIHZvbHVtZSA9IHRoaXMuZ2V0Vm9sdW1lTXVzaWMoKTtcblxuICAgICAgbXVzaWMudm9sdW1lID0gMDtcbiAgICAgIHZhciBpZCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICBjb3VudGVyICs9IDE7XG4gICAgICAgIHZhciByYXRlID0gY291bnRlci9jb3VudDtcbiAgICAgICAgbXVzaWMudm9sdW1lID0gdm9sdW1lKigxLXJhdGUpO1xuXG4gICAgICAgIGlmIChyYXRlID49IDEpIHtcbiAgICAgICAgICBtdXNpYy5zdG9wKCk7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChpZCk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LCB1bml0VGltZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgbXVzaWMuc3RvcCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDpn7Pmpb3jgpLkuIDmmYLlgZzmraJcbiAgICogXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgc3RhdGljIHBhdXNlTXVzaWMoKSB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRNdXNpYykgeyByZXR1cm4gOyB9XG4gICAgdGhpcy5jdXJyZW50TXVzaWMucGF1c2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDpn7Pmpb3jgpLlho3plotcbiAgICogXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgc3RhdGljIHJlc3VtZU11c2ljKCkge1xuICAgIGlmICghdGhpcy5jdXJyZW50TXVzaWMpIHsgcmV0dXJuIDsgfVxuICAgIHRoaXMuY3VycmVudE11c2ljLnJlc3VtZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOmfs+alveOBrumfs+mHj+OCkuioreWumlxuICAgKiBcbiAgICogQHBhcmFtIHtudW1iZXJ9IHZvbHVtZVxuICAgKiBAcmV0dXJucyB7U291bmRNYW5hZ2VyfVxuICAgKi9cbiAgc3RhdGljIHNldFZvbHVtZU11c2ljKHZvbHVtZSkge1xuICAgIHRoaXMubXVzaWNWb2x1bWUgPSB2b2x1bWU7XG4gICAgaWYgKHRoaXMuY3VycmVudE11c2ljKSB7XG4gICAgICB0aGlzLmN1cnJlbnRNdXNpYy52b2x1bWUgPSB2b2x1bWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICog6Z+z5qW944Gu6Z+z6YeP44KS5Y+W5b6XXG4gICAqIFxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cbiAgc3RhdGljIGdldFZvbHVtZU11c2ljKCkge1xuICAgIHJldHVybiB0aGlzLm11c2ljVm9sdW1lO1xuICB9XG5cbn1cblxuLyoqXG4gKiDpgJrluLjjgrXjgqbjg7Pjg4nvvIhTRe+8iemfs+mHj1xuICogQHR5cGUge251bWJlcn1cbiAqL1xuU291bmRNYW5hZ2VyLnZvbHVtZSA9IDAuODtcblxuLyoqXG4gKiDpn7Pmpb3pn7Pph49cbiAqIEB0eXBlIHtudW1iZXJ9XG4gKi9cblNvdW5kTWFuYWdlci5tdXNpY1ZvbHVtZSA9IDAuODtcblxuLyoqXG4gKiDjg5/jg6Xjg7zjg4jnirbmhYtcbiAqIEB0eXBlIHtib29sZWFufVxuICovXG5Tb3VuZE1hbmFnZXIubXV0ZUZsYWcgPSBmYWxzZTtcblxuLyoqXG4gKiDlho3nlJ/kuK3jga7pn7Pmpb3pn7PmupBcbiAqIEB0eXBlIHtpbXBvcnQoJy4uL2Fzc2V0L3NvdW5kJykuU291bmQgfCBudWxsfVxuICovXG5Tb3VuZE1hbmFnZXIuY3VycmVudE11c2ljID0gbnVsbDtcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICB0ZXh0Pzogc3RyaW5nLFxuICogICBmb250Q29sb3I/OiBpbXBvcnQoXCIuLi9ncmFwaGljcy9jYW52YXNcIikuQ2FudmFzU3R5bGUsXG4gKiAgIGZvbnRTaXplPzogbnVtYmVyLFxuICogICBmb250V2VpZ2h0Pzogc3RyaW5nIHwgbnVtYmVyLFxuICogICBmb250RmFtaWx5Pzogc3RyaW5nLFxuICogICBjb3JuZXJSYWRpdXM/OiBudW1iZXJcbiAqIH0gJiBpbXBvcnQoJy4uL2Rpc3BsYXkvc2hhcGUnKS5TaGFwZU9wdGlvbnMgfSBCdXR0b25PcHRpb25zXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEudWkuQnV0dG9uXG4gKiBCdXR0b25cbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuU2hhcGVcbiAqL1xuY2xhc3MgQnV0dG9uIGV4dGVuZHMgU2hhcGUge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtCdXR0b25PcHRpb25zfSBbb3B0aW9uc11cbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbChvcHRpb25zIHx8IHt9LCBCdXR0b24uZGVmYXVsdHMpO1xuICAgIC8vIG9wdGlvbnMgPSAob3B0aW9ucyB8fCB7fSkuJHNhZmUocGhpbmEudWkuQnV0dG9uLmRlZmF1bHRzKTtcbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIHRoaXMuY29ybmVyUmFkaXVzID0gb3B0aW9ucy5jb3JuZXJSYWRpdXM7XG4gICAgdGhpcy50ZXh0ICAgICAgICAgPSBvcHRpb25zLnRleHQ7XG4gICAgdGhpcy5mb250Q29sb3IgICAgPSBvcHRpb25zLmZvbnRDb2xvcjtcbiAgICB0aGlzLmZvbnRTaXplICAgICA9IG9wdGlvbnMuZm9udFNpemU7XG4gICAgdGhpcy5mb250V2VpZ2h0ICAgICA9IG9wdGlvbnMuZm9udFdlaWdodDtcbiAgICB0aGlzLmZvbnRGYW1pbHkgICA9IG9wdGlvbnMuZm9udEZhbWlseTtcblxuICAgIHRoaXMuc2V0SW50ZXJhY3RpdmUodHJ1ZSk7XG4gICAgdGhpcy5vbigncG9pbnRlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuZmxhcmUoJ3B1c2gnKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqL1xuICBwcmVyZW5kZXIoY2FudmFzKSB7XG4gICAgY2FudmFzLnJvdW5kUmVjdCgtdGhpcy53aWR0aC8yLCAtdGhpcy5oZWlnaHQvMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMuY29ybmVyUmFkaXVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqL1xuICBwb3N0cmVuZGVyKGNhbnZhcykge1xuICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmNvbnRleHQ7XG4gICAgLy8gdGV4dFxuICAgIHZhciBmb250ID0gZm9ybWF0LmNhbGwoXCJ7Zm9udFdlaWdodH0ge2ZvbnRTaXplfXB4IHtmb250RmFtaWx5fVwiLCB0aGlzKTtcbiAgICAvLyB2YXIgZm9udCA9IFwie2ZvbnRXZWlnaHR9IHtmb250U2l6ZX1weCB7Zm9udEZhbWlseX1cIi5mb3JtYXQodGhpcyk7XG4gICAgY29udGV4dC5mb250ID0gZm9udDtcbiAgICBjb250ZXh0LnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICAgIGNvbnRleHQudGV4dEJhc2VsaW5lID0gJ21pZGRsZSc7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSB0aGlzLmZvbnRDb2xvcjtcbiAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMudGV4dCwgMCwgMCk7XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlIHtCdXR0b25PcHRpb25zfVxuICogQHN0YXRpY1xuICovXG5CdXR0b24uZGVmYXVsdHMgPSB7XG4gIHdpZHRoOiAyMDAsXG4gIGhlaWdodDogODAsXG4gIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgZmlsbDogJ2hzbCgyMDAsIDgwJSwgNjAlKScsXG4gIHN0cm9rZTogbnVsbCxcblxuICBjb3JuZXJSYWRpdXM6IDgsXG4gIHRleHQ6ICdIZWxsbycsXG4gIGZvbnRDb2xvcjogJ3doaXRlJyxcbiAgZm9udFNpemU6IDMyLFxuICBmb250V2VpZ2h0OiAnJyxcbiAgZm9udEZhbWlseTogXCInSGlyYUtha3VQcm9OLVczJ1wiLCAvLyBIaXJhZ2lubyBvciBIZWx2ZXRpY2EsXG59O1xuXG4vLyBkZWZpbmVkXG5TaGFwZS53YXRjaFJlbmRlclByb3BlcnR5LmNhbGwoQnV0dG9uLCAnY29ybmVyUmFkaXVzJyk7XG5TaGFwZS53YXRjaFJlbmRlclByb3BlcnR5LmNhbGwoQnV0dG9uLCAndGV4dCcpO1xuU2hhcGUud2F0Y2hSZW5kZXJQcm9wZXJ0eS5jYWxsKEJ1dHRvbiwgJ2ZvbnRDb2xvcicpO1xuU2hhcGUud2F0Y2hSZW5kZXJQcm9wZXJ0eS5jYWxsKEJ1dHRvbiwgJ2ZvbnRTaXplJyk7XG5TaGFwZS53YXRjaFJlbmRlclByb3BlcnR5LmNhbGwoQnV0dG9uLCAnZm9udEZhbWlseScpO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHZhbHVlPzogbnVtYmVyXG4gKiAgIG1heFZhbHVlPzogbnVtYmVyXG4gKiAgIGdhdWdlQ29sb3I/OiBpbXBvcnQoXCIuLi9ncmFwaGljcy9jYW52YXNcIikuQ2FudmFzU3R5bGVcbiAqICAgYW5pbWF0aW9uPzogYm9vbGVhblxuICogICBjb3JuZXJSYWRpdXM/OiBudW1iZXJcbiAqIH0gJiBpbXBvcnQoJy4uL2Rpc3BsYXkvc2hhcGUnKS5TaGFwZU9wdGlvbnMgfSBHYXVnZU9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS51aS5HYXVnZVxuICogX2V4dGVuZHMgcGhpbmEuZGlzcGxheS5TaGFwZVxuICogXG4gKiBAZXhhbXBsZVxuICogY29uc3QgbGlmZUdhdWdlID0gbmV3IEdhdWdlKHtcbiAqICAgZmlsbDogXCJncmF5XCIsIC8vIEdhdWdlIGJhY2tncm91bmQgY29sb3JcbiAqICAgZ2F1Z2VDb2xvcjogXCJyZWRcIiwgLy8gR2F1Z2UgbWFpbiBjb2xvclxuICogICBzdHJva2U6IFwiYmxhY2tcIiAvLyBHYXVnZSBmcmFtZSBjb2xvclxuICogICBtYXhWYWx1ZTogMjAwLFxuICogICBhbmltYXRpb246IHRydWUsXG4gKiB9KVxuICogXG4gKiBpZiAocGxheWVyRGFtYWdlZCkge1xuICogICBsaWZlR2F1Z2UudmFsdWUgLT0gMTBcbiAqIH1cbiAqIFxuICovXG5jbGFzcyBHYXVnZSBleHRlbmRzIFNoYXBlIHtcblxuICAvKipcbiAgICogQHBhcmFtIHtHYXVnZU9wdGlvbnN9IFtvcHRpb25zXSBcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbCh7fSwgb3B0aW9ucyB8fCB7fSwgR2F1Z2UuZGVmYXVsdHMpO1xuICAgIC8vIG9wdGlvbnMgPSAoe30pLiRzYWZlKG9wdGlvbnMgfHwge30sIHBoaW5hLnVpLkdhdWdlLmRlZmF1bHRzKTtcbiAgICBcbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLl92YWx1ZSA9IChvcHRpb25zLnZhbHVlICE9PSB1bmRlZmluZWQpID8gb3B0aW9ucy52YWx1ZSA6IG9wdGlvbnMubWF4VmFsdWU7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7bnVtYmVyfSDmnIDlpKflgKRcbiAgICAgKi9cbiAgICB0aGlzLm1heFZhbHVlID0gb3B0aW9ucy5tYXhWYWx1ZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtpbXBvcnQoXCIuLi9ncmFwaGljcy9jYW52YXNcIikuQ2FudmFzU3R5bGV9IOOCsuODvOOCuOOBruiJslxuICAgICAqL1xuICAgIHRoaXMuZ2F1Z2VDb2xvciA9IG9wdGlvbnMuZ2F1Z2VDb2xvcjtcbiAgICBcbiAgICAvKipcbiAgICAgKiBAdHlwZSB7bnVtYmVyfSDmnIDlpKflgKRcbiAgICAgKi9cbiAgICB0aGlzLmNvcm5lclJhZGl1cyA9IG9wdGlvbnMuY29ybmVyUmFkaXVzO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge251bWJlcn0g6KaL44Gf55uu44Gu5YCkXG4gICAgICovXG4gICAgdGhpcy52aXN1YWxWYWx1ZSA9IChvcHRpb25zLnZhbHVlICE9PSB1bmRlZmluZWQpID8gb3B0aW9ucy52YWx1ZSA6IG9wdGlvbnMubWF4VmFsdWU7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0g44Ki44OL44Oh44O844K344On44Oz44GV44Gb44KL44GL44Gp44GG44GLXG4gICAgICovXG4gICAgdGhpcy5hbmltYXRpb24gPSBvcHRpb25zLmFuaW1hdGlvbjtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9IOOCouODi+ODoeODvOOCt+ODp+ODs+WujOS6huaZgumWk+OCkuODn+ODquenkuaMh+WumlxuICAgICAqIEBkZWZhdWx0IDEwMDBcbiAgICAgKi9cbiAgICB0aGlzLmFuaW1hdGlvblRpbWUgPSAxKjEwMDA7XG4gIH1cblxuICAvKipcbiAgICog5rqA44K/44Oz44GL44KS44OB44Kn44OD44KvXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgaXNGdWxsKCkge1xuICAgIHJldHVybiB0aGlzLnZhbHVlID09PSB0aGlzLm1heFZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIOepuuOBo+OBveOBi+OCkuODgeOCp+ODg+OCr1xuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGlzRW1wdHkoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IDA7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgc2V0VmFsdWUodmFsdWUpIHtcbiAgICB2YWx1ZSA9IGNsYW1wKHZhbHVlLCAwLCB0aGlzLm1heFZhbHVlKTtcbiAgICAvLyB2YWx1ZSA9IE1hdGguY2xhbXAodmFsdWUsIDAsIHRoaXMubWF4VmFsdWUpO1xuXG4gICAgLy8gZW5kIHdoZW4gbm93IHZhbHVlIGVxdWFsIHZhbHVlIG9mIGFyZ3VtZW50XG4gICAgaWYgKHRoaXMudmFsdWUgPT09IHZhbHVlKSByZXR1cm4gO1xuXG4gICAgLy8gZmlyZSB2YWx1ZSBjaGFuZ2UgZXZlbnRcbiAgICB0aGlzLmZsYXJlKCdjaGFuZ2UnKTtcblxuICAgIHRoaXMuX3ZhbHVlID0gdmFsdWU7XG5cbiAgICBpZiAodGhpcy5hbmltYXRpb24pIHtcbiAgICAgIHZhciByYW5nZSA9IE1hdGguYWJzKHRoaXMudmlzdWFsVmFsdWUtdmFsdWUpO1xuICAgICAgdmFyIHRpbWUgPSAocmFuZ2UvdGhpcy5tYXhWYWx1ZSkqdGhpcy5hbmltYXRpb25UaW1lO1xuXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICB0aGlzLnR3ZWVuZXIub250d2VlbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9kaXJ0eURyYXcgPSB0cnVlO1xuICAgICAgfS5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy50d2VlbmVyXG4gICAgICAgIC5jbGVhcigpXG4gICAgICAgIC50byh7J3Zpc3VhbFZhbHVlJzogdmFsdWV9LCB0aW1lKVxuICAgICAgICAuY2FsbChmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLmZsYXJlKCdjaGFuZ2VkJyk7XG4gICAgICAgICAgaWYgKHRoaXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICB0aGlzLmZsYXJlKCdlbXB0eScpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmICh0aGlzLmlzRnVsbCgpKSB7XG4gICAgICAgICAgICB0aGlzLmZsYXJlKCdmdWxsJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLnZpc3VhbFZhbHVlID0gdmFsdWU7XG4gICAgICB0aGlzLmZsYXJlKCdjaGFuZ2VkJyk7XG4gICAgICBpZiAodGhpcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgdGhpcy5mbGFyZSgnZW1wdHknKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHRoaXMuaXNGdWxsKCkpIHtcbiAgICAgICAgdGhpcy5mbGFyZSgnZnVsbCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG4gIGdldFJhdGUoKSB7XG4gICAgdmFyIHJhdGUgPSB0aGlzLnZpc3VhbFZhbHVlL3RoaXMubWF4VmFsdWU7XG4gICAgcmV0dXJuIHJhdGU7XG4gIH1cblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhcyBcbiAgICovXG4gIHByZXJlbmRlcihjYW52YXMpIHtcbiAgICBjYW52YXMucm91bmRSZWN0KC10aGlzLndpZHRoLzIsIC10aGlzLmhlaWdodC8yLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgdGhpcy5jb3JuZXJSYWRpdXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqL1xuICBwb3N0cmVuZGVyKGNhbnZhcykge1xuICAgIHZhciByYXRlID0gdGhpcy5nZXRSYXRlKCk7XG4gICAgY2FudmFzLmNvbnRleHQuZmlsbFN0eWxlID0gdGhpcy5nYXVnZUNvbG9yO1xuICAgIGNhbnZhcy5jb250ZXh0LnNhdmUoKTtcbiAgICBjYW52YXMuY29udGV4dC5jbGlwKCk7XG4gICAgY2FudmFzLmZpbGxSZWN0KC10aGlzLndpZHRoLzIsIC10aGlzLmhlaWdodC8yLCB0aGlzLndpZHRoKnJhdGUsIHRoaXMuaGVpZ2h0KTtcbiAgICBjYW52YXMuY29udGV4dC5yZXN0b3JlKCk7XG4gIH1cblxuICBnZXQgdmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICB9XG4gIHNldCB2YWx1ZSh2KSB7XG4gICAgdGhpcy5zZXRWYWx1ZSh2KTtcbiAgfVxuXG59XG5cbi8qKlxuICogQHR5cGUge0dhdWdlT3B0aW9uc31cbiAqIEBzdGF0aWNcbiAqL1xuR2F1Z2UuZGVmYXVsdHMgPSB7XG4gIHdpZHRoOiAyNTYsXG4gIGhlaWdodDogMzIsXG4gIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgZmlsbDogJ3doaXRlJyxcbiAgc3Ryb2tlOiAnI2FhYScsXG4gIHN0cm9rZVdpZHRoOiA0LFxuICBtYXhWYWx1ZTogMTAwLFxuICBnYXVnZUNvbG9yOiAnIzQ0ZicsXG4gIGNvcm5lclJhZGl1czogMCxcbiAgYW5pbWF0aW9uOiB0cnVlXG59O1xuXG4vLyBkZWZpbmVkXG5TaGFwZS53YXRjaFJlbmRlclByb3BlcnR5LmNhbGwoR2F1Z2UsICd2YWx1ZScpO1xuU2hhcGUud2F0Y2hSZW5kZXJQcm9wZXJ0eS5jYWxsKEdhdWdlLCAnbWF4VmFsdWUnKTtcblNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHkuY2FsbChHYXVnZSwgJ2dhdWdlQ29sb3InKTtcblNoYXBlLndhdGNoUmVuZGVyUHJvcGVydHkuY2FsbChHYXVnZSwgJ2Nvcm5lclJhZGl1cycpO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGFudGljbG9ja3dpc2U/OiBib29sZWFuXG4gKiAgIHNob3dQZXJjZW50YWdlPzogYm9vbGVhblxuICogfSAmIEdhdWdlT3B0aW9ucyB9IENpcmNsZUdhdWdlT3B0aW9uc1xuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLnVpLkNpcmNsZUdhdWdlXG4gKiBfZXh0ZW5kcyBwaGluYS51aS5HYXVnZVxuICovXG5jbGFzcyBDaXJjbGVHYXVnZSBleHRlbmRzIEdhdWdlIHtcblxuICAvKipcbiAgICogQHBhcmFtIHtDaXJjbGVHYXVnZU9wdGlvbnN9IFtvcHRpb25zXSBcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbChvcHRpb25zIHx8IHt9LCB7XG4gICAgLy8gb3B0aW9ucyA9IChvcHRpb25zIHx8IHt9KS4kc2FmZSh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICd0cmFuc3BhcmVudCcsXG4gICAgICBmaWxsOiAnI2FhYScsXG4gICAgICBzdHJva2U6ICcjMjIyJyxcblxuICAgICAgcmFkaXVzOiA2NCxcbiAgICAgIGFudGljbG9ja3dpc2U6IHRydWUsXG4gICAgICBzaG93UGVyY2VudGFnZTogZmFsc2UsIC8vIFRPRE9cbiAgICB9KTtcblxuICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgdGhpcy5zZXRCb3VuZGluZ1R5cGUoJ2NpcmNsZScpO1xuXG4gICAgdGhpcy5yYWRpdXMgPSBvcHRpb25zLnJhZGl1cztcbiAgICB0aGlzLmFudGljbG9ja3dpc2UgPSBvcHRpb25zLmFudGljbG9ja3dpc2U7XG4gICAgdGhpcy5zaG93UGVyY2VudGFnZSA9IG9wdGlvbnMuc2hvd1BlcmNlbnRhZ2U7XG4gIH1cblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IF9jYW52YXMgXG4gICAqL1xuICBwcmVyZW5kZXIoX2NhbnZhcykge1xuICAgIHZhciByYXRlID0gdGhpcy5nZXRSYXRlKCk7XG4gICAgdmFyIGVuZCA9IChNYXRoLlBJKjIpKnJhdGU7XG4gICAgdGhpcy5zdGFydEFuZ2xlID0gMDtcbiAgICB0aGlzLmVuZEFuZ2xlID0gZW5kO1xuXG4gICAgdGhpcy5jYW52YXMucm90YXRlKC1NYXRoLlBJKjAuNSk7XG4gICAgdGhpcy5jYW52YXMuc2NhbGUoMSwgLTEpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqL1xuICByZW5kZXJGaWxsKGNhbnZhcykge1xuICAgIGNhbnZhcy5maWxsUGllKDAsIDAsIHRoaXMucmFkaXVzLCB0aGlzLnN0YXJ0QW5nbGUsIHRoaXMuZW5kQW5nbGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZ3JhcGhpY3MvY2FudmFzJykuQ2FudmFzfSBjYW52YXMgXG4gICAqL1xuICByZW5kZXJTdHJva2UoY2FudmFzKSB7XG4gICAgY2FudmFzLnN0cm9rZUFyYygwLCAwLCB0aGlzLnJhZGl1cywgdGhpcy5zdGFydEFuZ2xlLCB0aGlzLmVuZEFuZ2xlKTtcbiAgfVxuXG4gIHBvc3RyZW5kZXIoKSB7XG4gICAgLy8gaWYgKHRoaXMuc2hvd1BlcmNlbnRhZ2UpIHtcbiAgICAvLyAgIC8vIFRPRE86XG4gICAgLy8gICB2YXIgbGVmdCA9IE1hdGgubWF4KDAsIHRoaXMubGltaXQtdGhpcy50aW1lKTtcbiAgICAvLyAgIHRoaXMubGFiZWwudGV4dCA9IE1hdGguY2VpbChsZWZ0LzEwMDApKycnO1xuICAgIC8vIH1cbiAgfVxuXG59XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgdmVydGljYWxBbGlnbj86IG51bWJlciB8IGtleW9mIExhYmVsQXJlYS52ZXJ0aWNhbEFsaWduVG9PZmZzZXRNYXBcbiAqICAgYWxpZ24/OiBrZXlvZiBMYWJlbEFyZWEuYWxpZ25Ub09mZnNldE1hcCxcbiAqICAgYmFzZWxpbmU/OiBDYW52YXNUZXh0QmFzZWxpbmUsXG4gKiAgIHNjcm9sbD86IFZlY3RvcjJcbiAqICAgc2Nyb2xsWD86IG51bWJlclxuICogICBzY3JvbGxZPzogbnVtYmVyXG4gKiB9ICYgaW1wb3J0KCcuLi9kaXNwbGF5L2xhYmVsJykuTGFiZWxPcHRpb25zIH0gTGFiZWxBcmVhT3B0aW9uc1xuICovXG5cbi8qKlxuICogQHR5cGUge3tbZm9udE5hbWU6IHN0cmluZ106IHtbY2hhcmFjdGVyOiBzdHJpbmddOiBudW1iZXIgfX19XG4gKi9cbnZhciB0ZXh0V2lkdGhDYWNoZSA9IHt9O1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS51aS5MYWJlbEFyZWFcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuTGFiZWxcbiAqL1xuY2xhc3MgTGFiZWxBcmVhIGV4dGVuZHMgTGFiZWwge1xuXG4gIC8vIF9saW5lVXBkYXRlOiB0cnVlLFxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0xhYmVsQXJlYU9wdGlvbnN9IG9wdGlvbnMgXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwoe30sIG9wdGlvbnMsIExhYmVsQXJlYS5kZWZhdWx0cyk7XG4gICAgLy8gb3B0aW9ucyA9IHt9LiRzYWZlKG9wdGlvbnMsIExhYmVsQXJlYS5kZWZhdWx0cyk7XG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICB0aGlzLl9saW5lVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnZlcnRpY2FsQWxpZ24gPSBvcHRpb25zLnZlcnRpY2FsQWxpZ247XG4gICAgdGhpcy5zY3JvbGwgPSBvcHRpb25zLnNjcm9sbCB8fCBuZXcgVmVjdG9yMigpO1xuICAgIHRoaXMuc2Nyb2xsWCA9IG9wdGlvbnMuc2Nyb2xsWDtcbiAgICB0aGlzLnNjcm9sbFkgPSBvcHRpb25zLnNjcm9sbFk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG4gIGNhbGNDYW52YXNXaWR0aCAoKSB7XG4gICAgcmV0dXJuIHRoaXMud2lkdGggKyB0aGlzLnBhZGRpbmcgKiAyO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBjYWxjQ2FudmFzSGVpZ2h0ICgpIHtcbiAgICByZXR1cm4gdGhpcy5oZWlnaHQgKyB0aGlzLnBhZGRpbmcgKiAyO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBnZXRPZmZzZXRZICgpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMudmVydGljYWxBbGlnbiA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiB0aGlzLnZlcnRpY2FsQWxpZ247XG4gICAgfVxuICAgIHJldHVybiBMYWJlbEFyZWEudmVydGljYWxBbGlnblRvT2Zmc2V0TWFwW3RoaXMudmVydGljYWxBbGlnbl0gfHwgMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0T2Zmc2V0WCAoKSB7XG4gICAgcmV0dXJuIExhYmVsQXJlYS5hbGlnblRvT2Zmc2V0TWFwW3RoaXMuYWxpZ25dIHx8IDA7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybnMge3sgW2NoYXJhY3Rlcjogc3RyaW5nXTogbnVtYmVyIH19XG4gICAqL1xuICBnZXRUZXh0V2lkdGhDYWNoZSAoKSB7XG4gICAgdmFyIGNhY2hlID0gdGV4dFdpZHRoQ2FjaGVbdGhpcy5mb250XTtcbiAgICByZXR1cm4gY2FjaGUgfHwgKHRleHRXaWR0aENhY2hlW3RoaXMuZm9udF0gPSB7fSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBsaW5lcyDmlofnq6BcbiAgICogQHJldHVybnMge3N0cmluZ1tdfSDmlbTlvaLmuIjjgb/mloflrZfjg6njgqTjg7NcbiAgICovXG4gIHNwbGljZUxpbmVzIChsaW5lcykge1xuICAgIHZhciByb3dXaWR0aCA9IHRoaXMud2lkdGg7XG4gICAgdmFyIGNvbnRleHQgPSB0aGlzLmNhbnZhcy5jb250ZXh0O1xuICAgIGNvbnRleHQuZm9udCA9IHRoaXMuZm9udDtcblxuICAgIHZhciBjYWNoZSA9IHRoaXMuZ2V0VGV4dFdpZHRoQ2FjaGUoKTtcblxuICAgIC8vIHVwZGF0ZSBjYWNoZVxuICAgIGVhY2guY2FsbCh0aGlzLl90ZXh0LCBmdW5jdGlvbihjaCkge1xuICAgIC8vIHRoaXMuX3RleHQuZWFjaChmdW5jdGlvbihjaCkge1xuICAgICAgaWYgKCFjYWNoZVtjaF0pIHtcbiAgICAgICAgY2FjaGVbY2hdID0gY29udGV4dC5tZWFzdXJlVGV4dChjaCkud2lkdGg7XG4gICAgICB9XG4gICAgfSk7XG4gICAgXG4gICAgdmFyIGxvY2FsTGluZXMgPSBbXTtcbiAgICBsaW5lcy5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIFxuICAgICAgdmFyIHN0ciA9ICcnO1xuICAgICAgdmFyIHRvdGFsV2lkdGggPSAwO1xuXG4gICAgICAvLyDjga/jgb/lh7rjgabjgYTjgZ/jgonlvLfliLbnmoTjgavmlLnooYzjgZnjgotcbiAgICAgIGVhY2guY2FsbChsaW5lLCBmdW5jdGlvbihjaCkge1xuICAgICAgLy8gbGluZS5lYWNoKGZ1bmN0aW9uKGNoKSB7XG4gICAgICAgIHZhciB3ID0gY2FjaGVbY2hdO1xuXG4gICAgICAgIGlmICgodG90YWxXaWR0aCt3KSA+IHJvd1dpZHRoKSB7XG4gICAgICAgICAgbG9jYWxMaW5lcy5wdXNoKHN0cik7XG4gICAgICAgICAgc3RyID0gJyc7XG4gICAgICAgICAgdG90YWxXaWR0aCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBzdHIgKz0gY2g7XG4gICAgICAgIHRvdGFsV2lkdGggKz0gdztcbiAgICAgIH0pO1xuXG4gICAgICAvLyDmrovjgorjgpIgcHVzaCDjgZnjgotcbiAgICAgIGxvY2FsTGluZXMucHVzaChzdHIpO1xuXG4gICAgfSk7XG4gICAgXG5cbiAgICByZXR1cm4gbG9jYWxMaW5lcztcbiAgfVxuICBcbiAgZ2V0TGluZXMgKCkge1xuICAgIGlmICh0aGlzLl9saW5lVXBkYXRlID09PSBmYWxzZSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xpbmVzO1xuICAgIH1cbiAgICB0aGlzLl9saW5lVXBkYXRlID0gZmFsc2U7XG5cbiAgICB2YXIgbGluZXMgPSAodGhpcy50ZXh0ICsgJycpLnNwbGl0KCdcXG4nKTtcbiAgICBpZiAodGhpcy53aWR0aCA8IDEpIHtcbiAgICAgIHRoaXMuX2xpbmVzID0gbGluZXM7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5fbGluZXMgPSB0aGlzLnNwbGljZUxpbmVzKGxpbmVzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fbGluZXM7XG4gIH1cblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhcyBcbiAgICovXG4gIHByZXJlbmRlciAoY2FudmFzKSB7XG4gICAgdmFyIGNvbnRleHQgPSBjYW52YXMuY29udGV4dDtcbiAgICBjb250ZXh0LmZvbnQgPSB0aGlzLmZvbnQ7XG4gICAgY29udGV4dC50ZXh0QWxpZ24gPSB0aGlzLmFsaWduO1xuICAgIGNvbnRleHQudGV4dEJhc2VsaW5lID0gdGhpcy5iYXNlbGluZTtcblxuICAgIHZhciB0ZXh0ID0gdGhpcy50ZXh0ICsgJyc7XG4gICAgdmFyIGxpbmVzID0gdGhpcy5nZXRMaW5lcygpO1xuICAgIHZhciBsZW5ndGggPSBsaW5lcy5sZW5ndGg7XG4gICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDtcbiAgICB2YXIgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG5cbiAgICB2YXIgZm9udFNpemUgPSB0aGlzLmZvbnRTaXplO1xuICAgIHZhciBsaW5lU2l6ZSA9IGZvbnRTaXplICogdGhpcy5saW5lSGVpZ2h0O1xuICAgIHZhciBvZmZzZXRYID0gdGhpcy5nZXRPZmZzZXRYKCkgKiB3aWR0aDtcbiAgICB2YXIgb2Zmc2V0WSA9IHRoaXMuZ2V0T2Zmc2V0WSgpO1xuICAgIGlmIChvZmZzZXRZID09PSAwKSB7XG4gICAgICBvZmZzZXRZID0gLU1hdGguZmxvb3IobGVuZ3RoIC8gMikgKiBsaW5lU2l6ZTtcbiAgICAgIG9mZnNldFkgKz0gKChsZW5ndGggKyAxKSAlIDIpICogKGxpbmVTaXplIC8gMik7XG4gICAgfVxuICAgIGVsc2UgaWYgKG9mZnNldFkgPCAwKSB7XG4gICAgICBvZmZzZXRZICo9IGhlaWdodDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBvZmZzZXRZID0gb2Zmc2V0WSAqIGhlaWdodCAtIGxlbmd0aCAqIGxpbmVTaXplICsgbGluZVNpemU7XG4gICAgfVxuXG4gICAgb2Zmc2V0WSAtPSB0aGlzLnNjcm9sbFk7XG4gICAgb2Zmc2V0WCAtPSB0aGlzLnNjcm9sbFg7XG4gICAgdmFyIHN0YXJ0ID0gKG9mZnNldFkgKyBoZWlnaHQgLyAyKSAvIC1saW5lU2l6ZSB8IDA7XG4gICAgaWYgKHN0YXJ0IDwgMCkgeyBzdGFydCA9IDA7IH1cblxuICAgIHZhciBlbmQgPSAoaGVpZ2h0IC8gMiAtIG9mZnNldFkgKyBsaW5lU2l6ZSAqIDIpIC8gbGluZVNpemUgfCAwO1xuICAgIGxpbmVzID0gbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUsIGkpIHtcbiAgICAgIHJldHVybiBzdGFydCA8PSBpICYmIGVuZCA+IGk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmxpbmVzID0gbGluZXM7XG4gICAgdGhpcy5vZmZzZXRYID0gb2Zmc2V0WDtcbiAgICB0aGlzLm9mZnNldFkgPSBvZmZzZXRZO1xuICAgIHRoaXMubGluZVNpemUgPSBsaW5lU2l6ZTtcbiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7XG4gIH1cblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9ncmFwaGljcy9jYW52YXMnKS5DYW52YXN9IGNhbnZhcyBcbiAgICovXG4gIHJlbmRlckZpbGwgKGNhbnZhcykge1xuICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmNvbnRleHQ7XG4gICAgdmFyIG9mZnNldFggPSB0aGlzLm9mZnNldFg7XG4gICAgdmFyIG9mZnNldFkgPSB0aGlzLm9mZnNldFk7XG4gICAgdmFyIGxpbmVTaXplID0gdGhpcy5saW5lU2l6ZTtcbiAgICB2YXIgc3RhcnQgPSB0aGlzLnN0YXJ0O1xuICAgIHRoaXMubGluZXMuZm9yRWFjaChmdW5jdGlvbihsaW5lLCBpKSB7XG4gICAgICBjb250ZXh0LmZpbGxUZXh0KGxpbmUsIG9mZnNldFgsIChzdGFydCArIGkpICogbGluZVNpemUgKyBvZmZzZXRZKTtcbiAgICB9LCB0aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3ZlcnJpZGVcbiAgICogQHBhcmFtIHtpbXBvcnQoJy4uL2dyYXBoaWNzL2NhbnZhcycpLkNhbnZhc30gY2FudmFzIFxuICAgKi9cbiAgcmVuZGVyU3Ryb2tlIChjYW52YXMpIHtcbiAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5jb250ZXh0O1xuICAgIHZhciBvZmZzZXRYID0gdGhpcy5vZmZzZXRYO1xuICAgIHZhciBvZmZzZXRZID0gdGhpcy5vZmZzZXRZO1xuICAgIHZhciBsaW5lU2l6ZSA9IHRoaXMubGluZVNpemU7XG4gICAgdmFyIHN0YXJ0ID0gdGhpcy5zdGFydDtcbiAgICB0aGlzLmxpbmVzLmZvckVhY2goZnVuY3Rpb24obGluZSwgaSkge1xuICAgICAgY29udGV4dC5zdHJva2VUZXh0KGxpbmUsIG9mZnNldFgsIChzdGFydCArIGkpICogbGluZVNpemUgKyBvZmZzZXRZKTtcbiAgICB9LCB0aGlzKTtcbiAgfVxuXG4gIGdldCB0ZXh0KCkge1xuICAgIHJldHVybiB0aGlzLl90ZXh0O1xuICB9XG4gIHNldCB0ZXh0KHYpIHtcbiAgICB0aGlzLl90ZXh0ID0gdjtcbiAgfVxuXG4gIGdldCBzY3JvbGxYKCkge1xuICAgIHJldHVybiB0aGlzLnNjcm9sbC54O1xuICB9XG4gIHNldCBzY3JvbGxYKHYpIHtcbiAgICB0aGlzLnNjcm9sbC54ID0gdjtcbiAgfVxuXG4gIGdldCBzY3JvbGxZKCkge1xuICAgIHJldHVybiB0aGlzLnNjcm9sbC55O1xuICB9XG4gIHNldCBzY3JvbGxZKHYpIHtcbiAgICB0aGlzLnNjcm9sbC55ID0gdjtcbiAgfVxuICBcbiAgLy8gX3N0YXRpYzoge1xuICAvLyAgIGRlZmF1bHRzOiB7XG4gIC8vICAgICB2ZXJ0aWNhbEFsaWduOiAndG9wJyxcbiAgLy8gICAgIGFsaWduOiAnbGVmdCcsXG4gIC8vICAgICBiYXNlbGluZTogJ3RvcCcsXG4gIC8vICAgICB3aWR0aDogMzIwLFxuICAvLyAgICAgaGVpZ2h0OiAzMjAsXG4gIC8vICAgICBzY3JvbGxYOiAwLFxuICAvLyAgICAgc2Nyb2xsWTogMCxcbiAgLy8gICB9LFxuICAvLyAgIGFsaWduVG9PZmZzZXRNYXA6IHtcbiAgLy8gICAgIHN0YXJ0OiAtMC41LFxuICAvLyAgICAgbGVmdDogLTAuNSxcbiAgLy8gICAgIGNlbnRlcjogMCxcbiAgLy8gICAgIGVuZDogMC41LFxuICAvLyAgICAgcmlnaHQ6IDAuNSxcbiAgLy8gICB9LFxuXG4gIC8vICAgdmVydGljYWxBbGlnblRvT2Zmc2V0TWFwOiB7XG4gIC8vICAgICB0b3A6IC0wLjUsXG4gIC8vICAgICBjZW50ZXI6IDAsXG4gIC8vICAgICBtaWRkbGU6IDAsXG4gIC8vICAgICBib3R0b206IDAuNSxcbiAgLy8gICB9LFxuICAvLyB9LFxuXG4gIC8vIF9kZWZpbmVkOiBmdW5jdGlvbigpIHtcbiAgLy8gICB2YXIgZnVuYyA9IGZ1bmN0aW9uKG5ld1ZhbCwgb2xkVmFsKSB7XG4gIC8vICAgICBpZigodGhpcy5fbGluZVVwZGF0ZSA9PT0gZmFsc2UpICYmIChuZXdWYWwgIT09IG9sZFZhbCkpe1xuICAvLyAgICAgICB0aGlzLl9saW5lVXBkYXRlID0gdHJ1ZTtcbiAgLy8gICAgIH1cbiAgLy8gICB9O1xuXG4gIC8vICAgW1xuICAvLyAgICAgJ3RleHQnLFxuICAvLyAgICAgJ3dpZHRoJyxcbiAgLy8gICAgICdmb250U2l6ZScsXG4gIC8vICAgICAnZm9udFdlaWdodCcsXG4gIC8vICAgICAnZm9udEZhbWlseSdcbiAgLy8gICBdLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gIC8vICAgICB0aGlzLiR3YXRjaChrZXksIGZ1bmMpO1xuICAvLyAgIH0sIHRoaXMucHJvdG90eXBlKTtcblxuICAvLyAgIHBoaW5hLmRpc3BsYXkuU2hhcGUud2F0Y2hSZW5kZXJQcm9wZXJ0aWVzLmNhbGwodGhpcyAsW1xuICAvLyAgICAgJ3ZlcnRpY2FsQWxpZ24nLFxuICAvLyAgICAgJ3RleHQnLFxuICAvLyAgICAgJ3Njcm9sbCcsXG4gIC8vICAgICAnc2Nyb2xsWCcsXG4gIC8vICAgICAnc2Nyb2xsWSdcbiAgLy8gICBdKTtcbiAgLy8gfSxcblxuICAvKipcbiAgICog5pyq5a6a576pXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZW5hYmxlU2Nyb2xsKCkge1xuICAgIC8vICAgdGhpcy5zZXRJbnRlcmFjdGl2ZSh0cnVlKTtcbiAgICAvLyAgIHZhciBwaHlzaWNhbCA9IHBoaW5hLmFjY2Vzc29yeS5QaHlzaWNhbCgpO1xuICAgIC8vICAgcGh5c2ljYWwuYXR0YWNoVG8odGhpcyk7XG4gICAgLy8gICBwaHlzaWNhbC5mcmljdGlvbiA9IDAuODtcbiAgICAvLyAgIHZhciBsYXN0Rm9yY2UgPSAwO1xuICAgIC8vICAgdmFyIGxhc3RNb3ZlID0gMDtcbiAgICAvLyAgIHRoaXMub24oJ3BvaW50c3RhcnQnLCBmdW5jdGlvbihlKXtcbiAgICAvLyAgICAgbGFzdEZvcmNlID0gcGh5c2ljYWwudmVsb2NpdHkueTtcbiAgICAvLyAgICAgbGFzdE1vdmUgPSAwO1xuICAgIC8vICAgICBwaHlzaWNhbC5mb3JjZSgwLCAwKTtcbiAgICAvLyAgIH0pO1xuICAgIC8vICAgdGhpcy5vbigncG9pbnRtb3ZlJywgZnVuY3Rpb24oZSl7XG4gICAgLy8gICAgIHZhciBwID0gZS5wb2ludGVyLmRlbHRhUG9zaXRpb247XG4gICAgLy8gICAgIGxhc3RNb3ZlID0gcC55O1xuICAgIC8vICAgICB0aGlzLnNjcm9sbFkgKz0gbGFzdE1vdmU7XG4gICAgLy8gICB9KTtcblxuICAgIC8vICAgdGhpcy5vbigncG9pbnRlbmQnLCBmdW5jdGlvbihlKXtcbiAgICAvLyAgICAgcGh5c2ljYWwuZm9yY2UoMCwgbGFzdEZvcmNlICsgbGFzdE1vdmUpO1xuICAgIC8vICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG59XG5cbi8qKlxuICogQHR5cGUge0xhYmVsQXJlYU9wdGlvbnN9XG4gKi9cbkxhYmVsQXJlYS5kZWZhdWx0cyA9IHtcbiAgdmVydGljYWxBbGlnbjogJ3RvcCcsXG4gIGFsaWduOiAnbGVmdCcsXG4gIGJhc2VsaW5lOiAndG9wJyxcbiAgd2lkdGg6IDMyMCxcbiAgaGVpZ2h0OiAzMjAsXG4gIHNjcm9sbFg6IDAsXG4gIHNjcm9sbFk6IDAsXG59O1xuTGFiZWxBcmVhLmFsaWduVG9PZmZzZXRNYXAgPSB7XG4gIHN0YXJ0OiAtMC41LFxuICBsZWZ0OiAtMC41LFxuICBjZW50ZXI6IDAsXG4gIGVuZDogMC41LFxuICByaWdodDogMC41LFxufTtcbkxhYmVsQXJlYS52ZXJ0aWNhbEFsaWduVG9PZmZzZXRNYXAgPSB7XG4gIHRvcDogLTAuNSxcbiAgY2VudGVyOiAwLFxuICBtaWRkbGU6IDAsXG4gIGJvdHRvbTogMC41LFxufVxuXG4vLyBkZWZpbmVkXG47KGZ1bmN0aW9uKCkge1xuICB2YXIgZnVuYyA9IGZ1bmN0aW9uKG5ld1ZhbCwgb2xkVmFsKSB7XG4gICAgaWYoKHRoaXMuX2xpbmVVcGRhdGUgPT09IGZhbHNlKSAmJiAobmV3VmFsICE9PSBvbGRWYWwpKXtcbiAgICAgIHRoaXMuX2xpbmVVcGRhdGUgPSB0cnVlO1xuICAgIH1cbiAgfTtcblxuICBbXG4gICAgJ3RleHQnLFxuICAgICd3aWR0aCcsXG4gICAgJ2ZvbnRTaXplJyxcbiAgICAnZm9udFdlaWdodCcsXG4gICAgJ2ZvbnRGYW1pbHknXG4gIF0uZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAkd2F0Y2guY2FsbCh0aGlzLCBrZXksIGZ1bmMpO1xuICAgIC8vIHRoaXMuJHdhdGNoKGtleSwgZnVuYyk7XG4gIH0sIExhYmVsQXJlYS5wcm90b3R5cGUpO1xufSkoKTtcblxuU2hhcGUud2F0Y2hSZW5kZXJQcm9wZXJ0aWVzLmNhbGwoTGFiZWxBcmVhICxbXG4gICd2ZXJ0aWNhbEFsaWduJyxcbiAgJ3RleHQnLFxuICAnc2Nyb2xsJyxcbiAgJ3Njcm9sbFgnLFxuICAnc2Nyb2xsWSdcbl0pO1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5lZmZlY3QuV2F2ZVxuICogX2V4dGVuZHMgcGhpbmEuZGlzcGxheS5DaXJjbGVTaGFwZVxuICovXG5jbGFzcyBXYXZlIGV4dGVuZHMgQ2lyY2xlU2hhcGUge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuLi9kaXNwbGF5L3NoYXBlXCIpLkNpcmNsZVNoYXBlT3B0aW9uc30gW29wdGlvbnNdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwob3B0aW9ucyB8fCB7fSwge1xuICAgIC8vIG9wdGlvbnMgPSAob3B0aW9ucyB8fCB7fSkuJHNhZmUoe1xuICAgICAgZmlsbDogJ3doaXRlJyxcbiAgICAgIHN0cm9rZTogZmFsc2UsXG4gICAgfSk7XG5cbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIHZhciB0d2VlbmVyID0gbmV3IFR3ZWVuZXIoKS5hdHRhY2hUbyh0aGlzKTtcbiAgICB0d2VlbmVyXG4gICAgICAudG8oe3NjYWxlWDoyLCBzY2FsZVk6MiwgYWxwaGE6MH0sIDUwMClcbiAgICAgIC5jYWxsKGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnJlbW92ZSgpO1xuICAgICAgfSwgdGhpcyk7XG4gIH1cbn1cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuc29jaWFsLlR3aXR0ZXJcbiAqICMgVHdpdHRlciDjga7lhbHmnInjg6rjg7Pjgq/jgpLnlJ/miJDjgZnjgovjgq/jg6njgrlcbiAqIFR3aXR0ZXIg44Gu5YWx5pyJ44Oq44Oz44Kv44GuIFVSTCDjgpLnlJ/miJDjgZfjgabjgY/jgozjgovjgq/jg6njgrnjgafjgZnjgIJcbiAqL1xuY2xhc3MgVHdpdHRlciB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBcbiAgICog44Kz44Oz44K544OI44Op44Kv44K/44Gv5a2Y5Zyo44GX44G+44GZ44GM44Kk44Oz44K544K/44Oz44K544Oh44Oz44OQ44Gv44GC44KK44G+44Gb44KT44CCXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHt9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgcGhpbmEuc29jaWFsLlR3aXR0ZXIuY3JlYXRlVVJMXG4gICAqIEBzdGF0aWNcbiAgICogVHdpdHRlcuOBruWFseacieODquODs+OCr+OCkueUn+aIkOOBl+OBvuOBmeOAguW8leaVsOOBq+OCquODluOCuOOCp+OCr+ODiOOCkua4oeOBmeOBk+OBqOOBp+anmOOAheOBquODkeODqeODoeODvOOCv+ODvOOCkuioreWumuWHuuadpeOBvuOBmeOAguW8leaVsOOBruOCquODluOCuOOCp+OCr+ODiOOBryB7QGxpbmsgI3BoaW5hLnNvY2lhbC5Ud2l0dGVyLmRlZmF1bHRzfSDjgaflronlhajmi6HlvLXjgZXjgozjgb7jgZnjgIJcbiAgICogXG4gICAqICMjIyBFeGFtcGxlXG4gICAqICAgICBwaGluYS5zb2NpYWwuVHdpdHRlci5jcmVhdGVVUkwoKTsgLy8gPT4gaHR0cDovL3R3aXR0ZXIuY29tL2ludGVudC90d2VldD90ZXh0PUhlbGxvJTJDJTIwd29ybGQhJmhhc2h0YWdzPWphdmFzY3JpcHQlMkNwaGluYSZ1cmw9e+ePvuWcqOOBrlVSTH1cbiAgICogXG4gICAqICAgICBwaGluYS5zb2NpYWwuVHdpdHRlci5jcmVhdGVVUkwoe1xuICAgKiAgICAgICB0ZXh0OiAnVGhpcyBpcyB0ZXh0JyxcbiAgICogICAgICAgaGFzaHRhZ3M6ICdoYXNodGFnMSxoYXNodGFnMicsXG4gICAqICAgICAgIHVybDogJ2h0dHA6Ly9waGluYWpzLmNvbSdcbiAgICogICAgIH0pOyAvLyA9PiBodHRwOi8vdHdpdHRlci5jb20vaW50ZW50L3R3ZWV0P3RleHQ9VGhpcyUyMGlzJTIwdGV4dCZoYXNodGFncz1oYXNodGFnMSUyQ2hhc2h0YWcyJnVybD1odHRwJTNBJTJGJTJGcGhpbmFqcy5jb21cbiAgICogXG4gICAqICAgICBwaGluYS5zb2NpYWwuVHdpdHRlci5jcmVhdGVVUkwoe1xuICAgKiAgICAgICB0ZXh0OiAnVGhpcyBpcyB0ZXh0JyxcbiAgICogICAgICAgaGFzaHRhZ3M6ICdoYXNodGFnMSxoYXNodGFnMicsXG4gICAqICAgICAgIHVybDogJ2h0dHA6Ly9waGluYWpzLmNvbScsXG4gICAqICAgICAgIG90aGVyOiAnVGhpcyBpcyBvdGhlcicvL+ioreWumumgheebruOBr+mBqeW9k+OBq+Wil+OChOOBm+OCi1xuICAgKiAgICAgfSk7IC8vID0+IGh0dHA6Ly90d2l0dGVyLmNvbS9pbnRlbnQvdHdlZXQ/dGV4dD1UaGlzJTIwaXMlMjB0ZXh0Jmhhc2h0YWdzPWhhc2h0YWcxJTJDaGFzaHRhZzImdXJsPWh0dHAlM0ElMkYlMkZwaGluYWpzLmNvbSZvdGhlcj1UaGlzJTIwaXMlMjBvdGhlclxuICAgKiBcbiAgICogICAgIHBoaW5hLnNvY2lhbC5Ud2l0dGVyLmNyZWF0ZVVSTCh7XG4gICAqICAgICAgIHVybDogJ2h0dHA6Ly9waGluYWpzLmNvbSdcbiAgICogICAgIH0pOyAvLyA9PiBodHRwOi8vdHdpdHRlci5jb20vaW50ZW50L3R3ZWV0P3VybD1odHRwJTNBJTJGJTJGcGhpbmFqcy5jb20mdGV4dD1IZWxsbyUyQyUyMHdvcmxkISZoYXNodGFncz1qYXZhc2NyaXB0JTJDcGhpbmFcbiAgICogXG4gICAqIEBwYXJhbSB7VHdpdHRlci5kZWZhdWx0c30gb3B0aW9uc1xuICAgKiBAcmV0dXJuIHtTdHJpbmd9IFR3aXR0ZXIg44Gu5YWx5pyJ44Oq44Oz44KvXG4gICAqL1xuICBzdGF0aWMgY3JlYXRlVVJMIChvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwob3B0aW9ucyB8fCB7fSwgVHdpdHRlci5kZWZhdWx0cyk7XG4gICAgLy8gb3B0aW9ucyA9IChvcHRpb25zIHx8IHt9KS4kc2FmZSh0aGlzLmRlZmF1bHRzKTtcblxuICAgIHZhciBxdWVyaWVzID0gW107XG4gICAgdmFyIGV1YyA9IGVuY29kZVVSSUNvbXBvbmVudDtcbiAgICBmb3JJbi5jYWxsKG9wdGlvbnMsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAvLyBvcHRpb25zLmZvckluKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgIHZhciBzdHIgPSBrZXkgKyAnPScgKyBldWModmFsdWUpO1xuICAgICAgcXVlcmllcy5wdXNoKHN0cik7XG4gICAgfSk7XG5cbiAgICB2YXIgdXJsID0gZm9ybWF0LmNhbGwoJ3tiYXNlVVJMfS97dHlwZX0/e3F1ZXJ5fScsIHtcbiAgICAvLyB2YXIgdXJsID0gJ3tiYXNlVVJMfS97dHlwZX0/e3F1ZXJ5fScuZm9ybWF0KHtcbiAgICAgIGJhc2VVUkw6IHRoaXMuYmFzZVVSTCxcbiAgICAgIC8vIHR5cGU6IG9wdGlvbnMudHlwZSxcbiAgICAgIHR5cGU6ICd0d2VldCcsXG4gICAgICBxdWVyeTogcXVlcmllcy5qb2luKCcmJyksXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdXJsO1xuICB9XG5cbn1cblxuXG4vKipcbiAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbcGhpbmEuc29jaWFsLlR3aXR0ZXIuYmFzZVVSTCA9ICdodHRwczovL3R3aXR0ZXIuY29tL2ludGVudCddXG4gKiBUd2l0dGVyIOOBruWFseacieODquODs+OCr+OBruODmeODvOOCueOBqOOBquOCiyBVUkwg44Gn44GZ44CCXG4gKiBcbiAqIEBzdGF0aWNcbiAqL1xuVHdpdHRlci5iYXNlVVJMID0gJ2h0dHBzOi8vdHdpdHRlci5jb20vaW50ZW50JztcblxuLyoqXG4gKiBAcHJvcGVydHkge09iamVjdH0gcGhpbmEuc29jaWFsLlR3aXR0ZXIuZGVmYXVsdHNcbiAqIOODh+ODleOCqeODq+ODiOWApOOCkuagvOe0jeOBl+OBpuOBhOOCi+OCquODluOCuOOCp+OCr+ODiOOBp+OBmeOAgntAbGluayAjcGhpbmEuc29jaWFsLlR3aXR0ZXIuZGVmYXVsdHMudGV4dH0sIHtAbGluayAjcGhpbmEuc29jaWFsLlR3aXR0ZXIuZGVmYXVsdHMuaGFzaHRhZ3N9LCB7QGxpbmsgI3BoaW5hLnNvY2lhbC5Ud2l0dGVyLmRlZmF1bHRzLnVybH0g44KS5YaF5YyF44GX44Gm44GE44G+44GZ44CCXG4gKiBcbiAqIEBzdGF0aWNcbiAqL1xuVHdpdHRlci5kZWZhdWx0cyA9IHtcbiAgLy8gdHlwZTogJ3R3ZWV0JyxcblxuICAvKipcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IFtwaGluYS5zb2NpYWwuVHdpdHRlci5kZWZhdWx0cy50ZXh0ID0gJ0hlbGxvLCBXb3JsZCddXG4gICAqIOODh+ODleOCqeODq+ODiOOBp+ODhOOCpOODvOODiOOBq+WQq+OBvuOCjOOCi+aWh+Wtl+WIl+OBp+OBmeOAglxuICAgKiBcbiAgICogQHN0YXRpY1xuICAgKi9cbiAgdGV4dDogJ0hlbGxvLCB3b3JsZCEnLFxuXG4gIC8vIHNjcmVlbl9uYW1lOiAncGhpX2pwJyxcblxuICAvKipcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IFtwaGluYS5zb2NpYWwuVHdpdHRlci5kZWZhdWx0cy5oYXNodGFncyA9ICdqYXZhc2NyaXB0LCBwaGluYV9qcyddXG4gICAqIOODh+ODleOCqeODq+ODiOOBp+ODhOOCpOODvOODiOOBq+WQq+OBvuOCjOOCi+ODj+ODg+OCt+ODpeOCv+OCsOOBp+OBmeOAglxuICAgKiBcbiAgICogQHN0YXRpY1xuICAgKi9cbiAgaGFzaHRhZ3M6ICdqYXZhc2NyaXB0LHBoaW5hX2pzJyxcblxuICAvLyB1cmw6ICdodHRwOi8vZ2l0aHViLmNvbS9waGktanAvcGhpbmEuanMnLFxuXG4gIC8qKlxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW3BoaW5hLnNvY2lhbC5Ud2l0dGVyLmRlZmF1bHRzLnVybCA9IHBoaW5hLmdsb2JhbC5sb2NhdGlvbiAmJiBwaGluYS5nbG9iYWwubG9jYXRpb24uaHJlZl1cbiAgICog44OH44OV44Kp44Or44OI44Gn44OE44Kk44O844OI44Gr5ZCr44G+44KM44KLIFVSTCDjgafjgZnjgIJcbiAgICogXG4gICAqIEBzdGF0aWNcbiAgICovXG4gIHVybDogcGhpbmEuZ2xvYmFsLmxvY2F0aW9uICYmIHBoaW5hLmdsb2JhbC5sb2NhdGlvbi5ocmVmXG5cbiAgLy8gdmlhOiAncGhpX2pwJyxcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgY2xhc3NOYW1lOiBzdHJpbmcgfCAobmV3ICguLi5hcmdzOiBhbnkpPT4gYW55KVxuICogICBsYWJlbDogaW1wb3J0KFwiLi4vYXBwL3NjZW5lXCIpLlNjZW5lTGFiZWxcbiAqICAgYXJndW1lbnRzPzogYW55XG4gKiAgIG5leHRMYWJlbD86IGltcG9ydChcIi4uL2FwcC9zY2VuZVwiKS5TY2VuZUxhYmVsXG4gKiAgIG5leHRBcmd1bWVudHM/OiBhbnlcbiAqIH19IFNjZW5lRGF0YVxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgc3RhcnRMYWJlbDogaW1wb3J0KFwiLi4vYXBwL3NjZW5lXCIpLlNjZW5lTGFiZWxcbiAqICAgc2NlbmVzOiBTY2VuZURhdGFbXVxuICogfX0gTWFuYWdlclNjZW5lUGFyYW1zXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZ2FtZS5NYW5hZ2VyU2NlbmVcbiAqIF9leHRlbmRzIHBoaW5hLmFwcC5TY2VuZVxuICovXG5jbGFzcyBNYW5hZ2VyU2NlbmUgZXh0ZW5kcyBTY2VuZSB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge01hbmFnZXJTY2VuZVBhcmFtc30gcGFyYW1zXG4gICAqL1xuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgLyoqIEB0eXBlIFNjZW5lRGF0YVtdICovXG4gICAgdGhpcy5zY2VuZXM7XG4gICAgLyoqIEB0eXBlIG51bWJlciAqL1xuICAgIHRoaXMuc2NlbmVJbmRleDtcblxuICAgIHRoaXMuc2V0U2NlbmVzKHBhcmFtcy5zY2VuZXMpO1xuXG4gICAgdGhpcy5vbihcImVudGVyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5nb3RvU2NlbmUocGFyYW1zLnN0YXJ0TGFiZWwgfHwgMCk7XG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMub24oXCJyZXN1bWVcIiwgdGhpcy5vbm5leHQuYmluZCh0aGlzKSk7XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZSDmnKrkvb/nlKhcbiAgICAgKi9cbiAgICB0aGlzLmNvbW1vbkFyZ3VtZW50cyA9IHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIHNjZW5lcyDjgpLjgrvjg4Pjg4hcbiAgICogXG4gICAqIEBwYXJhbSB7U2NlbmVEYXRhW119IHNjZW5lc1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHNldFNjZW5lcyhzY2VuZXMpIHtcbiAgICB0aGlzLnNjZW5lcyA9IHNjZW5lcztcbiAgICB0aGlzLnNjZW5lSW5kZXggPSAwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogU2NlbmXjgq/jg6njgrnjgpLjgqTjg7Pjgrnjgr/jg7PjgrnljJbjgZfjgabov5TjgZlcbiAgICogXG4gICAqIEBwYXJhbSB7U2NlbmVEYXRhfSBkYXRhIFNjZW5l44OH44O844K/XG4gICAqIEBwYXJhbSB7YW55fSBhcmdzIOOCpOODs+OCueOCv+ODs+OCueWMluOBrumam+OBruOCs+ODs+OCueODiOODqeOCr+OCv+OBruW8leaVsFxuICAgKiBAcmV0dXJucyB7U2NlbmV9XG4gICAqL1xuICBfaW5zdGFudGlhdGVTY2VuZShkYXRhLCBhcmdzKSB7XG4gICAgLy8gU2NlbmXliJ3mnJ/ljJblvJXmlbBcbiAgICAvLyB0eXBlc2NyaXB044GM5L2V5pWF44GLYXJndW1lbnRz44Gr5Y+N5b+c44GX44Gm5L2Z6KiI44Gq5byV5pWw5a6a576p44KS55Sf5oiQ44GZ44KL44Gf44KB44CB5paH5a2X5YiX5Y+C54Wn44Go44GZ44KLXG4gICAgdmFyIGluaXRBcmd1bWVudHMgPSAkZXh0ZW5kLmNhbGwoe30sIGRhdGFbXCJhcmd1bWVudHNcIl0sIGFyZ3MpO1xuICAgIC8vIHZhciBpbml0QXJndW1lbnRzID0ge30uJGV4dGVuZChkYXRhLmFyZ3VtZW50cywgYXJncyk7XG5cbiAgICAvKiogQHR5cGUge1NjZW5lfSAqL1xuICAgIHZhciBzY2VuZTtcblxuICAgIC8qKiBAdHlwZSB7KG5ldyAoYXJnczogYW55KT0+IGFueSl9ICovXG4gICAgdmFyIFNjZW5lQ29uc3RydWN0b3I7XG4gICAgaWYgKHR5cGVvZiBkYXRhLmNsYXNzTmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vIOaWh+Wtl+WIl+Wei+OBruWgtOWQiO+8mnBoaW5hLmRlZmluZeOAgeOBguOCi+OBhOOBr+OCsOODreODvOODkOODq+OCueOCs+ODvOODl++8iHdpbmRvd++8ieOBq+ebtOaOpeWumue+qeOBleOCjOOBn+OCr+ODqeOCueOBruaWh+Wtl+WIl1xuICAgICAgU2NlbmVDb25zdHJ1Y3RvciA9IHBoaW5hLnVzaW5nKGRhdGEuY2xhc3NOYW1lKTtcbiAgICAgIGlmICh0eXBlb2YgU2NlbmVDb25zdHJ1Y3RvciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBTY2VuZUNvbnN0cnVjdG9yID0gcGhpbmEudXNpbmcoJ3BoaW5hLmdhbWUuJyArIGRhdGEuY2xhc3NOYW1lKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRhLmNsYXNzTmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8g6Zai5pWw5Z6L44Gu5aC05ZCI77ya57SU57KL44GqY2xhc3PjgajopovjgarjgZlcbiAgICAgIFNjZW5lQ29uc3RydWN0b3IgPSBkYXRhLmNsYXNzTmFtZTtcbiAgICB9XG4gICAgc2NlbmUgPSBuZXcgU2NlbmVDb25zdHJ1Y3Rvcihpbml0QXJndW1lbnRzKTtcblxuICAgIC8vIOasoeOCt+ODvOODs+ODkeODqeODoeODvOOCv+OBjOeEoeOBhOWgtOWQiOOBruWHpueQhlxuICAgIGlmICghc2NlbmUubmV4dExhYmVsKSB7XG4gICAgICBzY2VuZS5uZXh0TGFiZWwgPSBkYXRhLm5leHRMYWJlbDtcbiAgICB9XG4gICAgaWYgKCFzY2VuZS5uZXh0QXJndW1lbnRzKSB7XG4gICAgICBzY2VuZS5uZXh0QXJndW1lbnRzID0gZGF0YS5uZXh0QXJndW1lbnRzO1xuICAgIH1cblxuICAgIHJldHVybiBzY2VuZVxuICB9XG5cbiAgLyoqXG4gICAqIOaMh+WumuOBl+OBn2xhYmVs44Gr5a++5b+c44GZ44KL44K344O844Oz44G46aOb44G2ICBcbiAgICogU2NlbmXjgq/jg6njgrnjgpLjgqTjg7Pjgrnjgr/jg7PjgrnljJbjgZfjgaZhcHDjgatyZXBsYWNlU2NlbmXjgZXjgZvjgosgIFxuICAgKiBcbiAgICogQHBhcmFtICB7aW1wb3J0KFwiLi4vYXBwL3NjZW5lXCIpLlNjZW5lTGFiZWx9IGxhYmVsIOOCt+ODvOODs+ODqeODmeODq1xuICAgKiBAcGFyYW0gIHthbnl9IFthcmdzXSBTY2VuZeOBq+OCj+OBn+OBmeW8leaVsOOBjOOBguOCi+WgtOWQiOOBq+aMh+WumlxuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIHJlcGxhY2VTY2VuZShsYWJlbCwgYXJncykge1xuICAgIHZhciBpbmRleCA9ICh0eXBlb2YgbGFiZWwgPT0gJ3N0cmluZycpID8gdGhpcy5sYWJlbFRvSW5kZXgobGFiZWwpIDogbGFiZWx8fDA7XG4gICAgaWYgKCF0aGlzLnNjZW5lc1tpbmRleF0pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0LmNhbGwoJ3BoaW5hLmpzIGVycm9yOiBgezB9YCDjgavlr77lv5zjgZnjgovjgrfjg7zjg7PjgYzjgYLjgorjgb7jgZvjgpMuJywgbGFiZWwpKTtcbiAgICB9XG4gICAgdmFyIHNjZW5lID0gdGhpcy5faW5zdGFudGlhdGVTY2VuZSh0aGlzLnNjZW5lc1tpbmRleF0sIGFyZ3MpO1xuICAgIHRoaXMuYXBwLnJlcGxhY2VTY2VuZShzY2VuZSk7XG4gICAgdGhpcy5zY2VuZUluZGV4ID0gaW5kZXg7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiDmjIflrprjgZfjgZ9sYWJlbOOBq+WvvuW/nOOBmeOCi+OCt+ODvOODs+OBuOmjm+OBtiAgXG4gICAqIHJlcGxhY2VTY2VuZeOBqOOBrumBleOBhOOBr2FwcC5yZXBsYWNlU2NlbmXjgafjga/jgarjgY/jgIFcbiAgICogYXBwLnB1c2hTY2VuZeOCkuWun+ihjOOBmeOCi+eCuVxuICAgKiBcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuLi9hcHAvc2NlbmVcIikuU2NlbmVMYWJlbH0gbGFiZWwg44K344O844Oz44Op44OZ44OrXG4gICAqIEBwYXJhbSB7YW55fSBhcmdzIFNjZW5l44Kz44Oz44K544OI44Op44Kv44K/44Gu5byV5pWwXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZ290b1NjZW5lKGxhYmVsLCBhcmdzKSB7XG4gICAgdmFyIGluZGV4ID0gKHR5cGVvZiBsYWJlbCA9PSAnc3RyaW5nJykgPyB0aGlzLmxhYmVsVG9JbmRleChsYWJlbCkgOiBsYWJlbHx8MDtcbiAgICBpZiAoIXRoaXMuc2NlbmVzW2luZGV4XSkge1xuICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQuY2FsbCgncGhpbmEuanMgZXJyb3I6IGB7MH1gIOOBq+WvvuW/nOOBmeOCi+OCt+ODvOODs+OBjOOBguOCiuOBvuOBm+OCky4nLCBsYWJlbCkpO1xuICAgIH1cbiAgICB2YXIgc2NlbmUgPSB0aGlzLl9pbnN0YW50aWF0ZVNjZW5lKHRoaXMuc2NlbmVzW2luZGV4XSwgYXJncyk7XG4gICAgdGhpcy5hcHAucHVzaFNjZW5lKHNjZW5lKTtcbiAgICB0aGlzLnNjZW5lSW5kZXggPSBpbmRleDtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOasoeOBruOCt+ODvOODs+OBuOmjm+OBtiAgXG4gICAqIOOCt+ODvOODs+OBjOWtmOWcqOOBl+OBquOBhOWgtOWQiOOAgVwiZmluaXNoXCLjgqTjg5njg7Pjg4jjgpLnmbrngavjgZfjgabntYLkuoZcbiAgICogXG4gICAqIEBwYXJhbSB7YW55fSBhcmdzIOasoeOBrlNjZW5l44Kz44Oz44K544OI44Op44Kv44K/44Gu5byV5pWwXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgZ290b05leHQoYXJncykge1xuICAgIHZhciBkYXRhID0gdGhpcy5zY2VuZXNbdGhpcy5zY2VuZUluZGV4XTtcbiAgICB2YXIgbmV4dEluZGV4ID0gbnVsbDtcblxuICAgIGlmIChkYXRhLm5leHRMYWJlbCkge1xuICAgICAgLy8g5qyh44Gu44Op44OZ44Or44GM6Kit5a6a44GV44KM44Gm44GE44Gf5aC05ZCIXG4gICAgICBuZXh0SW5kZXggPSB0aGlzLmxhYmVsVG9JbmRleChkYXRhLm5leHRMYWJlbCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRoaXMuc2NlbmVJbmRleCsxIDwgdGhpcy5zY2VuZXMubGVuZ3RoKSB7XG4gICAgICAvLyBpbmRleOS4iuOBruasoeOBruOCt+ODvOODs+OBq+mBt+enu1xuICAgICAgbmV4dEluZGV4ID0gdGhpcy5zY2VuZUluZGV4KzE7XG4gICAgfVxuXG4gICAgaWYgKG5leHRJbmRleCAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5nb3RvU2NlbmUobmV4dEluZGV4LCBhcmdzKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLmZsYXJlKFwiZmluaXNoXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIOePvuWcqOOBruOCt+ODvOODs+OBruOCpOODs+ODh+ODg+OCr+OCueOCkuWPluW+l1xuICAgKiBcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG4gIGdldEN1cnJlbnRJbmRleCgpIHtcbiAgICByZXR1cm4gdGhpcy5zY2VuZUluZGV4O1xuICB9XG5cbiAgLyoqXG4gICAqIOePvuWcqOOBruOCt+ODvOODs+OBruODqeODmeODq+OCkuWPluW+l1xuICAgKiBcbiAgICogQHJldHVybnMge2ltcG9ydChcIi4uL2FwcC9zY2VuZVwiKS5TY2VuZUxhYmVsfSBsYWJlbFxuICAgKi9cbiAgZ2V0Q3VycmVudExhYmVsKCkge1xuICAgIHJldHVybiB0aGlzLnNjZW5lc1t0aGlzLnNjZW5lSW5kZXhdLmxhYmVsO1xuICB9XG5cbiAgLyoqXG4gICAqIOODqeODmeODq+OBi+OCieOCpOODs+ODh+ODg+OCr+OCueOBq+WkieaPm1xuICAgKiBcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuLi9hcHAvc2NlbmVcIikuU2NlbmVMYWJlbH0gbGFiZWxcbiAgICovXG4gIGxhYmVsVG9JbmRleChsYWJlbCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5zY2VuZXMuZmlsdGVyKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHJldHVybiBkYXRhLmxhYmVsID09IGxhYmVsO1xuICAgIH0pWzBdO1xuXG4gICAgcmV0dXJuIHRoaXMuc2NlbmVzLmluZGV4T2YoZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICog44Kk44Oz44OH44OD44Kv44K544GL44KJ44Op44OZ44Or44Gr5aSJ5o+bXG4gICAqIFxuICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXhcbiAgICogQHJldHVybnMge2ltcG9ydChcIi4uL2FwcC9zY2VuZVwiKS5TY2VuZUxhYmVsfSBsYWJlbFxuICAgKi9cbiAgaW5kZXhUb0xhYmVsKGluZGV4KSB7XG4gICAgcmV0dXJuIHRoaXMuc2NlbmVzW2luZGV4XS5sYWJlbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiB7QGxpbmsgQmFzZUFwcCNwb3BTY2VuZX0g44Gu6Zqb44GrcmVzdW1l44Kk44OZ44Oz44OI57WM55Sx44Gn5a6f6KGM44GV44KM44CBXG4gICAqIOWvvuW/nOOBmeOCi+asoeOBruOCt+ODvOODs+OBq+enu+ihjOOBmeOCi1xuICAgKiBcbiAgICogQHBhcmFtIHt7IHByZXZTY2VuZTogeyBuZXh0TGFiZWw6IGltcG9ydChcIi4uL2FwcC9zY2VuZVwiKS5TY2VuZUxhYmVsOyBuZXh0QXJndW1lbnRzOiBhbnk7IH07IH19IGVcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBvbm5leHQoZSkge1xuICAgIHZhciBuZXh0TGFiZWwgPSBlLnByZXZTY2VuZS5uZXh0TGFiZWw7XG4gICAgdmFyIG5leHRBcmd1bWVudHMgPSBlLnByZXZTY2VuZS5uZXh0QXJndW1lbnRzO1xuICAgIGlmIChuZXh0TGFiZWwpIHtcbiAgICAgIHRoaXMuZ290b1NjZW5lKG5leHRMYWJlbCwgbmV4dEFyZ3VtZW50cyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5nb3RvTmV4dChuZXh0QXJndW1lbnRzKTtcbiAgICB9XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGxpZT86IGJvb2xlYW4sXG4gKiAgIGV4aXRUeXBlPzogJ2F1dG8nXG4gKiAgIGFzc2V0cz86IGltcG9ydChcIi4uL2Fzc2V0L2Fzc2V0bG9hZGVyXCIpLkFzc2V0TG9hZGVyTG9hZFBhcmFtXG4gKiB9ICYgaW1wb3J0KFwiLi4vZGlzcGxheS9kaXNwbGF5c2NlbmVcIikuRGlzcGxheVNjZW5lT3B0aW9ucyB9IExvYWRpbmdTY2VuZU9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5nYW1lLkxvYWRpbmdTY2VuZVxuICogX2V4dGVuZHMgcGhpbmEuZGlzcGxheS5EaXNwbGF5U2NlbmVcbiAqL1xuY2xhc3MgTG9hZGluZ1NjZW5lIGV4dGVuZHMgRGlzcGxheVNjZW5lIHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7TG9hZGluZ1NjZW5lT3B0aW9uc30gW29wdGlvbnNdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9ICRzYWZlLmNhbGwoe30sIG9wdGlvbnMsIExvYWRpbmdTY2VuZS5kZWZhdWx0cyk7XG4gICAgLy8gb3B0aW9ucyA9ICh7fSkuJHNhZmUob3B0aW9ucywgcGhpbmEuZ2FtZS5Mb2FkaW5nU2NlbmUuZGVmYXVsdHMpO1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgdGhpcy5nYXVnZSA9IG5ldyBHYXVnZSh7XG4gICAgICB2YWx1ZTogMCxcbiAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxuICAgICAgaGVpZ2h0OiAxMixcbiAgICAgIGZpbGw6ICcjYWFhJyxcbiAgICAgIHN0cm9rZTogZmFsc2UsXG4gICAgICBnYXVnZUNvbG9yOiAnaHNsYSgyMDAsIDEwMCUsIDgwJSwgMC44KScsXG4gICAgICBwYWRkaW5nOiAwLFxuICAgIH0pLmFkZENoaWxkVG8odGhpcylcbiAgICAgIC5zZXRQb3NpdGlvbihcbiAgICAgICAgdGhpcy5ncmlkWC5jZW50ZXIoKSxcbiAgICAgICAgMCxcbiAgICAgIClcbiAgICAgIC5zZXRPcmlnaW4oXG4gICAgICAgIDAuNSwgXG4gICAgICAgIDBcbiAgICAgICk7XG4gICAgLy8gdGhpcy5mcm9tSlNPTih7XG4gICAgLy8gICBjaGlsZHJlbjoge1xuICAgIC8vICAgICBnYXVnZToge1xuICAgIC8vICAgICAgIGNsYXNzTmFtZTogJ3BoaW5hLnVpLkdhdWdlJyxcbiAgICAvLyAgICAgICBhcmd1bWVudHM6IHtcbiAgICAvLyAgICAgICAgIHZhbHVlOiAwLFxuICAgIC8vICAgICAgICAgd2lkdGg6IHRoaXMud2lkdGgsXG4gICAgLy8gICAgICAgICBoZWlnaHQ6IDEyLFxuICAgIC8vICAgICAgICAgZmlsbDogJyNhYWEnLFxuICAgIC8vICAgICAgICAgc3Ryb2tlOiBmYWxzZSxcbiAgICAvLyAgICAgICAgIGdhdWdlQ29sb3I6ICdoc2xhKDIwMCwgMTAwJSwgODAlLCAwLjgpJyxcbiAgICAvLyAgICAgICAgIHBhZGRpbmc6IDAsXG4gICAgLy8gICAgICAgfSxcbiAgICAvLyAgICAgICB4OiB0aGlzLmdyaWRYLmNlbnRlcigpLFxuICAgIC8vICAgICAgIHk6IDAsXG4gICAgLy8gICAgICAgb3JpZ2luWTogMCxcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfVxuICAgIC8vIH0pO1xuXG4gICAgdmFyIGxvYWRlciA9IG5ldyBBc3NldExvYWRlcigpO1xuXG4gICAgaWYgKG9wdGlvbnMubGllKSB7XG4gICAgICB0aGlzLmdhdWdlLmFuaW1hdGlvblRpbWUgPSAxMCoxMDAwO1xuICAgICAgdGhpcy5nYXVnZS52YWx1ZSA9IDkwO1xuXG4gICAgICBsb2FkZXIub24oJ2xvYWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5nYXVnZS5hbmltYXRpb25UaW1lID0gMDtcbiAgICAgICAgdGhpcy5nYXVnZS52YWx1ZSA9IDEwMDtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5nYXVnZS5hbmltYXRpb25UaW1lID0gMTAwO1xuICAgICAgbG9hZGVyLm9uKCdwcm9ncmVzcycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdGhpcy5nYXVnZS52YWx1ZSA9IGUucHJvZ3Jlc3MgKiAxMDA7XG4gICAgICB9LmJpbmQodGhpcykpIDtcbiAgICB9XG5cbiAgICB0aGlzLmdhdWdlLm9uKCdmdWxsJywgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAob3B0aW9ucy5leGl0VHlwZSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgIHRoaXMuYXBwLnBvcFNjZW5lKCk7XG4gICAgICB9XG4gICAgICB0aGlzLmZsYXJlKCdsb2FkZWQnKTtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgbG9hZGVyLmxvYWQob3B0aW9ucy5hc3NldHMpO1xuICB9XG5cbn1cblxuLyoqIEB0eXBlIExvYWRpbmdTY2VuZU9wdGlvbnMgKi9cbkxvYWRpbmdTY2VuZS5kZWZhdWx0cyA9IHtcbiAgZXhpdFR5cGU6ICdhdXRvJyxcbiAgbGllOiBmYWxzZSxcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU3BsYXNoU2NlbmVPcHRpb25FeHRlbmRcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbaW1hZ2VVUkxdIOihqOekuuOBmeOCi+OCueODl+ODqeODg+OCt+ODpeeUu+WDj+ODkeOCuVxuICovXG5cbi8qKlxuICogQGNsYXNzIHBoaW5hLmdhbWUuU3BsYXNoU2NlbmVcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuRGlzcGxheVNjZW5lXG4gKi9cbmNsYXNzIFNwbGFzaFNjZW5lIGV4dGVuZHMgRGlzcGxheVNjZW5lIHtcblxuICAvKipcbiAgICogQHBhcmFtIHtpbXBvcnQoXCIuLi9kaXNwbGF5L2Rpc3BsYXlzY2VuZVwiKS5EaXNwbGF5U2NlbmVPcHRpb25zfSBbb3B0aW9uc11cbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB2YXIgZGVmYXVsdHMgPSBTcGxhc2hTY2VuZS5kZWZhdWx0cztcbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIHZhciB0ZXh0dXJlID0gbmV3IFRleHR1cmUoKTtcbiAgICB0ZXh0dXJlLmxvYWQoZGVmYXVsdHMuaW1hZ2VVUkwpLnRoZW4oXG4gICAgLyoqIEB0aGlzIFNwbGFzaFNjZW5lICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9pbml0KCk7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnRleHR1cmUgPSB0ZXh0dXJlO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwcml2YXRlXG4gICAqIOWIneacn+WMlumWouaVsFxuICAgKi9cbiAgX2luaXQoKSB7XG4gICAgdGhpcy5zcHJpdGUgPSBuZXcgU3ByaXRlKHRoaXMudGV4dHVyZSkuYWRkQ2hpbGRUbyh0aGlzKTtcblxuICAgIHRoaXMuc3ByaXRlLnNldFBvc2l0aW9uKHRoaXMuZ3JpZFguY2VudGVyKCksIHRoaXMuZ3JpZFkuY2VudGVyKCkpO1xuICAgIHRoaXMuc3ByaXRlLmFscGhhID0gMDtcblxuICAgIHRoaXMuc3ByaXRlLnR3ZWVuZXJcbiAgICAgIC5jbGVhcigpXG4gICAgICAudG8oe2FscGhhOjF9LCA1MDAsICdlYXNlT3V0Q3ViaWMnKVxuICAgICAgLndhaXQoMTAwMClcbiAgICAgIC50byh7YWxwaGE6MH0sIDUwMCwgJ2Vhc2VPdXRDdWJpYycpXG4gICAgICAud2FpdCgyNTApXG4gICAgICAuY2FsbChmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5leGl0KCk7XG4gICAgICB9LCB0aGlzKVxuICAgICAgO1xuICB9XG5cbn1cblxuLyoqIEB0eXBlIHtpbXBvcnQoXCIuLi9kaXNwbGF5L2Rpc3BsYXlzY2VuZVwiKS5EaXNwbGF5U2NlbmVPcHRpb25zICYgU3BsYXNoU2NlbmVPcHRpb25FeHRlbmR9ICovXG5TcGxhc2hTY2VuZS5kZWZhdWx0cyA9IHtcbiAgaW1hZ2VVUkw6ICdodHRwOi8vY2RuLnJhd2dpdC5jb20vcGhpLWpwL3BoaW5hLmpzL2RldmVsb3AvbG9nby5wbmcnLFxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBUaXRsZVNjZW5lT3B0aW9uRXh0ZW5kXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3RpdGxlXSDjgr/jgqTjg4jjg6vmloflrZfliJdcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbbWVzc2FnZV0g5pyq5L2/55SoXG4gKiBAcHJvcGVydHkge2ltcG9ydChcIi4uL2dyYXBoaWNzL2NhbnZhc1wiKS5DYW52YXNTdHlsZX0gW2ZvbnRDb2xvcl0g44K/44Kk44OI44Or44Op44OZ44Or44Gu6ImyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2JhY2tncm91bmRJbWFnZV0g5pyq5L2/55SoXG4gKiBAcHJvcGVydHkge1widG91Y2hcInxcIlwifSBbZXhpdFR5cGVdIFwidG91Y2hcIuaMh+WumuaZguOBq+iHquWLleOBp+OCv+ODg+ODgemBt+enu+OCpOODmeODs+ODiOOCkuS7mOS4jlxuICogXG4gKiBAdHlwZWRlZiB7aW1wb3J0KFwiLi4vZGlzcGxheS9kaXNwbGF5c2NlbmVcIikuRGlzcGxheVNjZW5lT3B0aW9ucyAmIFRpdGxlU2NlbmVPcHRpb25FeHRlbmR9IFRpdGxlU2NlbmVPcHRpb25zXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZ2FtZS5UaXRsZVNjZW5lXG4gKiBfZXh0ZW5kcyBwaGluYS5kaXNwbGF5LkRpc3BsYXlTY2VuZVxuICovXG5jbGFzcyBUaXRsZVNjZW5lIGV4dGVuZHMgRGlzcGxheVNjZW5lIHtcblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7VGl0bGVTY2VuZU9wdGlvbnN9IFtwYXJhbXNdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICBwYXJhbXMgPSAkc2FmZS5jYWxsKHt9LCBwYXJhbXMsIFRpdGxlU2NlbmUuZGVmYXVsdHMpO1xuICAgIC8vIHBhcmFtcyA9ICh7fSkuJHNhZmUocGFyYW1zLCBwaGluYS5nYW1lLlRpdGxlU2NlbmUuZGVmYXVsdHMpO1xuICAgIHN1cGVyKHBhcmFtcyk7XG5cbiAgICB0aGlzLmJhY2tncm91bmRDb2xvciA9IHBhcmFtcy5iYWNrZ3JvdW5kQ29sb3I7XG5cbiAgICB0aGlzLmZyb21KU09OKHtcbiAgICAgIGNoaWxkcmVuOiB7XG4gICAgICAgIHRpdGxlTGFiZWw6IHtcbiAgICAgICAgICBjbGFzc05hbWU6IExhYmVsLFxuICAgICAgICAgIC8vIGNsYXNzTmFtZTogJ3BoaW5hLmRpc3BsYXkuTGFiZWwnLFxuICAgICAgICAgIGFyZ3VtZW50czoge1xuICAgICAgICAgICAgdGV4dDogcGFyYW1zLnRpdGxlLFxuICAgICAgICAgICAgZmlsbDogcGFyYW1zLmZvbnRDb2xvcixcbiAgICAgICAgICAgIHN0cm9rZTogZmFsc2UsXG4gICAgICAgICAgICBmb250U2l6ZTogNjQsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB4OiB0aGlzLmdyaWRYLmNlbnRlcigpLFxuICAgICAgICAgIHk6IHRoaXMuZ3JpZFkuc3Bhbig0KSxcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHBhcmFtcy5leGl0VHlwZSA9PT0gJ3RvdWNoJykge1xuICAgICAgdGhpcy5mcm9tSlNPTih7XG4gICAgICAgIGNoaWxkcmVuOiB7XG4gICAgICAgICAgdG91Y2hMYWJlbDoge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiBMYWJlbCxcbiAgICAgICAgICAgIC8vIGNsYXNzTmFtZTogJ3BoaW5hLmRpc3BsYXkuTGFiZWwnLFxuICAgICAgICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgICAgICAgIHRleHQ6IFwiVE9VQ0ggU1RBUlRcIixcbiAgICAgICAgICAgICAgZmlsbDogcGFyYW1zLmZvbnRDb2xvcixcbiAgICAgICAgICAgICAgc3Ryb2tlOiBmYWxzZSxcbiAgICAgICAgICAgICAgZm9udFNpemU6IDMyLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHg6IHRoaXMuZ3JpZFguY2VudGVyKCksXG4gICAgICAgICAgICB5OiB0aGlzLmdyaWRZLnNwYW4oMTIpLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5vbigncG9pbnRlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5leGl0KCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxufVxuXG4vKipcbiAqIEB0eXBlIHtUaXRsZVNjZW5lT3B0aW9uc31cbiAqL1xuVGl0bGVTY2VuZS5kZWZhdWx0cyA9IHtcbiAgdGl0bGU6ICdwaGluYS5qcyBnYW1lcycsXG4gIG1lc3NhZ2U6ICcnLFxuXG4gIGZvbnRDb2xvcjogJ3doaXRlJyxcbiAgYmFja2dyb3VuZENvbG9yOiAnaHNsKDIwMCwgODAlLCA2NCUpJyxcbiAgYmFja2dyb3VuZEltYWdlOiAnJyxcblxuICBleGl0VHlwZTogJ3RvdWNoJyxcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge3tcbiAqICAgZm9udENvbG9yPzogc3RyaW5nLFxuICogICBleGl0VHlwZT86ICd0b3VjaCdcbiAqIH0gJiBpbXBvcnQoXCIuLi9kaXNwbGF5L2Rpc3BsYXlzY2VuZVwiKS5EaXNwbGF5U2NlbmVPcHRpb25zIH0gUGF1c2VTY2VuZU9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5nYW1lLlBhdXNlU2NlbmVcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuRGlzcGxheVNjZW5lXG4gKi9cbmNsYXNzIFBhdXNlU2NlbmUgZXh0ZW5kcyBEaXNwbGF5U2NlbmUge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtQYXVzZVNjZW5lT3B0aW9uc30gW3BhcmFtc11cbiAgICovXG4gIGNvbnN0cnVjdG9yKHBhcmFtcykge1xuICAgIHBhcmFtcyA9ICRzYWZlLmNhbGwoe30sIHBhcmFtcywgUGF1c2VTY2VuZS5kZWZhdWx0cyk7XG4gICAgLy8gcGFyYW1zID0gKHt9KS4kc2FmZShwYXJhbXMsIHBoaW5hLmdhbWUuUGF1c2VTY2VuZS5kZWZhdWx0cyk7XG4gICAgc3VwZXIocGFyYW1zKTtcblxuICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gcGFyYW1zLmJhY2tncm91bmRDb2xvcjtcblxuICAgIHRoaXMuZnJvbUpTT04oe1xuICAgICAgY2hpbGRyZW46IHtcbiAgICAgICAgdGV4dDoge1xuICAgICAgICAgIGNsYXNzTmFtZTogTGFiZWwsXG4gICAgICAgICAgLy8gY2xhc3NOYW1lOiAncGhpbmEuZGlzcGxheS5MYWJlbCcsXG4gICAgICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgICAgICB0ZXh0OiAnUGF1c2UnLFxuICAgICAgICAgICAgZmlsbDogcGFyYW1zLmZvbnRDb2xvcixcbiAgICAgICAgICAgIHN0cm9rZTogbnVsbCxcbiAgICAgICAgICAgIGZvbnRTaXplOiA0OCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHg6IHRoaXMuZ3JpZFguY2VudGVyKCksXG4gICAgICAgICAgeTogdGhpcy5ncmlkWS5jZW50ZXIoKSxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChwYXJhbXMuZXhpdFR5cGUgPT09ICd0b3VjaCcpIHtcbiAgICAgIHRoaXMub24oJ3BvaW50ZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZXhpdCgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbn1cblxuLyoqIEB0eXBlIFBhdXNlU2NlbmVPcHRpb25zICovXG5QYXVzZVNjZW5lLmRlZmF1bHRzID0gIHtcbiAgZm9udENvbG9yOiAnd2hpdGUnLFxuICBiYWNrZ3JvdW5kQ29sb3I6ICdoc2xhKDAsIDAlLCAwJSwgMC44NSknLFxuXG4gIGV4aXRUeXBlOiAndG91Y2gnLFxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBSZXN1bHRTY2VuZU9wdGlvbkV4dGVuZFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFtzY29yZV0gW2Rlc2NyaXB0aW9uXVxuICogQHByb3BlcnR5IHtzdHJpbmd9IFttZXNzYWdlXSBbZGVzY3JpcHRpb25dXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2hhc2h0YWdzXSBbZGVzY3JpcHRpb25dXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3VybF0gW2Rlc2NyaXB0aW9uXVxuICogQHByb3BlcnR5IHtcInRvdWNoXCJ9IFtleGl0VHlwZV0gW2Rlc2NyaXB0aW9uXVxuICogQHByb3BlcnR5IHtpbXBvcnQoXCIuLi9ncmFwaGljcy9jYW52YXNcIikuQ2FudmFzU3R5bGV9IFtmb250Q29sb3JdIFtkZXNjcmlwdGlvbl1cbiAqIEBwcm9wZXJ0eSB7aW1wb3J0KFwiLi4vZ3JhcGhpY3MvY2FudmFzXCIpLkNhbnZhc1N0eWxlfSBbYmFja2dyb3VuZENvbG9yXVxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtiYWNrZ3JvdW5kSW1hZ2VdIOacquS9v+eUqFxuICogXG4gKiBAdHlwZWRlZiB7aW1wb3J0KFwiLi4vZGlzcGxheS9kaXNwbGF5c2NlbmVcIikuRGlzcGxheVNjZW5lT3B0aW9ucyAmIFJlc3VsdFNjZW5lT3B0aW9uRXh0ZW5kfSBSZXN1bHRTY2VuZU9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5nYW1lLlJlc3VsdFNjZW5lXG4gKiBfZXh0ZW5kcyBwaGluYS5kaXNwbGF5LkRpc3BsYXlTY2VuZVxuICovXG5jbGFzcyBSZXN1bHRTY2VuZSBleHRlbmRzIERpc3BsYXlTY2VuZSB7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge1Jlc3VsdFNjZW5lT3B0aW9uc30gW3BhcmFtc11cbiAgICovXG4gIGNvbnN0cnVjdG9yKHBhcmFtcykge1xuICAgIHBhcmFtcyA9ICRzYWZlLmNhbGwoe30sIHBhcmFtcywgUmVzdWx0U2NlbmUuZGVmYXVsdHMpO1xuICAgIC8vIHBhcmFtcyA9ICh7fSkuJHNhZmUocGFyYW1zLCBwaGluYS5nYW1lLlJlc3VsdFNjZW5lLmRlZmF1bHRzKTtcbiAgICBzdXBlcihwYXJhbXMpO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBmb3JtYXQuY2FsbChwYXJhbXMubWVzc2FnZSwgcGFyYW1zKTtcbiAgICAvLyB2YXIgbWVzc2FnZSA9IHBhcmFtcy5tZXNzYWdlLmZvcm1hdChwYXJhbXMpO1xuXG4gICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBwYXJhbXMuYmFja2dyb3VuZENvbG9yO1xuXG4gICAgdGhpcy5mcm9tSlNPTih7XG4gICAgICBjaGlsZHJlbjoge1xuICAgICAgICBzY29yZVRleHQ6IHtcbiAgICAgICAgICBjbGFzc05hbWU6IExhYmVsLFxuICAgICAgICAgIC8vIGNsYXNzTmFtZTogJ3BoaW5hLmRpc3BsYXkuTGFiZWwnLFxuICAgICAgICAgIGFyZ3VtZW50czoge1xuICAgICAgICAgICAgdGV4dDogJ3Njb3JlJyxcbiAgICAgICAgICAgIGZpbGw6IHBhcmFtcy5mb250Q29sb3IsXG4gICAgICAgICAgICBzdHJva2U6IG51bGwsXG4gICAgICAgICAgICBmb250U2l6ZTogNDgsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB4OiB0aGlzLmdyaWRYLnNwYW4oOCksXG4gICAgICAgICAgeTogdGhpcy5ncmlkWS5zcGFuKDQpLFxuICAgICAgICB9LFxuICAgICAgICBzY29yZUxhYmVsOiB7XG4gICAgICAgICAgY2xhc3NOYW1lOiBMYWJlbCxcbiAgICAgICAgICAvLyBjbGFzc05hbWU6ICdwaGluYS5kaXNwbGF5LkxhYmVsJyxcbiAgICAgICAgICBhcmd1bWVudHM6IHtcbiAgICAgICAgICAgIHRleHQ6IHBhcmFtcy5zY29yZSsnJyxcbiAgICAgICAgICAgIGZpbGw6IHBhcmFtcy5mb250Q29sb3IsXG4gICAgICAgICAgICBzdHJva2U6IG51bGwsXG4gICAgICAgICAgICBmb250U2l6ZTogNzIsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB4OiB0aGlzLmdyaWRYLnNwYW4oOCksXG4gICAgICAgICAgeTogdGhpcy5ncmlkWS5zcGFuKDYpLFxuICAgICAgICB9LFxuXG4gICAgICAgIG1lc3NhZ2VMYWJlbDoge1xuICAgICAgICAgIGNsYXNzTmFtZTogTGFiZWwsXG4gICAgICAgICAgLy8gY2xhc3NOYW1lOiAncGhpbmEuZGlzcGxheS5MYWJlbCcsXG4gICAgICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgICAgICB0ZXh0OiBtZXNzYWdlLFxuICAgICAgICAgICAgZmlsbDogcGFyYW1zLmZvbnRDb2xvcixcbiAgICAgICAgICAgIHN0cm9rZTogbnVsbCxcbiAgICAgICAgICAgIGZvbnRTaXplOiAzMixcbiAgICAgICAgICB9LFxuICAgICAgICAgIHg6IHRoaXMuZ3JpZFguY2VudGVyKCksXG4gICAgICAgICAgeTogdGhpcy5ncmlkWS5zcGFuKDkpLFxuICAgICAgICB9LFxuXG4gICAgICAgIHNoYXJlQnV0dG9uOiB7XG4gICAgICAgICAgY2xhc3NOYW1lOiBCdXR0b24sXG4gICAgICAgICAgLy8gY2xhc3NOYW1lOiAncGhpbmEudWkuQnV0dG9uJyxcbiAgICAgICAgICBhcmd1bWVudHM6IFt7XG4gICAgICAgICAgICB0ZXh0OiAn4piFJyxcbiAgICAgICAgICAgIHdpZHRoOiAxMjgsXG4gICAgICAgICAgICBoZWlnaHQ6IDEyOCxcbiAgICAgICAgICAgIGZvbnRDb2xvcjogcGFyYW1zLmZvbnRDb2xvcixcbiAgICAgICAgICAgIGZvbnRTaXplOiA1MCxcbiAgICAgICAgICAgIGNvcm5lclJhZGl1czogNjQsXG4gICAgICAgICAgICBmaWxsOiAncmdiYSgyNDAsIDI0MCwgMjQwLCAwLjUpJyxcbiAgICAgICAgICAgIC8vIHN0cm9rZTogJyNhYWEnLFxuICAgICAgICAgICAgLy8gc3Ryb2tlV2lkdGg6IDIsXG4gICAgICAgICAgfV0sXG4gICAgICAgICAgeDogdGhpcy5ncmlkWC5jZW50ZXIoLTMpLFxuICAgICAgICAgIHk6IHRoaXMuZ3JpZFkuc3BhbigxMiksXG4gICAgICAgIH0sXG4gICAgICAgIHBsYXlCdXR0b246IHtcbiAgICAgICAgICBjbGFzc05hbWU6IEJ1dHRvbixcbiAgICAgICAgICAvLyBjbGFzc05hbWU6ICdwaGluYS51aS5CdXR0b24nLFxuICAgICAgICAgIGFyZ3VtZW50czogW3tcbiAgICAgICAgICAgIHRleHQ6ICfilrYnLFxuICAgICAgICAgICAgd2lkdGg6IDEyOCxcbiAgICAgICAgICAgIGhlaWdodDogMTI4LFxuICAgICAgICAgICAgZm9udENvbG9yOiBwYXJhbXMuZm9udENvbG9yLFxuICAgICAgICAgICAgZm9udFNpemU6IDUwLFxuICAgICAgICAgICAgY29ybmVyUmFkaXVzOiA2NCxcbiAgICAgICAgICAgIGZpbGw6ICdyZ2JhKDI0MCwgMjQwLCAyNDAsIDAuNSknLFxuICAgICAgICAgICAgLy8gc3Ryb2tlOiAnI2FhYScsXG4gICAgICAgICAgICAvLyBzdHJva2VXaWR0aDogMixcbiAgICAgICAgICB9XSxcbiAgICAgICAgICB4OiB0aGlzLmdyaWRYLmNlbnRlcigzKSxcbiAgICAgICAgICB5OiB0aGlzLmdyaWRZLnNwYW4oMTIpLFxuXG4gICAgICAgICAgaW50ZXJhY3RpdmU6IHRydWUsXG4gICAgICAgICAgb25wdXNoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuZXhpdCgpO1xuICAgICAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChwYXJhbXMuZXhpdFR5cGUgPT09ICd0b3VjaCcpIHtcbiAgICAgIHRoaXMub24oJ3BvaW50ZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZXhpdCgpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqIEB0eXBlIEJ1dHRvbiAmIHtvbmNsaWNrOiBGdW5jdGlvbn0gKi9cbiAgICB0aGlzLnNoYXJlQnV0dG9uO1xuXG4gICAgdGhpcy5zaGFyZUJ1dHRvbi5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgdGV4dCA9IGZvcm1hdC5jYWxsKCdTY29yZTogezB9XFxuezF9JywgcGFyYW1zLnNjb3JlLCBtZXNzYWdlKTtcbiAgICAgIC8vIHZhciB0ZXh0ID0gJ1Njb3JlOiB7MH1cXG57MX0nLmZvcm1hdChwYXJhbXMuc2NvcmUsIG1lc3NhZ2UpO1xuICAgICAgdmFyIHVybCA9IFR3aXR0ZXIuY3JlYXRlVVJMKHtcbiAgICAgICAgdGV4dDogdGV4dCxcbiAgICAgICAgaGFzaHRhZ3M6IHBhcmFtcy5oYXNodGFncyxcbiAgICAgICAgdXJsOiBwYXJhbXMudXJsLFxuICAgICAgfSk7XG4gICAgICB3aW5kb3cub3Blbih1cmwsICdzaGFyZSB3aW5kb3cnLCAnd2lkdGg9NDgwLCBoZWlnaHQ9MzIwJyk7XG4gICAgfTtcbiAgfVxuXG59XG5cbi8qKiBAdHlwZSB7UmVzdWx0U2NlbmVPcHRpb25zfSAqL1xuUmVzdWx0U2NlbmUuZGVmYXVsdHMgPSB7XG4gIHNjb3JlOiAxNixcblxuICBtZXNzYWdlOiAndGhpcyBpcyBwaGluYS5qcyBwcm9qZWN0LicsXG4gIGhhc2h0YWdzOiAncGhpbmFfanMsZ2FtZSxqYXZhc2NyaXB0JyxcbiAgdXJsOiBwaGluYS5nbG9iYWwubG9jYXRpb24gJiYgcGhpbmEuZ2xvYmFsLmxvY2F0aW9uLmhyZWYsXG5cbiAgZm9udENvbG9yOiAnd2hpdGUnLFxuICBiYWNrZ3JvdW5kQ29sb3I6ICdoc2woMjAwLCA4MCUsIDY0JSknLFxuICBiYWNrZ3JvdW5kSW1hZ2U6ICcnLFxufTtcblxuLyoqXG4gKiDjg4fjg5Xjgqnjg6vjg4jjgrfjg7zjg7Pjga7jgqrjg5fjgrfjg6fjg7PntbHlkIjlnotcbiAqIEB0eXBlZGVmIHsgaW1wb3J0KFwiLi90aXRsZXNjZW5lXCIpLlRpdGxlU2NlbmVPcHRpb25zXG4gKiAmIGltcG9ydChcIi4vcGF1c2VzY2VuZVwiKS5QYXVzZVNjZW5lT3B0aW9uc1xuICogJiBpbXBvcnQoXCIuL3Jlc3VsdHNjZW5lXCIpLlJlc3VsdFNjZW5lT3B0aW9uc1xuICogJiBpbXBvcnQoXCIuLi9nYW1lL2xvYWRpbmdzY2VuZVwiKS5Mb2FkaW5nU2NlbmVPcHRpb25zXG4gKiB9IERlZmF1bHRTY2VuZU9wdGlvbnNcbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHNjZW5lcz86IGltcG9ydChcIi4vbWFuYWdlcnNjZW5lXCIpLlNjZW5lRGF0YVtdXG4gKiAgIHN0YXJ0TGFiZWw/OiBpbXBvcnQoXCIuLi9hcHAvc2NlbmVcIikuU2NlbmVMYWJlbFxuICogICBhdXRvUGF1c2U/OiBib29sZWFuXG4gKiAgIGRlYnVnPzogYm9vbGVhblxuICogICBsb2FkaW5nU2NlbmU/OiB0eXBlb2YgRGlzcGxheVNjZW5lXG4gKiAgIHBhdXNlU2NlbmU/OiB0eXBlb2YgRGlzcGxheVNjZW5lXG4gKiB9IFxuICogJiBpbXBvcnQoXCIuLi9kaXNwbGF5L2NhbnZhc2FwcFwiKS5DYW52YXNBcHBPcHRpb25zXG4gKiB9IEdhbWVBcHBPcHRpb25zXG4gKi9cblxuLyoqXG4gKiDjg4fjg5Xjgqnjg6vjg4jjga5tYWluIGNsYXNzXG4gKi9cbmNsYXNzIERlZmF1bHRNYWluU2NlbmUgZXh0ZW5kcyBEaXNwbGF5U2NlbmUge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgY29uc29sZS5sb2coJ1RoaXMgaXMgTWFpblNjZW5lJyk7XG4gIH1cbn1cbi8qKlxuICog44Kv44Op44K544GMcGhpbmEuZGVmaW5l44Gr44KI44Gj44Gm5a6a576p77yI44Kw44Ot44O844OQ44Or44Gr5a6a576p77yJ44GV44KM44Gm44GE44KL44GL44Gp44GG44GL44KS44OB44Kn44OD44KvXG4gKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIOOCr+ODqeOCueWQjeOAgnBoaW5hLmdhbWVbY2xhc3NOYW1lXeOBp+Wumue+qeOBleOCjOOBpuOBhOOCi+OBi+OCguiqv+OBueOCi1xuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzR2FtZUNsYXNzRGVmaW5lZChjbGFzc05hbWUpIHtcbiAgaWYgKFxuICAgIHR5cGVvZiBwaGluYS51c2luZyhjbGFzc05hbWUpID09PSAnZnVuY3Rpb24nXG4gICAgfHwgdHlwZW9mIHBoaW5hLnVzaW5nKCdwaGluYS5nYW1lLicgKyBjbGFzc05hbWUpID09PSAnZnVuY3Rpb24nXG4gICkge1xuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEBjbGFzcyBwaGluYS5nYW1lLkdhbWVBcHBcbiAqIF9leHRlbmRzIHBoaW5hLmRpc3BsYXkuQ2FudmFzQXBwXG4gKi9cbmNsYXNzIEdhbWVBcHAgZXh0ZW5kcyBDYW52YXNBcHAge1xuICAvKipcbiAgICogQHBhcmFtIHtHYW1lQXBwT3B0aW9ucyAmIERlZmF1bHRTY2VuZU9wdGlvbnN9IFtvcHRpb25zXVxuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIG9wdGlvbnMgPSAvKiogQHR5cGUge0dhbWVBcHBPcHRpb25zfSAqLygkc2FmZS5jYWxsKG9wdGlvbnMgfHwge30sIHtcbiAgICAvLyBvcHRpb25zID0gKG9wdGlvbnMgfHwge30pLiRzYWZlKHtcbiAgICAgIHN0YXJ0TGFiZWw6ICd0aXRsZScsXG4gICAgfSkpO1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgLyoqIEB0eXBlIHthbnl9IGRhdC5HVUnjgqTjg7Pjgrnjgr/jg7PjgrkgKi9cbiAgICB0aGlzLmd1aSA9IHVuZGVmaW5lZDtcblxuICAgIHZhciBzdGFydExhYmVsID0gb3B0aW9ucy5zdGFydExhYmVsIHx8ICd0aXRsZSc7XG5cbiAgICB2YXIgc2NlbmVzID0gb3B0aW9ucy5zY2VuZXMgfHwgW1xuICAgICAge1xuICAgICAgICBjbGFzc05hbWU6IGlzR2FtZUNsYXNzRGVmaW5lZChcIlNwbGFzaFNjZW5lXCIpID8gXCJTcGxhc2hTY2VuZVwiIDogU3BsYXNoU2NlbmUsXG4gICAgICAgIGxhYmVsOiAnc3BsYXNoJyxcbiAgICAgICAgbmV4dExhYmVsOiAndGl0bGUnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY2xhc3NOYW1lOiBpc0dhbWVDbGFzc0RlZmluZWQoXCJUaXRsZVNjZW5lXCIpID8gXCJUaXRsZVNjZW5lXCIgOiBUaXRsZVNjZW5lLFxuICAgICAgICBsYWJlbDogJ3RpdGxlJyxcbiAgICAgICAgbmV4dExhYmVsOiAnbWFpbicsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjbGFzc05hbWU6IGlzR2FtZUNsYXNzRGVmaW5lZChcIk1haW5TY2VuZVwiKSA/IFwiTWFpblNjZW5lXCIgOiBEZWZhdWx0TWFpblNjZW5lLFxuICAgICAgICBsYWJlbDogJ21haW4nLFxuICAgICAgICBuZXh0TGFiZWw6ICdyZXN1bHQnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY2xhc3NOYW1lOiBpc0dhbWVDbGFzc0RlZmluZWQoXCJSZXN1bHRTY2VuZVwiKSA/IFwiUmVzdWx0U2NlbmVcIiA6IFJlc3VsdFNjZW5lLFxuICAgICAgICBsYWJlbDogJ3Jlc3VsdCcsXG4gICAgICAgIG5leHRMYWJlbDogJ3RpdGxlJyxcbiAgICAgIH0sXG4gICAgXTtcblxuICAgIHNjZW5lcyA9IGVhY2gkMS5jYWxsKHNjZW5lcywgZnVuY3Rpb24ocykge1xuICAgICAgcy5hcmd1bWVudHMgPSBzLmFyZ3VtZW50cyB8fCBvcHRpb25zO1xuICAgIH0pO1xuXG4gICAgdmFyIHNjZW5lID0gbmV3IE1hbmFnZXJTY2VuZSh7XG4gICAgICBzdGFydExhYmVsOiBzdGFydExhYmVsLFxuICAgICAgc2NlbmVzOiBzY2VuZXMsXG4gICAgfSk7XG5cbiAgICBpZiAob3B0aW9ucy5hc3NldHMpIHtcbiAgICAgIC8vIOODreODvOODh+OCo+ODs+OCsO+8mmVzbeeJiOOBp+OBr+eLrOiHquOBrkxvYWRpbmdTY2VuZeOBr+OCquODl+OCt+ODp+ODs+OBp+a4oeOBm+OCi+OCiOOBhuOBq+OBmeOCi1xuXG4gICAgICB2YXIgbG9hZGluZ09wdGlvbnMgPSAkZXh0ZW5kLmNhbGwoe30sIG9wdGlvbnMsIHtcbiAgICAgIC8vIHZhciBsb2FkaW5nT3B0aW9ucyA9ICh7fSkuJGV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgIGV4aXRUeXBlOiAnJyxcbiAgICAgIH0pO1xuICAgICAgLy8g44Kw44Ot44O844OQ44Or5a6a576p44GuTG9hZGluZ1NjZW5l44KS5o6i44GZ77yI5b6T5p2l77yJXG4gICAgICAvLyAtPiDjgarjgZHjgozjgbDjgqrjg5fjgrfjg6fjg7PjgpLjg4Hjgqfjg4Pjgq8gXG4gICAgICAvLyAtPiDjgZPjgozjgoLjgarjgZHjgozjgbDjg4fjg5Xjgqnjg6vjg4jjga5Mb2FkaW5nU2NlbmXjgpLkvb/jgYZcbiAgICAgIHZhciBkZWZpbmVkTG9hZGluZ0NsYXNzID0gcGhpbmEudXNpbmcoXCJMb2FkaW5nU2NlbmVcIikgfHwgcGhpbmEudXNpbmcoXCJwaGluYS5nYW1lLkxvYWRpbmdTY2VuZVwiKTtcbiAgICAgIHZhciBsb2FkaW5nID0gKHR5cGVvZiBkZWZpbmVkTG9hZGluZ0NsYXNzID09PSAnZnVuY3Rpb24nKSBcbiAgICAgICAgPyBkZWZpbmVkTG9hZGluZ0NsYXNzKGxvYWRpbmdPcHRpb25zKVxuICAgICAgICA6IChvcHRpb25zLmxvYWRpbmdTY2VuZSAhPSBudWxsKVxuICAgICAgICAgID8gbmV3IG9wdGlvbnMubG9hZGluZ1NjZW5lKGxvYWRpbmdPcHRpb25zKSBcbiAgICAgICAgICA6IG5ldyBMb2FkaW5nU2NlbmUobG9hZGluZ09wdGlvbnMpXG4gICAgICA7XG4gICAgICB0aGlzLnJlcGxhY2VTY2VuZShsb2FkaW5nKTtcblxuICAgICAgbG9hZGluZy5vbmxvYWRlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnJlcGxhY2VTY2VuZShzY2VuZSk7XG4gICAgICAgIGlmIChvcHRpb25zLmRlYnVnKSB7XG4gICAgICAgICAgdGhpcy5fZW5hYmxlRGVidWdnZXIoKTtcbiAgICAgICAgfVxuICAgICAgfS5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMucmVwbGFjZVNjZW5lKHNjZW5lKTtcbiAgICAgIGlmIChvcHRpb25zLmRlYnVnKSB7XG4gICAgICAgIHRoaXMuX2VuYWJsZURlYnVnZ2VyKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8g6Ieq5YuV44Gn44Od44O844K644GZ44KLXG4gICAgLy8gZXNt54mI44Gn44Gv54us6Ieq44Gu44Od44O844K644K344O844Oz44Gv44Kq44OX44K344On44Oz44Gn5rih44GZXG4gICAgLy8g5byV5pWw44GM5rih44Gb44Gq44GE44Gu44Gv5YWD44GL44KJXG4gICAgaWYgKG9wdGlvbnMuYXV0b1BhdXNlKSB7XG4gICAgICB0aGlzLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkZWZpbmVkUGF1c2VTY2VuZSA9IHBoaW5hLnVzaW5nKFwicGhpbmEuZ2FtZS5QYXVzZVNjZW5lXCIpO1xuICAgICAgICB2YXIgcGF1c2VTY2VuZSA9ICh0eXBlb2YgZGVmaW5lZFBhdXNlU2NlbmUgPT09ICdmdW5jdGlvbicpIFxuICAgICAgICAgID8gZGVmaW5lZFBhdXNlU2NlbmUoKSBcbiAgICAgICAgICA6IChvcHRpb25zLnBhdXNlU2NlbmUpIFxuICAgICAgICAgICAgPyBuZXcgb3B0aW9ucy5wYXVzZVNjZW5lKG9wdGlvbnMpIFxuICAgICAgICAgICAgOiBuZXcgUGF1c2VTY2VuZSgpO1xuICAgICAgICB0aGlzLnB1c2hTY2VuZShwYXVzZVNjZW5lKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgX2VuYWJsZURlYnVnZ2VyKCkge1xuICAgIGlmICh0aGlzLmd1aSkgcmV0dXJuIDtcblxuICAgIHRoaXMuZW5hYmxlRGF0R1VJKFxuICAgIC8qKlxuICAgICAqIEB0aGlzIHtHYW1lQXBwfVxuICAgICAqIEBwYXJhbSB7eyBhZGRGb2xkZXI6IChhcmcwOiBzdHJpbmcpID0+IGFueTsgfX0gZ3VpIERhdC5ndWnjgqTjg7Pjgrnjgr/jg7PjgrlcbiAgICAgKi9cbiAgICBmdW5jdGlvbihndWkpIHtcbiAgICAgIHZhciBmID0gZ3VpLmFkZEZvbGRlcignc2NlbmVzJyk7XG4gICAgICB2YXIgZnVuY3MgPSB7fTtcbiAgICAgIGVhY2gkMS5jYWxsKC8qKiBAdHlwZSB7TWFuYWdlclNjZW5lfSAqLyh0aGlzLnJvb3RTY2VuZSkuc2NlbmVzLCBmdW5jdGlvbihzY2VuZSkge1xuICAgICAgLy8gdGhpcy5yb290U2NlbmUuc2NlbmVzLmVhY2goZnVuY3Rpb24oc2NlbmUpIHtcbiAgICAgICAgZnVuY3Nbc2NlbmUubGFiZWxdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5yb290U2NlbmUucmVwbGFjZVNjZW5lKHNjZW5lLmxhYmVsKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLl9zY2VuZXMubGVuZ3RoKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpO1xuICAgICAgICByZXR1cm4gc2NlbmU7XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgZm9ySW4uY2FsbChmdW5jcywgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgLy8gZnVuY3MuZm9ySW4oZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgICBmLmFkZChmdW5jcywga2V5KTtcbiAgICAgIH0pO1xuICAgICAgZi5vcGVuKCk7XG5cbiAgICAgIHRoaXMuZ3VpID0gZ3VpO1xuICAgIH0uYmluZCh0aGlzKSk7XG4gIH1cbn1cblxuLyoqXG4gKiBBcHDjgq/jg6njgrnntbHlkIjlnotcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uL2FwcC9iYXNlYXBwJykuQmFzZUFwcCB8IGltcG9ydCgnLi4vZGlzcGxheS9kb21hcHAnKS5Eb21BcHAgfCBpbXBvcnQoJy4uL2Rpc3BsYXkvY2FudmFzYXBwJykuQ2FudmFzQXBwIHwgR2FtZUFwcH0gQXBwVW5pb25cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IENvdW50U2NlbmVPcHRpb25FeHRlbmRcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfG51bWJlcltdfSBbY291bnRdIOOCq+OCpuODs+ODiOODgOOCpuODs+WbnuaVsOOAgumFjeWIl+OBp+a4oeOBl+OBn+WgtOWQiOOAgeOBneOBrumAhumghuOBp+OCq+OCpuODs+ODiOODgOOCpuODs+OCkuihjOOBhlxuICogQHByb3BlcnR5IHtpbXBvcnQoXCIuLi9pbmRleC5lc21cIikuQ2FudmFzU3R5bGV9IFtmb250Q29sb3JdIOODleOCqeODs+ODiOOBruiJslxuICogQHByb3BlcnR5IHtudW1iZXJ9IFtmb250U2l6ZV0g44OV44Kp44Oz44OI44K144Kk44K6XG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2V4aXRUeXBlXSAnYXV0byfjga7jgajjgY3jgIHoh6rli5Xjgadwb3BTY2VuZVxuICogXG4gKiBAdHlwZWRlZiB7aW1wb3J0KFwiLi4vZGlzcGxheS9kaXNwbGF5c2NlbmVcIikuRGlzcGxheVNjZW5lT3B0aW9ucyAmIENvdW50U2NlbmVPcHRpb25FeHRlbmR9IENvdW50U2NlbmVPcHRpb25zXG4gKi9cblxuLyoqXG4gKiBAY2xhc3MgcGhpbmEuZ2FtZS5Db3VudFNjZW5lXG4gKiBfZXh0ZW5kcyBwaGluYS5kaXNwbGF5LkRpc3BsYXlTY2VuZVxuICogXG4gKiDoh6rli5Xjgafjgqvjgqbjg7Pjg4jjg4Djgqbjg7PjgpLooYzjgYbkuIDmmYLnlKhTY2VuZVxuICog44Oh44Kk44Oz44Gu44K344O844Oz44Gn44Ky44O844Og6ZaL5aeL5YmN44GrcHVzaFNjZW5l44GZ44KL44Gu44GM5LiA6Iis55qE44Gq5L2/44GE5pa5XG4gKi9cbmNsYXNzIENvdW50U2NlbmUgZXh0ZW5kcyBEaXNwbGF5U2NlbmUge1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtDb3VudFNjZW5lT3B0aW9uc30gW29wdGlvbnNdXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICBvcHRpb25zID0gJHNhZmUuY2FsbChvcHRpb25zIHx8IHt9LCBDb3VudFNjZW5lLmRlZmF1bHRzKTtcbiAgICAvLyBvcHRpb25zID0gKG9wdGlvbnMgfHwge30pLiRzYWZlKHBoaW5hLmdhbWUuQ291bnRTY2VuZS5kZWZhdWx0cyk7XG5cbiAgICB0aGlzLmJhY2tncm91bmRDb2xvciA9IG9wdGlvbnMuYmFja2dyb3VuZENvbG9yO1xuXG4gICAgdGhpcy5mcm9tSlNPTih7XG4gICAgICBjaGlsZHJlbjoge1xuICAgICAgICBsYWJlbDoge1xuICAgICAgICAgIGNsYXNzTmFtZTogTGFiZWwsXG4gICAgICAgICAgLy8gY2xhc3NOYW1lOiAncGhpbmEuZGlzcGxheS5MYWJlbCcsXG4gICAgICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgICAgICBmaWxsOiBvcHRpb25zLmZvbnRDb2xvcixcbiAgICAgICAgICAgIGZvbnRTaXplOiBvcHRpb25zLmZvbnRTaXplLFxuICAgICAgICAgICAgc3Ryb2tlOiBmYWxzZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHg6IHRoaXMuZ3JpZFguY2VudGVyKCksXG4gICAgICAgICAgeTogdGhpcy5ncmlkWS5jZW50ZXIoKSxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKiBAdHlwZSB7TGFiZWx9ICovXG4gICAgdGhpcy5sYWJlbDtcblxuICAgIC8qKiBAdHlwZSB7bnVtYmVyW119ICovXG4gICAgdGhpcy5jb3VudExpc3Q7XG5cbiAgICBpZiAob3B0aW9ucy5jb3VudCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICB0aGlzLmNvdW50TGlzdCA9IGNsb25lLmNhbGwob3B0aW9ucy5jb3VudCkucmV2ZXJzZSgpO1xuICAgICAgLy8gdGhpcy5jb3VudExpc3QgPSBvcHRpb25zLmNvdW50LmNsb25lKCkucmV2ZXJzZSgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuY291bnRMaXN0ID0gcmFuZ2UuY2FsbChbXSwgMSwgb3B0aW9ucy5jb3VudCsxKTtcbiAgICAgIC8vIHRoaXMuY291bnRMaXN0ID0gQXJyYXkucmFuZ2UoMSwgb3B0aW9ucy5jb3VudCsxKTtcbiAgICB9XG4gICAgdGhpcy5jb3VudGVyID0gdGhpcy5jb3VudExpc3QubGVuZ3RoO1xuICAgIHRoaXMuZXhpdFR5cGUgPSBvcHRpb25zLmV4aXRUeXBlO1xuXG4gICAgdGhpcy5fdXBkYXRlQ291bnQoKTtcbiAgfVxuXG4gIF91cGRhdGVDb3VudCgpIHtcbiAgICB2YXIgZW5kRmxhZyA9IHRoaXMuY291bnRlciA8PSAwO1xuICAgIHZhciBpbmRleCA9IC0tdGhpcy5jb3VudGVyO1xuXG4gICAgdGhpcy5sYWJlbC50ZXh0ID0gdGhpcy5jb3VudExpc3RbaW5kZXhdO1xuXG4gICAgdGhpcy5sYWJlbC5zY2FsZS5zZXQoMSwgMSk7XG4gICAgdGhpcy5sYWJlbC50d2VlbmVyXG4gICAgICAuY2xlYXIoKVxuICAgICAgLnRvKHtcbiAgICAgICAgc2NhbGVYOiAxLFxuICAgICAgICBzY2FsZVk6IDEsXG4gICAgICAgIGFscGhhOiAxLFxuICAgICAgfSwgMjUwKVxuICAgICAgLndhaXQoNTAwKVxuICAgICAgLnRvKHtcbiAgICAgICAgc2NhbGVYOiAxLjUsXG4gICAgICAgIHNjYWxlWTogMS41LFxuICAgICAgICBhbHBoYTogMC4wXG4gICAgICB9LCAyNTApXG4gICAgICAuY2FsbChcbiAgICAgIC8qKiBAdGhpcyBDb3VudFNjZW5lICovXG4gICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuY291bnRlciA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5mbGFyZSgnZmluaXNoJyk7XG4gICAgICAgICAgaWYgKHRoaXMuZXhpdFR5cGUgPT09ICdhdXRvJykge1xuICAgICAgICAgICAgdGhpcy5hcHAucG9wU2NlbmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5fdXBkYXRlQ291bnQoKTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcyk7XG4gIH1cblxufVxuXG4vKiogQHR5cGUge0NvdW50U2NlbmVPcHRpb25zfSAqL1xuQ291bnRTY2VuZS5kZWZhdWx0cyA9IHtcbiAgY291bnQ6IDMsXG5cbiAgd2lkdGg6IDY0MCxcbiAgaGVpZ2h0OiA5NjAsXG5cbiAgZm9udENvbG9yOiAnd2hpdGUnLFxuICBmb250U2l6ZTogMTY0LFxuICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDUwLCA1MCwgNTAsIDEpJyxcblxuICBleGl0VHlwZTogJ2F1dG8nLFxufTtcblxuZXhwb3J0IHsgQWNjZWxlcm9tZXRlciwgQWNjZXNzb3J5LCBBamF4LCBhcnJheUV4dGVuc2lvbnMgYXMgQXJyYXlFeCwgYXJyYXlTdGF0aWNFeHRlbnNpb25zIGFzIEFycmF5RXhTdGF0aWMsIEFzc2V0LCBBc3NldExvYWRlciwgQXNzZXRNYW5hZ2VyLCBCYXNlQXBwLCBCdXR0b24sIENhbnZhcywgQ2FudmFzQXBwLCBDYW52YXNMYXllciwgQ2FudmFzUmVuZGVyZXIsIENoYW5nZURpc3BhdGNoZXIsIENpcmNsZSwgQ2lyY2xlR2F1Z2UsIENpcmNsZVNoYXBlLCBDb2xsaXNpb24sIENvbG9yLCBDb3VudFNjZW5lLCBEaXNwbGF5RWxlbWVudCwgRGlzcGxheVNjZW5lLCBEb21BcHAsIERyYWdnYWJsZSwgRWxlbWVudCwgRXZlbnREaXNwYXRjaGVyLCBGaWxlLCBGbGlja2FibGUsIEZsb3csIEZvbnQsIEZyYW1lQW5pbWF0aW9uLCBHYW1lQXBwLCBQaGluYUdhbWVwYWQgYXMgR2FtZXBhZCwgR2FtZXBhZE1hbmFnZXIsIEdhdWdlLCBHcmlkLCBIZWFydFNoYXBlLCBJbnB1dCwgSW50ZXJhY3RpdmUsIEtleWJvYXJkLCBMYWJlbCwgTGFiZWxBcmVhLCBMYXllciwgTG9hZGluZ1NjZW5lLCBNYW5hZ2VyU2NlbmUsIG1hdGhFeHRlbnNpb25zIGFzIE1hdGhFeCwgTWF0cml4MzMsIE1vdXNlLCBudW1iZXJFeHRlbnNpb25zIGFzIE51bWJlckV4LCBPYmplY3QyRCwgb2JqZWN0RXh0ZW5zaW9ucyBhcyBPYmplY3RFeCwgUGF0aFNoYXBlLCBQYXVzZVNjZW5lLCBQaHlzaWNhbCwgUGxhaW5FbGVtZW50LCBQb2x5Z29uU2hhcGUsIFF1ZXJ5U3RyaW5nLCBSYW5kb20sIFJlY3QsIFJlY3RhbmdsZVNoYXBlLCBSZXN1bHRTY2VuZSwgU2NlbmUsIFNjcmlwdCwgU2hhcGUsIFNvdW5kLCBTb3VuZE1hbmFnZXIsIFNwbGFzaFNjZW5lLCBTcHJpdGUsIFNwcml0ZVNoZWV0LCBTdGFyU2hhcGUsIHN0cmluZ0V4dGVuc2lvbnMgYXMgU3RyaW5nRXgsIFN1cHBvcnQsIFRleHR1cmUsIFRocmVlTGF5ZXIsIFRpY2tlciwgVGl0bGVTY2VuZSwgVG91Y2gkMSBhcyBUb3VjaCwgVG91Y2hMaXN0LCBUcmlhbmdsZVNoYXBlLCBUd2VlbiwgVHdlZW5lciwgVHdpdHRlciwgVXBkYXRlciwgVmVjdG9yMiwgVmVjdG9yMywgV2F2ZSwgZGF0ZUV4dGVuc2lvbnMgYXMgZGF0ZUV4LCBkYXRlU3RhdGljRXh0ZW5zaW9ucyBhcyBkYXRlRXhTdGF0aWMsIGV4dGVuZEJ1aWx0SW5PYmplY3QsIGV4dGVuZEV2ZW50T2JqZWN0LCBwaGluYSB9O1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7VGlsZWRNYXB9IGZyb20gXCIuL3RpbGVkbWFwL1RpbGVkbWFwXCI7XG5pbXBvcnQge1RpbGVTZXR9IGZyb20gXCIuL3RpbGVkbWFwL1RpbGVzZXRcIjsiXSwic291cmNlUm9vdCI6IiJ9